(self.webpackChunkzom=self.webpackChunkzom||[]).push([[179],{9019:(Mt,xe,U)=>{"use strict";U.d(xe,{N:()=>E});const E={production:!0,userBaseUrl:"https://backend-social-net.herokuapp.com/",appIdAgora:"25eb4c988a7644d9ac9e6362bf1d1a90"}},3543:(Mt,xe,U)=>{"use strict";var E=U(1481),M=U(8256),S=U(6773);const L=[{path:"home",loadChildren:()=>U.e(549).then(U.bind(U,8549)).then(ee=>ee.HomeModule)},{path:"auth",loadChildren:()=>Promise.all([U.e(433),U.e(131)]).then(U.bind(U,9131)).then(ee=>ee.AuthModule)},{path:"videoCall",loadChildren:()=>Promise.all([U.e(433),U.e(242)]).then(U.bind(U,7242)).then(ee=>ee.VideoCallModule)},{path:"**",redirectTo:"home"}];let ae=(()=>{class ee{}return ee.\u0275fac=function(Le){return new(Le||ee)},ee.\u0275mod=M.oAB({type:ee}),ee.\u0275inj=M.cJS({imports:[S.Bz.forRoot(L,{scrollPositionRestoration:"enabled"}),S.Bz]}),ee})(),De=(()=>{class ee{constructor(){this.title="zom"}}return ee.\u0275fac=function(Le){return new(Le||ee)},ee.\u0275cmp=M.Xpm({type:ee,selectors:[["app-root"]],decls:1,vars:0,template:function(Le,z){1&Le&&M._UZ(0,"router-outlet")},dependencies:[S.lC]}),ee})();var pe=U(529),ce=U(1444),Ce=U(9019);let we=(()=>{class ee{}return ee.\u0275fac=function(Le){return new(Le||ee)},ee.\u0275mod=M.oAB({type:ee,bootstrap:[De]}),ee.\u0275inj=M.cJS({imports:[E.b2,ae,pe.JF,ce.QC.forRoot({AppID:Ce.N.appIdAgora})]}),ee})();(0,M.G48)(),E.q6().bootstrapModule(we).catch(ee=>console.error(ee))},8293:Mt=>{window,Mt.exports=function(xe){var U={};function E(M){if(U[M])return U[M].exports;var S=U[M]={i:M,l:!1,exports:{}};return xe[M].call(S.exports,S,S.exports,E),S.l=!0,S.exports}return E.m=xe,E.c=U,E.d=function(M,S,L){E.o(M,S)||Object.defineProperty(M,S,{enumerable:!0,get:L})},E.r=function(M){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(M,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(M,"__esModule",{value:!0})},E.t=function(M,S){if(1&S&&(M=E(M)),8&S||4&S&&"object"==typeof M&&M&&M.__esModule)return M;var L=Object.create(null);if(E.r(L),Object.defineProperty(L,"default",{enumerable:!0,value:M}),2&S&&"string"!=typeof M)for(var ae in M)E.d(L,ae,function(De){return M[De]}.bind(null,ae));return L},E.n=function(M){var S=M&&M.__esModule?function(){return M.default}:function(){return M};return E.d(S,"a",S),S},E.o=function(M,S){return Object.prototype.hasOwnProperty.call(M,S)},E.p="",E(E.s=26)}([function(xe,U,E){"use strict";E.r(U);var M=E(6),S=E.n(M),L=E(7),ae=E(2),De=E(1),pe=0,ce="free",Ce=[],we=[],Y=0;setInterval(function(){Object(ae.getParameter)("UPLOAD_LOG")&&ee.info("console log upload")},9e5);var ee=function(){var je,Le,z,ke,ye,K,G="https://".concat(Object(ae.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v1"),Fe=["DEBUG","INFO","WARNING","ERROR","NONE"],He=0,Xe=function me(ge){ce="uploading",setTimeout(function(){!function(Se,Be,oe){var J;Array.isArray(Se)||(Se=[Se]),Se=Se.map(function(he){return{log_item_id:pe++,log_level:he.log_level,payload_str:he.payload}}),J={sdk_version:ae.VERSION,process_id:Object(De.a)(),payload:JSON.stringify(Se)};try{Object(L.c)(G,J,function(he){"OK"===he?Be&&Be():oe&&oe()},function(he){oe&&oe()},{withCredentials:!0})}catch(he){oe&&oe()}}(ge,function(){Y=0,0!==Ce.length?(we=Ce.splice(0,Ce.length<10?Ce.length:10),me(we)):ce="free"},function(){setTimeout(function(){me(we)},Y++<2?200:1e4)})},3e3)};Le=function(){for(var me=[0],ge=0;ge<arguments.length;ge++)me.push(arguments[ge]);je.apply(this,me)},z=function(){for(var me=[1],ge=0;ge<arguments.length;ge++)me.push(arguments[ge]);je.apply(this,me)},ke=function(){for(var me=[2],ge=0;ge<arguments.length;ge++)me.push(arguments[ge]);je.apply(this,me)},ye=function(){for(var me=[3],ge=0;ge<arguments.length;ge++)me.push(arguments[ge]);je.apply(this,me)};var $e={};return K=function(me){$e[me]||(ke.apply(void 0,arguments),$e[me]=!0)},{DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4,enableLogUpload:function(){Object(ae.setParameter)("UPLOAD_LOG",!0)},disableLogUpload:function(){Object(ae.setParameter)("UPLOAD_LOG",!1)},setProxyServer:function(me){G=me?"https://".concat(me,"/ls/?h=").concat(Object(ae.getParameter)("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Object(ae.getParameter)("LOG_UPLOAD_SERVER"),"/upload/v1")},setLogLevel:function(me){me>4?me=4:me<0&&(me=0),He=me},log:je=function(){var me,ge=arguments[0],Se=arguments;if(Se[0]=(me=new Date).toTimeString().split(" ")[0]+":"+me.getMilliseconds()+" Agora-SDK ["+(Fe[ge]||"DEFAULT")+"]:",function(Be,oe){if(Object(ae.getParameter)("UPLOAD_LOG"))try{oe=Array.prototype.slice.call(oe);var J="";oe.forEach(function(he){"object"===S()(he)&&(he=JSON.stringify(he)),J=J+he+" "}),Ce.push({payload:J,log_level:Be}),"free"===ce&&(we=Ce.splice(0,Ce.length<10?Ce.length:10),Xe(we))}catch{}}(ge,Se),!(ge<He))switch(ge){case 0:case 1:console.log.apply(console,Se);break;case 2:console.warn.apply(console,Se);break;case 3:console.error.apply(console,Se);break;default:return void console.log.apply(console,Se)}},debug:Le,info:z,warning:ke,deprecate:K,error:ye}}();U.default=ee},function(xe,U,E){"use strict";var M=E(11),S=E.n(M),L=E(4),ae=E.n(L),De=E(2),pe=E(0),ce=E(7),Ce=E(12),we=E.n(Ce);E.d(U,"b",function(){return Le}),E.d(U,"a",function(){return je});var Y={eventType:null,sid:null,lts:null,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0},ee=null,je=function(){return ee||(ee="process-"+we()(),pe.default.info("processId: "+ee)),ee},Le=function(){var z={list:{}};z.url=Object(ce.e)()?"https://".concat(Object(De.getParameter)("EVENT_REPORT_DOMAIN"),":6443/events/message"):"http://".concat(Object(De.getParameter)("EVENT_REPORT_DOMAIN"),":6080/events/message"),z.urlBackup=Object(ce.e)()?"https://".concat(Object(De.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6443/events/message"):"http://".concat(Object(De.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6080/events/message"),z.setProxyServer=function(ye){ye?(z.url=Object(ce.e)()?"https://".concat(ye,"/rs/?h=").concat(Object(De.getParameter)("EVENT_REPORT_DOMAIN"),"&p=6443&d=events/message"):"http://".concat(ye,"/rs/?h=").concat(Object(De.getParameter)("EVENT_REPORT_DOMAIN"),"&p=6080&d=events/message"),z.urlBackup=Object(ce.e)()?"https://".concat(ye,"/rs/?h=").concat(Object(De.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6443&d=events/message"):"http://".concat(ye,"/rs/?h=").concat(Object(De.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),"&p=6080&d=events/message"),pe.default.debug("reportProxyServerURL: ".concat(z.url)),pe.default.debug("reportProxyServerBackupURL: ".concat(z.urlBackup))):(z.url=Object(ce.e)()?"https://".concat(Object(De.getParameter)("EVENT_REPORT_DOMAIN"),":6443/events/message"):"http://".concat(Object(De.getParameter)("EVENT_REPORT_DOMAIN"),":6080/events/message"),z.urlBackup=Object(ce.e)()?"https://".concat(Object(De.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6443/events/message"):"http://".concat(Object(De.getParameter)("EVENT_REPORT_BACKUP_DOMAIN"),":6080/events/message"))},z.sessionInit=function(ye,K){var G=ae()({},Y);G.startTime=+new Date,G.sid=ye,G.cname=K.cname,z.list[ye]=G;var Fe=ae()({},{willUploadConsoleLog:Object(De.getParameter)("UPLOAD_LOG")},K.extend),He=ae()({},G);He.eventType="session_init",He.appid=K.appid,He.browser=navigator.userAgent,He.build=De.BUILD,He.lts=+new Date,He.elapse=He.lts-He.startTime,He.extend=JSON.stringify(Fe),He.mode=K.mode,He.process=je(),He.success=K.succ,He.version=De.VERSION,delete He.startTime,z.send({type:"io.agora.pb.Wrtc.Session",data:He}),z._flushInvokeReport(ye)},z.joinChooseServer=function(ye,K,G){if(z.list[ye]){K.uid&&(z.list[ye].uid=parseInt(K.uid)),K.cid&&(z.list[ye].cid=parseInt(K.cid));var Fe=ae()({},z.list[ye]);Fe.eventType="join_choose_server";var He=K.lts;Fe.lts=Date.now(),Fe.eventElapse=Fe.lts-He,Fe.chooseServerAddr=K.csAddr,Fe.errorCode=K.ec,Fe.elapse=Fe.lts-Fe.startTime,Fe.success=K.succ,Fe.chooseServerAddrList=JSON.stringify(K.serverList),delete Fe.startTime,z.send({type:"io.agora.pb.Wrtc.JoinChooseServer",data:Fe})}},z.reqUserAccount=function(ye,K){K.vid&&(z.list[ye].vid=K.vid);var G=ae()({},z.list[ye]),Fe=K.lts;G.eventType="req_user_account",G.lts=Date.now(),G.success=K.success,G.serverAddress=K.serverAddress,G.stringUid=K.stringUid,G.uid=K.uid,G.errorCode=K.errorCode,G.elapse=G.lts-G.startTime,G.eventElapse=G.lts-Fe,G.extend="string"==typeof K.extend?K.extend:JSON.stringify(K.extend),delete G.startTime,z.send({type:"io.agora.pb.Wrtc.ReqUserAccount",data:G})},z.joinGateway=function(ye,K){K.vid&&(z.list[ye].vid=K.vid);var G=ae()({},z.list[ye]),Fe=K.lts;G.eventType="join_gateway",G.lts=Date.now(),G.gatewayAddr=K.addr,G.success=K.succ,G.errorCode=K.ec,G.elapse=G.lts-G.startTime,G.eventElapse=G.lts-Fe,delete G.startTime,z.send({type:"io.agora.pb.Wrtc.JoinGateway",data:G})},z.publish=function(ye,K){var G=ae()({},z.list[ye]);G.eventType="publish";var Fe=K.lts;G.lts=Date.now(),G.eventElapse=G.lts-Fe,G.elapse=G.lts-G.startTime,G.success=K.succ,G.errorCode=K.ec,K.videoName&&(G.videoName=K.videoName),K.audioName&&(G.audioName=K.audioName),K.screenName&&(G.screenName=K.screenName),delete G.startTime,z.send({type:"io.agora.pb.Wrtc.Publish",data:G}),z._flushInvokeReport(ye)},z.subscribe=function(ye,K){var G=ae()({},z.list[ye]);G.eventType="subscribe";var Fe=K.lts;G.lts=Date.now(),G.eventElapse=G.lts-Fe,G.elapse=G.lts-G.startTime,G.errorCode=K.ec,G.success=K.succ,isFinite(K.peerid)?G.peer=K.peerid:G.peerSuid=""+K.peerid,"boolean"==typeof K.video&&(G.video=K.video),"boolean"==typeof K.audio&&(G.audio=K.audio),delete G.startTime,z.send({type:"io.agora.pb.Wrtc.Subscribe",data:G}),z._flushInvokeReport(ye)},z.firstRemoteFrame=function(ye,K){var G=ae()({},z.list[ye]);G.eventType="first_remote_frame";var Fe=K.lts;G.lts=Date.now(),G.eventElapse=G.lts-Fe,G.elapse=G.lts-G.startTime,G.width=K.width,G.height=K.height,G.success=K.succ,G.errorCode=K.ec,isFinite(K.peerid)?G.peer=K.peerid:G.peerSuid=""+K.peerid,delete G.startTime,z.send({type:"io.agora.pb.Wrtc.FirstFrame",data:G})},z.streamSwitch=function(ye,K){var G=ae()({},z.list[ye]);G.eventType="stream_switch",G.lts=Date.now(),G.isDual=K.isdual,G.elapse=G.lts-G.startTime,G.success=G.succ,delete G.startTime,z.send({type:"io.agora.pb.Wrtc.StreamSwitch",data:G})},z.audioSendingStopped=function(ye,K){var G=ae()({},z.list[ye]);G.eventType="audio_sending_stopped",G.lts=Date.now(),G.elapse=G.lts-G.startTime,G.reason=K.reason,G.success=K.succ,delete G.startTime,z.send({type:"io.agora.pb.Wrtc.AudioSendingStopped",data:G})},z.videoSendingStopped=function(ye,K){var G=ae()({},z.list[ye]);G.eventType="video_sending_stopped",G.lts=Date.now(),G.elapse=G.lts-G.startTime,G.reson=K.reason,G.success=K.succ,delete G.startTime,z.send({type:"io.agora.pb.Wrtc.VideoSendingStopped",data:G})},z.requestProxyAppCenter=function(ye,K){var G=ae()({},z.list[ye]),Fe=K.lts;G.eventType="request_proxy_appcenter",G.lts=Date.now(),G.eventElapse=G.lts-Fe,G.elapse=G.lts-G.startTime,G.extend=K.extend+"",G.APAddr=K.APAddr,G.workerManagerList=K.workerManagerList,G.response=K.response,G.errorCode=K.ec,G.success=K.succ,delete G.startTime,z.send({type:"io.agora.pb.Wrtc.RequestProxyAppCenter",data:G})},z.requestProxyWorkerManager=function(ye,K){var G=ae()({},z.list[ye]),Fe=K.lts;G.eventType="request_proxy_worker_manager",G.lts=Date.now(),G.eventElapse=G.lts-Fe,G.elapse=G.lts-G.startTime,G.extend=K.extend,G.workerManagerAddr=K.workerManagerAddr,G.response=K.response,G.errorCode=K.ec,G.success=K.succ,delete G.startTime,z.send({type:"io.agora.pb.Wrtc.RequestProxyWorkerManager",data:G})};var ke=0;return z.reportApiInvoke=function(ye,K){var G=K.tag,Fe=K.name,He=K.getStates,Xe=K.options,$e=K.timeout,me=void 0===$e?6e4:$e,ge=K.callback,Se=K.reportResult,Be=void 0===Se||Se,oe=Date.now(),J=0,he=ke++,de=function(){return S()({tag:G,invokeId:he,sid:ye,name:Fe,apiInvokeTime:oe,options:Xe},He&&{states:(re=He(),Object.keys(re).reduce(function(it,ft){var Ye=it;return null!=re[ft]&&(Ye[ft]=re[ft]),Ye},{}))});var re},Ze=!!Object(De.getParameter)("SHOW_REPORT_INVOKER_LOG");Ze&&pe.default.info("".concat(Fe," start"));var ve=setTimeout(function(){Le._sendApiInvoke(S()({},de(),{error:"API_INVOKE_TIMEOUT",success:!1}))},me);return function(re,it){if(clearTimeout(ve),++J>1&&(re="EXECUTOR_INVOKE_".concat(J)),re)return Le._sendApiInvoke(S()({},de(),{success:!1,error:re},He&&{states:He()})),Ze&&pe.default.info("".concat(Fe," onFailure"),re),ge&&ge(re);Le._sendApiInvoke(S()({},de(),{success:!0},Be&&{result:it},He&&{states:He()})),Ze&&pe.default.info("".concat(Fe," onSuccess")),ge&&ge(null,it)}},z._cachedItems=[],z._cacheInvokeReport=function(ye){ye.lts||(ye.lts=Date.now()),z._cachedItems.push(ye),z._cachedItems.length>50&&z._cachedItems.shift()},z._flushInvokeReport=function(ye){if(z._cachedItems.length){var K=z._cachedItems;z._cachedItems=[],pe.default.debug("Flush cached event reporting:",K.length),K.forEach(function(G,Fe){G.sid=ye,setTimeout(function(){z._sendApiInvoke(G)},5e3+500*Fe)})}},z._sendApiInvoke=function(ye){var K=ye.tag,G=ye.invokeId,Fe=ye.sid,He=ye.name,Xe=ye.result,$e=ye.states,me=ye.options,ge=ye.error,Se=ye.success,Be=ye.apiInvokeTime,oe=ye.lts,J=Object(De.getParameter)("NOT_REPORT_EVENT");if(!(K&&J instanceof Array&&-1!==J.indexOf(K)))if(z.list[Fe]){var he=z.list[Fe],de=he.startTime,Ze=he.cname,ve=he.uid,re=he.cid,it=(oe=oe||Date.now())-de,ft=oe-Be,Ye="";if(me)try{Ye=JSON.stringify(me)}catch{Ye=me.toString()}var Bt=S()({invokeId:G,sid:Fe,cname:Ze,cid:re,lts:oe,uid:ve,success:Se,elapse:it,apiName:He,execElapse:ft},void 0!==me&&{options:Ye},void 0!==$e&&{execStates:JSON.stringify($e)},void 0!==ge&&{errorCode:JSON.stringify(ge)},void 0!==Xe&&{execResult:JSON.stringify(Xe)});z.send({type:"io.agora.pb.Wrtc.ApiInvoke",data:Bt})}else z._cacheInvokeReport(arguments[0])},z._send=function(ye){try{var K=[];ye&&ye.data&&ye.data.apiName?K.push(["apiName",""+ye.data.apiName]):ye&&ye.data&&ye.data.eventType&&K.push(["eventType",ye.data.eventType]);var G=K.map(function(He){return"".concat(He[0],"=").concat(encodeURIComponent(He[1]))}).join("&"),Fe=-1===z.url.indexOf("?")?"".concat(z.url,"?").concat(G):z.url;Object(ce.c)(Fe,ye,null,function(He){var Xe=-1===z.urlBackup.indexOf("?")?"".concat(z.urlBackup,"?").concat(G):z.urlBackup;Object(ce.c)(Xe,ye,null,function($e){},{timeout:1e4})},{timeout:1e4})}catch{}},z.sendCache=[],z.sendTimer=null,z.send=function(ye){if(z.sendCache.push(ye),null===z.sendTimer)return function K(){z.sendTimer=setTimeout(function(){if(0!==z.sendCache.length)return z._send(z.sendCache.shift()),K();z.sendTimer=null},Object(De.getParameter)("EVENT_REPORT_SEND_INTERVAL"))}()},z}()},function(xe,U,E){"use strict";U.__esModule=!0,U.BUILD="v2.9.0-0-gd55f286",U.VERSION="2.9.0",U.SUPPORT_RESOLUTION_LIST={"90p_1":[160,90,null,null,null,null],"120p_1":[160,120,15,15,30,65],"120p_3":[120,120,15,15,30,50],"120p_4":[212,120,null,null,null,null],"180p_1":[320,180,15,15,30,140],"180p_3":[180,180,15,15,30,100],"180p_4":[240,180,15,15,30,120],"240p_1":[320,240,15,15,40,200],"240p_3":[240,240,15,15,40,140],"240p_4":[424,240,15,15,40,220],"360p_1":[640,360,15,15,80,400],"360p_3":[360,360,15,15,80,260],"360p_4":[640,360,30,30,80,600],"360p_6":[360,360,30,30,80,400],"360p_7":[480,360,15,15,80,320],"360p_8":[480,360,30,30,80,490],"360p_9":[640,360,15,15,80,800],"360p_10":[640,360,24,24,80,800],"360p_11":[640,360,24,24,80,1e3],"480p_1":[640,480,15,15,20,500,1,5],"480p_2":[640,480,30,30,100,1e3,25,30],"480p_3":[480,480,15,15,100,400],"480p_4":[640,480,30,30,100,750],"480p_6":[480,480,30,30,100,600],"480p_8":[848,480,15,15,100,610],"480p_9":[848,480,30,30,100,930],"480p_10":[640,480,10,10,100,400],"720p_1":[1280,720,15,15,120,1130,1,5],"720p_2":[1280,720,30,30,120,2e3,25,30],"720p_3":[1280,720,30,30,120,1710],"720p_5":[960,720,15,15,120,910],"720p_6":[960,720,30,30,120,1380],"1080p_1":[1920,1080,15,15,120,2080,1,5],"1080p_2":[1920,1080,30,30,120,3e3,25,30],"1080p_3":[1920,1080,30,30,120,3150],"1080p_5":[1920,1080,60,60,120,4780],"1440p_1":[2560,1440,30,30,120,4850],"1440p_2":[2560,1440,60,60,120,7350],"4k_1":[3840,2160,30,30,120,8910],"4k_3":[3840,2160,60,60,120,13500]},U.AUDIO_PROFILE_SETTINGS={speech_low_quality:[!1,!1,!0,!0],speech_standard:[!1,!1,!0,!1],music_standard:[!1,!1,!1,!1],standard_stereo:[!1,!0,!1,!1],high_quality:[!0,!1,!1,!1],high_quality_stereo:[!0,!0,!1,!1],default:[!1,!1,!1,!1]};var M={WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-ap-web-2.agoraio.cn"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-ap-web-4.agoraio.cn"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-2.agoraio.cn","cds-ap-web-3.agora.io","cds-ap-web-4.agoraio.cn"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-2.agoraio.cn","sua-ap-web-3.agora.io","sua-ap-web-4.agoraio.cn"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-2.agoraio.cn","uap-ap-web-3.agora.io","uap-ap-web-4.agoraio.cn"],ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"webcollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"webcollector-2.agoraio.cn",WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,LIVESTREAMING_ALIGN:!0,HTTP_CONNECT_TIMEOUT:5e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_TIMEOUT:1e4,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,REPORT_STATS:!0,REPORT_STATS_TIMEOUT:3e3,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],FILEPATH_LENMAX:255,SUBSCRIBE_TCC:!1,PING_PONG_TIME_OUT:10,DUALSTREAM_OPERATION_CHECK:!0,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:1e3,MEDIA_ELEMENT_EXISTS_DEPTH:3,CANDIDATE_TIMEOUT:2e3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,TICKET_RENEW_TIMEOUT:828e5,SHOW_REPORT_INVOKER_LOG:!1,STATS_FILTER:{transportId:!0,googTrackId:!0},FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,FORCE_CHANGED_GATEWAY_FLAG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:""};U.setParameter=function(S,L){return void 0!==M[S]&&(M[S]=L,!0)},U.getParameter=function(S){return void 0!==M[S]?M[S]:null}},function(xe,U,E){"use strict";E.r(U),E.d(U,"getBrowserInfo",function(){return ye}),E.d(U,"getBrowserVersion",function(){return Y}),E.d(U,"getBrowserOS",function(){return ee}),E.d(U,"isChrome",function(){return M}),E.d(U,"isSafari",function(){return S}),E.d(U,"isFireFox",function(){return ae}),E.d(U,"isOpera",function(){return De}),E.d(U,"isEdge",function(){return L}),E.d(U,"isQQBrowser",function(){return pe}),E.d(U,"isWeChatBrowser",function(){return ce}),E.d(U,"isLegacyChrome",function(){return Le}),E.d(U,"isSupportedPC",function(){return Ce}),E.d(U,"isSupportedMobile",function(){return we}),E.d(U,"getChromeKernelVersion",function(){return ke}),E.d(U,"isChromeKernel",function(){return je});var M=function(){var K=ye();return K.name&&"Chrome"===K.name},S=function(){var K=ye();return K.name&&"Safari"===K.name},L=function(){var K=ye();return K.name&&"Edge"===K.name},ae=function(){var K=ye();return K.name&&"Firefox"===K.name},De=function(){var K=ye();return K.name&&"OPR"===K.name},pe=function(){var K=ye();return K.name&&"QQBrowser"===K.name},ce=function(){var K=ye();return K.name&&"MicroMessenger"===K.name},Ce=function(){var K=ee();return"Linux"===K||"Mac OS X"===K||"Mac OS"===K||-1!==K.indexOf("Windows")},we=function(){var K=ee();return"Android"===K||"iOS"===K},Y=function(){return ye().version},ee=function(){return ye().os},je=function(){return!!navigator.userAgent.match(/chrome\/[\d]./i)};function Le(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}var z,ke=function(){var K=navigator.userAgent.match(/chrome\/[\d]./i);return K&&K[0]&&K[0].split("/")[1]},ye=(z=function(){var K,G=navigator.userAgent,Fe=G.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];"Chrome"===Fe[1]&&null!=(K=G.match(/(OPR(?=\/))\/?(\d+)/i))&&(Fe=K),"Safari"===Fe[1]&&null!=(K=G.match(/version\/(\d+)/i))&&(Fe[2]=K[1]),~G.toLowerCase().indexOf("qqbrowser")&&null!=(K=G.match(/(qqbrowser(?=\/))\/?(\d+)/i))&&(Fe=K),~G.toLowerCase().indexOf("micromessenger")&&null!=(K=G.match(/(micromessenger(?=\/))\/?(\d+)/i))&&(Fe=K),~G.toLowerCase().indexOf("edge")&&null!=(K=G.match(/(edge(?=\/))\/?(\d+)/i))&&(Fe=K),~G.toLowerCase().indexOf("trident")&&null!=(K=/\brv[ :]+(\d+)/g.exec(G)||[])&&(Fe=[null,"IE",K[1]]);var He=void 0,Xe=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var $e in Xe){var me=Xe[$e];if(me.r.test(navigator.userAgent)){He=me.s;break}}return{name:Fe[1],version:Fe[2],os:He}}(),function(){return z})},function(xe,U){function E(){return xe.exports=E=Object.assign||function(M){for(var S=1;S<arguments.length;S++){var L=arguments[S];for(var ae in L)Object.prototype.hasOwnProperty.call(L,ae)&&(M[ae]=L[ae])}return M},E.apply(this,arguments)}xe.exports=E},function(xe,U,E){xe.exports=E(24)},function(xe,U){function E(S){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(L){return typeof L}:function(L){return L&&"function"==typeof Symbol&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L})(S)}function M(S){return xe.exports=M="function"==typeof Symbol&&"symbol"===E(Symbol.iterator)?function(L){return E(L)}:function(L){return L&&"function"==typeof Symbol&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":E(L)},M(S)}xe.exports=M},function(xe,U,E){"use strict";E.d(U,"c",function(){return Ce}),E.d(U,"e",function(){return we}),E.d(U,"b",function(){return De}),E.d(U,"a",function(){return pe}),E.d(U,"d",function(){return ce});var M=E(2),S=E(8),L=0,ae=0,De=function(){return L},pe=function(){return ae},ce=function(){L=0,ae=0},Ce=function(Y,ee,je,Le,z){var ke=new XMLHttpRequest;if(ke.timeout=ee.timeout||Object(M.getParameter)("HTTP_CONNECT_TIMEOUT"),ke.open("POST",Y,!0),ke.setRequestHeader("Content-type","application/json; charset=utf-8"),z)for(var ye in z)"withCredentials"==ye?ke.withCredentials=!0:ke.setRequestHeader(ye,z[ye]);ke.onload=function(G){ae+=Object(S.d)(ke.responseText),je&&je(ke.responseText)},ke.onerror=function(G){Le&&Le(G,Y)},ke.ontimeout=function(G){Le&&Le(G,Y)};var K=JSON.stringify(ee);L+=Object(S.d)(K),ke.send(K)},we=function(){return"https:"==document.location.protocol}},function(xe,U,E){"use strict";E.d(U,"b",function(){return Ce}),E.d(U,"a",function(){return ce}),E.d(U,"g",function(){return we}),E.d(U,"c",function(){return Y}),E.d(U,"f",function(){return ee}),E.d(U,"e",function(){return Le}),E.d(U,"d",function(){return je}),E(6);var M=E(3),S=E(0),L=E(12),ae=E.n(L),De=E(13),pe=E(10),ce=function(z){return this.audioContext=Object(De.a)(),this.sourceNode=z.otWebkitAudioSource||this.audioContext.createMediaStreamSource(z),this.analyser=this.audioContext.createAnalyser(),this.timeDomainData=new Uint8Array(this.analyser.frequencyBinCount),this.sourceNode.connect(this.analyser),this.getAudioLevel=function(){if(this.analyser){this.analyser.getByteTimeDomainData(this.timeDomainData);for(var ke=0,ye=0;ye<this.timeDomainData.length;ye++)ke=Math.max(ke,Math.abs(this.timeDomainData[ye]-128));return ke/128}return S.default.warning("can't find analyser in audioLevelHelper"),0},this};function Ce(){return ae()().replace(/-/g,"").toUpperCase()}var we=function(z,ke,ye){try{S.default.debug("start vsResHack",z);var K=document.createElement("video");K.setAttribute("autoplay",""),K.setAttribute("muted",""),K.muted=!0,K.setAttribute("playsinline",""),K.setAttribute("style","position: absolute; top: 0; left: 0; width:1px; high:1px;"),document.body.appendChild(K),K.addEventListener("playing",function(G){M.isFireFox()?K.videoWidth&&(S.default.debug("[vsResHack] get stream resolution: ","".concat(K.videoWidth," x ").concat(K.videoHeight),z),ke(K.videoWidth,K.videoHeight),document.body.removeChild(K)):(S.default.debug("[vsResHack] get stream resolution: ","".concat(K.videoWidth," x ").concat(K.videoHeight),z),ke(K.videoWidth,K.videoHeight),document.body.removeChild(K))}),Object(pe.setSrcObject)(K,z)}catch(G){ye(G)}},Y=function(z){return"number"==typeof z&&0<=z&&z<=4294967295},ee=function(z){isNaN(z)&&(z=1e3);var ke=+new Date,ye=(ke=(9301*ke+49297)%233280)/233280;return Math.ceil(ye*z)},je=function(z){var ke=encodeURIComponent(z).match(/%[89ABab]/g);return z.length+(ke?ke.length:0)},Le=function(){if(!document.getElementById("agora-ban-tip")){var z=document.createElement("div");z.id="agora-ban-tip",z.style="position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: #fff;",document.querySelector("body").prepend(z);var ke=document.createElement("div");ke.style="background: #000; width: 346px; height: 116px; z-index: 100000; opacity: 0.6; border-radius: 10px; box-shadow: 0 2px 4px #000;",z.append(ke);var ye=document.createElement("div");ye.style="height: 76px; display: flex; justify-content: center; align-items: center;";var K=document.createElement("span");K.style="height: 28px; width: 28px; color: #000; text-align: center; line-height: 30px; background: #fff; border-radius: 50%; font-weight: 600; font-size: 20px;margin-right: 5px;",K.innerText="!";var G=document.createElement("span");G.innerText="This browser does not support webRTC",ye.append(K),ye.append(G);var Fe=document.createElement("div");Fe.style="height: 38px; display: flex; border-top: #fff 1px solid; justify-content: center; align-items: center;",Fe.innerText="OK",ke.append(ye),ke.append(Fe),Fe.onclick=function(){var He=document.getElementById("agora-ban-tip");He.parentNode.removeChild(He)}}}},function(xe,U){function E(M,S,L,ae,De,pe,ce){try{var Ce=M[pe](ce),we=Ce.value}catch(Y){return void L(Y)}Ce.done?S(we):Promise.resolve(we).then(ae,De)}xe.exports=function(M){return function(){var S=this,L=arguments;return new Promise(function(ae,De){var pe=M.apply(S,L);function ce(we){E(pe,ae,De,ce,Ce,"next",we)}function Ce(we){E(pe,ae,De,ce,Ce,"throw",we)}ce(void 0)})}}},function(xe,U,E){"use strict";E.r(U),E.d(U,"RTCPeerConnection",function(){return Xe}),E.d(U,"getUserMedia",function(){return ae}),E.d(U,"attachMediaStream",function(){return De}),E.d(U,"reattachMediaStream",function(){return pe}),E.d(U,"setSrcObject",function(){return ee}),E.d(U,"getSrcObject",function(){return je}),E.d(U,"webrtcDetectedBrowser",function(){return ce}),E.d(U,"webrtcDetectedVersion",function(){return Ce}),E.d(U,"webrtcMinimumVersion",function(){return we}),E.d(U,"webrtcTesting",function(){return $e}),E.d(U,"webrtcUtils",function(){return ke});var M=E(6),S=E.n(M),L=E(3),ae=null,De=null,pe=null,ce=null,Ce=null,we=null,Y=null,ee=null,je=null,Le=null,z={addStream:null},ke={log:function(){},extractVersion:function(me,ge,Se){var Be=me.match(ge);return Be&&Be.length>=Se&&parseInt(Be[Se])}};if("object"==(typeof window>"u"?"undefined":S()(window))?(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype?(ee=function(me,ge){me.srcObject=ge},je=function(me){return me.srcObject}):(ee=function(me,ge){"mozSrcObject"in me?me.mozSrcObject=ge:(me._srcObject=ge,me.src=ge?URL.createObjectURL(ge):null)},je=function(me){return"mozSrcObject"in me?me.mozSrcObject:me._srcObject}),ae=window.navigator&&window.navigator.getUserMedia):(ee=function(me,ge){me.srcObject=ge},je=function(me){return me.srcObject}),De=function(me,ge){ee(me,ge)},pe=function(me,ge){ee(me,je(ge))},typeof window<"u"&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){for(var ye in ke.log("This appears to be Firefox"),ce="firefox",Ce=ke.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),we=31,Le=mozRTCPeerConnection,z)z[ye]=Le.prototype[ye];if(Y=function(me,ge){if(Ce<38&&me&&me.iceServers){for(var Se=[],Be=0;Be<me.iceServers.length;Be++){var oe=me.iceServers[Be];if(oe.hasOwnProperty("urls"))for(var J=0;J<oe.urls.length;J++){var he={url:oe.urls[J]};0===oe.urls[J].indexOf("turn")&&(he.username=oe.username,he.credential=oe.credential),Se.push(he)}else Se.push(me.iceServers[Be])}me.iceServers=Se}var de=new Le(me,ge);for(var Ze in z)de[Ze]=z[Ze];return de},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),ae=function(me,ge,Se){var Be=function(oe){if("object"!==S()(oe)||oe.require)return oe;var J=[];return Object.keys(oe).forEach(function(he){if("require"!==he&&"advanced"!==he&&"mediaSource"!==he){var de=oe[he]="object"===S()(oe[he])?oe[he]:{ideal:oe[he]};if(void 0===de.min&&void 0===de.max&&void 0===de.exact||J.push(he),void 0!==de.exact&&("number"==typeof de.exact?de.min=de.max=de.exact:oe[he]=de.exact,delete de.exact),void 0!==de.ideal){oe.advanced=oe.advanced||[];var Ze={};Ze[he]="number"==typeof de.ideal?{min:de.ideal,max:de.ideal}:de.ideal,oe.advanced.push(Ze),delete de.ideal,Object.keys(de).length||delete oe[he]}}}),J.length&&(oe.require=J),oe};return Ce<38&&(ke.log("spec: "+JSON.stringify(me)),me.audio&&(me.audio=Be(me.audio)),me.video&&(me.video=Be(me.video)),ke.log("ff37: "+JSON.stringify(me))),navigator.mozGetUserMedia(me,ge,Se)},navigator.getUserMedia=ae,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:He,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(me){me([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},Ce<41){var K=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return K().then(void 0,function(me){if("NotFoundError"===me.name)return[];throw me})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){for(var ye in ke.log("This appears to be Chrome"),ce="chrome",Ce=ke.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),we=38,Le=webkitRTCPeerConnection,z)z[ye]=Le.prototype[ye];Y=function(me,ge){me&&me.iceTransportPolicy&&(me.iceTransports=me.iceTransportPolicy);var Se=new Le(me,ge);for(var Be in z)Se[Be]=z[Be];var oe=Se.getStats.bind(Se);return Se.getStats=function(J,he,de){var Ze=this,ve=arguments;ve.length>0&&"function"==typeof J&&(he?(de=he,he=J,ve=[J=null,he,de]):(he=J,ve=[J=null,he]));var re=function(it){var ft={};return it.result().forEach(function(Ye){var Bt={id:Ye.id,timestamp:Ye.timestamp,type:Ye.type};Ye.names().forEach(function(mn){Bt[mn]=Ye.stat(mn)}),ft[Bt.id]=Bt}),ft};return ve.length>=2?oe.apply(this,[function(it){ve[1](re(it))},ve[0]]):new Promise(function(it,ft){oe.apply(Ze,1===ve.length&&null===J?[function(Ye){it.apply(null,[re(Ye)])},ft]:[it,ft])})},Se},["createOffer","createAnswer"].forEach(function(me){var ge=webkitRTCPeerConnection.prototype[me];webkitRTCPeerConnection.prototype[me]=function(){var Se=this;if(arguments.length<1||1===arguments.length&&"object"===S()(arguments[0])){var Be=1===arguments.length?arguments[0]:void 0;return new Promise(function(oe,J){ge.apply(Se,[oe,J,Be])})}return ge.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(me){var ge=webkitRTCPeerConnection.prototype[me];webkitRTCPeerConnection.prototype[me]=function(){var Se=arguments,Be=this;return new Promise(function(oe,J){ge.apply(Be,[Se[0],function(){oe(),Se.length>=2&&Se[1].apply(null,[])},function(he){J(he),Se.length>=3&&Se[2].apply(null,[he])}])})}});var G=function(me){if("object"!==S()(me)||me.mandatory||me.optional)return me;var ge={};return Object.keys(me).forEach(function(Se){if("require"!==Se&&"advanced"!==Se&&"mediaSource"!==Se){var Be="object"===S()(me[Se])?me[Se]:{ideal:me[Se]};void 0!==Be.exact&&"number"==typeof Be.exact&&(Be.min=Be.max=Be.exact);var oe=function(he,de){return he?he+de.charAt(0).toUpperCase()+de.slice(1):"deviceId"===de?"sourceId":de};if(void 0!==Be.ideal){ge.optional=ge.optional||[];var J={};"number"==typeof Be.ideal?(J[oe("min",Se)]=Be.ideal,ge.optional.push(J),(J={})[oe("max",Se)]=Be.ideal,ge.optional.push(J)):(J[oe("",Se)]=Be.ideal,ge.optional.push(J))}void 0!==Be.exact&&"number"!=typeof Be.exact?(ge.mandatory=ge.mandatory||{},ge.mandatory[oe("",Se)]=Be.exact):["min","max"].forEach(function(he){void 0!==Be[he]&&(ge.mandatory=ge.mandatory||{},ge.mandatory[oe(he,Se)]=Be[he])})}}),me.advanced&&(ge.optional=(ge.optional||[]).concat(me.advanced)),ge};if(ae=function(me,ge,Se){return me.audio&&(me.audio=G(me.audio)),me.video&&(me.video=G(me.video)),ke.log("chrome: "+JSON.stringify(me)),navigator.webkitGetUserMedia(me,ge,Se)},navigator.getUserMedia=ae,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:He,enumerateDevices:function(){return new Promise(function(me){var ge={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(Se){me(Se.map(function(Be){return{label:Be.label,kind:ge[Be.kind],deviceId:Be.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){if(Number(Object(L.getBrowserVersion)().split(".")[0])<46){var Fe=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(me){return ke.log("spec:   "+JSON.stringify(me)),me.audio=G(me.audio),me.video=G(me.video),ke.log("chrome: "+JSON.stringify(me)),Fe(me)}}}else navigator.mediaDevices.getUserMedia=function(me){return He(me)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){ke.log("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){ke.log("Dummy mediaDevices.removeEventListener called.")}),De=function(me,ge){Ce>=43?ee(me,ge):void 0!==me.src?me.src=ge?URL.createObjectURL(ge):null:ke.log("Error attaching stream to element.")},pe=function(me,ge){Ce>=43?ee(me,je(ge)):me.src=ge.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(ke.log("This appears to be Edge"),ce="edge",Ce=ke.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),we=12):ke.log("Browser does not appear to be WebRTC-capable");else ke.log("This does not appear to be a browser"),ce="not a browser";function He(me){return new Promise(function(ge,Se){ae(me,ge,Se)})}var Xe,$e={};try{Object.defineProperty($e,"version",{set:function(me){Ce=me}})}catch{}Y?Xe=Y:typeof window<"u"&&(Xe=window.RTCPeerConnection)},function(xe,U,E){var M=E(19);xe.exports=function(S){for(var L=1;L<arguments.length;L++){var ae=null!=arguments[L]?arguments[L]:{},De=Object.keys(ae);"function"==typeof Object.getOwnPropertySymbols&&(De=De.concat(Object.getOwnPropertySymbols(ae).filter(function(pe){return Object.getOwnPropertyDescriptor(ae,pe).enumerable}))),De.forEach(function(pe){M(S,pe,ae[pe])})}return S}},function(xe,U,E){var M=E(17),S=E(18);xe.exports=function(L,ae,De){var pe=ae&&De||0;"string"==typeof L&&(ae="binary"===L?new Array(16):null,L=null);var ce=(L=L||{}).random||(L.rng||M)();if(ce[6]=15&ce[6]|64,ce[8]=63&ce[8]|128,ae)for(var Ce=0;Ce<16;++Ce)ae[pe+Ce]=ce[Ce];return ae||S(ce)}},function(xe,U,E){"use strict";E.d(U,"a",function(){return De});var M=window.AudioContext||window.webkitAudioContext,S=E(2),L=S.getParameter,ae=S.setParameter,De=function(){return L("AUDIO_CONTEXT")||(console.log("Creating Audio Context"),ae("AUDIO_CONTEXT",function(){if(M)return new M;throw new Error("AUDIO_CONTEXT_NOT_SUPPORTED")}())),L("AUDIO_CONTEXT")}},function(xe,U,E){"use strict";U.__esModule=!0;var M,De,S=E(0),L=E(10);(De=M||(M={})).NEW="new",De.PREPARING_OFFER="preparing-offer",De.OFFER_SENT="offer-sent",De.ESTABLISHED="established",De.CLOSED="closed";var ae=function(){function De(pe){this.candidate=null,this.state=M.NEW,this.config=pe,this.isSubscriber=this.config.isSubscriber,this.peerConnection=this.initPeecConnection(pe),this.peerConnection.onicecandidate=this._onicecandidate.bind(this),this.peerConnection.oniceconnectionstatechange=this._oniceconnectionstatechange.bind(this),this.peerConnection.onaddstream=this._onaddstream.bind(this),this.peerConnection.ontrack=this._ontrack.bind(this),this.processSignalingMessage=this.setAnswer.bind(this),this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.setLocalSDP.bind(this)),this.sendVideoStats={id:"",type:"",mediaType:"",googCodecName:"h264"===this.config.codec?"H264":"VP8",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},this.sendAudioStats={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},this.receiveAudioStats={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},this.receiveVideoStats={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"}}return De.prototype.addStream=function(pe){this.peerConnection.addStream(pe)},De.prototype.setAnswer=function(pe){var ce=JSON.parse(pe);this.peerConnection.setRemoteDescription(new RTCSessionDescription({sdp:ce.sdp,type:"answer"})),this.onsignalingmessage&&this.onsignalingmessage("")},De.prototype.close=function(){this.peerConnection.close()},De.prototype.getStats=function(pe,ce){if(void 0===ce&&(ce=500),ce=ce>500?500:ce,Date.now()-this.lastTimeGetStats<ce){var Ce=[];this.config.isSubscriber?(Ce.push(this.receiveVideoStats),Ce.push(this.receiveAudioStats)):(Ce.push(this.sendAudioStats),Ce.push(this.sendVideoStats)),Ce.push({id:"time",startTime:this.connectedTime,timestamp:Date.now()}),pe&&pe(Ce)}else this._getStats(pe)},De.prototype._getStats=function(pe){var ce=this,Ce=[];this.peerConnection.getStats(null).then(function(we){ce.lastTimeGetStats=Date.now(),Object.keys(we).map(function(Y){var ee=we[Y];ce.config.isSubscriber?ee.type&&"inboundrtp"===ee.type&&ee.mediaType&&"audio"===ee.mediaType?(ce.receiveAudioStats.id=ee.id+"recv",ce.receiveAudioStats.type=ee.type+"",ce.receiveAudioStats.mediaType=ee.mediaType+"",ce.receiveAudioStats.packetsReceived=ee.packetsReceived+"",ce.receiveAudioStats.bytesReceived=ee.bytesReceived+"",ce.receiveAudioStats.packetsLost=ee.packetsLost+"",ce.receiveAudioStats.googJitterReceived=ee.jitter+""):ee.type&&"inboundrtp"===ee.type&&ee.mediaType&&"video"===ee.mediaType?(ce.receiveVideoStats.id=ee.id+"recv",ce.receiveVideoStats.type=ee.type+"",ce.receiveVideoStats.mediaType=ee.mediaType+"",ce.receiveVideoStats.packetsReceived=ee.packetsReceived+"",ce.receiveVideoStats.bytesReceived=ee.bytesReceived+"",ce.receiveVideoStats.packetsLost=ee.packetsLost+"",ce.receiveVideoStats.googJitterBufferMs=ee.jitter+"",ce.receiveVideoStats.googPlisSent=ee.pliCount+"",ce.receiveVideoStats.googFirsSent=ee.firCount+"",ce.receiveVideoStats.googNacksSent=ee.nackCount+""):ee.remoteSource&&ee.type&&"track"===ee.type&&ee.trackIdentifier&&-1!==ee.trackIdentifier.indexOf("v")?(ce.receiveVideoStats.googFrameHeightReceived=ee.frameHeight+"",ce.receiveVideoStats.googFrameWidthReceived=ee.frameWidth+"",ce.receiveVideoStats.googFrameRateDecoded=ee.framesPerSecond+"",ce.receiveVideoStats.googFrameRateOutput=ee.framesPerSecond+"",ce.receiveVideoStats.googFrameRateReceived=ee.framesPerSecond+"",ce.receiveVideoStats.googFramesDecoded=ee.framesDecoded+"",ce.receiveVideoStats.googFrameReceived=ee.framesReceived+""):ee.remoteSource&&ee.type&&"track"===ee.type&&ee.trackIdentifier&&-1!==ee.trackIdentifier.indexOf("a")&&(ce.receiveAudioStats.audioOutputLevel=ee.audioLevel+""):!ee.isRemote&&ee.type&&"outboundrtp"===ee.type&&ee.mediaType&&"audio"===ee.mediaType?(ce.sendAudioStats.id=ee.id+"send",ce.sendAudioStats.type=ee.type+"",ce.sendAudioStats.mediaType=ee.mediaType+"",ce.sendAudioStats.packetsSent=ee.packetsSent+"",ce.sendAudioStats.bytesSent=ee.bytesSent+""):!ee.isRemote&&ee.type&&"outboundrtp"===ee.type&&ee.mediaType&&"video"===ee.mediaType?(ce.sendVideoStats.id=ee.id+"send",ce.sendVideoStats.type=ee.type+"",ce.sendVideoStats.mediaType=ee.mediaType+"",ce.sendVideoStats.packetsSent=ee.packetsSent+"",ce.sendVideoStats.bytesSent=ee.bytesSent+"",ce.sendVideoStats.googRtt=ee.roundTripTime+"",ce.sendVideoStats.googPlisReceived=ee.pliCount+"",ce.sendVideoStats.googFirsReceived=ee.firCount+"",ce.sendVideoStats.googNacksReceived=ee.nackCount+""):!ee.remoteSource&&ee.type&&"track"===ee.type&&ee.framesSent&&0!==ee.framesSent&&(ce.sendVideoStats.googFrameHeightSent=ee.frameHeight+"",ce.sendVideoStats.googFrameHeightInput=ee.frameHeight+"",ce.sendVideoStats.googFrameWidthSent=ee.frameWidth+"",ce.sendVideoStats.googFrameWidthInput=ee.frameWidth+"",ce.sendVideoStats.googFramesEncoded=ee.framesSent+"",ce.sendVideoStats.googFrameRateSent=ee.framesPerSecond+"")}),ce.config.isSubscriber?(Ce.push(ce.receiveVideoStats),Ce.push(ce.receiveAudioStats)):(Ce.push(ce.sendAudioStats),Ce.push(ce.sendVideoStats)),Ce.push({id:"time",startTime:ce.connectedTime,timestamp:Date.now()}),pe&&pe(Ce)})},De.prototype.getStatsRate=function(pe){this.getStats(pe)},De.prototype.initPeecConnection=function(pe){var ce=pe.stunServerUrl,Ce=pe.turnServer,we=pe.iceServers;return this.pcConfig={iceServers:[{urls:"stun:webcs.agora.io:3478"}]},we instanceof Array?this.pcConfig.iceServers=pe.iceServers:ce&&(ce instanceof Array?ce.map(function(Y){"string"==typeof Y&&""!==Y&&this.pcConfig.iceServers.push({urls:Y})}):"string"==typeof ce&&""!==ce&&this.pcConfig.iceServers.push({urls:ce})),Ce&&(Ce instanceof Array?Ce.map(function(Y){"string"==typeof Y.url&&""!==Y.url&&this.pcConfig.iceServers.push({username:Y.username,credential:Y.credential,url:Y.url})}):"auto"!==Ce.mode&&"manual"!==Ce.mode||(Ce.udpport&&this.pcConfig.iceServers.push({username:Ce.username,credential:Ce.credential,credentialType:"password",urls:"turn:"+Ce.url+":"+Ce.udpport+"?transport=udp"}),"string"==typeof Ce.tcpport&&""!==Ce.tcpport&&this.pcConfig.iceServers.push({username:Ce.username,credential:Ce.credential,credentialType:"password",urls:"turn:"+Ce.url+":"+Ce.tcpport+"?transport=tcp"}),!0===Ce.forceturn&&(this.pcConfig.iceTransportPolicy="relay"))),new L.RTCPeerConnection(this.pcConfig)},De.prototype._ontrack=function(pe){this.onaddstream&&this.onaddstream(pe,"ontrack")},De.prototype._onaddstream=function(pe){this.onaddstream&&this.onaddstream(pe,"onaddstream")},De.prototype._oniceconnectionstatechange=function(pe){"connected"===pe.currentTarget.iceConnectionState&&(this.state=M.ESTABLISHED,this.connectedTime=Date.now()),this.oniceconnectionstatechange&&this.oniceconnectionstatechange(pe.currentTarget.iceConnectionState)},De.prototype._onicecandidate=function(pe){!this.candidate&&pe&&(this.candidate=pe.candidate,this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then(this.editLocalSDP.bind(this)).then(this.setLocalSDP.bind(this)).then(this.sendOffer.bind(this)).catch())},De.prototype.setLocalSDP=function(pe){return this.peerConnection.setLocalDescription(new RTCSessionDescription({sdp:pe.sdp,type:"offer"})),this.state=M.PREPARING_OFFER,pe},De.prototype.editLocalSDP=function(pe){return pe.sdp=this.setBandWidth(pe.sdp),pe.sdp=this.reviseOpus(pe.sdp),pe.sdp=this.addCandidate(pe.sdp),pe},De.prototype.setSendRecv=function(pe){return(pe=(pe=pe.replace(/a=recvonly\r\n/g,"a=sendrecv\r\n")).replace(/a=sendonly\r\n/g,"a=sendrecv\r\n")).replace(/a=inactive\r\n/g,"a=sendrecv\r\n")},De.prototype.setBandWidth=function(pe){var ce,Ce,we=this.config,Y=we.codec,ee=we.minVideoBW,je=we.maxVideoBW,Le=we.maxAudioBW,z=we.clientId;if((ce=pe.match(/m=video.*\r\n/))&&ee&&je){Ce=ce[0]+"b=AS:"+je+"\r\n";var ke=0,ye=0;"h264"===Y?(ke=pe.search(/a=rtpmap:(\d+) H264\/90000\r\n/),ye=pe.search(/H264\/90000\r\n/)):"vp8"===Y&&(ke=pe.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),ye=pe.search(/VP8\/90000\r\n/)),-1!==ke&&-1!==ye&&ye-ke>10&&(Ce=Ce+"a=fmtp:"+pe.slice(ke+9,ye-1)+" x-google-min-bitrate="+ee+"\r\n"),pe=pe.replace(ce[0],Ce),S.default.debug("["+z+"]Set Video Bitrate - min:"+ee+" max:"+je)}return(ce=pe.match(/m=audio.*\r\n/))&&Le&&(pe=pe.replace(ce[0],Ce=ce[0]+"b=AS:"+Le+"\r\n")),pe},De.prototype.reviseOpus=function(pe){return(pe=pe.replace(/a=rtpmap:102 opus\/48000\/2/g,"a=rtpmap:111 opus/48000/2")).replace(/m=audio 9 UDP\/TLS\/RTP\/SAVPF 102 0 8 97 13 118 101/g,"m=audio 9 UDP/TLS/RTP/SAVPF 111 0 8 97 13 118 101")},De.prototype.addCandidate=function(pe){return pe+"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"},De.prototype.sendOffer=function(pe){this.config.callback(JSON.stringify({sdp:pe.sdp,messageType:"OFFER",tiebreaker:Math.floor(429496723*Math.random()+1)})),this.state=M.OFFER_SENT},De}();U.default=ae},function(xe,U,E){"use strict";var M=this&&this.__awaiter||function(Ce,we,Y,ee){return new(Y||(Y=Promise))(function(je,Le){function z(K){try{ye(ee.next(K))}catch(G){Le(G)}}function ke(K){try{ye(ee.throw(K))}catch(G){Le(G)}}function ye(K){K.done?je(K.value):new Y(function(G){G(K.value)}).then(z,ke)}ye((ee=ee.apply(Ce,we||[])).next())})},S=this&&this.__generator||function(Ce,we){var Y,ee,je,Le,z={label:0,sent:function(){if(1&je[0])throw je[1];return je[1]},trys:[],ops:[]};return Le={next:ke(0),throw:ke(1),return:ke(2)},"function"==typeof Symbol&&(Le[Symbol.iterator]=function(){return this}),Le;function ke(ye){return function(K){return function(G){if(Y)throw new TypeError("Generator is already executing.");for(;z;)try{if(Y=1,ee&&(je=2&G[0]?ee.return:G[0]?ee.throw||((je=ee.return)&&je.call(ee),0):ee.next)&&!(je=je.call(ee,G[1])).done)return je;switch(ee=0,je&&(G=[2&G[0],je.value]),G[0]){case 0:case 1:je=G;break;case 4:return z.label++,{value:G[1],done:!1};case 5:z.label++,ee=G[1],G=[0];continue;case 7:G=z.ops.pop(),z.trys.pop();continue;default:if(!(je=(je=z.trys).length>0&&je[je.length-1])&&(6===G[0]||2===G[0])){z=0;continue}if(3===G[0]&&(!je||G[1]>je[0]&&G[1]<je[3])){z.label=G[1];break}if(6===G[0]&&z.label<je[1]){z.label=je[1],je=G;break}if(je&&z.label<je[2]){z.label=je[2],z.ops.push(G);break}je[2]&&z.ops.pop(),z.trys.pop();continue}G=we.call(Ce,z)}catch(Fe){G=[6,Fe],ee=0}finally{Y=je=0}if(5&G[0])throw G[1];return{value:G[0]?G[1]:void 0,done:!0}}([ye,K])}}},L=this;U.__esModule=!0;var ae=E(20),De=E(3),pe=E(0);U.getSupportedCodec=function(Ce){return M(L,void 0,void 0,function(){var we,Y,ee,je;return S(this,function(z){switch(z.label){case 0:return we={video:[],audio:[]},typeof window<"u"?[3,1]:(pe.default.error("getSupportedCodec: NOT_BROWSER_ENV"),[2,Promise.reject("NOT_BROWSER_ENV")]);case 1:try{Y=ae.createRTCPeerConnection({iceServers:[]})}catch(ke){return pe.default.error("Failed to init RTCPeerConnection",ke),[2,Promise.reject(ke)]}return Y?[3,2]:(pe.default.warning("getSupportedCodec: no RTCPeerConnection constructor is detected"),[2,Promise.resolve(we)]);case 2:return Ce&&Ce.stream?[3,7]:(ee={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},je=void 0,(De.isSafari()||De.isFireFox()||De.isWeChatBrowser())&&Y.addTransceiver?(Y.addTransceiver("audio"),Y.addTransceiver("video"),[4,Y.createOffer()]):[3,4]);case 3:return je=z.sent(),[3,6];case 4:return[4,new Promise(function(ke,ye){var K=setTimeout(function(){ye("CREATEOFFER_TIMEOUT")},3e3);Y.createOffer(function(G){clearTimeout(K),ke(G)},function(G){clearTimeout(K),ye(G)},ee)})];case 5:je=z.sent(),z.label=6;case 6:return Y.close(),[2,ce(je.sdp)];case 7:return Ce.stream.getTracks&&Y.addTrack?Ce.stream.getTracks().forEach(function(ke){Y.addTrack(ke,Ce.stream)}):Y.addStream(Ce.stream),je=void 0,De.isSafari()||De.isFireFox()?[4,Y.createOffer()]:[3,9];case 8:return je=z.sent(),[3,11];case 9:return[4,new Promise(function(ke,ye){Y.createOffer(ke,ye)})];case 10:je=z.sent(),z.label=11;case 11:return Y.close(),[2,ce(je.sdp)]}})})};var ce=function(Ce){var we={video:[],audio:[]};return Ce.match(/ VP8/i)&&we.video.push("VP8"),Ce.match(/ H264/i)&&we.video.push("H264"),Ce.match(/ opus/i)&&we.audio.push("OPUS"),Promise.resolve(we)}},function(xe,U,E){var M=E(21),S=E(22),L=E(23);xe.exports=function(ae){return M(ae)||S(ae)||L()}},function(xe,U){var E=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(E){var M=new Uint8Array(16);xe.exports=function(){return E(M),M}}else{var S=new Array(16);xe.exports=function(){for(var L,ae=0;ae<16;ae++)0==(3&ae)&&(L=4294967296*Math.random()),S[ae]=L>>>((3&ae)<<3)&255;return S}}},function(xe,U){for(var E=[],M=0;M<256;++M)E[M]=(M+256).toString(16).substr(1);xe.exports=function(S,L){var ae=L||0;return[E[S[ae++]],E[S[ae++]],E[S[ae++]],E[S[ae++]],"-",E[S[ae++]],E[S[ae++]],"-",E[S[ae++]],E[S[ae++]],"-",E[S[ae++]],E[S[ae++]],"-",E[S[ae++]],E[S[ae++]],E[S[ae++]],E[S[ae++]],E[S[ae++]],E[S[ae++]]].join("")}},function(xe,U){xe.exports=function(E,M,S){return M in E?Object.defineProperty(E,M,{value:S,enumerable:!0,configurable:!0,writable:!0}):E[M]=S,E}},function(xe,U,E){"use strict";U.__esModule=!0;var M="object"==typeof window&&window.RTCPeerConnection,S="object"==typeof window&&window.webkitRTCPeerConnection,L="object"==typeof window&&window.mozRTCPeerConnection;U.createRTCPeerConnection=function(ae){var De=M||S||L;return De?new De(ae):null}},function(xe,U){xe.exports=function(E){if(Array.isArray(E)){for(var M=0,S=new Array(E.length);M<E.length;M++)S[M]=E[M];return S}}},function(xe,U){xe.exports=function(E){if(Symbol.iterator in Object(E)||"[object Arguments]"===Object.prototype.toString.call(E))return Array.from(E)}},function(xe,U){xe.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(xe,U,E){var M=function(){return this||"object"==typeof self&&self}()||Function("return this")(),S=M.regeneratorRuntime&&Object.getOwnPropertyNames(M).indexOf("regeneratorRuntime")>=0,L=S&&M.regeneratorRuntime;if(M.regeneratorRuntime=void 0,xe.exports=E(25),S)M.regeneratorRuntime=L;else try{delete M.regeneratorRuntime}catch{M.regeneratorRuntime=void 0}},function(xe,U){!function(E){"use strict";var M,S=Object.prototype,L=S.hasOwnProperty,ae="function"==typeof Symbol?Symbol:{},De=ae.iterator||"@@iterator",pe=ae.asyncIterator||"@@asyncIterator",ce=ae.toStringTag||"@@toStringTag",Ce="object"==typeof xe,we=E.regeneratorRuntime;if(we)Ce&&(xe.exports=we);else{(we=E.regeneratorRuntime=Ce?xe.exports:{}).wrap=Fe;var Y="suspendedStart",ee="suspendedYield",je="executing",Le="completed",z={},ke={};ke[De]=function(){return this};var ye=Object.getPrototypeOf,K=ye&&ye(ye(de([])));K&&K!==S&&L.call(K,De)&&(ke=K);var G=me.prototype=Xe.prototype=Object.create(ke);$e.prototype=G.constructor=me,me.constructor=$e,me[ce]=$e.displayName="GeneratorFunction",we.isGeneratorFunction=function(ve){var re="function"==typeof ve&&ve.constructor;return!!re&&(re===$e||"GeneratorFunction"===(re.displayName||re.name))},we.mark=function(ve){return Object.setPrototypeOf?Object.setPrototypeOf(ve,me):(ve.__proto__=me,ce in ve||(ve[ce]="GeneratorFunction")),ve.prototype=Object.create(G),ve},we.awrap=function(ve){return{__await:ve}},ge(Se.prototype),Se.prototype[pe]=function(){return this},we.AsyncIterator=Se,we.async=function(ve,re,it,ft){var Ye=new Se(Fe(ve,re,it,ft));return we.isGeneratorFunction(re)?Ye:Ye.next().then(function(Bt){return Bt.done?Bt.value:Ye.next()})},ge(G),G[ce]="Generator",G[De]=function(){return this},G.toString=function(){return"[object Generator]"},we.keys=function(ve){var re=[];for(var it in ve)re.push(it);return re.reverse(),function ft(){for(;re.length;){var Ye=re.pop();if(Ye in ve)return ft.value=Ye,ft.done=!1,ft}return ft.done=!0,ft}},we.values=de,he.prototype={constructor:he,reset:function(ve){if(this.prev=0,this.next=0,this.sent=this._sent=M,this.done=!1,this.delegate=null,this.method="next",this.arg=M,this.tryEntries.forEach(J),!ve)for(var re in this)"t"===re.charAt(0)&&L.call(this,re)&&!isNaN(+re.slice(1))&&(this[re]=M)},stop:function(){this.done=!0;var ve=this.tryEntries[0].completion;if("throw"===ve.type)throw ve.arg;return this.rval},dispatchException:function(ve){if(this.done)throw ve;var re=this;function it(qt,At){return Bt.type="throw",Bt.arg=ve,re.next=qt,At&&(re.method="next",re.arg=M),!!At}for(var ft=this.tryEntries.length-1;ft>=0;--ft){var Ye=this.tryEntries[ft],Bt=Ye.completion;if("root"===Ye.tryLoc)return it("end");if(Ye.tryLoc<=this.prev){var mn=L.call(Ye,"catchLoc"),Vt=L.call(Ye,"finallyLoc");if(mn&&Vt){if(this.prev<Ye.catchLoc)return it(Ye.catchLoc,!0);if(this.prev<Ye.finallyLoc)return it(Ye.finallyLoc)}else if(mn){if(this.prev<Ye.catchLoc)return it(Ye.catchLoc,!0)}else{if(!Vt)throw new Error("try statement without catch or finally");if(this.prev<Ye.finallyLoc)return it(Ye.finallyLoc)}}}},abrupt:function(ve,re){for(var it=this.tryEntries.length-1;it>=0;--it){var ft=this.tryEntries[it];if(ft.tryLoc<=this.prev&&L.call(ft,"finallyLoc")&&this.prev<ft.finallyLoc){var Ye=ft;break}}Ye&&("break"===ve||"continue"===ve)&&Ye.tryLoc<=re&&re<=Ye.finallyLoc&&(Ye=null);var Bt=Ye?Ye.completion:{};return Bt.type=ve,Bt.arg=re,Ye?(this.method="next",this.next=Ye.finallyLoc,z):this.complete(Bt)},complete:function(ve,re){if("throw"===ve.type)throw ve.arg;return"break"===ve.type||"continue"===ve.type?this.next=ve.arg:"return"===ve.type?(this.rval=this.arg=ve.arg,this.method="return",this.next="end"):"normal"===ve.type&&re&&(this.next=re),z},finish:function(ve){for(var re=this.tryEntries.length-1;re>=0;--re){var it=this.tryEntries[re];if(it.finallyLoc===ve)return this.complete(it.completion,it.afterLoc),J(it),z}},catch:function(ve){for(var re=this.tryEntries.length-1;re>=0;--re){var it=this.tryEntries[re];if(it.tryLoc===ve){var ft=it.completion;if("throw"===ft.type){var Ye=ft.arg;J(it)}return Ye}}throw new Error("illegal catch attempt")},delegateYield:function(ve,re,it){return this.delegate={iterator:de(ve),resultName:re,nextLoc:it},"next"===this.method&&(this.arg=M),z}}}function Fe(ve,re,it,ft){var Vt,qt,At,Xt,Bt=Object.create((re&&re.prototype instanceof Xe?re:Xe).prototype),mn=new he(ft||[]);return Bt._invoke=(Vt=ve,qt=it,At=mn,Xt=Y,function(tn,xt){if(Xt===je)throw new Error("Generator is already running");if(Xt===Le){if("throw"===tn)throw xt;return Ze()}for(At.method=tn,At.arg=xt;;){var jn=At.delegate;if(jn){var Ut=Be(jn,At);if(Ut){if(Ut===z)continue;return Ut}}if("next"===At.method)At.sent=At._sent=At.arg;else if("throw"===At.method){if(Xt===Y)throw Xt=Le,At.arg;At.dispatchException(At.arg)}else"return"===At.method&&At.abrupt("return",At.arg);Xt=je;var Ct=He(Vt,qt,At);if("normal"===Ct.type){if(Xt=At.done?Le:ee,Ct.arg===z)continue;return{value:Ct.arg,done:At.done}}"throw"===Ct.type&&(Xt=Le,At.method="throw",At.arg=Ct.arg)}}),Bt}function He(ve,re,it){try{return{type:"normal",arg:ve.call(re,it)}}catch(ft){return{type:"throw",arg:ft}}}function Xe(){}function $e(){}function me(){}function ge(ve){["next","throw","return"].forEach(function(re){ve[re]=function(it){return this._invoke(re,it)}})}function Se(ve){var re;this._invoke=function(it,ft){function Ye(){return new Promise(function(Bt,mn){!function Vt(qt,At,Xt,tn){var xt=He(ve[qt],ve,At);if("throw"!==xt.type){var jn=xt.arg,Ut=jn.value;return Ut&&"object"==typeof Ut&&L.call(Ut,"__await")?Promise.resolve(Ut.__await).then(function(Ct){Vt("next",Ct,Xt,tn)},function(Ct){Vt("throw",Ct,Xt,tn)}):Promise.resolve(Ut).then(function(Ct){jn.value=Ct,Xt(jn)},function(Ct){return Vt("throw",Ct,Xt,tn)})}tn(xt.arg)}(it,ft,Bt,mn)})}return re=re?re.then(Ye,Ye):Ye()}}function Be(ve,re){var it=ve.iterator[re.method];if(it===M){if(re.delegate=null,"throw"===re.method){if(ve.iterator.return&&(re.method="return",re.arg=M,Be(ve,re),"throw"===re.method))return z;re.method="throw",re.arg=new TypeError("The iterator does not provide a 'throw' method")}return z}var ft=He(it,ve.iterator,re.arg);if("throw"===ft.type)return re.method="throw",re.arg=ft.arg,re.delegate=null,z;var Ye=ft.arg;return Ye?Ye.done?(re[ve.resultName]=Ye.value,re.next=ve.nextLoc,"return"!==re.method&&(re.method="next",re.arg=M),re.delegate=null,z):Ye:(re.method="throw",re.arg=new TypeError("iterator result is not an object"),re.delegate=null,z)}function oe(ve){var re={tryLoc:ve[0]};1 in ve&&(re.catchLoc=ve[1]),2 in ve&&(re.finallyLoc=ve[2],re.afterLoc=ve[3]),this.tryEntries.push(re)}function J(ve){var re=ve.completion||{};re.type="normal",delete re.arg,ve.completion=re}function he(ve){this.tryEntries=[{tryLoc:"root"}],ve.forEach(oe,this),this.reset(!0)}function de(ve){if(ve){var re=ve[De];if(re)return re.call(ve);if("function"==typeof ve.next)return ve;if(!isNaN(ve.length)){var it=-1,ft=function Ye(){for(;++it<ve.length;)if(L.call(ve,it))return Ye.value=ve[it],Ye.done=!1,Ye;return Ye.value=M,Ye.done=!0,Ye};return ft.next=ft}}return{next:Ze}}function Ze(){return{value:M,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(xe,U,E){"use strict";E.r(U);var M=E(2),S=E(0),L=E(1),ae=function(){var g={dispatcher:{}};return g.dispatcher.eventListeners={},g.addEventListener=function(r,I){void 0===g.dispatcher.eventListeners[r]&&(g.dispatcher.eventListeners[r]=[]),g.dispatcher.eventListeners[r].push(I)},g.hasListeners=function(r){return!(!g.dispatcher.eventListeners[r]||!g.dispatcher.eventListeners[r].length)},g.on=g.addEventListener,g.removeEventListener=function(r,I){var c;-1!==(c=g.dispatcher.eventListeners[r].indexOf(I))&&g.dispatcher.eventListeners[r].splice(c,1)},g.dispatchEvent=function(r){var I;for(I in g.dispatcher.eventListeners[r.type])g.dispatcher.eventListeners[r.type]&&g.dispatcher.eventListeners[r.type].hasOwnProperty(I)&&"function"==typeof g.dispatcher.eventListeners[r.type][I]&&g.dispatcher.eventListeners[r.type][I](r)},g.dispatchSocketEvent=function(r){var I;for(I in g.dispatcher.eventListeners[r.type])g.dispatcher.eventListeners[r.type]&&g.dispatcher.eventListeners[r.type].hasOwnProperty(I)&&"function"==typeof g.dispatcher.eventListeners[r.type][I]&&g.dispatcher.eventListeners[r.type][I](r.msg)},g},De=function(g){var r={};return r.type=g.type,r},pe=function(g){var r=De(g);return r.stream=g.stream,r.reason=g.reason,r.msg=g.msg,r},ce=function(g){var r=De(g);return r.uid=g.uid,r.attr=g.attr,r.stream=g.stream,r},Ce=function(g){var r=De(g);return r.msg=g.msg,r},we=function(g){var r=De(g);return r.url=g.url,r.uid=g.uid,r.status=g.status,r.reason=g.reason,r},Y=E(3),ee=function(){};ee.prototype.set=function(g,r){["BatteryLevel"].indexOf(g)>-1&&(this[g]=r)};var je=new function(){var g=ae();return g.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},g.state=g.states.UNINIT,g.batteryManager=null,g._init=function(r,I){g.state=g.states.INITING,navigator.getBattery?navigator.getBattery().then(function(c){g.batteryManager=c,r&&setTimeout(function(){r()},0)}).catch(function(c){S.default.debug("navigator.getBattery is disabled",c),r&&r()}):(g.state=g.states.INITED,r&&r())},g._getBatteryStats=function(){var r={};return r.BatteryLevel=g.batteryManager&&g.batteryManager.level?Math.floor(100*g.batteryManager.level):"UNSUPPORTED",r},g.getStats=function(r,I){var c=new ee,v=g._getBatteryStats();v&&v.BatteryLevel&&c.set("BatteryLevel",v.BatteryLevel),r&&r(c)},g._init(),g},Le=E(4),z=E.n(Le),ye=E(10),K={101100:"NO_FLAG_SET",101101:"FLAG_SET_BUT_EMPTY",101102:"INVALID_FALG_SET",101203:"NO_SERVICE_AVIABLE",0:"OK_CODE",5:"INVALID_VENDOR_KEY",7:"INVALID_CHANNEL_NAME",8:"INTERNAL_ERROR",9:"NO_AUTHORIZED",10:"DYNAMIC_KEY_TIMEOUT",11:"NO_ACTIVE_STATUS",13:"DYNAMIC_KEY_EXPIRED",14:"STATIC_USE_DYANMIC_KEY",15:"DYNAMIC_USE_STATIC_KEY",1010100:"NO_FLAG_SET",1010101:"FLAG_SET_BUT_EMPTY",1010102:"INVALID_FALG_SET",1010200:"NO_SERVICE_AVAILABLE",1010203:"NO_SERVICE_AVAILABLE_WEBRTC",1010205:"NO_SERVICE_AVAILABLE_DISPATCHER",1010208:"NO_SERVICE_AVAILABLE_APPCENTER",1010211:"NO_SERVICE_AVAILABLE_SUA",2010005:"INVALID_VENDOR_KEY",2010007:"INVALID_CHANNEL_NAME",2010008:"INTERNAL_ERROR",2010009:"NO_AUTHORIZED",2010010:"DYNAMIC_KEY_TIMEOUT",2010011:"NO_ACTIVE_STATUS",2010013:"DYNAMIC_KEY_EXPIRED",2010014:"STATIC_USE_DYANMIC_KEY",2010015:"DYNAMIC_USE_STATIC_KEY"},G={2e3:"ERR_NO_VOCS_AVAILABLE",2001:"ERR_NO_VOS_AVAILABLE",2002:"ERR_JOIN_CHANNEL_TIMEOUT",2003:"WARN_REPEAT_JOIN",2004:"ERR_JOIN_BY_MULTI_IP",2011:"ERR_NOT_JOINED",2012:"WARN_REPEAT_JOIN",2013:"ERR_INVALID_VENDOR_KEY",2014:"ERR_INVALID_CHANNEL_NAME",2015:"ERR_INVALID_STRINGUID",2016:"ERR_TOO_MANY_USERS",2017:"ERR_SET_CLIENT_ROLE_TIMEOUT",2018:"ERR_SET_CLIENT_ROLE_NO_PERMISSION",2019:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",2020:"ERR_PUBLISH_REQUEST_INVALID",2021:"ERR_SUBSCRIBE_REQUEST_INVALID",2022:"ERR_NOT_SUPPORTED_MESSAGE",2023:"ERR_ILLEAGAL_PLUGIN",101:"ERR_INVALID_VENDOR_KEY",102:"ERR_INVALID_CHANNEL_NAME",103:"WARN_NO_AVAILABLE_CHANNEL",104:"WARN_LOOKUP_CHANNEL_TIMEOUT",105:"WARN_LOOKUP_CHANNEL_REJECTED",106:"WARN_OPEN_CHANNEL_TIMEOUT",107:"WARN_OPEN_CHANNEL_REJECTED",108:"WARN_REQUEST_DEFERRED",109:"ERR_DYNAMIC_KEY_TIMEOUT",110:"ERR_NO_AUTHORIZED",111:"ERR_VOM_SERVICE_UNAVAILABLE",112:"ERR_NO_CHANNEL_AVAILABLE_CODE",113:"ERR_TOO_MANY_USERS",114:"ERR_MASTER_VOCS_UNAVAILABLE",115:"ERR_INTERNAL_ERROR",116:"ERR_NO_ACTIVE_STATUS",117:"ERR_INVALID_UID",118:"ERR_DYNAMIC_KEY_EXPIRED",119:"ERR_STATIC_USE_DYANMIC_KE",120:"ERR_DYNAMIC_USE_STATIC_KE",2:"K_TIMESTAMP_EXPIRED",3:"K_CHANNEL_PERMISSION_INVALID",4:"K_CERTIFICATE_INVALID",5:"K_CHANNEL_NAME_EMPTY",6:"K_CHANNEL_NOT_FOUND",7:"K_TICKET_INVALID",8:"K_CHANNEL_CONFLICTED",9:"K_SERVICE_NOT_READY",10:"K_SERVICE_TOO_HEAVY",14:"K_UID_BANNED",15:"K_IP_BANNED",16:"K_CHANNEL_BANNED"},Fe={1:"ERROR_ILLEAGAL_APPID",2:"ERROR_ILLEAGAL_UID",3:"INTERNAL_SERVER_ERROR"},He=["NO_FLAG_SET","NO_SERVICE_AVIABLE","FLAG_SET_BUT_EMPTY","EMPTY_ADDRESS_RESPONSE"],ve={19:"ERR_ALREADY_IN_USE",10:"ERR_TIMEDOUT",3:"ERR_NOT_READY",9:"ERR_NO_PERMISSION",0:"UNKNOW_ERROR"},re_INVALID_CLIENT_MODE="INVALID_CLIENT_MODE",re_INVALID_CLIENT_CODEC="INVALID_CLIENT_CODEC",re_CLIENT_MODE_CODEC_MISMATCH="CLIENT_MODE_CODEC_MISMATCH",re_WEB_API_NOT_SUPPORTED="WEB_API_NOT_SUPPORTED",re_INVALID_PARAMETER="INVALID_PARAMETER",re_INVALID_OPERATION="INVALID_OPERATION",re_INVALID_LOCAL_STREAM="INVALID_LOCAL_STREAM",re_INVALID_REMOTE_STREAM="INVALID_REMOTE_STREAM",re_STREAM_ALREADY_PUBLISHED="STREAM_ALREADY_PUBLISHED",re_STREAM_NOT_YET_PUBLISHED="STREAM_NOT_YET_PUBLISHED",re_SOCKET_ERROR="SOCKET_ERROR",re_SOCKET_DISCONNECTED="SOCKET_DISCONNECTED",re_PEERCONNECTION_FAILED="PEERCONNECTION_FAILED",re_JOIN_CHANNEL_FAILED="JOIN_CHANNEL_FAILED",re_NO_SUCH_REMOTE_STREAM="NO_SUCH_REMOTE_STREAM",re_IOS_NOT_SUPPORT="IOS_NOT_SUPPORT",re_WECHAT_NOT_SUPPORT="WECHAT_NOT_SUPPORT",re_SHARING_SCREEN_NOT_SUPPORT="SHARING_SCREEN_NOT_SUPPORT",re_STILL_ON_PUBLISHING="STILL_ON_PUBLISHING",re_LOW_STREAM_ALREADY_PUBLISHED="LOW_STREAM_ALREADY_PUBLISHED",re_LOW_STREAM_NOT_YET_PUBLISHED="LOW_STREAM_ALREADY_PUBLISHED",re_HIGH_STREAM_NOT_VIDEO_TRACE="HIGH_STREAM_NOT_VIDEO_TRACE",re_NOT_FIND_DEVICE_BY_LABEL="NOT_FIND_DEVICE_BY_LABEL",re_ENABLE_DUALSTREAM_FAILED="ENABLE_DUALSTREAM_FAILED",re_DISABLE_DUALSTREAM_FAILED="DISABLE_DUALSTREAM_FAILED",re_PLAYER_NOT_FOUND="PLAYER_NOT_FOUND",re_BAD_ENVIRONMENT="BAD_ENVIRONMENT",re_LOAD_AUDIO_FAILED="LOAD_AUDIO_FAILED",it=0,ft=function(g){var r=function(g){var r=ae();return r.url=".",r}();r.id=g.id,r.playerId=it++,r.fit=g.options&&g.options.fit,"contain"!==r.fit&&"cover"!==r.fit&&(r.fit=null),r.url=g.url,r.stream=g.stream.stream,r.elementID=g.elementID,r.setAudioOutput=function(P,F,j){var u=r.video||r.audio;return u?u.setSinkId?void u.setSinkId(P).then(function(){return S.default.debug("["+r.id+"] "+"video ".concat(r.id," setAudioOutput ").concat(P," SUCCESS")),u==r.video&&r.audio?r.audio.setSinkId(P):Promise.resolve()}).then(function(){return S.default.debug("["+r.id+"] "+"audio ".concat(r.id," setAudioOutput ").concat(P," SUCCESS")),F&&F()}).catch(function(W){return S.default.error("["+r.id+"] VideoPlayer.setAudioOutput",W),j&&j(W)}):(S.default.error("["+r.id+"] ",re_WEB_API_NOT_SUPPORTED),j&&j(re_WEB_API_NOT_SUPPORTED)):(S.default.error("["+r.id+"] ",re_PLAYER_NOT_FOUND),j&&j(re_PLAYER_NOT_FOUND))},r.destroy=function(){S.default.debug("destroy ".concat(g.stream.local?"local":"remote"," Player ").concat(r.id)),Object(ye.setSrcObject)(r.video,null),Object(ye.setSrcObject)(r.audio,null),r.video.pause(),delete r.resizer,clearInterval(r.mediaPlayerTimer),r.mediaPlayerTimer=null,document.getElementById(r.div.id)&&r.parentNode.contains(r.div)&&r.parentNode.removeChild(r.div),["video","audio"].forEach(function(P){var F=v[P];clearTimeout(F.playDeferTimeout),F.formerMediaState=null;var j={playerId:r.playerId,stateId:F.stateId+1,playDeferTimeout:null,error:!1,status:"aborted",reason:"stop",updatedAt:Date.now()};v[P]=j;var u={type:"player-status-change",playerId:r.playerId,mediaType:P,status:j.status,reason:j.reason,isErrorState:!1};S.default.debug("Media Player Status Change Triggered by destroy()",u),g.stream.dispatchEvent(u),L.b.reportApiInvoke(g.stream.sid,{name:"Stream.playerStatusChange",options:u,tag:"tracer"})()})},r.div=document.createElement("div"),r.div.setAttribute("id","player_"+r.id),r.div.setAttribute("style",g.stream.video?"width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;":"width: 100%; height: 100%; position: relative; overflow: hidden;"),r.video=document.createElement("video"),r.video.setAttribute("id","video"+r.id),r.video.setAttribute("style",g.stream.local&&!g.stream.screen?g.stream.mirror?"width: 100%; height: 100%; position: absolute; transform: rotateY(180deg); object-fit: ".concat(r.fit||"cover",";"):"width: 100%; height: 100%; position: absolute; object-fit: ".concat(r.fit||"cover",";"):g.stream.video?"width: 100%; height: 100%; position: absolute; object-fit: ".concat(r.fit||"cover",";"):g.stream.screen?"width: 100%; height: 100%; position: absolute; object-fit: ".concat(r.fit||"contain"):"width: 100%; height: 100%; position: absolute; display: none; object-fit: ".concat(r.fit||"cover"));var I={autoplay:!0,muted:!!g.stream.local||!(!Y.isSafari()&&"iOS"!==Y.getBrowserOS())&&"video_element_muted",playsinline:!0,controls:!(!Y.isSafari()&&"iOS"!==Y.getBrowserOS()||g.stream.local),volume:null},c=z()({},I,g.options);!0!==c.muted||c.volume||(c.volume=0),c.autoplay&&r.video.setAttribute("autoplay",""),!0!==c.muted&&"video_element_muted"!==c.muted||(r.video.setAttribute("muted",""),r.video.muted=!0),c.playsinline&&r.video.setAttribute("playsinline",""),c.controls&&r.video.setAttribute("controls",""),Number.isFinite(c.volume)&&(r.video.volume=c.volume),r.audio=document.createElement("audio"),r.audio.setAttribute("id","audio"+r.id),c.autoplay&&r.audio.setAttribute("autoplay",""),!0===c.muted&&r.audio.setAttribute("muted",""),!0===c.muted&&(r.audio.muted=!0),c.playsinline&&r.audio.setAttribute("playsinline",""),Number.isFinite(c.volume)&&(r.audio.volume=c.volume),void 0!==r.elementID?(document.getElementById(r.elementID).appendChild(r.div),r.container=document.getElementById(r.elementID)):(document.body.appendChild(r.div),r.container=document.body),r.parentNode=r.div.parentNode;var v={video:{playerId:r.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()},audio:{playerId:r.playerId,stateId:0,playDeferTimeout:null,error:!1,status:"init",reason:null,updatedAt:Date.now()}};r.mediaElemExists=function(P){for(var F=P,j=0;j<Object(M.getParameter)("MEDIA_ELEMENT_EXISTS_DEPTH")&&F;j++)F=F.parentNode;return!!F};var h=function(P){return r.mediaElemExists(P)?P.paused?"paused":"play":"aborted"},b=function(P,F,j){var u=h(P),W=!0;return"paused"===u?("audio"===F&&!0===j.muted&&(W=!1),j.autoplay||(W=!1)):"play"===u?"video"===F?W=!1:!0===j.muted?P.muted&&(W=!1):P.muted||(W=!1):"aborted"===u&&(W=!1),W},C=function(P){var F,j=this;if(j===r.video?F="video":j===r.audio&&(F="audio"),F){P.type||S.default.error("Unexpected evt",P);var u=h(j);clearTimeout(v[F].playDeferTimeout),v[F].playDeferTimeout=setTimeout(function(){v[F].playDeferTimeout=null;var W=v[F],Q=h(j);if(u===Q){var ne={playerId:r.playerId,stateId:W.stateId+1,playDeferTimeout:null,error:b(j,F,c),status:h(j),reason:P.type,updatedAt:Date.now()};if(W.status!==ne.status){v[F]=ne;var Oe={type:"player-status-change",playerId:r.playerId,mediaType:F,status:ne.status,reason:ne.reason,isErrorState:ne.error};S.default.debug("Media Player Status Change",Oe),g.stream.dispatchEvent(Oe),L.b.reportApiInvoke(g.stream.sid,{name:"Stream.playerStatusChange",options:Oe,tag:"tracer"})()}}else S.default.debug("Status Change after event Triggered."+"Stream ".concat(r.id," PlayerId ").concat(r.playerId," mediaType ").concat(F," Status ").concat(u,"=>").concat(Q))},Object(M.getParameter)("PLAYER_STATE_DEFER"))}else S.default.error("Unknown media element",j)};if(r.mediaPlayerTimer=setInterval(function(){["video","audio"].forEach(function(P){var F=r[P],j=v[P];if(!j.playDeferTimeout){var u={playerId:r.playerId,stateId:j.stateId+1,playDeferTimeout:null,error:b(F,P,c),status:h(F),reason:"timer",updatedAt:Date.now()};if(j.status!==u.status){S.default.debug("Player ".concat(r.playerId," ").concat(P," Status Changed Detected by Timer: ").concat(j.status,"=>").concat(u.status)),v[P]=u;var W={type:"player-status-change",playerId:r.playerId,mediaType:P,status:u.status,reason:u.reason,isErrorState:u.error};S.default.debug("Media Player Status Change",W),g.stream.dispatchEvent(W),L.b.reportApiInvoke(g.stream.sid,{name:"Stream.playerStatusChange",options:W,tag:"tracer"})()}}})},Object(M.getParameter)("PLAYER_STATE_DEFER")),r.video.addEventListener("playing",function(P){!function F(){r.video.videoWidth*r.video.videoHeight>4?S.default.debug("["+r.id+"] video dimensions:",r.video.videoWidth,r.video.videoHeight):setTimeout(F,50)}()}),r.video.addEventListener("playing",C),r.video.addEventListener("canplay",C),r.video.addEventListener("abort",C),r.video.addEventListener("onerror",C),r.video.addEventListener("suspend",C),r.video.addEventListener("stalled",C),r.video.addEventListener("pause",C),r.audio.addEventListener("playing",C),r.audio.addEventListener("canplay",C),r.audio.addEventListener("abort",C),r.audio.addEventListener("onerror",C),r.audio.addEventListener("suspend",C),r.audio.addEventListener("stalled",C),r.audio.addEventListener("pause",C),g.stream.hasVideo()||g.stream.hasScreen())r.div.appendChild(r.video),r.div.appendChild(r.audio),Y.isEdge()?r.video.srcObject=g.stream.stream:(Object(ye.attachMediaStream)(r.video,g.stream.stream),Object(ye.attachMediaStream)(r.audio,g.stream.stream));else if(!1!==c.muted&&"video_element_muted"!==c.muted||(r.video.removeAttribute("muted"),r.video.muted=!1),r.div.appendChild(r.video),window.MediaStream&&(Y.isSafari()||"iOS"===Y.getBrowserOS())){var O=new MediaStream(g.stream.stream.getAudioTracks());Object(ye.setSrcObject)(r.video,O)}else Object(ye.setSrcObject)(r.video,g.stream.stream);return r.setAudioVolume=function(P){var F=parseInt(P)/100;isFinite(F)&&(F<0?F=0:F>1&&(F=1),r.video&&(r.video.volume=F),r.audio&&(r.audio.volume=F))},r},Vt=E(14),qt=E.n(Vt),At=null,Xt=function(){try{At=window.require("electron")}catch{}return At},tn=function(g){var r=L.b.reportApiInvoke(null,{callback:g,name:"getScreenSources",options:arguments,tag:"tracer"}),I=Xt();if(!I)return r&&r("electron is null");I.desktopCapturer.getSources({types:["window","screen"]},function(c,v){if(c)return r&&r(c);r&&r(null,v)})},xt=function(g,r,I){r={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:g,maxHeight:r.height,maxWidth:r.width,maxFrameRate:r.frameRate&&r.frameRate.max,minFrameRate:r.frameRate&&r.frameRate.min}}},navigator.webkitGetUserMedia(r,function(v){I&&I(null,v)},function(v){I&&I(v)})},Ut=tn,Ct=xt,bn=103,hn=function(g){var r={};if(r.clientId=g.clientId,g.session_id=bn+=1,typeof window>"u"||!window.navigator)throw S.default.error("["+r.streamId+"]["+r.clientId+"]Publish/subscribe video/audio streams not supported yet"),new Error("NON_BROWSER_ENV_DETECTED");return null!==window.navigator.userAgent.match("Firefox")?(r.browser="mozilla",r=function(g){var r={},I=(mozRTCPeerConnection,mozRTCSessionDescription),c=!1;r.uid=g.uid,r.isVideoMute=g.isVideoMute,r.isAudioMute=g.isAudioMute,r.isSubscriber=g.isSubscriber,r.clientId=g.clientId,r.filterStatsCache=[],r.originStatsCache=[],r.lastTimeGetStats=null,r.pc_config={iceServers:[]},g.iceServers instanceof Array?g.iceServers.map(function(F){0===F.url.indexOf("stun:")&&r.pc_config.iceServers.push({url:F.url})}):(g.stunServerUrl&&(g.stunServerUrl instanceof Array?g.stunServerUrl.map(function(F){"string"==typeof F&&""!==F&&r.pc_config.iceServers.push({url:F})}):"string"==typeof g.stunServerUrl&&""!==g.stunServerUrl&&r.pc_config.iceServers.push({url:g.stunServerUrl})),g.turnServer&&"string"==typeof g.turnServer.url&&""!==g.turnServer.url&&(g.turnServer.udpport&&r.pc_config.iceServers.push({username:g.turnServer.username,credential:g.turnServer.credential,credentialType:"password",urls:"turn:"+g.turnServer.url+":"+g.turnServer.udpport+"?transport=udp"}),"string"==typeof g.turnServer.tcpport&&""!==g.turnServer.tcpport&&r.pc_config.iceServers.push({username:g.turnServer.username,credential:g.turnServer.credential,credentialType:"password",urls:"turn:"+g.turnServer.url+":"+g.turnServer.tcpport+"?transport=tcp"}),!0===g.turnServer.forceturn&&(r.pc_config.iceTransportPolicy="relay"))),void 0===g.audio&&(g.audio=!0),void 0===g.video&&(g.video=!0),r.mediaConstraints={offerToReceiveAudio:g.audio,offerToReceiveVideo:g.video,mozDontOfferDataChannel:!0},r.roapSessionId=103,r.peerConnection=new ye.RTCPeerConnection(r.pc_config),S.default.debug("["+r.clientId+']safari Created RTCPeerConnnection with config "'+JSON.stringify(r.pc_config)+'".'),r.iceCandidateTimer=setTimeout(function(){r.iceCandidateTimer=null,S.default.debug("[".concat(r.clientId,"]Candidates collected: ").concat(r.iceCandidateCount)),r.moreIceComing&&(r.moreIceComing=!1,r.markActionNeeded())},Object(M.getParameter)("CANDIDATE_TIMEOUT")),r.peerConnection.onicecandidate=function(F){var j,u,W,Q;u=(j=r.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),W=j.match(/a=candidate:.+typ\shost.+\r\n/),Q=j.match(/a=candidate:.+typ\srelay.+\r\n/),null===u&&null===W&&null===Q||void 0!==r.ice||!r.iceCandidateTimer||(S.default.debug("["+r.clientId+"]srflx candidate : "+u+" relay candidate: "+Q+" host candidate : "+W),clearTimeout(r.iceCandidateTimer),r.iceCandidateTimer=null,r.ice=0,r.moreIceComing=!1,r.markActionNeeded()),r.iceCandidateCount=r.iceCandidateCount+1},r.checkMLineReverseInSDP=function(F){return!(!~F.indexOf("m=audio")||!~F.indexOf("m=video"))&&F.indexOf("m=audio")>F.indexOf("m=video")},r.reverseMLineInSDP=function(F){var j=F.split("m=audio"),u=j[1].split("m=video");return j[0]+"m=video"+u[1]+"m=audio"+u[0]},r.processSignalingMessage=function(F){var u=JSON.parse(F);r.incomingMessage=u,"new"===r.state?"OFFER"===u.messageType?(u.sdp=P(u.sdp),r.peerConnection.setRemoteDescription(new I({sdp:u.sdp,type:"offer"}),function(){S.default.debug("["+r.clientId+"]setRemoteDescription succeeded")},function(W){S.default.info("["+r.clientId+"]setRemoteDescription failed: "+W.name)}),r.state="offer-received",r.markActionNeeded()):r.error("Illegal message for this state: "+u.messageType+" in state "+r.state):"offer-sent"===r.state?"ANSWER"===u.messageType?(u.sdp=P(u.sdp),u.sdp=u.sdp.replace(/ generation 0/g,""),u.sdp=u.sdp.replace(/ udp /g," UDP "),-1!==u.sdp.indexOf("a=group:BUNDLE")?(u.sdp=u.sdp.replace(/a=group:BUNDLE audio video/,"a=group:BUNDLE sdparta_0 sdparta_1"),u.sdp=u.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),u.sdp=u.sdp.replace(/a=mid:video/,"a=mid:sdparta_1")):(u.sdp=u.sdp.replace(/a=mid:audio/,"a=mid:sdparta_0"),u.sdp=u.sdp.replace(/a=mid:video/,"a=mid:sdparta_0")),r.peerConnection.setRemoteDescription(new I({sdp:u.sdp,type:"answer"}),function(){S.default.debug("["+r.clientId+"]setRemoteDescription succeeded")},function(W){S.default.info("["+r.clientId+"]setRemoteDescription failed: "+W)}),r.state="established"):"pr-answer"===u.messageType?r.peerConnection.setRemoteDescription(new I({sdp:u.sdp,type:"pr-answer"}),function(){S.default.debug("["+r.clientId+"]setRemoteDescription succeeded")},function(W){S.default.info("["+r.clientId+"]setRemoteDescription failed: "+W.name)}):r.error("offer"===u.messageType?"Not written yet":"Illegal message for this state: "+u.messageType+" in state "+r.state):"established"===r.state&&("OFFER"===u.messageType?(r.peerConnection.setRemoteDescription(new I({sdp:u.sdp,type:"offer"}),function(){S.default.debug("["+r.clientId+"]setRemoteDescription succeeded")},function(W){S.default.info("["+r.clientId+"]setRemoteDescription failed: "+W.name)}),r.state="offer-received",r.markActionNeeded()):r.error("Illegal message for this state: "+u.messageType+" in state "+r.state))};var v={id:"",type:"",mediaType:"opus",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},h={id:"",type:"",mediaType:"",googCodecName:"h264"===g.codec?"H264":"VP8",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0"},b={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},C={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0",googFramesDecoded:"0"},O=0;r.getVideoRelatedStats=function(F){r.peerConnection.getStats().then(function(j){var u=!0,W=!1,Q=void 0;try{for(var ne,Oe=j.values()[Symbol.iterator]();!(u=(ne=Oe.next()).done);u=!0){var $=ne.value;if(r.isSubscriber){if(("inbound-rtp"===$.type||"inboundrtp"===$.type)&&"video"===$.mediaType){if(!r.lastReport)return void(r.lastReport=$);F&&F({browser:"firefox",mediaType:"video",peerId:r.uid,isVideoMute:r.isVideoMute,frameRateReceived:$.framerateMean+"",frameRateDecoded:$.framesDecoded-r.lastReport.framesDecoded+"",bytesReceived:$.bytesReceived+"",packetsReceived:$.packetsReceived+"",packetsLost:$.packetsLost+""}),r.lastReport=$}}else if(("outbound-rtp"===$.type||"outboundrtp"===$.type)&&"video"===$.mediaType){if(!r.lastReport)return void(r.lastReport=$);F&&F({mediaType:"video",isVideoMute:r.isVideoMute,frameRateInput:$.framerateMean+"",frameRateSent:$.framesEncoded-r.lastReport.framesEncoded+""}),r.lastReport=$}}}catch(Ie){W=!0,Q=Ie}finally{try{u||null==Oe.return||Oe.return()}finally{if(W)throw Q}}})},r.getAudioRelatedStats=function(F){r.peerConnection.getStats().then(function(j){var u=!0,W=!1,Q=void 0;try{for(var ne,Oe=j.values()[Symbol.iterator]();!(u=(ne=Oe.next()).done);u=!0){var $=ne.value;r.isSubscriber&&("inbound-rtp"!==$.type&&"inboundrtp"!==$.type||"audio"!==$.mediaType||F&&F({browser:"firefox",mediaType:"audio",peerId:r.uid,isAudioMute:r.isAudioMute,frameDropped:$.packetsLost+"",frameReceived:$.packetsReceived+"",googJitterReceived:$.jitter+"",bytesReceived:$.bytesReceived+"",packetsReceived:$.packetsReceived+"",packetsLost:$.packetsLost+""}))}}catch(Ie){W=!0,Q=Ie}finally{try{u||null==Oe.return||Oe.return()}finally{if(W)throw Q}}})},r.getStatsRate=function(F){r.getStats(function(j){j.forEach(function(u){"inbound-rtp"!==u.type&&"inboundrtp"!==u.type||"video"!==u.mediaType||u.googFrameRateDecoded&&(u.googFrameRateDecoded=((u.googFramesDecoded-O)/3).toString(),O=u.googFramesDecoded)}),F(j)})},r.getStats=function(F,j){j=(j=j||500)>500?500:j,r.lastTimeGetStats&&Date.now()-r.lastTimeGetStats<j?F&&F(r.filterStatsCache,r.originStatsCache):this._getStats(function(u,W){r.filterStatsCache=u,r.originStatsCache=W,r.lastTimeGetStats=Date.now(),F&&F(u,W)})},r._getStats=function(F){r.peerConnection.getStats().then(function(j){var u=[],W=!0,Q=!1,ne=void 0;try{for(var Oe,$=j.values()[Symbol.iterator]();!(W=(Oe=$.next()).done);W=!0){var Ie=Oe.value;u.push(Ie),"outbound-rtp"!==Ie.type&&"outboundrtp"!==Ie.type||"video"!==Ie.mediaType||-1!==Ie.id.indexOf("rtcp")||(h.id=Ie.id,h.type=Ie.type,h.mediaType=Ie.mediaType,h.bytesSent=Ie.bytesSent?Ie.bytesSent+"":"0",h.packetsSent=Ie.packetsSent?Ie.packetsSent+"":"0",h.googPlisReceived=Ie.pliCount?Ie.pliCount+"":"0",h.googNacksReceived=Ie.nackCount?Ie.nackCount+"":"0",h.googFirsReceived=Ie.firCount?Ie.firCount+"":"0",h.googFrameRateSent=Ie.framerateMean?Ie.framerateMean+"":"0"),"outbound-rtp"!==Ie.type&&"outboundrtp"!==Ie.type||"audio"!==Ie.mediaType||-1!==Ie.id.indexOf("rtcp")||(v.id=Ie.id,v.type=Ie.type,v.mediaType=Ie.mediaType,v.bytesSent=Ie.bytesSent?Ie.bytesSent+"":"0",v.packetsSent=Ie.packetsSent?Ie.packetsSent+"":"0"),"inbound-rtp"!==Ie.type&&"inboundrtp"!==Ie.type||"audio"!==Ie.mediaType||Ie.isRemote||-1!==Ie.id.indexOf("rtcp")||(b.id=Ie.id,b.type=Ie.type,b.mediaType=Ie.mediaType,b.bytesReceived=Ie.bytesReceived?Ie.bytesReceived+"":"0",b.packetsLost=Ie.packetsLost?Ie.packetsLost+"":"0",b.packetsReceived=Ie.packetsReceived?Ie.packetsReceived+"":"0",b.googJitterReceived=Ie.jitter?Ie.jitter+"":"0"),"inbound-rtp"!==Ie.type&&"inboundrtp"!==Ie.type||"video"!==Ie.mediaType||Ie.isRemote||-1!==Ie.id.indexOf("rtcp")||(C.id=Ie.id,C.type=Ie.type,C.mediaType=Ie.mediaType,C.bytesReceived=Ie.bytesReceived?Ie.bytesReceived+"":"0",C.googFrameRateReceived=Ie.framerateMean?Ie.framerateMean+"":"0",C.googFramesDecoded=Ie.framesDecoded?Ie.framesDecoded+"":"0",C.packetsLost=Ie.packetsLost?Ie.packetsLost+"":"0",C.packetsReceived=Ie.packetsReceived?Ie.packetsReceived+"":"0",C.googJitterBufferMs=Ie.jitter?Ie.jitter+"":"0",C.googNacksSent=Ie.nackCount?Ie.nackCount+"":"0",C.googPlisSent=Ie.pliCount?Ie.pliCount+"":"0",C.googFirsSent=Ie.firCount?Ie.firCount+"":"0"),-1!==Ie.id.indexOf("outbound_rtcp_video")&&(h.packetsLost=Ie.packetsLost?Ie.packetsLost+"":"0")}}catch(tt){Q=!0,ne=tt}finally{try{W||null==$.return||$.return()}finally{if(Q)throw ne}}var We=[h,v,b,C];We.push({id:"time",startTime:r.connectedTime,timestamp:new Date}),F(We,u)},function(j){S.default.error("["+r.clientId+"]"+j)})},r.addStream=function(F){c=!0,r.peerConnection.addStream(F),r.markActionNeeded()},r.removeStream=function(){r.markActionNeeded()},r.close=function(){r.state="closed",r.peerConnection.close()},r.markActionNeeded=function(){r.actionNeeded=!0,r.doLater(function(){r.onstablestate()})},r.doLater=function(F){window.setTimeout(F,1)},r.onstablestate=function(){if(r.actionNeeded){if("new"===r.state||"established"===r.state)c&&(r.mediaConstraints=void 0),r.peerConnection.createOffer(function(j){if(j.sdp=P(j.sdp),j.sdp=j.sdp.replace(/a=extmap:1 http:\/\/www.webrtc.org\/experiments\/rtp-hdrext\/abs-send-time/,"a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"),j.sdp!==r.prevOffer)return r.peerConnection.setLocalDescription(j),r.state="preparing-offer",void r.markActionNeeded();S.default.debug("["+r.clientId+"]Not sending a new offer")},function(j){S.default.debug("["+r.clientId+"]Ups! create offer failed ",j)},r.mediaConstraints);else if("preparing-offer"===r.state){if(r.moreIceComing)return;r.prevOffer=r.peerConnection.localDescription.sdp,r.offerCandidates=r.prevOffer.match(/a=candidate.+\r\n/g)||[],r.offerCandidates.length||(S.default.warning("[".concat(r.clientId,"]No Ice Candidate generated")),Object(M.getParameter)("SHIM_CANDIDATE")?(S.default.debug("Shimming fake candidate"),r.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):S.default.error("[".concat(r.clientId,"]None Ice Candidate not allowed"))),r.prevOffer=r.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),r.sendMessage("OFFER",r.prevOffer),r.state="offer-sent"}else if("offer-received"===r.state)r.peerConnection.createAnswer(function(j){if(r.peerConnection.setLocalDescription(j),r.state="offer-received-preparing-answer",r.iceStarted)r.markActionNeeded();else{var u=new Date;S.default.debug("["+r.clientId+"]"+u.getTime()+": Starting ICE in responder"),r.iceStarted=!0}},function(){S.default.debug("["+r.clientId+"]Ups! Something went wrong")});else if("offer-received-preparing-answer"===r.state){if(r.moreIceComing)return;r.sendMessage("ANSWER",r.peerConnection.localDescription.sdp),r.state="established"}else r.error("Dazed and confused in state "+r.state+", stopping here");r.actionNeeded=!1}},r.sendMessage=function(F,j){var u={};u.messageType=F,u.sdp=j,"OFFER"===F?(u.offererSessionId=r.sessionId,u.answererSessionId=r.otherSessionId,u.seq=r.sequenceNumber+=1,u.tiebreaker=Math.floor(429496723*Math.random()+1)):(u.offererSessionId=r.incomingMessage.offererSessionId,u.answererSessionId=r.sessionId,u.seq=r.incomingMessage.seq),r.onsignalingmessage(JSON.stringify(u))},r._getSender=function(F){if(r.peerConnection&&r.peerConnection.getSenders){var j=r.peerConnection.getSenders().find(function(u){return u.track.kind==F});if(j)return j}return null},r.hasSender=function(F){return!!r._getSender(F)},r.replaceTrack=function(F,j,u){var W=r._getSender(F.kind);if(!W)return u("NO_SENDER_FOUND");try{W.replaceTrack(F)}catch(Q){return u&&u(Q)}setTimeout(function(){return j&&j()},50)},r.error=function(F){throw"Error in RoapOnJsep: "+F},r.sessionId=r.roapSessionId+=1,r.sequenceNumber=0,r.actionNeeded=!1,r.iceStarted=!1,r.moreIceComing=!0,r.iceCandidateCount=0,r.onsignalingmessage=g.callback,r.peerConnection.ontrack=function(F){r.onaddstream&&r.onaddstream(F,"ontrack")},r.peerConnection.onremovestream=function(F){r.onremovestream&&r.onremovestream(F)},r.peerConnection.oniceconnectionstatechange=function(F){"connected"===F.currentTarget.iceConnectionState&&(r.connectedTime=new Date),r.oniceconnectionstatechange&&r.oniceconnectionstatechange(F.currentTarget.iceConnectionState)};var P=function(F){var j;if(g.video&&g.maxVideoBW&&(null==(j=F.match(/m=video.*\r\n/))&&(j=F.match(/m=video.*\n/)),j&&j.length>0)){var u=j[0]+"b=TIAS:"+1e3*g.maxVideoBW+"\r\n";F=F.replace(j[0],u)}return g.audio&&g.maxAudioBW&&(null==(j=F.match(/m=audio.*\r\n/))&&(j=F.match(/m=audio.*\n/)),j&&j.length>0)&&(F=F.replace(j[0],u=j[0]+"b=TIAS:"+1e3*g.maxAudioBW+"\r\n")),F};return r.onaddstream=null,r.onremovestream=null,r.state="new",r.markActionNeeded(),r}(g)):"iOS"===Y.getBrowserOS()||Y.isSafari()?(S.default.debug("["+r.streamId+"]["+r.clientId+"]Safari"),(r=function(g){var r={},I=ye.RTCPeerConnection;r.uid=g.uid,r.isVideoMute=g.isVideoMute,r.isAudioMute=g.isAudioMute,r.isSubscriber=g.isSubscriber,r.clientId=g.clientId,r.filterStatsCache=[],r.originStatsCache=[],r.lastTimeGetStats=null,r.pc_config={iceServers:[{urls:["stun:webcs.agora.io:3478","stun:stun.l.google.com:19302"]}],bundlePolicy:"max-bundle"},r.con={optional:[{DtlsSrtpKeyAgreement:!0}]},g.iceServers instanceof Array?r.pc_config.iceServers=g.iceServers:(g.stunServerUrl&&(g.stunServerUrl instanceof Array?g.stunServerUrl.map(function(W){"string"==typeof W&&""!==W&&r.pc_config.iceServers.push({url:W})}):"string"==typeof g.stunServerUrl&&""!==g.stunServerUrl&&r.pc_config.iceServers.push({url:g.stunServerUrl})),g.turnServer&&(g.turnServer instanceof Array?g.turnServer.map(function(W){"string"==typeof W.url&&""!==W.url&&r.pc_config.iceServers.push({username:W.username,credential:W.credential,url:W.url})}):"auto"!==g.turnServer.mode&&"manual"!==g.turnServer.mode||(g.turnServer.udpport&&r.pc_config.iceServers.push({username:g.turnServer.username,credential:g.turnServer.credential,credentialType:"password",urls:["turn:"+g.turnServer.url+":"+g.turnServer.udpport+"?transport=udp"]}),"string"==typeof g.turnServer.tcpport&&""!==g.turnServer.tcpport&&r.pc_config.iceServers.push({username:g.turnServer.username,credential:g.turnServer.credential,credentialType:"password",urls:["turn:"+g.turnServer.url+":"+g.turnServer.tcpport+"?transport=tcp"]}),!0===g.turnServer.forceturn&&(r.pc_config.iceTransportPolicy="relay")))),void 0===g.audio&&(g.audio=!0),void 0===g.video&&(g.video=!0),r.mediaConstraints={mandatory:{OfferToReceiveVideo:g.video,OfferToReceiveAudio:g.audio}},r.roapSessionId=103;try{r.pc_config.sdpSemantics="plan-b",r.peerConnection=new I(r.pc_config,r.con)}catch{delete r.pc_config.sdpSemantics,r.peerConnection=new I(r.pc_config,r.con)}S.default.debug("["+r.clientId+']safari Created RTCPeerConnnection with config "'+JSON.stringify(r.pc_config)+'".'),r.iceCandidateTimer=setTimeout(function(){r.iceCandidateTimer=null,S.default.debug("[".concat(r.clientId,"]Candidates collected: ").concat(r.iceCandidateCount)),r.moreIceComing&&(r.moreIceComing=!1,r.markActionNeeded())},Object(M.getParameter)("CANDIDATE_TIMEOUT")),r.peerConnection.onicecandidate=function(W){var Q,ne,Oe,$;ne=(Q=r.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),Oe=Q.match(/a=candidate:.+typ\shost.+\r\n/),$=Q.match(/a=candidate:.+typ\srelay.+\r\n/),0===r.iceCandidateCount&&(r.timeout=setTimeout(function(){r.moreIceComing&&(r.moreIceComing=!1,r.markActionNeeded())},1e3)),null===ne&&null===Oe&&null===$||void 0!==r.ice||!r.iceCandidateTimer||(S.default.debug("["+r.clientId+"]srflx candidate : "+ne+" relay candidate: "+$+" host candidate : "+Oe),clearTimeout(r.iceCandidateTimer),r.iceCandidateTimer=null,r.ice=0,r.moreIceComing=!1,r.markActionNeeded()),r.iceCandidateCount=r.iceCandidateCount+1};var c=function(W){return g.screen&&(W=W.replace("a=x-google-flag:conference\r\n","")),W},v=function(W){var Q;return(Q=W.match(/m=video.*\r\n/))&&g.minVideoBW&&g.maxVideoBW&&(W=W.replace(Q[0],Q[0]+"b=AS:"+g.maxVideoBW+"\r\n"),S.default.debug("["+r.clientId+"]Set Video Bitrate - min:"+g.minVideoBW+" max:"+g.maxVideoBW)),(Q=W.match(/m=audio.*\r\n/))&&g.maxAudioBW&&(W=W.replace(Q[0],Q[0]+"b=AS:"+g.maxAudioBW+"\r\n")),W};r.processSignalingMessage=function(W){var Q,ne=JSON.parse(W);r.incomingMessage=ne,"new"===r.state?"OFFER"===ne.messageType?(Q={sdp:ne.sdp,type:"offer"},r.peerConnection.setRemoteDescription(new RTCSessionDescription(Q)),r.state="offer-received",r.markActionNeeded()):r.error("Illegal message for this state: "+ne.messageType+" in state "+r.state):"offer-sent"===r.state?"ANSWER"===ne.messageType?((Q={sdp:ne.sdp,type:"answer"}).sdp=c(Q.sdp),Q.sdp=v(Q.sdp),Q.sdp=Q.sdp.replace(/a=x-google-flag:conference\r\n/g,""),r.peerConnection.setRemoteDescription(new RTCSessionDescription(Q)),r.state="established"):"pr-answer"===ne.messageType?(Q={sdp:ne.sdp,type:"pr-answer"},r.peerConnection.setRemoteDescription(new RTCSessionDescription(Q))):r.error("offer"===ne.messageType?"Not written yet":"Illegal message for this state: "+ne.messageType+" in state "+r.state):"established"===r.state&&("OFFER"===ne.messageType?(Q={sdp:ne.sdp,type:"offer"},r.peerConnection.setRemoteDescription(new RTCSessionDescription(Q)),r.state="offer-received",r.markActionNeeded()):"ANSWER"===ne.messageType?((Q={sdp:ne.sdp,type:"answer"}).sdp=c(Q.sdp),Q.sdp=v(Q.sdp),r.peerConnection.setRemoteDescription(new RTCSessionDescription(Q))):r.error("Illegal message for this state: "+ne.messageType+" in state "+r.state))};var h={id:"",type:"",mediaType:"",googCodecName:"opus",aecDivergentFilterFraction:"0",audioInputLevel:"0",bytesSent:"0",packetsSent:"0",googEchoCancellationReturnLoss:"0",googEchoCancellationReturnLossEnhancement:"0"},b={id:"",type:"",mediaType:"",googCodecName:"h264"===g.codec?"H264":"VP8",bytesSent:"0",packetsLost:"0",packetsSent:"0",googAdaptationChanges:"0",googAvgEncodeMs:"0",googEncodeUsagePercent:"0",googFirsReceived:"0",googFrameHeightSent:"0",googFrameHeightInput:"0",googFrameRateInput:"0",googFrameRateSent:"0",googFrameWidthSent:"0",googFrameWidthInput:"0",googNacksReceived:"0",googPlisReceived:"0",googRtt:"0",googFramesEncoded:"0"},C={id:"",type:"",mediaType:"",audioOutputLevel:"0",bytesReceived:"0",packetsLost:"0",packetsReceived:"0",googAccelerateRate:"0",googCurrentDelayMs:"0",googDecodingCNG:"0",googDecodingCTN:"0",googDecodingCTSG:"0",googDecodingNormal:"0",googDecodingPLC:"0",googDecodingPLCCNG:"0",googExpandRate:"0",googJitterBufferMs:"0",googJitterReceived:"0",googPreemptiveExpandRate:"0",googPreferredJitterBufferMs:"0",googSecondaryDecodedRate:"0",googSpeechExpandRate:"0"},O={id:"",type:"",mediaType:"",googTargetDelayMs:"0",packetsLost:"0",googDecodeMs:"0",googMaxDecodeMs:"0",googRenderDelayMs:"0",googFrameWidthReceived:"0",googFrameHeightReceived:"0",googFrameRateReceived:"0",googFrameRateDecoded:"0",googFrameRateOutput:"0",googFramesDecoded:"0",googFrameReceived:"0",googJitterBufferMs:"0",googCurrentDelayMs:"0",googMinPlayoutDelayMs:"0",googNacksSent:"0",googPlisSent:"0",googFirsSent:"0",bytesReceived:"0",packetsReceived:"0"},P={id:"bweforvideo",type:"VideoBwe",googAvailableSendBandwidth:"0",googAvailableReceiveBandwidth:"0",googActualEncBitrate:"0",googRetransmitBitrate:"0",googTargetEncBitrate:"0",googBucketDelay:"0",googTransmitBitrate:"0"},F=0,j=0,u=0;return r.getVideoRelatedStats=function(W){r.peerConnection.getStats().then(function(Q){var ne={peerId:r.uid,mediaType:"video",isVideoMute:r.isVideoMute};Q.forEach(function(Oe){if(r.isSubscriber){if("track"===Oe.type&&(~Oe.id.indexOf("video")||~Oe.trackIdentifier.indexOf("v"))){if(!r.lastReport)return void(r.lastReport=Oe);ne.frameRateReceived=Oe.framesReceived-r.lastReport.framesReceived+"",ne.frameRateDecoded=Oe.framesDecoded-r.lastReport.framesDecoded+"",r.lastReport=Oe}"inbound-rtp"===Oe.type&&~Oe.id.indexOf("Video")&&(ne.bytesReceived=Oe.bytesReceived+"",ne.packetsReceived=Oe.packetsReceived+"",ne.packetsLost=Oe.packetsLost+"")}else if("outbound-rtp"===Oe.type&&~Oe.id.indexOf("Video")){if(!r.lastReport)return void(r.lastReport=Oe);W&&W({mediaType:"video",isVideoMute:r.isVideoMute,frameRateInput:g.maxFrameRate+"",frameRateSent:Oe.framesEncoded-r.lastReport.framesEncoded+""}),r.lastReport=Oe}}),W&&W(ne)})},r.getAudioRelatedStats=function(W){r.peerConnection.getStats().then(function(Q){Q.forEach(function(ne){r.isSubscriber&&"inbound-rtp"===ne.type&&~ne.id.indexOf("Audio")&&W&&W({peerId:r.uid,mediaType:"audio",isAudioMute:r.isAudioMute,frameDropped:ne.packetsLost+"",frameReceived:ne.packetsReceived+"",googJitterReceived:ne.jitter+"",bytesReceived:ne.bytesReceived+"",packetsReceived:ne.packetsReceived+"",packetsLost:ne.packetsLost+""})})})},r.getStatsRate=function(W){r.getStats(function(Q){Q.forEach(function(ne){"outbound-rtp"===ne.type&&"video"===ne.mediaType&&ne.googFramesEncoded&&(ne.googFrameRateSent=((ne.googFramesEncoded-F)/3).toString(),F=ne.googFramesEncoded),"inbound-rtp"===ne.type&&-1!=ne.id.indexOf("55543")&&(ne.googFrameRateReceived&&(ne.googFrameRateReceived=((ne.googFrameReceived-u)/3).toString(),u=ne.googFrameReceived),ne.googFrameRateDecoded&&(ne.googFrameRateDecoded=((ne.googFramesDecoded-j)/3).toString(),j=ne.googFramesDecoded))}),W(Q)})},r.getStats=function(W,Q){Q=(Q=Q||500)>500?500:Q,r.lastTimeGetStats&&Date.now()-r.lastTimeGetStats<Q?W&&W(r.filterStatsCache,r.originStatsCache):this._getStats(function(ne,Oe){r.filterStatsCache=ne,r.originStatsCache=Oe,r.lastTimeGetStats=Date.now(),W&&W(ne,Oe)})},r._getStats=function(W){var Q=[];r.peerConnection.getStats().then(function(ne){ne.forEach(function($){Q.push($),"outbound-rtp"===$.type&&"audio"===$.mediaType&&(h.id=$.id,h.type=$.type,h.mediaType=$.mediaType,h.bytesSent=$.bytesSent?$.bytesSent+"":"0",h.packetsSent=$.packetsSent?$.packetsSent+"":"0"),"outbound-rtp"===$.type&&"video"===$.mediaType&&(b.id=$.id,b.type=$.type,b.mediaType=$.mediaType,b.bytesSent=$.bytesSent?$.bytesSent+"":"0",b.packetsSent=$.packetsSent?$.packetsSent+"":"0",b.googPlisReceived=$.pliCount?$.pliCount+"":"0",b.googNacksReceived=$.nackCount?$.nackCount+"":"0",b.googFirsReceived=$.firCount?$.firCount+"":"0",b.googFramesEncoded=$.framesEncoded?$.framesEncoded+"":"0"),"inbound-rtp"===$.type&&-1!=$.id.indexOf("44444")&&(C.id=$.id,C.type=$.type,C.mediaType="audio",C.packetsReceived=$.packetsReceived?$.packetsReceived+"":"0",C.bytesReceived=$.bytesReceived?$.bytesReceived+"":"0",C.packetsLost=$.packetsLost?$.packetsLost+"":"0",C.packetsReceived=$.packetsReceived?$.packetsReceived+"":"0",C.googJitterReceived=$.jitter?$.jitter+"":"0"),"inbound-rtp"===$.type&&-1!=$.id.indexOf("55543")&&(O.id=$.id,O.type=$.type,O.mediaType="video",O.packetsReceived=$.packetsReceived?$.packetsReceived+"":"0",O.bytesReceived=$.bytesReceived?$.bytesReceived+"":"0",O.packetsLost=$.packetsLost?$.packetsLost+"":"0",O.googJitterBufferMs=$.jitter?$.jitter+"":"0",O.googNacksSent=$.nackCount?$.nackCount+"":"0",O.googPlisSent=$.pliCount?$.pliCount+"":"0",O.googFirsSent=$.firCount?$.firCount+"":"0"),"track"!==$.type||-1==$.id.indexOf("55543")&&!~$.trackIdentifier.indexOf("v")&&null!=$.audioLevel||(O.googFrameWidthReceived=$.frameWidth?$.frameWidth+"":"0",O.googFrameHeightReceived=$.frameHeight?$.frameHeight+"":"0",O.googFrameReceived=$.framesReceived?$.framesReceived+"":"0",O.googFramesDecoded=$.framesDecoded?$.framesDecoded+"":"0"),"track"!==$.type||-1==$.id.indexOf("44444")&&!~$.trackIdentifier.indexOf("a")&&void 0===$.audioLevel||(C.audioOutputLevel=$.audioLevel+"",h.audioInputLevel=$.audioLevel+""),"candidate-pair"===$.type&&(0==$.availableIncomingBitrate?P.googAvailableSendBandwidth=$.availableOutgoingBitrate+"":P.googAvailableReceiveBandwidth=$.availableIncomingBitrate+"")});var Oe=[P,h,b,C,O];Oe.push({id:"time",startTime:r.connectedTime,timestamp:new Date}),W(Oe,Q)}).catch(function(ne){console.error(ne)})},r.addTrack=function(W,Q){r.peerConnection.addTrack(W,Q)},r.removeTrack=function(W,Q){var ne=r.peerConnection.getSenders().find(function(Oe){return Oe.track==W});ne.replaceTrack(null),r.peerConnection.removeTrack(ne)},r.addStream=function(W){window.navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")?W.getTracks().forEach(function(Q){return r.peerConnection.addTrack(Q,W)}):r.peerConnection.addStream(W),r.markActionNeeded()},r.removeStream=function(){r.markActionNeeded()},r.close=function(){r.state="closed",r.peerConnection.close()},r.markActionNeeded=function(){r.actionNeeded=!0,r.doLater(function(){r.onstablestate()})},r.doLater=function(W){window.setTimeout(W,1)},r.onstablestate=function(){if(r.actionNeeded){if("new"===r.state||"established"===r.state)g.isSubscriber&&(r.peerConnection.addTransceiver("audio",{direction:"recvonly"}),r.peerConnection.addTransceiver("video",{direction:"recvonly"})),r.peerConnection.createOffer(r.mediaConstraints).then(function(Q){if(Q.sdp=v(Q.sdp),g.isSubscriber||(Q.sdp=Q.sdp.replace(/a=extmap:4 urn:3gpp:video-orientation\r\n/g,"")),Q.sdp!==r.prevOffer)return r.peerConnection.setLocalDescription(Q),r.state="preparing-offer",void r.markActionNeeded();S.default.debug("["+r.clientId+"]Not sending a new offer")}).catch(function(Q){S.default.debug("["+r.clientId+"]peer connection create offer failed ",Q)});else if("preparing-offer"===r.state){if(r.moreIceComing)return;r.prevOffer=r.peerConnection.localDescription.sdp,r.offerCandidates=r.prevOffer.match(/a=candidate.+\r\n/g)||[],r.offerCandidates.length||(S.default.warning("[".concat(r.clientId,"]No Ice Candidate generated")),Object(M.getParameter)("SHIM_CANDIDATE")?(S.default.debug("Shimming fake candidate"),r.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):S.default.error("[".concat(r.clientId,"]None Ice Candidate not allowed"))),r.prevOffer=r.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),r.sendMessage("OFFER",r.prevOffer),r.state="offer-sent"}else if("offer-received"===r.state)r.peerConnection.createAnswer(function(Q){if(r.peerConnection.setLocalDescription(Q),r.state="offer-received-preparing-answer",r.iceStarted)r.markActionNeeded();else{var ne=new Date;S.default.debug("["+r.clientId+"]"+ne.getTime()+": Starting ICE in responder"),r.iceStarted=!0}},function(Q){S.default.debug("["+r.clientId+"]peer connection create answer failed ",Q)},r.mediaConstraints);else if("offer-received-preparing-answer"===r.state){if(r.moreIceComing)return;r.sendMessage("ANSWER",r.peerConnection.localDescription.sdp),r.state="established"}else r.error("Dazed and confused in state "+r.state+", stopping here");r.actionNeeded=!1}},r.sendMessage=function(W,Q){var ne={};ne.messageType=W,ne.sdp=Q,"OFFER"===W?(ne.offererSessionId=r.sessionId,ne.answererSessionId=r.otherSessionId,ne.seq=r.sequenceNumber+=1,ne.tiebreaker=Math.floor(429496723*Math.random()+1)):(ne.offererSessionId=r.incomingMessage.offererSessionId,ne.answererSessionId=r.sessionId,ne.seq=r.incomingMessage.seq),r.onsignalingmessage(JSON.stringify(ne))},r._getSender=function(W){if(r.peerConnection&&r.peerConnection.getSenders){var Q=r.peerConnection.getSenders().find(function(ne){return ne.track.kind==W});if(Q)return Q}return null},r.hasSender=function(W){return!!r._getSender(W)},r.replaceTrack=function(W,Q,ne){var Oe=r._getSender(W.kind);if(!Oe)return ne("NO_SENDER_FOUND");try{Oe.replaceTrack(W)}catch($){return ne&&ne($)}setTimeout(function(){return Q&&Q()},50)},r.error=function(W){throw"Error in RoapOnJsep: "+W},r.sessionId=r.roapSessionId+=1,r.sequenceNumber=0,r.actionNeeded=!1,r.iceStarted=!1,r.moreIceComing=!0,r.iceCandidateCount=0,r.onsignalingmessage=g.callback,r.peerConnection.ontrack=function(W){console.log("!!! ontrack, ",W.track.kind,W.track),r.onaddstream&&r.onaddstream(W,"ontrack")},r.peerConnection.onremovestream=function(W){r.onremovestream&&r.onremovestream(W)},r.peerConnection.oniceconnectionstatechange=function(W){"connected"===W.currentTarget.iceConnectionState&&(r.connectedTime=new Date),r.oniceconnectionstatechange&&r.oniceconnectionstatechange(W.currentTarget.iceConnectionState)},r.renegotiate=function(){void 0!==r.prevOffer&&r.peerConnection.createOffer().then(function(W){return W.sdp=W.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),W.sdp=c(W.sdp),W.sdp=v(W.sdp),r.peerConnection.setLocalDescription(W)}).then(function(){r.onnegotiationneeded&&r.onnegotiationneeded(r.peerConnection.localDescription.sdp)}).catch(function(W){console.log("createOffer error: ",W)})},r.peerConnection.onnegotiationneeded=r.renegotiate,r.onaddstream=null,r.onremovestream=null,r.state="new",r.markActionNeeded(),r}(g)).browser="safari"):~window.navigator.userAgent.indexOf("Edge")?r=new qt.a(g):(r=function(g){var r={},I=ye.RTCPeerConnection;r.uid=g.uid,r.isVideoMute=g.isVideoMute,r.isAudioMute=g.isAudioMute,r.isSubscriber=g.isSubscriber,r.clientId=g.clientId,r.filterStatsCache=[],r.originStatsCache=[],r.lastTimeGetStats=null,r.pc_config={iceServers:[{url:"stun:webcs.agora.io:3478"}]},r.con={optional:[{DtlsSrtpKeyAgreement:!0}]},g.iceServers instanceof Array?r.pc_config.iceServers=g.iceServers:(g.stunServerUrl&&(g.stunServerUrl instanceof Array?g.stunServerUrl.map(function(h){"string"==typeof h&&""!==h&&r.pc_config.iceServers.push({url:h})}):"string"==typeof g.stunServerUrl&&""!==g.stunServerUrl&&r.pc_config.iceServers.push({url:g.stunServerUrl})),g.turnServer&&(g.turnServer instanceof Array?g.turnServer.map(function(h){"string"==typeof h.url&&""!==h.url&&r.pc_config.iceServers.push({username:h.username,credential:h.credential,url:h.url})}):"auto"!==g.turnServer.mode&&"manual"!==g.turnServer.mode||(g.turnServer.udpport&&r.pc_config.iceServers.push({username:g.turnServer.username,credential:g.turnServer.credential,credentialType:"password",urls:"turn:"+g.turnServer.url+":"+g.turnServer.udpport+"?transport=udp"}),"string"==typeof g.turnServer.tcpport&&""!==g.turnServer.tcpport&&r.pc_config.iceServers.push({username:g.turnServer.username,credential:g.turnServer.credential,credentialType:"password",urls:"turn:"+g.turnServer.url+":"+g.turnServer.tcpport+"?transport=tcp"}),!0===g.turnServer.forceturn&&(r.pc_config.iceTransportPolicy="relay")))),void 0===g.audio&&(g.audio=!0),void 0===g.video&&(g.video=!0),r.mediaConstraints={mandatory:{OfferToReceiveVideo:g.video,OfferToReceiveAudio:g.audio}},r.roapSessionId=103;try{r.pc_config.sdpSemantics="plan-b",r.peerConnection=new I(r.pc_config,r.con)}catch{delete r.pc_config.sdpSemantics,r.peerConnection=new I(r.pc_config,r.con)}r.iceCandidateTimer=setTimeout(function(){r.iceCandidateTimer=null,S.default.debug("[".concat(r.clientId,"]Candidates collected: ").concat(r.iceCandidateCount)),r.moreIceComing&&(r.moreIceComing=!1,r.markActionNeeded())},Object(M.getParameter)("CANDIDATE_TIMEOUT")),r.peerConnection.onicecandidate=function(h){var b,C,O,P;C=(b=r.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\ssrflx.+\r\n/),O=b.match(/a=candidate:.+typ\shost.+\r\n/),P=b.match(/a=candidate:.+typ\srelay.+\r\n/),null===C&&null===O&&null===P||void 0!==r.ice||!r.iceCandidateTimer||(S.default.debug("["+r.clientId+"]srflx candidate : "+C+" relay candidate: "+P+" host candidate : "+O),clearTimeout(r.iceCandidateTimer),r.iceCandidateTimer=null,r.ice=0,r.moreIceComing=!1,r.markActionNeeded()),r.iceCandidateCount=r.iceCandidateCount+1},S.default.debug("["+r.clientId+']Created webkitRTCPeerConnnection with config "'+JSON.stringify(r.pc_config)+'".');var c=function(h){return g.screen&&(h=h.replace("a=x-google-flag:conference\r\n","")),h},v=function(h){var b,C;if((b=h.match(/m=video.*\r\n/))&&g.minVideoBW&&g.maxVideoBW){C=b[0]+"b=AS:"+g.maxVideoBW+"\r\n";var O=0,P=0;"h264"===g.codec?(O=h.search(/a=rtpmap:(\d+) H264\/90000\r\n/),P=h.search(/H264\/90000\r\n/)):"vp8"===g.codec&&(O=h.search(/a=rtpmap:(\d+) VP8\/90000\r\n/),P=h.search(/VP8\/90000\r\n/)),-1!==O&&-1!==P&&P-O>10&&(C=C+"a=fmtp:"+h.slice(O+9,P-1)+" x-google-min-bitrate="+g.minVideoBW+"\r\n"),h=h.replace(b[0],C),S.default.debug("["+r.clientId+"]Set Video Bitrate - min:"+g.minVideoBW+" max:"+g.maxVideoBW)}return(b=h.match(/m=audio.*\r\n/))&&g.maxAudioBW&&(h=h.replace(b[0],C=b[0]+"b=AS:"+g.maxAudioBW+"\r\n")),h};return r.processSignalingMessage=function(h){var b,C=JSON.parse(h);r.incomingMessage=C,"new"===r.state?"OFFER"===C.messageType?(b={sdp:C.sdp,type:"offer"},r.peerConnection.setRemoteDescription(new RTCSessionDescription(b)).catch(function(O){}),r.state="offer-received",r.markActionNeeded()):r.error("Illegal message for this state: "+C.messageType+" in state "+r.state):"offer-sent"===r.state?"ANSWER"===C.messageType?((b={sdp:C.sdp,type:"answer"}).sdp=c(b.sdp),b.sdp=v(b.sdp),r.peerConnection.setRemoteDescription(new RTCSessionDescription(b)).catch(function(O){}),r.state="established"):"pr-answer"===C.messageType?(b={sdp:C.sdp,type:"pr-answer"},r.peerConnection.setRemoteDescription(new RTCSessionDescription(b)).catch(function(O){})):r.error("offer"===C.messageType?"Not written yet":"Illegal message for this state: "+C.messageType+" in state "+r.state):"established"===r.state&&("OFFER"===C.messageType?(b={sdp:C.sdp,type:"offer"},r.peerConnection.setRemoteDescription(new RTCSessionDescription(b)).catch(function(O){}),r.state="offer-received",r.markActionNeeded()):"ANSWER"===C.messageType?((b={sdp:C.sdp,type:"answer"}).sdp=c(b.sdp),b.sdp=v(b.sdp),r.peerConnection.setRemoteDescription(new RTCSessionDescription(b)).catch(function(O){})):r.error("Illegal message for this state: "+C.messageType+" in state "+r.state))},r.getVideoRelatedStats=function(h){r.peerConnection.getStats(function(b){Object.keys(b).forEach(function(C){var O=b[C];r.isSubscriber?"video"===O.mediaType&&O.id&&~O.id.indexOf("recv")&&h&&h({mediaType:"video",peerId:r.uid,isVideoMute:r.isVideoMute,frameRateReceived:O.googFrameRateReceived,frameRateDecoded:O.googFrameRateDecoded,bytesReceived:O.bytesReceived,packetsReceived:O.packetsReceived,packetsLost:O.packetsLost}):"video"===O.mediaType&&O.id&&~O.id.indexOf("send")&&h&&h({mediaType:"video",isVideoMute:r.isVideoMute,frameRateInput:O.googFrameRateInput,frameRateSent:O.googFrameRateSent,googRtt:O.googRtt})})})},r.getAudioRelatedStats=function(h){r.peerConnection.getStats(function(b){Object.keys(b).forEach(function(C){var O=b[C];r.isSubscriber&&"audio"===O.mediaType&&O.id&&~O.id.indexOf("recv")&&h&&h({mediaType:"audio",peerId:r.uid,isAudioMute:r.isAudioMute,frameDropped:parseInt(O.googDecodingPLC)+parseInt(O.googDecodingPLCCNG)+"",frameReceived:O.googDecodingCTN,googJitterReceived:O.googJitterReceived,bytesReceived:O.bytesReceived,packetsReceived:O.packetsReceived,packetsLost:O.packetsLost})})})},r.getStatsRate=function(h){r.getStats(function(b){h(b)})},r.getStats=function(h,b){b=(b=b||500)>500?500:b,r.lastTimeGetStats&&Date.now()-r.lastTimeGetStats<b?h&&h(r.filterStatsCache,r.originStatsCache):this._getStats(function(C,O){r.filterStatsCache=C,r.originStatsCache=O,r.lastTimeGetStats=Date.now(),h&&h(C,O)})},r._getStats=function(h){r.peerConnection.getStats(function(b){var C=[],O=[],P=null;Object.keys(b).forEach(function(F){var j=b[F];O.push(j),"ssrc"!==j.type&&"VideoBwe"!==j.type||(P=j.timestamp,C.push(j))}),C.push({id:"time",startTime:r.connectedTime,timestamp:P||new Date}),h(C,O)})},r.addTrack=function(h,b){r.peerConnection.addTrack(h,b)},r.removeTrack=function(h,b){r.peerConnection.removeTrack(r.peerConnection.getSenders().find(function(C){return C.track==h}))},r.addStream=function(h){r.peerConnection.addStream(h),r.markActionNeeded()},r.removeStream=function(){r.markActionNeeded()},r.close=function(){r.state="closed",r.peerConnection.close()},r.markActionNeeded=function(){r.actionNeeded=!0,r.doLater(function(){r.onstablestate()})},r.doLater=function(h){window.setTimeout(h,1)},r.onstablestate=function(){if(r.actionNeeded){if("new"===r.state||"established"===r.state)r.peerConnection.createOffer(function(b){if(b.sdp!==r.prevOffer)return r.peerConnection.setLocalDescription(b),r.state="preparing-offer",void r.markActionNeeded();S.default.debug("["+r.clientId+"]Not sending a new offer")},function(b){S.default.debug("["+r.clientId+"]peer connection create offer failed ",b)},r.mediaConstraints);else if("preparing-offer"===r.state){if(r.moreIceComing)return;r.prevOffer=r.peerConnection.localDescription.sdp,r.offerCandidates=r.prevOffer.match(/a=candidate.+\r\n/g)||[],r.offerCandidates.length||(S.default.warning("[".concat(r.clientId,"]No Ice Candidate generated")),Object(M.getParameter)("SHIM_CANDIDATE")?(S.default.debug("Shimming fake candidate"),r.prevOffer+="a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"):S.default.error("[".concat(r.clientId,"]None Ice Candidate not allowed"))),r.prevOffer=r.prevOffer.replace(/a=candidate:.+typ\shost.+\r\n/g,"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\r\n"),r.sendMessage("OFFER",r.prevOffer),r.state="offer-sent"}else if("offer-received"===r.state)r.peerConnection.createAnswer(function(b){if(r.peerConnection.setLocalDescription(b),r.state="offer-received-preparing-answer",r.iceStarted)r.markActionNeeded();else{var C=new Date;S.default.debug("["+r.clientId+"]"+C.getTime()+": Starting ICE in responder"),r.iceStarted=!0}},function(b){S.default.debug("["+r.clientId+"]peer connection create answer failed ",b)},r.mediaConstraints);else if("offer-received-preparing-answer"===r.state){if(r.moreIceComing)return;r.sendMessage("ANSWER",r.peerConnection.localDescription.sdp),r.state="established"}else r.error("Dazed and confused in state "+r.state+", stopping here");r.actionNeeded=!1}},r.sendMessage=function(h,b){var C={};C.messageType=h,C.sdp=b,"OFFER"===h?(C.offererSessionId=r.sessionId,C.answererSessionId=r.otherSessionId,C.seq=r.sequenceNumber+=1,C.tiebreaker=Math.floor(429496723*Math.random()+1)):(C.offererSessionId=r.incomingMessage.offererSessionId,C.answererSessionId=r.sessionId,C.seq=r.incomingMessage.seq),r.onsignalingmessage(JSON.stringify(C))},r._getSender=function(h){if(r.peerConnection&&r.peerConnection.getSenders){var b=r.peerConnection.getSenders().find(function(C){return C.track.kind==h});if(b)return b}return null},r.hasSender=function(h){return!!r._getSender(h)},r.replaceTrack=function(h,b,C){var O=r._getSender(h.kind);if(!O)return C("NO_SENDER_FOUND");try{O.replaceTrack(h)}catch(P){return C&&C(P)}setTimeout(function(){return b&&b()},50)},r.error=function(h){throw"Error in RoapOnJsep: "+h},r.sessionId=r.roapSessionId+=1,r.sequenceNumber=0,r.actionNeeded=!1,r.iceStarted=!1,r.moreIceComing=!0,r.iceCandidateCount=0,r.onsignalingmessage=g.callback,r.peerConnection.ontrack=function(h){r.onaddstream&&(r.onaddstream(h,"ontrack"),r.peerConnection.onaddstream=null)},r.peerConnection.onaddstream=function(h){r.onaddstream&&(r.onaddstream(h,"onaddstream"),r.peerConnection.ontrack=null)},r.peerConnection.onremovestream=function(h){r.onremovestream&&r.onremovestream(h)},r.peerConnection.oniceconnectionstatechange=function(h){"connected"===h.currentTarget.iceConnectionState&&(r.connectedTime=new Date),r.oniceconnectionstatechange&&r.oniceconnectionstatechange(h.currentTarget.iceConnectionState)},r.renegotiate=function(){void 0!==r.prevOffer&&r.peerConnection.createOffer().then(function(h){return h.sdp=h.sdp.replace(/a=recvonly\r\n/g,"a=inactive\r\n"),h.sdp=c(h.sdp),h.sdp=v(h.sdp),r.peerConnection.setLocalDescription(h)}).then(function(){r.onnegotiationneeded&&r.onnegotiationneeded(r.peerConnection.localDescription.sdp)}).catch(function(h){console.log("createOffer error: ",h)})},r.peerConnection.onnegotiationneeded=r.renegotiate,r.onaddstream=null,r.onremovestream=null,r.onnegotiationneeded=null,r.state="new",r.markActionNeeded(),r}(g)).browser="chrome-stable",r},On=function(g,r,I){var c={};c.config=g,c.streamId=g.streamId,delete g.streamId,navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var v=0,h=1,b=!1,C=null,O=function(u){if(v++,C)if(C===u)S.default.debug("Using Video Source/ Audio Source");else{var W=C.getVideoTracks()[0],Q=C.getAudioTracks()[0],ne=u.getVideoTracks()[0],Oe=u.getAudioTracks()[0];ne&&(W&&C.removeTrack(W),C.addTrack(ne)),Oe&&(Q&&C.removeTrack(Q),C.addTrack(Oe))}else C=u;v!==h||b||(b=!0,setTimeout(function(){r(C)},0))},P=function(u){S.default.error("Failed to GetUserMedia",u.name,u.code,u.message,u),v++,b||(b=!0,setTimeout(function(){I&&I(u)},0))},F=function(){var u={video:g.video,audio:g.audio};if(S.default.debug("GetUserMedia",JSON.stringify(u)),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia(u).then(O).catch(P);else if(typeof navigator<"u"&&navigator.getMedia)navigator.getMedia(g,O,P);else{var W={name:"MEDIA_NOT_SUPPORT",message:"Video/audio streams not supported yet"};S.default.error("["+c.streamId+"]"+W.message),I&&I(W)}};if((g.videoSource||g.audioSource)&&(C=new MediaStream,g.videoSource&&C.addTrack(g.videoSource),g.audioSource&&C.addTrack(g.audioSource)),g.video||g.audio||g.screen)if(g.screen){if(Xt())return g.screen.sourceId?Ct(g.screen.sourceId,g.screen,function(u,W){u?P(u):O(W)}):function(g,r){tn(function(I,c){if(I)return r&&r(I);!function(v,h){var b=document.createElement("div");b.innerText="share screen",b.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");var C=document.createElement("div");C.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");var O=document.createElement("div");O.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",O.setAttribute("style","height: 12%;");var P=document.createElement("div");P.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");var F=document.createElement("div");F.setAttribute("style","text-align: right; padding: 16px 0;");var j=document.createElement("button");j.innerHTML="cancel",j.setAttribute("style","width: 85px;"),j.onclick=function(){document.body.removeChild(u),h&&h("NotAllowedError")},F.appendChild(j),C.appendChild(O),C.appendChild(P),C.appendChild(F);var u=document.createElement("div");u.setAttribute("style","position: absolute; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),u.appendChild(b),u.appendChild(C),document.body.appendChild(u),v.map(function(W){if(W.id){var Q=document.createElement("div");Q.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;"),Q.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+W.thumbnail.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+W.name+"</span>",Q.onclick=function(){document.body.removeChild(u),h&&h(null,W.id)},P.appendChild(Q)}})}(c,function(v,h){if(v)return r&&r(v);xt(h,g,r)})})}(g.screen,function(u,W){u?P(u):O(W)});if(Y.isFireFox()){if(S.default.debug("["+c.streamId+"]Screen access requested"),!~["screen","window","application"].indexOf(g.screen.mediaSource))return I&&I({code:"Invalid mediaSource, mediaSource should be one of [screen, window, application]"});navigator.getMedia({video:g.screen},function(u){g.audio&&(h++,F()),O(u)},P)}else if(Y.isChrome()&&g.screen.extensionId){if(window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<34)return void I({code:"This browser does not support screen sharing"});S.default.debug("["+c.streamId+"]Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(g.screen.extensionId,{getStream:!0},function(u){void 0===u?(S.default.error("["+c.streamId+"]No response from Chrome Plugin. Plugin not installed properly"),P({name:"PluginNotInstalledProperly",message:"No response from Chrome Plugin. Plugin not installed properly."})):(g.screen.mandatory.chromeMediaSourceId=u.streamId,navigator.getMedia({video:g.screen},function(W){g.audio&&(h++,F()),O(W)},P))})}catch{return S.default.debug("["+c.streamId+"]AgoraRTC screensharing plugin is not accessible"),void I({code:"no_plugin_present"})}}else{if(window.navigator.mediaDevices.getDisplayMedia){var j={};return j.video="number"==typeof g.screen.width&&"number"==typeof g.screen.height?{width:{ideal:g.screen.width},height:{ideal:g.screen.height}}:{width:g.screen.width,height:g.screen.height},j.video.frameRate=g.screen.frameRate&&g.screen.frameRate.min?{ideal:g.screen.frameRate.max,max:g.screen.frameRate.max}:g.screen.frameRate,S.default.debug("use getDisplayMedia, constraints:",j),window.navigator.mediaDevices.getDisplayMedia(j).then(function(u){g.audio&&(h++,F()),O(u)}).catch(P)}S.default.error("["+c.streamId+"]This browser does not support screenSharing"),I({code:"This browser does not support screen sharing"})}}else F();else O(C)},zt=E(8),Te=function(g,r,I){if(["End2EndDelay","TransportDelay","PacketLossRate","RecvLevel","RecvBitrate","CodecType","MuteState","TotalFreezeTime","TotalPlayDuration","RecordingLevel","SendLevel","SamplingRate","SendBitrate","CodecType","MuteState","End2EndDelay","TransportDelay","PacketLossRate","RecvBitrate","RecvResolutionWidth","RecvResolutionHeight","RenderResolutionHeight","RenderResolutionWidth","RenderFrameRate","TotalFreezeTime","TotalPlayDuration","TargetSendBitrate","SendFrameRate","SendFrameRate","SendBitrate","SendResolutionWidth","SendResolutionHeight","CaptureResolutionHeight","CaptureResolutionWidth","EncodeDelay","MuteState","TotalFreezeTime","TotalDuration","CaptureFrameRate","RTT","OutgoingAvailableBandwidth","Duration","UserCount","SendBytes","RecvBytes","SendBitrate","RecvBitrate","accessDelay","audioSendBytes","audioSendPackets","videoSendBytes","videoSendPackets","videoSendPacketsLost","videoSendFrameRate","audioSendPacketsLost","videoSendResolutionWidth","videoSendResolutionHeight","accessDelay","audioReceiveBytes","audioReceivePackets","audioReceivePacketsLost","videoReceiveBytes","videoReceivePackets","videoReceivePacketsLost","videoReceiveFrameRate","videoReceiveDecodeFrameRate","videoReceiveResolutionWidth","videoReceiveResolutionHeight","endToEndDelay","videoReceiveDelay","audioReceiveDelay","FirstFrameTime","VideoFreezeRate","AudioFreezeRate","RenderResolutionWidth","RenderResolutionHeight"].indexOf(r)>-1&&("string"==typeof I||isFinite(I)))return g[r]=""+I},Yt=new function(){var g=ae();return g.devicesHistory={},g.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},g.state=g.states.UNINIT,g.deviceStates={ACTIVE:"ACTIVE",INACTIVE:"INACTIVE"},g.deviceReloadTimer=null,g._init=function(r,I){g.state=g.states.INITING,g.devicesHistory={},g._reloadDevicesInfo(function(){g.state=g.states.INITED,g.dispatchEvent({type:"inited"}),r&&r()},function(c){S.default.warning("Device Detection functionality cannot start properly."),g.state=g.states.UNINIT,I&&I(c)})},g._enumerateDevices=function(r,I){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return S.default.warning("enumerateDevices() not supported."),I&&I("enumerateDevices() not supported");navigator.mediaDevices.enumerateDevices().then(function(c){r&&setTimeout(function(){r(c)},0)}).catch(function(c){I&&I(c)})},g._reloadDevicesInfo=function(r,I){var c=[];g._enumerateDevices(function(v){var h=Date.now();for(var b in v.forEach(function(O){var P=g.devicesHistory[O.deviceId];if((P?P.state:g.deviceStates.INACTIVE)!=g.deviceStates.ACTIVE){var F=P||{initAt:h};F.device=O,F.state=g.deviceStates.ACTIVE,c.push(F),g.devicesHistory[O.deviceId]=F}g.devicesHistory[O.deviceId].lastReloadAt=h}),g.devicesHistory){var C=g.devicesHistory[b];C&&C.state==g.deviceStates.ACTIVE&&C.lastReloadAt!==h&&(C.state=g.deviceStates.INACTIVE,c.push(C)),C.lastReloadAt=h}g.state==g.states.INITED&&c.forEach(function(O){var P=z()({},O);switch(O.device.kind){case"audioinput":P.type="recordingDeviceChanged";break;case"audiooutput":P.type="playoutDeviceChanged";break;case"videoinput":P.type="cameraChanged";break;default:S.default.warning("Unknown device change",P),P.type="unknownDeviceChanged"}g.dispatchEvent(P)}),r&&r()},I)},g.getDeviceById=function(r,I,c){g.getDevices(function(v){for(var h=0;h<v.length;h++){var b=v[h];if(b&&b.deviceId===r)return I&&I(b)}return c&&c()})},g.searchDeviceNameById=function(r){var I=g.devicesHistory[r];return I?I.device.label||I.device.deviceId:null},g.getDevices=function(r,I){g._enumerateDevices(r,function(c){I&&I(c.name+": "+c.message)})},g.getVideoCameraIdByLabel=function(r,I,c){g.getCameras(function(v){var h=!0,b=!1,C=void 0;try{for(var O,P=v[Symbol.iterator]();!(h=(O=P.next()).done);h=!0){var F=O.value;if(F.label===r)return I&&I(F.deviceId)}}catch(j){b=!0,C=j}finally{try{h||null==P.return||P.return()}finally{if(b)throw C}}return c&&c(re_NOT_FIND_DEVICE_BY_LABEL)},c)},g.getRecordingDevices=function(r,I){return g._enumerateDevices(function(c){var v=c.filter(function(h){return"audioinput"==h.kind});r&&r(v)},function(c){I&&I(c)})},g.getPlayoutDevices=function(r,I){return g._enumerateDevices(function(c){var v=c.filter(function(h){return"audiooutput"==h.kind});r&&r(v)},function(c){I&&I(c)})},g.getCameras=function(r,I){return g._enumerateDevices(function(c){var v=c.filter(function(h){return"videoinput"==h.kind});r&&r(v)},function(c){I&&I(c)})},g._init(function(){navigator.mediaDevices&&navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",function(){g._reloadDevicesInfo()}),g.deviceReloadTimer=setInterval(g._reloadDevicesInfo,5e3)}),g},Mn=E(6),nn=E.n(Mn),Nn=function(g,r,I){for(var c=0;c<I.length;c++)if(g===I[c])return!0;throw new Error("".concat(r," can only be set as ").concat(JSON.stringify(I)))},an=function(g,r){if(!g)throw new Error("Invalid param: ".concat(r||"param"," cannot be empty"));if("object"!==nn()(g))throw new Error("".concat(r||"This paramter"," is of the object type"));return!0},Kt=function(g,r,I,c,v){if(Je(I)&&(I=1),c=c||255,Je(v)&&(v=!0),Je(g))throw new Error("".concat(r||"param"," cannot be empty"));if(!X(g,I,c,v))throw new Error("Invalid ".concat(r||"string param",": Length of the string: [").concat(I,",").concat(c,"].").concat(v?" ASCII characters only.":""))},le=function(g,r,I,c){if(Je(I)&&(I=1),c=c||1e4,Je(g))throw new Error("".concat(r||"param"," cannot be empty"));if(!Me(g,I,c))throw new Error("Invalid ".concat(r||"number param",": The value range is [").concat(I,",").concat(c,"]. integer only"))},te=function(g,r){if(Je(g))throw new Error("".concat(r||"param"," cannot be empty"));if(!Ke(g))throw new Error("Invalid ".concat(r||"boolean param",": The value is of the boolean type."))},X=function(g,r,I,c){return r||(r=0),I||(I=Number.MAX_SAFE_INTEGER),Je(c)&&(c=!0),Tn(g)&&(!c||Nt(g))&&g.length>=r&&g.length<=I},Me=function(g,r,I){return kt(g)&&g>=r&&g<=I},Ke=function(g){return"boolean"==typeof g},Et=function(g){return X(g,1,2047)},Nt=function(g){if("string"==typeof g){for(var r=0;r<g.length;r++){var I=g.charCodeAt(r);if(I<0||I>255)return!1}return!0}},kt=function(g){return"number"==typeof g&&g%1==0},wt=function(g){return"number"==typeof g},Tn=function(g){return"string"==typeof g},$t=function(g){return g instanceof Array},Je=function(g){return null==g},Wt=E(13),rn=function(g){Kt(g,"profileName"),-1===(g=g.toLowerCase()).indexOf("_")&&(g+="_1"),Nn(g,"profileName",Object.keys(M.SUPPORT_RESOLUTION_LIST));var r=M.SUPPORT_RESOLUTION_LIST[g];r||(g=Object(M.getParameter)("DEFAULT_PROFILE"),r=M.SUPPORT_RESOLUTION_LIST[g]);var I={profileName:g,video:{width:r[0],height:r[1]},attributes:{resolution:"".concat(r[0],"x").concat(r[1]),minFrameRate:r[2],maxFrameRate:r[3],minVideoBW:r[4],maxVideoBW:r[5]}};return r[2]&&r[3]&&(I.video.frameRate={ideal:r[2],max:r[3]}),r[6]&&r[7]&&(I.screen={width:r[0],height:r[1],frameRate:{min:r[6],max:r[7]}}),I},Jt=function(g){return Object.keys(M.SUPPORT_RESOLUTION_LIST).filter(function(r){var I=M.SUPPORT_RESOLUTION_LIST[r],c=["width","height","frameRate"];for(var v in c){var h=c[v];if(g[h]&&I[v]&&("number"==typeof g[h].max&&g[h].max<I[v]||"number"==typeof g[h].min&&g[h].min>I[v]))return!1}return!0}).reverse()},Lt=function(g){var r=M.AUDIO_PROFILE_SETTINGS[g]||M.AUDIO_PROFILE_SETTINGS.default;return{highQuality:r[0],stereo:r[1],speech:r[2],lowQuality:r[3]}},En=function(g){var c,r=ae();if(r.params=z()({},g),r.stream=g.stream,r.url=g.url,r.onClose=void 0,r.local=!1,r.videoSource=g.videoSource,r.audioSource=g.audioSource,g.video=!(!g.videoSource&&!g.video),r.video=g.video,g.audio=!(!g.audioSource&&!g.audio),r.audio=g.audio,r.screen=!!g.screen,r.screenAttributes={width:1920,height:1080,maxFr:5,minFr:1},r.videoSize=g.videoSize,r.player=void 0,r.audioLevelHelper=null,g.attributes=g.attributes||{},r.attributes=g.attributes,r.microphoneId=g.microphoneId,r.cameraId=g.cameraId,r.facingMode=g.facingMode,r.inSwitchDevice=!1,r.userMuteVideo=!1,r.userMuteAudio=!1,r.peerMuteVideo=!1,r.peerMuteAudio=!1,r.lowStream=null,r.videoWidth=0,r.videoHeight=0,r.streamId=g.streamID,r.userId=null,r.mirror=!1!==g.mirror,r.DTX=g.audioProcessing&&g.audioProcessing.DTX,r.audioProcessing=g.audioProcessing,r.highQuality=!1,r.stereo=!1,r.speech=!1,r.screen||delete r.screen,!(void 0===r.videoSize||r.videoSize instanceof Array&&4===r.videoSize.length))throw Error("Invalid Video Size");function I(){var c={};r.getVideoTrack()===this?(S.default.debug("Video Track Ended"),c.type="videoTrackEnded",c.track=this):r.getAudioTrack()===this?(S.default.debug("Audio Track Ended"),c.type="audioTrackEnded",c.track=this):S.default.debug("Detached Track ended",this.kind,this.label,this),c.type&&r.dispatchEvent(c)}return r.videoSize=[640,480,640,480],void 0!==g.local&&!0!==g.local||(r.local=!0),r.initialized=!r.local,r._streamInitID=null,(c=r).audioMixing={audioContextInited:!1,defaultVolume:100,inEarMonitoring:"FILE",sounds:{},states:{IDLE:"IDLE",STARTING:"STARTING",BUSY:"BUSY",PAUSED:"PAUSED"},inEarMonitoringModes:{NONE:"NONE",FILE:"FILE",MICROPHONE:"MOCROPHONE",ALL:"ALL"},ctx:null,mediaStreamSource:null,mediaStreamDest:null,buffer:{}},c._initSoundIfNotExists=function(v,h){c.audioMixing.sounds[v]||(c.audioMixing.sounds[v]={soundId:v,state:"IDLE",muted:c.userMuteAudio,filePath:h,volume:c.audioMixing.defaultVolume,startAt:null,startOffset:null,pauseAt:null,pauseOffset:null,resumeAt:null,resumeOffset:null,stopAt:null,options:null,source:null})},c._initSoundIfNotExists(-1),c.loadAudioBuffer=function(v,h,b){var C=L.b.reportApiInvoke(c.sid,{callback:b,name:"Stream.loadAudioBuffer",options:arguments,tag:"tracer"});Kt(h,"url",1,1024,!1),Kt(v,"id",1,1024,!1);var O=function(F){S.default.error("[".concat(c.streamId,"] loadAudioBuffer Failed: ")+F),C(re_LOAD_AUDIO_FAILED)},P=new XMLHttpRequest;P.open("GET",h,!0),P.responseType="arraybuffer",P.onload=function(){if(P.status>400)O("".concat(P.status," ").concat(P.statusText));else{var F=P.response;c.audioMixing.audioContextInited||c._initAudioContext(),c.audioMixing.ctx.decodeAudioData(F,function(j){c.audioMixing.buffer[v]=j,C(null)},function(j){S.default.error("[".concat(c.streamId,"] decodeAudioData Failed: "),j),C(j)})}},P.onerror=function(){return O("load error")},P.ontimeout=function(){return O("timeout")},P.send()},c.createAudioBufferSource=function(v){var h=L.b.reportApiInvoke(c.sid,{name:"Stream.createAudioBufferSource",options:arguments,tag:"tracer"});if(c.audioMixing.buffer[v.id]){var b=c.audioMixing.buffer[v.id],C=c.audioMixing.ctx.createBufferSource();C.buffer=b;var O=c.audioMixing.ctx.createGain();C.connect(O),O.connect(c.audioMixing.mediaStreamDest),C.gainNode=O,v.loop?(C.loop=!0,C.start(0,v.playTime/1e3)):v.cycle>1?Object(Y.isChrome)()?(C.loop=!0,C.start(0,v.playTime/1e3,(v.cycle*b.duration*1e3-(v.playTime||0))/1e3)):(S.default.warning("[".concat(c.streamId,"] Cycle Param is ignored by current browser")),C.start(0,v.playTime/1e3)):C.start(0,v.playTime/1e3);var F=c.audioMixing.sounds[v.soundId];return F.source=C,c._flushAudioMixingMuteStatus(),C.addEventListener("ended",function(){C===F.source&&c.dispatchEvent({type:"audioSourceEnded",soundId:v.soundId,source:C,sound:F})}),h(),C}return S.default.error("[".concat(c.streamId,"] "),"AUDIOBUFFER_NOT_FOUND",v.id),h(!1),!1},c.on("audioSourceEnded",function(v){var h=v.source,b=v.sound;b&&b.state===c.audioMixing.states.BUSY&&!b.pauseAt&&(b.state=c.audioMixing.states.IDLE,b.startAt=null,b.startOffset=null,b.resumeAt=null,b.resumeOffset=null,h.gainNode&&h.gainNode.disconnect&&h.gainNode.disconnect(),h.buffer=null,c.audioMixing.mediaStreamSource.connect(c.audioMixing.mediaStreamDest))}),c.clearAudioBufferSource=function(){c.audioBufferSource.forEach(function(v){v.stop()})},c._isSoundExists=function(v){return!!c.audioMixing.sounds[v.soundId]||(S.default.error("SoundId not exists. #".concat(v.soundId)),!1)},c._initAudioContext=function(){if(c.audioMixing.audioContextInited)throw new Error("Failed to init audio context. Already inited");if(!c.stream)throw new Error("Failed to init audio context. Local Stream not initialized");c.audioMixing.ctx=Object(Wt.a)(),c.audioMixing.mediaStreamSource=c.audioMixing.ctx.createMediaStreamSource(c.stream),c.audioMixing.mediaStreamDest=c.audioMixing.ctx.createMediaStreamDestination(),c.audioMixing.mediaStreamSource.connect(c.audioMixing.mediaStreamDest);var v=c.stream.getVideoTracks()[0];if(v&&c.audioMixing.mediaStreamDest.stream.addTrack(v),c._isAudioMuted()?(c._unmuteAudio(),c.stream=c.audioMixing.mediaStreamDest.stream,c._muteAudio()):c.stream=c.audioMixing.mediaStreamDest.stream,c.audioLevelHelper=null,c.pc&&c.pc.peerConnection&&c.pc.peerConnection){var h=(c.pc.peerConnection&&c.pc.peerConnection.getSenders()).find(function(C){return C&&C.track&&"audio"==C.track.kind}),b=c.audioMixing.mediaStreamDest.stream.getAudioTracks()[0];h&&h.replaceTrack&&b&&h.replaceTrack(b)}c.audioMixing.audioContextInited=!0},c._cleanupAudioMixing=function(){if(c.audioMixing.audioContextInited){for(var v in c.audioMixing.sounds){var h=c.audioMixing.sounds[v];h.state!==c.audioMixing.states.BUSY&&h.state!==c.audioMixing.states.PAUSED||c._stopOneEffect({soundId:v})}c.audioLevelHelper=null,c.audioMixing.audioContextInited=!1}},c._reloadInEarMonitoringMode=function(v){if(v){if(!c.audioMixing.inEarMonitoringModes[v])return S.default.error("[".concat(c.streamId,"] Invalid InEarMonitoringMode ").concat(v));c.audioMixing.inEarMonitoring=v}switch(c.audioMixing.audioContextInited||c._initAudioContext(),c.audioMixing.inEarMonitoring){case c.audioMixing.inEarMonitoringModes.FILE:c.audioMixing.mediaStreamSource.connectedToDestination&&(c.audioMixing.mediaStreamSource.disconnect(c.audioMixing.ctx.destination),c.audioMixing.mediaStreamSource.connectedToDestination=!1);case c.audioMixing.inEarMonitoringModes.ALL:for(var h in c.audioMixing.sounds){var b=c.audioMixing.sounds[h];b&&b.source&&!b.source.connectedToDestination&&(b.source.gainNode.connect(c.audioMixing.ctx.destination),b.source.connectedToDestination=!0)}}switch(c.audioMixing.inEarMonitoring){case c.audioMixing.inEarMonitoringModes.MICROPHONE:c.audioMixing.source.forEach(function(C){C.connectedToDestination&&(C.gainNode.disconnect(c.audioMixing.ctx.destination),C.connectedToDestination=!1)});case c.audioMixing.inEarMonitoringModes.ALL:c.audioMixing.mediaStreamSource.connectedToDestination||(c.audioMixing.mediaStreamSource.connect(c.audioMixing.ctx.destination),c.audioMixing.mediaStreamSource.connectedToDestination=!0)}},c._startAudioMixingBufferSource=function(v){c.audioMixing.audioContextInited||c._initAudioContext();var b=v.replace,C=c.createAudioBufferSource({soundId:v.soundId,id:v.filePath,loop:v.loop,cycle:v.cycle,playTime:v.playTime||0});return C.sound=c.audioMixing.sounds[v.soundId],C?(C.addEventListener("ended",c._audioMixingFinishedListener,{once:!0}),c._reloadInEarMonitoringMode(),b&&c.audioMixing.mediaStreamSource.disconnect(c.audioMixing.mediaStreamDest),C):null},c._stopAudioMixingBufferSource=function(v){var h=c.audioMixing.sounds[v.soundId].source;return h?(h.removeEventListener("ended",c._audioMixingFinishedListener),c.audioMixing.mediaStreamSource.connect(c.audioMixing.mediaStreamDest),h.stop(),h.gainNode&&h.gainNode.disconnect&&h.gainNode.disconnect(),h.buffer=null,h):null},c._flushAudioMixingMuteStatus=function(v){for(var h in c.audioMixing.sounds){var b=c.audioMixing.sounds[h];b&&(void 0!==v&&(b.muted=!!v),b.source&&(b.source.gainNode.gain.value=b.muted?0:b.volume/100))}},c._handleAudioMixingInvalidStateError=function(v,h,b){var C=c.audioMixing.sounds[h.soundId],O=-1===h.soundId?"INVALID_AUDIO_MIXING_STATE":"INVALID_PLAY_EFFECT_STATE";S.default.error("[".concat(c.streamId,"] Cannot ").concat(v,": ").concat(O,", state is ").concat(C.state)),b&&b(O)},c._handleAudioMixingNoSourceError=function(v,h,b){c.audioMixing.sounds[h.soundId].state=c.audioMixing.states.IDLE;var C=-1===h.soundId?"NO_AUDIO_MIXING_SOURCE":"NO_EFFECT_SOURCE";S.default.error("[".concat(c.streamId,"] Cannot ").concat(v,": ").concat(C)),b&&b(C)},c._getOneEffectStates=function(v){var h=c.audioMixing.sounds[v.soundId];return function(){return h?{state:h.state,startAt:h.startAt,resumeAt:h.resumeAt,pauseOffset:h.pauseOffset,pauseAt:h.pauseAt,resumeOffset:h.resumeOffset,stopAt:h.stopAt,duration:c._getOneEffectDuration(v),position:c._getOneEffectCurrentPosition(v)}:{}}},c._audioMixingFinishedListener=function(){var v=this.sound;v.state===c.audioMixing.states.IDLE&&c.audioMixing.buffer[v.options.filePath]&&!v.options.cacheResource&&(S.default.debug("Recycled buffer ".concat(v.options.filePath)),delete c.audioMixing.buffer[v.options.filePath]),-1===v.soundId&&c.dispatchEvent({type:"audioMixingFinished"})},c._playOneEffect=function(v,h){an(v,"options");var b=v.soundId,C=v.cacheResource;if(Object(Y.isSafari)()&&Object(Y.getBrowserVersion)()<12){var O="BROWSER_NOT_SUPPORT";return S.default.error("[".concat(c.streamId,"] Cannot _playOneEffect: "),O),h(O)}c.audioMixing.audioContextInited||c._initAudioContext(),c._initSoundIfNotExists(b);var P=c.audioMixing.sounds[b];if(P.state===c.audioMixing.states.IDLE){if(void 0!==v.cycle&&!v.cycle>0)return O="Invalid Parmeter cycle: "+v.cycle,S.default.error("[".concat(c.streamId,"] ").concat(b),O),h(O);if(Je(C)&&(v.cacheResource=!0),P.state=c.audioMixing.states.STARTING,P.options=v,c.audioMixing.buffer[v.filePath]){var F=c._startAudioMixingBufferSource(v);if(F)return P.source=F,P.startAt=Date.now(),P.resumeAt=null,P.pauseOffset=null,P.pauseAt=null,P.resumeOffset=null,P.stopAt=null,P.startOffset=v.playTime||0,P.state=c.audioMixing.states.BUSY,c._flushAudioMixingMuteStatus(),h(null);P.state=c.audioMixing.states.IDLE;var j="CREATE_BUFFERSOURCE_FAILED";if(h)return h(j);S.default.error("[".concat(c.streamId,"] "),j)}else c.loadAudioBuffer(v.filePath,v.filePath,function(u){if(u)P.state=c.audioMixing.states.IDLE,h?h(u):S.default.error("[".concat(c.streamId,"] "),u);else{var W=c._startAudioMixingBufferSource(v);if(W)return P.source=W,P.startAt=Date.now(),P.resumeAt=null,P.pauseOffset=null,P.pauseAt=null,P.resumeOffset=null,P.stopAt=null,P.startOffset=v.playTime||0,P.state=c.audioMixing.states.BUSY,c._flushAudioMixingMuteStatus(),h(null);if(P.state=c.audioMixing.states.IDLE,u="CREATE_BUFFERSOURCE_FAILED",h)return h(u);S.default.error("[".concat(c.streamId,"] "),u)}})}else c._handleAudioMixingInvalidStateError("_playEffect",v,h)},c._stopOneEffect=function(v,h){var b=c.audioMixing.sounds[v.soundId];return c._isSoundExists(v)?b.state===c.audioMixing.states.BUSY||b.state===c.audioMixing.states.PAUSED?(c._stopAudioMixingBufferSource(v),b.stopAt=Date.now(),b.state=c.audioMixing.states.IDLE,c.audioMixing.buffer[b.options.filePath]&&!b.options.cacheResource&&(S.default.debug("Recycled buffer ".concat(b.options.filePath)),delete c.audioMixing.buffer[b.options.filePath]),void(h&&h(null))):void c._handleAudioMixingInvalidStateError("_stopOneEffect",v,h):h("SOUND_NOT_EXISTS")},c._pauseOneEffect=function(v,h){var b=c.audioMixing.sounds[v.soundId];if(b.state===c.audioMixing.states.BUSY)return c._stopAudioMixingBufferSource(v)?(b.pauseAt=Date.now(),b.state=c.audioMixing.states.PAUSED,b.pauseOffset=b.resumeAt?b.pauseAt-b.resumeAt+b.resumeOffset:b.pauseAt-b.startAt+b.startOffset,h&&h(null)):void c._handleAudioMixingNoSourceError("_pauseOneEffect",v,h);c._handleAudioMixingInvalidStateError("_pauseOneEffect",v,h)},c._resumeOneEffect=function(v,h){var b=c.audioMixing.sounds[v.soundId];if(b.state===c.audioMixing.states.PAUSED){var O=c._startAudioMixingBufferSource({soundId:v.soundId,filePath:b.options.filePath,cycle:b.options.cycle,loop:b.options.loop,playTime:b.pauseOffset,replace:b.options.replace});if(!O){var P="CREATE_BUFFERSOURCE_FAILED";return h(P),void S.default.error("[".concat(c.streamId,"] "),P)}b.source=O,b.resumeAt=Date.now(),b.resumeOffset=b.pauseOffset,b.state=c.audioMixing.states.BUSY,b.pauseAt=null,b.pauseOffset=null,h(null)}else c._handleAudioMixingInvalidStateError("_resumeOneEffect",v,h)},c._getOneEffectDuration=function(v){var h=c.audioMixing.sounds[v.soundId];return h.options&&h.options.filePath&&c.audioMixing.buffer[h.options.filePath]?1e3*c.audioMixing.buffer[h.options.filePath].duration:null},c._getOneEffectCurrentPosition=function(v,h){var b=c.audioMixing.sounds[v.soundId];return b.state===c.audioMixing.states.PAUSED?b.pauseOffset%c._getOneEffectDuration(v):b.state===c.audioMixing.states.BUSY?b.resumeAt?(Date.now()-b.resumeAt+b.resumeOffset+b.startOffset)%c._getOneEffectDuration(v):(Date.now()-b.startAt+b.startOffset)%c._getOneEffectDuration(v):void(h&&c._handleAudioMixingInvalidStateError("_getOneEffectCurrentPosition",v))},c._setOneEffectPosition=function(v,h,b){var C=c.audioMixing.sounds[v.soundId];if(C.state===c.audioMixing.states.BUSY){if(!c._stopAudioMixingBufferSource(v))return void c._handleAudioMixingNoSourceError("_setOneEffectPosition",v,b);var P=c._startAudioMixingBufferSource({soundId:v.soundId,filePath:C.options.filePath,loop:C.options.loop,cycle:C.options.cycle,playTime:h});if(!P){var F="CREATE_BUFFERSOURCE_FAILED";return b&&b(F),void S.default.error("[".concat(c.streamId,"] "),F)}C.source=P,C.startAt=Date.now(),C.startOffset=h,C.resumeAt=null,C.resumeOffset=null,C.pauseOffset=null,C.pauseAt=null}else{if(C.state!==c.audioMixing.states.PAUSED)return void c._handleAudioMixingInvalidStateError("_setOneEffectPosition",v,b);C.pauseOffset=h}b&&b(null)},c.startAudioMixing=function(v,h){var b=L.b.reportApiInvoke(c.sid,{callback:function(Q){if(Q)return h&&h(Q);c.dispatchEvent({type:"audioMixingPlayed"}),h&&h(null)},getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.startAudioMixing",options:v});an(v,"options");var O=v.cacheResource,P=v.cycle,F=v.loop,j=v.playTime,u=v.replace;Kt(v.filePath,"filePath",1,Object(M.getParameter)("FILEPATH_LENMAX"),!1),le(j,"playTime",0,1e8),!Je(P)&&le(P,"cycle"),!Je(F)&&te(F,"loop"),!Je(u)&&te(u,"replace"),!Je(O)&&te(O,"cacheResource");var W=z()({soundId:-1},v);c._playOneEffect(W,b)},c.stopAudioMixing=function(v){var h=L.b.reportApiInvoke(c.sid,{callback:v,getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.stopAudioMixing"});c._stopOneEffect({soundId:-1},h)},c.pauseAudioMixing=function(v){var h=L.b.reportApiInvoke(c.sid,{callback:v,getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.pauseAudioMixing"});return c._pauseOneEffect({soundId:-1},h)},c.resumeAudioMixing=function(v){var h=L.b.reportApiInvoke(c.sid,{callback:function(b,C){if(b)return v&&v(b);c.dispatchEvent({type:"audioMixingPlayed"}),v&&v(null)},getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.resumeAudioMixing"});c._resumeOneEffect({soundId:-1},h)},c.adjustAudioMixingVolume=function(v){var h=L.b.reportApiInvoke(c.sid,{getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.adjustAudioMixingVolume",options:arguments,tag:"tracer"});le(v,"volume",0,100),c.audioMixing.sounds[-1].volume=v,c._flushAudioMixingMuteStatus(),h()},c.getAudioMixingDuration=function(){var v=L.b.reportApiInvoke(c.sid,{getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingDuration"}),h=c._getOneEffectDuration({soundId:-1});return v(null,h),h},c.getAudioMixingCurrentPosition=function(){var v=L.b.reportApiInvoke(c.sid,{getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.getAudioMixingCurrentPosition"}),h=c._getOneEffectCurrentPosition({soundId:-1},!0);return v(null,h),h},c.setAudioMixingPosition=function(v,h){var b=L.b.reportApiInvoke(c.sid,{callback:h,options:arguments,tag:"tracer",getStates:c._getOneEffectStates({soundId:-1}),name:"Stream.setAudioMixingPosition"});le(v,"position",0,1e8),c._setOneEffectPosition({soundId:-1},v,b)},c.playEffect=function(v,h){var b=L.b.reportApiInvoke(c.sid,{callback:function(F){if(F)return h&&h(F);c.dispatchEvent({type:"effectPlayed"}),h&&h(null)},name:"Stream.playEffect",options:v});an(v,"options");var O=v.filePath,P=v.cycle;le(v.soundId,"soundId",1,1e4),Kt(O,"filePath",0,Object(M.getParameter)("FILEPATH_LENMAX"),!1),!Je(P)&&le(P,"cycle"),c._playOneEffect(v,b)},c.stopEffect=function(v,h){var b=L.b.reportApiInvoke(c.sid,{callback:h,getStates:c._getOneEffectStates({soundId:v}),name:"Stream.stopEffect"});le(v,"soundId",1,1e4),c._stopOneEffect({soundId:v},b)},c.stopAllEffects=function(v){var h=L.b.reportApiInvoke(c.sid,{callback:v,name:"Stream.stopAllEffect"}),b=!1,C=0,O=0,P=function(u){b||(u?(h(u),b=!0):C+=1,C===O&&(h(null),b=!0))};for(var F in c.audioMixing.sounds){var j=c.audioMixing.sounds[F];-1!==j.soundId&&(j.state!==c.audioMixing.states.BUSY&&j.state!==c.audioMixing.states.PAUSED||(O++,c._stopOneEffect({soundId:F},P)))}O||h(null)},c.preloadEffect=function(v,h,b){var C=L.b.reportApiInvoke(c.sid,{callback:b,options:arguments,tag:"tracer",name:"Stream.preloadEffect"});le(v,"soundId",1,1e4),Kt(h,"filePath",1,Object(M.getParameter)("FILEPATH_LENMAX"),!1),c._initSoundIfNotExists(v,h),c.audioMixing.buffer[h]?C(null):c.loadAudioBuffer(h,h,C)},c.unloadEffect=function(v,h){var b=L.b.reportApiInvoke(c.sid,{callback:h,options:arguments,tag:"tracer",name:"Stream.unloadEffect"});le(v,"soundId",1,1e4);var C=c.audioMixing.sounds[v];if(!C){var O="SOUND_NOT_EXISTS";return S.default.error(O,v),void b(O)}var P=C.options?C.options.filePath:C.filePath;if(P)delete c.audioMixing.buffer[P],delete c.audioMixing.sounds[v],b(null);else{var F="SOUND_BUFFER_NOT_FOUND";S.default.error(F,v),b(F)}},c.pauseEffect=function(v,h){var b=L.b.reportApiInvoke(c.sid,{callback:h,options:arguments,tag:"tracer",name:"Stream.pauseEffect"});return c._pauseOneEffect({soundId:v},b)},c.pauseAllEffects=function(v){var h=L.b.reportApiInvoke(c.sid,{callback:v,name:"Stream.pauseAllEffects"}),b=!1,C=0,O=0,P=function(j){b||(j?(h(j),b=!0):C+=1,C===O&&(h(null),b=!0))};for(var F in c.audioMixing.sounds)"-1"!==F&&c.audioMixing.sounds[F].state===c.audioMixing.states.BUSY&&(O++,c._pauseOneEffect({soundId:F},P));O||h(null)},c.resumeEffect=function(v,h){le(v,"soundId",1,1e4);var b=L.b.reportApiInvoke(c.sid,{callback:h,options:arguments,tag:"tracer",name:"Stream.resumeEffect"});return c._resumeOneEffect({soundId:v},b)},c.resumeAllEffects=function(v){var h=L.b.reportApiInvoke(c.sid,{callback:v,name:"Stream.resumeAllEffects"}),b=!1,C=0,O=0,P=function(j){b||(j?(h(j),b=!0):C+=1,C===O&&(h(null),b=!0))};for(var F in c.audioMixing.sounds)"-1"!==F&&c.audioMixing.sounds[F].state===c.audioMixing.states.PAUSED&&(O++,c._resumeOneEffect({soundId:F},P));O||h(null)},c.getEffectsVolume=function(){var v=[];for(var h in c.audioMixing.sounds){var b=c.audioMixing.sounds[h];b&&"-1"!==h&&v.push({soundId:parseInt(h),volume:b.volume})}return v},c.setEffectsVolume=function(v,h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setEffectsVolume",options:arguments,tag:"tracer",callback:h});for(var C in le(v,"volume",0,100),c.audioMixing.defaultVolume=v,c.audioMixing.sounds)"-1"!==C&&(c.audioMixing.sounds[C].volume=v);c._flushAudioMixingMuteStatus(),b(null)},c.setVolumeOfEffect=function(v,h,b){var C=L.b.reportApiInvoke(c.sid,{name:"Stream.setVolumeOfEffect",options:arguments,tag:"tracer",callback:b});le(v,"soundId",0,1e4),le(h,"volume",0,100),c._initSoundIfNotExists(v),c.audioMixing.sounds[v].volume=h,c._flushAudioMixingMuteStatus(),C(null)},function(c,v){c.videoConstraint={},v.cameraId&&(c.videoConstraint.deviceId={exact:v.cameraId}),v.facingMode&&(c.videoConstraint.facingMode=v.facingMode),c.videoSize&&(c.videoConstraint.width=c.videoSize[0],c.videoConstraint.height=c.videoSize[1]),Object(Y.isLegacyChrome)()||(c.videoConstraint.frameRate={ideal:30,max:30}),c.audioConstraint={},v.microphoneId&&(c.audioConstraint.deviceId={exact:v.microphoneId}),Object(Y.isLegacyChrome)()||c.audioProcessing&&(void 0!==c.audioProcessing.AGC&&(Object(Y.isFireFox)()?c.audioConstraint.autoGainControl=c.audioProcessing.AGC:Object(Y.isChrome)()&&(c.audioConstraint.googAutoGainControl=c.audioProcessing.AGC,c.audioConstraint.googAutoGainControl2=c.audioProcessing.AGC)),void 0!==c.audioProcessing.AEC&&(c.audioConstraint.echoCancellation=c.audioProcessing.AEC),void 0!==c.audioProcessing.ANS&&(Object(Y.isFireFox)()?c.audioConstraint.noiseSuppression=c.audioProcessing.ANS:Object(Y.isChrome)()&&(c.audioConstraint.googNoiseSuppression=c.audioProcessing.ANS))),c.screenConstraint={},v.sourceId&&(c.screenConstraint.sourceId=v.sourceId),v.extensionId&&Object(Y.isChrome)()?(c.screenConstraint.extensionId=v.extensionId,c.screenConstraint.mandatory={chromeMediaSource:"desktop",maxWidth:c.screenAttributes.width,maxHeight:c.screenAttributes.height,maxFrameRate:c.screenAttributes.maxFr,minFrameRate:c.screenAttributes.minFr}):(c.screenConstraint.mediaSource="screen",c.screenConstraint.width=c.screenAttributes.width,c.screenConstraint.height=c.screenAttributes.height,c.screenConstraint.frameRate={ideal:c.screenAttributes.maxFr,max:c.screenAttributes.maxFr}),v.mediaSource&&(c.screenConstraint.mediaSource=v.mediaSource),c.setVideoResolution=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setVideoResolution",options:arguments,tag:"tracer"});if(!(h instanceof Array)){var C=rn(h+="");return C&&C.video?(c.videoConstraint=z()(c.videoConstraint,{width:{ideal:C.video.width},height:{ideal:C.video.height}}),v.attributes.resolution=C.attributes.resolution,(O=c.stream&&c.stream.getVideoTracks&&c.stream.getVideoTracks()[0])&&O.applyConstraints?(S.default.debug("setVideoResolution applyConstraints",c.videoConstraint),O.applyConstraints(c.videoConstraint).then(b).catch(b)):b(),!0):(b("NO_PROFILE_".concat(h)),!1)}var O,P=h[0],F=h[1];c.videoConstraint=z()(c.videoConstraint,{width:{ideal:P},height:{ideal:F}}),v.attributes.resolution="".concat(P,"x").concat(F),(O=c.stream&&c.stream.getVideoTracks&&c.stream.getVideoTracks()[0])&&O.applyConstraints?(S.default.debug("setVideoResolution applyConstraints",c.videoConstraint),O.applyConstraints(c.videoConstraint).then(b).catch(b)):b()},c.setVideoFrameRate=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setVideoFrameRate",options:arguments,tag:"tracer"});if(Object(Y.isFireFox)())return b("FIREFOX_NOT_SUPPORTED"),!1;if("object"===nn()(h)&&h instanceof Array&&h.length>1){c.videoConstraint=z()(c.videoConstraint,{frameRate:{ideal:h[0],max:h[1]}}),v.attributes.minFrameRate=h[0],v.attributes.maxFrameRate=h[1];var C=c.stream&&c.stream.getVideoTracks&&c.stream.getVideoTracks()[0];return C&&C.applyConstraints?(S.default.debug("setVideoFrameRate applyConstraints",c.videoConstraint),C.applyConstraints(c.videoConstraint).then(b).catch(b)):b(),!0}return b("INVALID_PARAM_".concat(JSON.stringify(h))),!1},c.setVideoBitRate=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setVideoBitRate",options:arguments,tag:"tracer"});return"object"===nn()(h)&&h instanceof Array&&h.length>1?(v.attributes.minVideoBW=h[0],v.attributes.maxVideoBW=h[1],c.connectionSpec&&(c.connectionSpec.minVideoBW=h[0],c.connectionSpec.maxVideoBW=h[1]),c.pc&&c.pc.renegotiate&&c.pc.renegotiate(),b(),!0):(b("INVALID_PARAM_".concat(JSON.stringify(h))),!1)},c.setScreenBitRate=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setScreenBitRate",options:arguments,tag:"tracer"});return"object"===nn()(h)&&h instanceof Array&&h.length>1?(v.screenAttributes.minVideoBW=h[0],v.screenAttributes.maxVideoBW=h[1],b(),!0):(b("INVALID_PARAM_".concat(JSON.stringify(h))),!1)},c.setScreenProfile=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setScreenProfile",options:arguments,tag:"tracer"});Nn(h,"profile",["480p_1","480p_2","720p_1","720p_2","1080p_1","1080p_2"]);var C=rn(h);return C&&C.screen?(c.screenConstraint.mandatory?(c.screenConstraint.mandatory.maxWidth=C.screen.width,c.screenConstraint.mandatory.maxHeight=C.screen.height,C.screen.frameRate&&C.screen.frameRate.min&&C.screen.frameRate.max&&(c.screenConstraint.mandatory.minFrameRate=C.screen.frameRate.min,c.screenConstraint.mandatory.maxFrameRate=C.screen.frameRate.max)):c.screenConstraint=z()(c.screenConstraint,C.screen),c.screenAttributes.width=C.screen.width,c.screenAttributes.height=C.screen.height,c.screenAttributes.minFr=C.screen.frameRate.min,c.screenAttributes.maxFr=C.screen.frameRate.max,b(),!0):(b("NO_SCREEN_PROFILE_".concat(JSON.stringify(h))),!1)},c.setVideoProfileCustom=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});c.setVideoResolution(h[0]),c.setVideoFrameRate([h[1],h[1]]),c.setVideoBitRate([h[2],h[2]]),b()},c.setVideoProfileCustomPlus=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setVideoProfileCustom",options:arguments,tag:"tracer"});c.videoConstraint.width=h.width,c.videoConstraint.height=h.height,v.attributes.resolution="".concat(h.width,"x").concat(h.height),c.setVideoFrameRate([h.framerate,h.framerate]),c.setVideoBitRate([h.bitrate,h.bitrate]),b()},c.setVideoProfile=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setVideoProfile",options:arguments,tag:"tracer"}),C=rn(h);if(!C){var O="Invalid Profile ".concat(h);throw new Error(O)}if(c.profile=h,C&&C.video){c.profile=C.profileName,c.videoConstraint=z()(c.videoConstraint,C.video),c.connectionSpec&&C.attributes.maxVideoBW&&(c.connectionSpec.minVideoBW=C.attributes.minVideoBW,c.connectionSpec.maxVideoBW=C.attributes.maxVideoBW),Object(Y.isEdge)()&&(c.videoConstraint.frameRate.max=60),Object(Y.isFireFox)()&&(c.videoConstraint.frameRate={ideal:30,max:30}),v.attributes=z()(v.attributes,C.attributes),c.pc&&c.pc.renegotiate&&c.pc.renegotiate();var P=c.stream&&c.stream.getVideoTracks&&c.stream.getVideoTracks()[0];return P&&P.applyConstraints?(S.default.debug("setVideoProfile applyConstraints",c.videoConstraint),P.applyConstraints(c.videoConstraint).then(function(F){b(F),Object(zt.g)(c.stream,function(j,u){c.videoWidth=j,c.videoHeight=u},function(j){S.default.warning("[".concat(c.streamId,"] vsResHack failed: "),j)})}).catch(b)):b(),!0}return b("INVALID_VIDEO_PROFILE_".concat(h)),!1},c.setAudioProfile=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setAudioProfile",options:arguments,tag:"tracer"});Nn(h,"profile",["speech_low_quality","speech_standard","music_standard","standard_stereo","high_quality","high_quality_stereo"]),c.audioProfile=h;var C=Lt(h);return c.highQuality=C.highQuality,c.stereo=C.stereo,c.speech=C.speech,c.lowQuality=C.lowQuality,c.stereo&&Object(Y.isChrome)()&&(c.audioConstraint.googAutoGainControl=!1,c.audioConstraint.googAutoGainControl2=!1,c.audioConstraint.echoCancellation=!1,c.audioConstraint.googNoiseSuppression=!1),b(),!0},c.setVideoEncoderConfiguration=function(h){an(h,"config");var b=L.b.reportApiInvoke(c.sid,{name:"Stream.setVideoEncoderConfiguration",options:h,tag:"tracer"});h.resolution&&(le(h.resolution.width,"config.resolution.width"),le(h.resolution.height,"config.resolution.height"),c.setVideoResolution([h.resolution.width,h.resolution.height])),h.frameRate&&(le(h.frameRate.min,"config.frameRate.min"),le(h.frameRate.max,"config.frameRate.max"),c.setVideoFrameRate([h.frameRate.min,h.frameRate.max])),h.bitrate&&(le(h.bitrate.min,"config.bitrate.min",1,1e7),le(h.bitrate.max,"config.bitrate.max",1,1e7),c.setVideoBitRate([h.bitrate.min,h.bitrate.max])),b()},c.getSupportedProfile=function(h){var b=L.b.reportApiInvoke(c.sid,{name:"Stream.getSupportedProfile",options:arguments,tag:"tracer",callback:h});if(!c.local){var C="ONLY_LOCAL_STREAM_SUPPORTED";return S.default.error(C),b(C)}if(!c.stream)return S.default.error(C="STREAM_NOT_INIT"),b(C);if(!c.stream.getVideoTracks)return S.default.error(C="TRACK_NOT_SUPPORT"),b(C);var O=c.stream.getVideoTracks()[0];if(!O)return S.default.error(C="NO_VIDEO_TRACK_FOUND"),b(C);if(!O.getCapabilities)return S.default.error(C="GETCAPABILITY_NOT_SUPPORT"),b(C);var P=O.getCapabilities();return b(null,Jt(P))}}(r,g),r.on("collectStats",function(c){c.promises.push(r._getPCStats(c.interval)),c.promises.push(new Promise(function(v){var h={};r.pc&&r.pc.isSubscriber?null!==window.navigator.userAgent.match("Firefox")&&(Te(h,"videoReceiveResolutionHeight",r.videoHeight),Te(h,"videoReceiveResolutionWidth",r.videoWidth)):r.pc&&!r.pc.isSubscriber&&((Object(Y.isSafari)()||Object(Y.isFireFox)())&&(Te(h,"videoSendResolutionHeight",r.videoHeight),Te(h,"videoSendResolutionWidth",r.videoWidth)),(Object(Y.isSafari)()||Object(Y.isFireFox)())&&r.uplinkStats&&Te(h,"videoSendPacketsLost",r.uplinkStats.uplink_cumulative_lost)),v(h)})),c.promises.push(new Promise(function(v){var h={};return r.traffic_stats&&r.pc&&r.pc.isSubscriber?(Te(h,"accessDelay",r.traffic_stats.access_delay),Te(h,"endToEndDelay",r.traffic_stats.e2e_delay),Te(h,"videoReceiveDelay",r.traffic_stats.video_delay),Te(h,"audioReceiveDelay",r.traffic_stats.audio_delay)):r.traffic_stats&&r.pc&&!r.pc.isSubscriber&&Te(h,"accessDelay",r.traffic_stats.access_delay),v(h)}))}),r.getId=function(){return r.streamId},r.getUserId=function(){return r.userId},r.checkDualStreamEnabled=function(){return!(!Object(M.getParameter)("DUALSTREAM_OPERATION_CHECK")||!r.isDualStream)&&(S.default.error("Operation not permitted: ".concat("DUAL_STREAM_ENABLED")),"DUAL_STREAM_ENABLED")},r.setUserId=function(c){var v=L.b.reportApiInvoke(r.sid,{name:"Stream.setUserId",options:arguments,tag:"tracer"});r.userId&&S.default.warning("[".concat(r.streamId,"] Stream.userId ").concat(r.userId," => ").concat(c)),r.userId=c,v()},r.getAttributes=function(){return g.screen?r.screenAttributes:g.attributes},r.hasAudio=function(){return r.audio},r.hasVideo=function(){return r.video},r.hasScreen=function(){return r.screen},r.isVideoOn=function(){return(r.hasVideo()||r.hasScreen())&&!r.userMuteVideo},r.isAudioOn=function(){return r.hasAudio()&&!r.userMuteAudio},r.init=function(c,v){var h=L.b.reportApiInvoke(r.sid,{callback:function(P,F){if(P)return v&&v(P);c&&c(F)},name:"Stream.init",options:arguments,tag:"tracer"}),b=((new Date).getTime(),arguments[2]);if(void 0===b&&(b=2),!0===r.initialized)return h({type:"warning",msg:"STREAM_ALREADY_INITIALIZED"});if(!0!==r.local)return h({type:"warning",msg:"STREAM_NOT_LOCAL"});var C=Math.random().toString().slice(3);this._streamInitID=C,r.videoSource?r.videoName="videoSource":r.video&&(r.videoName=Yt.searchDeviceNameById(g.cameraId)||"default"),r.audioSource?r.audioName="audioSource":r.audio&&(r.audioName=Yt.searchDeviceNameById(g.microphoneId)||"default"),r.screen&&(r.screenName=g.extensionId||"default");try{if(g.audio||g.video||g.screen||g.videoSource||g.audioSource){S.default.debug("[".concat(r.streamId,"] Requested access to local media"));var O={streamId:r.streamId};g.videoSource?O.videoSource=g.videoSource:g.screen?O.screen=r.screenConstraint:g.video&&(O.video=r.videoConstraint),g.audioSource?O.audioSource=g.audioSource:g.audio&&(O.audio=r.audioConstraint),On(O,function(P){if(O.screen&&S.default.debug("[".concat(r.streamId,"] User has granted access to screen sharing")),(O.video||O.audio)&&S.default.debug("[".concat(r.streamId,"] User has granted access to local media")),null===r._streamInitID){P.getTracks().forEach(function(j){j.stop()});var F={type:"error",msg:"STREAM_IS_CLOSED",info:"stream is closed and cannot be initialized"};return S.default.error(r.streamId,F.info),void h(F)}if(r._streamInitID!==C)return P.getTracks().forEach(function(j){j.stop()}),S.default.error(r.streamId,(F={type:"error",msg:"ABORT_OTHER_INIT",info:"stream initialization is aborted because of another stream.init"}).info),void h(F);r.dispatchEvent({type:"accessAllowed"}),r.stream=P,r.initialized=!0,r.reloadDeviceName(),r.hasVideo()&&Object(zt.g)(P,function(j,u){r.videoWidth=j,r.videoHeight=u},function(j){S.default.warning("[".concat(r.streamId,"] vsResHack failed: "),j)}),g.screen&&r.stream&&r.stream.getVideoTracks()[0]&&(r.stream.getVideoTracks()[0].onended=function(){r.dispatchEvent({type:"stopScreenSharing"})}),r.stream&&r.stream.getTracks&&r.stream.getTracks().forEach(function(j){j&&!j.onended&&(j.onended=I)}),h()},function(P){var F={type:"error",info:null};switch(P&&(F.msg=P.name||P.code||P,P.message&&(F.info=P.message),P.code&&(F.info?F.info+=". "+P.code:F.info=" "+P.code),P.constraint&&(F.info?F.info+=". Constraint: "+P.constraint:F.info="constraint: "+P.constraint)),F.msg){case"Starting video failed":case"TrackStartError":if(r.videoConstraint&&(delete r.videoConstraint.width,delete r.videoConstraint.height),b>0)return void setTimeout(function(){r.init(function(u){return h(u)},h,b-1)},1);F.msg="MEDIA_OPTION_INVALID";break;case"DevicesNotFoundError":F.msg="DEVICES_NOT_FOUND";break;case"NotSupportedError":F.msg="NOT_SUPPORTED";break;case"PermissionDeniedError":case"InvalidStateError":F.msg="PERMISSION_DENIED",r.dispatchEvent({type:"accessDenied"});break;case"PERMISSION_DENIED":case"NotAllowedError":r.dispatchEvent({type:"accessDenied"});break;case"ConstraintNotSatisfiedError":F.msg="CONSTRAINT_NOT_SATISFIED";break;default:F.msg||(F.msg="UNDEFINED")}var j="Media access ".concat(F.msg).concat(F.info?": "+F.info:"");S.default.error("[".concat(r.streamId,"] "),j),h(F)})}else h({type:"warning",msg:"STREAM_HAS_NO_MEDIA_ATTRIBUTES"})}catch(P){S.default.error("[".concat(r.streamId,"] Stream init: "),P),h({type:"error",msg:P.message||P})}},r.reloadDeviceName=function(){if(r.stream){if(r.stream.getVideoTracks){var c=r.stream.getVideoTracks()[0];c&&c.label&&(r.videoName=c.label)}if(r.stream.getAudioTracks){var v=r.stream.getAudioTracks()[0];v&&v.label&&(r.audioName=v.label)}}},r.close=function(){var c=L.b.reportApiInvoke(null,{name:"Stream.close",options:arguments,tag:"tracer"});if(S.default.debug("[".concat(r.streamId,"] Close stream with id"),r.streamId),void 0!==r.stream){var v=r.stream.getTracks();for(var h in v)v.hasOwnProperty(h)&&v[h].stop();r.stream=void 0}Object(Y.isSafari)()&&r.pc&&r.pc.peerConnection&&r.pc.peerConnection.removeTrack&&r.pc.peerConnection.getSenders&&r.pc.peerConnection.getSenders().forEach(function(b){b&&(S.default.debug("[".concat(r.streamId,"] Remove Track"),b),r.pc.peerConnection.removeTrack(b))}),r.initialized=!1,r._streamInitID=null,r._onAudioMute=void 0,r._onAudioUnmute=void 0,r._onVideoMute=void 0,r._onVideoUnmute=void 0,r.lowStream&&r.lowStream.close(),c()},r.enableAudio=function(){var c,v=L.b.reportApiInvoke(r.sid,{name:"Stream.enableAudio",options:arguments,tag:"tracer"});return S.default.deprecate("[".concat(r.streamId,"] Stream.enableAudio is deprecated and will be removed in the future. Use Stream.unmuteAudio instead")),r.userMuteAudio||S.default.warning("[".concat(r.streamId,"] User already enableAudio")),r.userMuteAudio=!1,v(null,c=!r.peerMuteAudio&&r._unmuteAudio()),c},r.disableAudio=function(){var c=L.b.reportApiInvoke(r.sid,{name:"Stream.disableAudio",options:arguments,tag:"tracer"});S.default.deprecate("[".concat(r.streamId,"] Stream.disableAudio is deprecated and will be removed in the future. Use Stream.muteAudio instead")),r.userMuteAudio&&S.default.warning("[".concat(r.streamId,"] User already disableAudio")),r.userMuteAudio=!0;var v=r._muteAudio();return c(null,v),v},r.enableVideo=function(){var c,v=L.b.reportApiInvoke(r.sid,{name:"Stream.enableVideo",options:arguments,tag:"tracer"});return S.default.deprecate("[".concat(r.streamId,"] Stream.enableVideo is deprecated and will be removed in the future. Use Stream.unmuteVideo instead")),r.userMuteVideo||S.default.warning("[".concat(r.streamId,"] User already enableVideo")),r.userMuteVideo=!1,r.lowStream&&(r.lowStream.userMuteVideo=!1),v(null,c=!r.peerMuteVideo&&r._unmuteVideo()),c},r.disableVideo=function(){var c=L.b.reportApiInvoke(r.sid,{name:"Stream.disableVideo",options:arguments,tag:"tracer"});S.default.deprecate("[".concat(r.streamId,"] Stream.disableVideo is deprecated and will be removed in the future. Use Stream.muteVideo instead")),r.userMuteVideo&&S.default.warning("[".concat(r.streamId,"] User already disableVideo")),r.userMuteVideo=!0,r.lowStream&&(r.lowStream.userMuteVideo=!0);var v=r._muteVideo();return c(null,v),v},r.unmuteAudio=function(){var c,v=L.b.reportApiInvoke(r.sid,{name:"Stream.unmuteAudio",options:arguments,tag:"tracer"});return r.userMuteAudio||S.default.warning("[".concat(r.streamId,"] User already unmuteAudio")),r.userMuteAudio=!1,v(null,c=!r.peerMuteAudio&&r._unmuteAudio()),c},r.muteAudio=function(){var c=L.b.reportApiInvoke(r.sid,{name:"Stream.muteAudio",options:arguments,tag:"tracer"});r.userMuteAudio&&S.default.warning("[".concat(r.streamId,"] User already muteAudio")),r.userMuteAudio=!0;var v=r._muteAudio();return c(null,v),v},r.unmuteVideo=function(){var c,v=L.b.reportApiInvoke(r.sid,{name:"Stream.unmuteVideo",options:arguments,tag:"tracer"});return r.userMuteVideo||S.default.warning("[".concat(r.streamId,"] User already unmuteVideo")),r.userMuteVideo=!1,r.lowStream&&(r.lowStream.userMuteVideo=!1),v(null,c=!r.peerMuteVideo&&r._unmuteVideo()),c},r.muteVideo=function(){var c=L.b.reportApiInvoke(r.sid,{name:"Stream.muteVideo",options:arguments,tag:"tracer"});r.userMuteVideo&&S.default.warning("[".concat(r.streamId,"] User already muteVideo")),r.userMuteVideo=!0,r.lowStream&&(r.lowStream.userMuteVideo=!0);var v=r._muteVideo();return c(null,v),v},r._unmuteAudio=function(){return S.default.debug("[".concat(r.streamId,"] Unmuted audio stream with id "),r.streamId),r._flushAudioMixingMuteStatus(!1),!(!r.hasAudio()||!r.initialized||void 0===r.stream||!0===r.stream.getAudioTracks()[0].enabled||(r._onAudioUnmute&&r._onAudioUnmute(),r.pc&&(r.pc.isAudioMute=!1),r.stream.getAudioTracks()[0].enabled=!0,0))},r._isAudioMuted=function(){if(r.stream&&r.hasAudio()){var c=r.stream.getAudioTracks();return c.length>0&&!c[0].enabled}return!1},r._isVideoMuted=function(){if(r.stream&&r.hasVideo()){var c=r.stream.getVideoTracks();return c.length>0&&!c[0].enabled}return!1},r._muteAudio=function(){return S.default.debug("[".concat(r.streamId,"] Muted audio stream with id "),r.streamId),r._flushAudioMixingMuteStatus(!0),!!(r.hasAudio()&&r.initialized&&void 0!==r.stream&&r.stream.getAudioTracks()[0].enabled)&&(r._onAudioMute&&r._onAudioMute(),r.pc&&(r.pc.isAudioMute=!0),r.stream.getAudioTracks()[0].enabled=!1,r.sid&&L.b.audioSendingStopped(r.sid,{succ:!0,reason:"muteAudio"}),!0)},r._unmuteVideo=function(){return S.default.debug("[".concat(r.streamId,"] Unmuted video stream with id"),r.streamId),!(!r.initialized||void 0===r.stream||!r.stream.getVideoTracks().length||!0===r.stream.getVideoTracks()[0].enabled||(r._onVideoUnmute&&r._onVideoUnmute(),r.pc&&(r.pc.isVideoMute=!1),r.stream.getVideoTracks()[0].enabled=!0,r.lowStream&&r.lowStream._unmuteVideo(),0))},r._muteVideo=function(){return S.default.debug("[".concat(r.streamId,"] Muted video stream with id"),r.streamId),!!(r.initialized&&void 0!==r.stream&&r.stream.getVideoTracks().length&&r.stream.getVideoTracks()[0].enabled)&&(r._onVideoMute&&r._onVideoMute(),r.pc&&(r.pc.isVideoMute=!0),r.stream.getVideoTracks()[0].enabled=!1,r.lowStream&&r.lowStream._muteVideo(),r.sid&&L.b.videoSendingStopped(r.sid,{succ:!0,reason:"muteVideo"}),!0)},r.addTrack=function(c){var v=L.b.reportApiInvoke(r.sid,{name:"Stream.addTrack",options:arguments,tag:"tracer"}),h=r.checkDualStreamEnabled();if(h)return v(h);if(r.pc&&r.pc.addTrack(c,r.stream),"audio"==c.kind){r._cleanupAudioMixing();var b=new MediaStream;r.userMuteAudio&&(c.enabled=!1),b.addTrack(c);var C=r.stream.getVideoTracks()[0];C&&(b.addTrack(C),r.audio=!0,g.audio=!0),r.stream=b,r.audioLevelHelper=null,r.player&&r.player.video&&(r.player.video.srcObject=r.stream)}else r.userMuteVideo&&(c.enabled=!1),r.stream.addTrack(c),r.video=!0,g.video=!0;c.onended||(c.onended=I),v()},r.removeTrack=function(c){var v=L.b.reportApiInvoke(r.sid,{name:"Stream.removeTrack",options:arguments,tag:"tracer"}),h=r.checkDualStreamEnabled();if(h)return v(h);r.pc&&r.pc.removeTrack(c,r.stream),r.stream.removeTrack(c),r._cleanupAudioMixing(),"audio"===c.kind?(r.audio=!1,g.audio=!1):(r.video=!1,g.video=!1),r.audioLevelHelper=null,"live"==c.readyState&&(c.stop(),S.default.debug("[".concat(r.streamId,"] Track ").concat(c.kind," Stopped"))),v()},r.setAudioOutput=function(c,v,h){var b=L.b.reportApiInvoke(r.sid,{callback:function(C,O){if(C)return h&&h(C);v&&v(O)},name:"Stream.setAudioOutput",options:arguments,tag:"tracer"});return X(c,1,255)?(r.audioOutput=c,r.player?void r.player.setAudioOutput(c,function(){return b()},b):b()):(S.default.error("[".concat(r.streamId,"] setAudioOutput Invalid Parameter"),c),b(re_INVALID_PARAMETER))},r.play=function(c,v,h){"function"==typeof v&&(h=v,v=null),S.default.debug("[".concat(r.streamId,"] play()."),c,v);var b=L.b.reportApiInvoke(r.sid,{name:"Stream.play",options:arguments,tag:"tracer",callback:h});if(Kt(c,"elementID"),Je(v)||(Je(v.fit)||Nn(v.fit,"fit",["cover","contain"]),Je(v.muted)||te(v.muted,"muted")),r.player)S.default.warning("[".concat(r.streamId,"] Stream.play(): Stream is already playing. Fallback to resume stream")),r.resume().then(function(){b(null)}).catch(b);else{r.elementID=c,r.playOptions=v,(!r.local||r.video||r.screen||r.hasAudio())&&(r.player=new ft({id:r.getId(),stream:r,elementID:c,options:v}));var C={audio:null,video:null};r.on("player-status-change",function O(P){if(C[P.mediaType]=P,C.audio&&C.video)if(r.removeEventListener("player-status-change",O),C.video.isErrorState||C.audio.isErrorState){var F=C.video.isErrorState?C.video:C.audio;b({isErrorState:!0,status:F.status,reason:F.reason,video:C.video,audio:C.audio})}else b("aborted"===C.video.status&&"aborted"===C.audio.status?{status:"aborted",reason:"stop",video:C.video,audio:C.audio}:null)}),r.audioOutput&&r.player.setAudioOutput(r.audioOutput),void 0!==r.audioLevel&&r.player.setAudioVolume(r.audioLevel),r._flushAudioMixingMuteStatus(!1)}},r.stop=function(){var c=L.b.reportApiInvoke(r.sid,{name:"Stream.stop",options:arguments,tag:"tracer"});S.default.debug("[".concat(r.streamId,"] Stop stream player with id "),r.streamId),r.player?(r.player.destroy(),delete r.player):S.default.error("[".concat(r.streamId,"] Stream.stop(): Stream is not playing")),r._flushAudioMixingMuteStatus(!0),c()},r.isPlaying=function(){return!!r.player},r.isPaused=function(){return!(!r.player||!(r.player.video&&r.player.video.paused&&r.player.mediaElemExists(r.player.video)||r.player.audio&&r.player.audio.paused&&r.player.mediaElemExists(r.player.audio)))},r.resume=function(){var c,v;return r.player?(r.player.video&&r.player.video.play&&(c=r.player.video.play()),c=c||Promise.resolve(),r.player.audio&&r.player.audio.play&&(v=r.player.audio.play()),v=v||Promise.resolve(),Promise.all([c,v])):Promise.reject("NO_PLAYER_FOUND")},r.getVideoTrack=function(){var c=L.b.reportApiInvoke(r.sid,{name:"Stream.getVideoTrack",options:arguments,tag:"tracer"});if(r.stream&&r.stream.getVideoTracks){var v=r.stream.getVideoTracks()[0];if(v)return S.default.info("[".concat(r.streamId,"] getVideoTrack"),v),c(),v}S.default.info("[".concat(r.streamId,"] getVideoTrack None")),c(null,"getVideoTrack None")},r.getAudioTrack=function(){var c=L.b.reportApiInvoke(r.sid,{name:"Stream.getAudioTrack",options:arguments,tag:"tracer"});if(r.stream&&r.stream.getAudioTracks){var v=r.stream.getAudioTracks()[0];if(v)return S.default.info("[".concat(r.streamId,"] getAudioTracks"),v),c(),v}S.default.info("[".concat(r.streamId,"] getAudioTracks None")),c(null,"getAudioTracks None")},r._replaceMediaStreamTrack=function(c,v,h){if(r.stream){if("video"==c.kind){if(C=r.stream.getVideoTracks()[0])return r.userMuteVideo&&(c.enabled=!1),r.stream.removeTrack(C),r.stream.addTrack(c),S.default.debug("[".concat(r.streamId,"] _replaceMediaStreamTrack ").concat(c.kind," SUCCESS")),"live"==C.readyState&&(C.stop(),S.default.debug("[".concat(r.streamId,"] Track ").concat(C.kind," Stopped"))),v&&v();var b="MEDIASTREAM_TRACK_NOT_FOUND";return S.default.error("[".concat(r.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(c.kind)),h(b)}if("audio"==c.kind){var C;if(C=r.stream.getAudioTracks()[0]){r.userMuteAudio&&(c.enabled=!1);var O=new MediaStream;O.addTrack(c);var P=r.stream&&r.stream.getVideoTracks()[0];return P&&O.addTrack(P),r.stream=O,r.audioLevelHelper=null,r.player&&r.player.video&&(r.player.video.srcObject=r.stream),S.default.debug("[".concat(r.streamId,"] _replaceMediaStreamTrack SUCCESS")),"live"==C.readyState&&(C.stop(),S.default.debug("[".concat(r.streamId,"] Track ").concat(C.kind," Stopped"))),v&&v()}return b="MEDIASTREAM_TRACK_NOT_FOUND",S.default.error("[".concat(r.streamId,"] MEDIASTREAM_TRACK_NOT_FOUND ").concat(c.kind)),h(b)}return b="INVALID_TRACK_TYPE",S.default.error("[".concat(r.streamId,"] _replaceMediaStreamTrack ").concat(b," ").concat(c.kind)),h&&h(b)}return b="NO_STREAM_FOUND",S.default.error("[".concat(r.streamId,"] _replaceMediaStreamTrack ").concat(b)),h&&h(b)},r.replaceTrack=function(c,v,h){var b=L.b.reportApiInvoke(r.sid,{callback:function(O,P){if(O)return h&&h(O);v&&v(P)},name:"Stream.replaceTrack",options:arguments,tag:"tracer"});if(!c||!c.kind)return b("INVALID_TRACK");var C=r.checkDualStreamEnabled();return C?b(C):(r._cleanupAudioMixing(),c.onended||(c.onended=I),r.pc&&r.pc.hasSender&&r.pc.hasSender(c.kind)?void r.pc.replaceTrack(c,function(){return S.default.debug("[".concat(r.streamId,"] PeerConnection.replaceTrack ").concat(c.kind," SUCCESS")),r._replaceMediaStreamTrack(c,function(O){return b(null,O)},b)},function(O){return S.default.error("[".concat(r.streamId,"] PeerConnection.replaceTrack ").concat(c.kind," Failed ").concat(O)),b(O)}):r._replaceMediaStreamTrack(c,function(O){return b(null,O)},b))},r.setAudioVolume=function(c){var v=L.b.reportApiInvoke(r.sid,{name:"Stream.setAudioVolume",options:arguments,tag:"tracer"});le(c,"level",0,100),r.audioLevel=c,r.player&&r.player.setAudioVolume(c),v()},r.getStats=function(c,v,h){var b={type:"collectStats",promises:[],interval:h};r.dispatchEvent(b),Promise.all(b.promises).then(function(C){for(var O={},P=C.length-1;P>=0;P--){var F=C[P];z()(O,F)}c&&setTimeout(c.bind(r,O),0)}).catch(function(C){v&&setTimeout(v.bind(r,C),0)})},r._getPCStats=function(c){return new Promise(function(v,h){if(!r.pc||"established"!==r.pc.state||!r.pc.getStats)return h("PEER_CONNECTION_NOT_ESTABLISHED");r.pc.getStats(function(b){if(!r.pc||"established"!==r.pc.state||!r.pc.getStats)return h("PEER_CONNECTION_STATE_CHANGE");var P,C=r.pc.isSubscriber?(P={},b.forEach(function(F){F.id&&(-1===F.id.indexOf("recv")&&-1===F.id.indexOf("inbound_rtp")&&-1===F.id.indexOf("inbound-rtp")&&-1===F.id.indexOf("InboundRTP")||("audio"===F.mediaType?(Te(P,"audioReceiveBytes",F.bytesReceived),Te(P,"audioReceivePackets",F.packetsReceived),Te(P,"audioReceivePacketsLost",F.packetsLost)):(Te(P,"videoReceiveBytes",F.bytesReceived),Te(P,"videoReceivePacketsLost",F.packetsLost),Te(P,"videoReceivePackets",F.packetsReceived),Te(P,"videoReceiveFrameRate",F.googFrameRateReceived),Te(P,"videoReceiveDecodeFrameRate",F.googFrameRateDecoded),Te(P,"videoReceiveResolutionWidth",F.googFrameWidthReceived),Te(P,"videoReceiveResolutionHeight",F.googFrameHeightReceived))))}),P):function(O){var P={};return O.forEach(function(F){F.id&&(-1===F.id.indexOf("send")&&-1===F.id.indexOf("outbound_rtp")&&-1===F.id.indexOf("OutboundRTP")||("audio"===F.mediaType?(Te(P,"audioSendBytes",F.bytesSent),Te(P,"audioSendPackets",F.packetsSent),Te(P,"audioSendPacketsLost",F.packetsLost)):(Te(P,"videoSendBytes",F.bytesSent),Te(P,"videoSendPackets",F.packetsSent),Te(P,"videoSendPacketsLost",F.packetsLost),Te(P,"videoSendFrameRate",F.googFrameRateSent),Te(P,"videoSendResolutionWidth",F.googFrameWidthSent),Te(P,"videoSendResolutionHeight",F.googFrameHeightSent))))}),P}(b);return v(C)},c)}).then(function(v){return r.pc.isSubscriber?(Object(Y.isFireFox)()||Object(Y.isSafari)())&&(v.videoReceiveResolutionHeight&&"0"!==v.videoReceiveResolutionHeight||v.videoReceiveResolutionWidth&&"0"!==v.videoReceiveResolutionWidth||(Te(v,"videoReceiveResolutionHeight",r.videoHeight),Te(v,"videoReceiveResolutionWidth",r.videoWidth))):((Object(Y.isSafari)()||Object(Y.isFireFox)())&&(v.videoSendResolutionHeight&&"0"!==v.videoSendResolutionHeight||v.videoSendResolutionWidth&&"0"!==v.videoSendResolutionWidth||(Te(v,"videoSendResolutionHeight",r.videoHeight),Te(v,"videoSendResolutionWidth",r.videoWidth))),(Object(Y.isSafari)()||Object(Y.isFireFox)())&&r.uplinkStats&&Te(v,"videoSendPacketsLost",r.uplinkStats.uplink_cumulative_lost)),Promise.resolve(v)})},r.getAudioLevel=function(){if(r.audioLevelHelper)return r.audioLevelHelper.getAudioLevel();if(r.stream){if(0!==r.stream.getAudioTracks().length)return r.audioLevelHelper=new zt.a(r.stream),r.audioLevelHelper.getAudioLevel();S.default.warning("[".concat(r.streamId,"] can't get audioLevel beacuse no audio trace in stream"))}else S.default.warning("[".concat(r.streamId,"] can't get audioLevel beacuse no stream exist"))},r.setVideoProfile("480P"),r._switchVideoDevice=function(c,v,h){if(c===r.cameraId)return v&&v();var b={video:z()({},r.videoConstraint,{deviceId:{exact:c}}),audio:!1};S.default.debug("[".concat(r.streamId,"] ").concat(b)),On(b,function(C){try{var O=function(){r.isPlaying()&&(r.stop(),r.elementID&&r.play(r.elementID,r.playOptions)),r.cameraId=c,r.videoConstraint.deviceId={exact:c},r.userMuteVideo&&(r.stream.getVideoTracks()[0].enabled=!1),v&&v()};Object(Y.isSafari)()?r.replaceTrack(C.getVideoTracks()[0],O,h):(r.removeTrack(r.stream.getVideoTracks()[0]),r.addTrack(C.getVideoTracks()[0]),O())}catch(P){return h&&h(P)}},function(C){return h&&h(C)})},r._switchAudioDevice=function(c,v,h){if(c===r.microphoneId)return v&&v();var b={video:!1,audio:z()({},r.audioConstraint,{deviceId:{exact:c}})};S.default.debug("[".concat(r.streamId,"] "),b),On(b,function(C){var O=function(){r._cleanupAudioMixing(),r.userMuteAudio&&(r.stream.getAudioTracks()[0].enabled=!1),r.isPlaying()&&(r.stop(),r.elementID&&r.play(r.elementID)),r.microphoneId=c,r.audioConstraint.deviceId={exact:c},v&&v()};try{Object(Y.isSafari)()?r.replaceTrack(C.getAudioTracks()[0],O,h):(r.removeTrack(r.stream.getAudioTracks()[0]),r.addTrack(C.getAudioTracks()[0]),O())}catch(P){return h&&h(P)}},function(C){return h&&h(C)})},r.switchDevice=function(c,v,h,b){var C=L.b.reportApiInvoke(r.sid,{callback:function(u,W){if(u)return b&&b(u);h&&h(W)},name:"Stream.switchDevice",options:arguments,tag:"tracer"});Kt(v,"deviceId");var O=function(){return r.inSwitchDevice=!1,C()},P=function(u){r.inSwitchDevice=!1,S.default.error("[".concat(r.streamId,"] "),u),C(u)};if(r.inSwitchDevice)return C("Device switch is in process.");if(r.inSwitchDevice=!0,!r.local)return P("Only the local stream can switch the device.");if(r.screen&&"video"===c)return P("The device cannot be switched during screen-sharing.");if(r.videoSource||r.audioSource)return P("The device cannot be switched when using videoSource or audioSource.");if(r.lowStream)return P("The device cannot be switched when using lowstream.");var F=!1;for(var j in r.audioMixing.sounds)if(r.audioMixing.sounds[j].state!==r.audioMixing.states.IDLE){F=!0;break}if(r.audioMixing.audioContextInited&&F)return P("The device cannot be switched when using audio Mixing.");Yt.getDeviceById(v,function(){if("video"===c)r._switchVideoDevice(v,O,P);else{if("audio"!==c)return P("Invalid type.");r._switchAudioDevice(v,O,P)}},function(){return P("The device does not exist.")})},r},St=E(15),$n=["live","rtc","web","interop","h264_interop","web-only"],yr=["vp8","h264"],In=["aes-128-xts","aes-256-xts","aes-128-ecb"],ur=E(16),eo=E.n(ur),lr=function(g){g&&g.apply(this,[].slice.call(arguments,1))},Wn=E(7),_r=function(g,r){var I={connect:function(){r.host=g,I.signal=function(g){var r=ae();r.needReconnect=!0,r.isTimeout=!1,r.isInit=!0,r.sendbytes=0,r.recvbytes=0,r.startTime=Date.now(),r.lastMsgTime=null,r.clientId=g.clientId,r.hostIndex=0,r.requestID=0,r.host=g.host instanceof Array?g.host:[g.host],r.getSendBytes=function(){return r.sendbytes},r.getRecvBytes=function(){return r.recvbytes},r.getDuration=function(){return Math.ceil((Date.now()-r.startTime)/1e3)},r.getURL=function(){return r.connection.url},r.reconnect=function(){r.isInit=!0,r.creatConnection()},r.connectNext=function(){r.isInit=!0,++r.hostIndex,S.default.debug("["+r.clientId+"] Gateway length:"+r.host.length+" current index:"+r.hostIndex),r.hostIndex>=r.host.length?r.dispatchEvent(Ce({type:"recover"})):r.creatConnection()},r.replaceHost=function(c){r.host=c||r.host,r.hostIndex=0,r.creatConnection()},r.creatConnection=function(){if(r.needReconnect=!0,S.default.debug("["+r.clientId+"] start connect:"+r.host[r.hostIndex]),r.lts=(new Date).getTime(),r.connection=new WebSocket("wss://"+r.host[r.hostIndex]),r.connection.binaryType="arraybuffer",r.turnConfig={},r.connection.url){var c=r.connection.url.match(/wss\:\/\/([^:]+):(\d+)/);if(c)r.turnConfig.url=c[1],Object(M.getParameter)("TURN_ENABLE_TCP")&&(r.turnConfig.tcpport=parseInt(c[2])+30),Object(M.getParameter)("TURN_ENABLE_UDP")&&(r.turnConfig.udpport=parseInt(c[2])+30);else{var v=r.host[r.hostIndex].split(":");r.turnConfig.url=v[0],Object(M.getParameter)("TURN_ENABLE_TCP")&&(r.turnConfig.tcpport=parseInt(v[1])+30),Object(M.getParameter)("TURN_ENABLE_UDP")&&(r.turnConfig.udpport=parseInt(v[1])+30)}}r.connection.onopen=function(h){S.default.debug("["+r.clientId+"] websockect opened: "+r.host[r.hostIndex]),r.needReconnect=!0,r.isTimeout=!1,r.isInit=!1,r.sendbytes=0,r.recvbytes=0,r.startTime=Date.now(),Object(Wn.d)(),clearTimeout(r.timeoutCheck),r.dispatchEvent(Ce({type:"onopen",event:h,socket:r}))},r.connection.onmessage=function(h){if(h.data instanceof ArrayBuffer)r.dispatchEvent({type:"onBinaryData",data:h.data});else{r.recvbytes+=Object(zt.d)(h.data);var b=JSON.parse(h.data);r.lastMsgTime=Date.now(),b.hasOwnProperty("_id")?r.dispatchEvent(Ce({type:b._id,msg:b})):b.hasOwnProperty("_type")&&r.dispatchSocketEvent(Ce({type:b._type,msg:b._message}))}},r.connection.onclose=function(h){r.needReconnect?r.isTimeout||r.isInit?(S.default.debug("["+r.clientId+"] websockect connect timeout"),L.b.joinGateway(g.sid,{lts:r.lts,succ:!1,ec:"timeout",addr:r.connection.url}),r.connectNext()):r.dispatchEvent(Ce({type:"disconnect",event:h})):(S.default.debug("["+r.clientId+"] websockect closeed"),lr(g.onFailure,h),clearTimeout(r.timeoutCheck),r.dispatchEvent(Ce({type:"close",event:h})),r.connection.onopen=void 0,r.connection.onclose=void 0,r.connection.onerror=void 0,r.connection.onmessage=void 0,r.connection=void 0)},r.connection.onerror=function(h){},setTimeout(function(){r.connection&&r.connection.readyState!=WebSocket.OPEN&&(r.isTimeout=!0,r.connection.close())},5e3)},r.creatConnection(),r.sendMessage=function(c,v){if(r.connection&&r.connection.readyState==WebSocket.OPEN){var h=JSON.stringify(c);r.sendbytes+=Object(zt.d)(h),r.connection.send(h)}else v({error:"Gateway not connected"})},r.disconnect=function(){r.needReconnect=!0,r.connection.close()},r.close=function(){r.needReconnect=!1,r.connection.onclose=void 0,r.connection.close()},r.sendSignalCommand=function(c,v){c._id="_request_"+r.requestID,r.requestID+=1,"publish_stats"!==c._type&&"subscribe_stats"!==c._type&&"publish_stats_low"!==c._type&&r.on(c._id,function(h){h.msg&&v&&v(h.msg._result,h.msg.message),delete r.dispatcher.eventListeners[c._id]}),r.sendMessage(c,function(h){h.reason="NOT_CONNECTED",v&&v(h.reason,h)})},r.requests=[];var I=function(c){var v=r.requests.findIndex(function(b){return b.id===c.type});if(v>=0)var h=r.requests.splice(v,1)[0];h&&r.dispatcher.eventListeners[c.type]?(delete r.dispatcher.eventListeners[c.type],c.msg&&h.callback&&h.callback(c.msg._result,c.msg._message)):S.default.warning("Detached Response",c.type,c.msg)};return r.sendRequest=function(c,v){c=z()({_id:"_request_"+r.requestID},c),r.requestID+=1;var h={id:c._id,timeoutCounter:0,stalledAt:Date.now(),message:c,callback:v};r.requests.push(h),r.addEventListener(c._id,I),r.sendMessage(c,function(b){var C=this,O=r.requests.findIndex(function(P){return P.id===C.id});O>=0&&(C=r.requests.splice(O,1)[0]),C&&r.dispatcher.eventListeners[b.type]?(delete r.dispatcher.eventListeners[b.type],b.reason="NOT_CONNECTED",C.callback&&C.callback(b.reason,b)):S.default.warning("handleSendError",C)}.bind(h))},r.checkRequestTimeout=function(){for(var c=Math.ceil(Object(M.getParameter)("SIGNAL_REQUEST_TIMEOUT")/Object(M.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),v=r.requests.length-1;v>=0;v--){var h=r.requests[v];h.timeoutCounter>=c?(r.requests.splice(v,1),S.default.error("Request Timeout",h.timeoutCounter,h.message),h.callback&&h.callback("TIMEOUT")):h.timeoutCounter++}},clearInterval(r.requestTimer),r.requestTimer=setInterval(r.checkRequestTimeout,Object(M.getParameter)("SIGNAL_REQUEST_WATCH_INTERVAL")),r.sendReport=function(c){r.sendMessage(c,function(){})},r}(r),I.on=I.signal.on,I.dispatchEvent=I.signal.dispatchEvent,I.signal.on("onopen",function(c){I.signal.onEvent=function(v){I.dispatchEvent(Ce({type:v.event,msg:v}))},I.dispatchEvent(Ce({type:"connect",msg:c}))}),I.signal.on("onError",function(c){onError(c.msg.code,"error")})},getLastMsgTime:function(){return I.signal&&I.signal.lastMsgTime},getSendBytes:function(){return I.signal.getSendBytes()},getRecvBytes:function(){return I.signal.getRecvBytes()},getDuration:function(){return I.signal.getDuration()},disconnect:function(){I.signal.disconnect()},close:function(){I.signal.close()},getURL:function(){return I.signal.getURL()},reconnect:function(){I.signal.reconnect()},connectNext:function(){I.signal.connectNext()},replaceHost:function(c){I.signal.replaceHost(c)},emitSimpleMessage:function(c,v){I.signal.sendSignalCommand(c,v)},emitRequest:function(c,v){I.signal.sendRequest(c,v)},emitReport:function(c){I.signal.sendReport(c)}};return I.connect(),I},Nr=E(5),Rt=E.n(Nr),to=E(9),vn=E.n(to),_e=function(g,r,I){var c={service_name:"webrtc_proxy",json_body:JSON.stringify(r)};Object(Wn.c)(g,c,function(v){I&&I(null,v)},function(v){I&&I(v)},{"X-Packet-Service-Type":0,"X-Packet-URI":61})},q=function(g){if(!(g&&[]instanceof Array))return[];var r=[];return g.forEach(function(I){var c;I.address&&I.tcp?(I.address.match(/^[\.\:\d]+$/)?c="".concat(I.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(S.default.info("["+joinInfo.clientId+"] "+"Cannot recognized as IP address ".concat(I.address,". Used As Host instead")),c="".concat(I.address,":").concat(I.tcp)),r.push(c)):S.default.error("["+joinInfo.clientId+"] Invalid address format ",I)}),r},ze={},Ve={},ct=function(g,r,I,c){var v=(new Date).getTime(),h=r,b="";r.multiIP&&r.multiIP.gateway_ip&&(b={vocs_ip:[r.multiIP.uni_lbs_ip],vos_ip:[r.multiIP.gateway_ip]});var C={opid:133,flag:4096,ts:+new Date,key:r.token,cname:r.cname,sid:r.sid,detail:{},uid:r.uid||0};b&&(C.detail[5]=JSON.stringify(b)),Object(Wn.c)(g+"".concat(-1===g.indexOf("?")?"?":"&","action=wrtc_gateway"),C,function(O){try{var P=JSON.parse(O);P.res&&(P=P.res);var F=P.code}catch{var j="requestChooseServer failed with unexpected body "+O;return S.default.error("["+h.clientId+"]",j),c(j)}if(F){var u=K[P.code]||F;return L.b.joinChooseServer(r.sid,{lts:v,succ:!1,csAddr:g,serverList:null,ec:u}),c("Get server node failed ["+u+"]",g,u)}var W=[],Q=[".agora.io",".agoraio.cn"],ne=0;return g.indexOf(Q[1])>-1&&(ne=1),P.addresses.forEach(function($){var Ie;$.ip&&$.port?($.ip.match(/^[\.\:\d]+$/)?Ie="".concat($.ip.replace(/[^\d]/g,"-"),".edge").concat(Q[ne++%Q.length],":").concat($.port):(S.default.info("["+h.clientId+"] "+"Cannot recognized as IP address ".concat($.ip,". Used As Host instead")),Ie="".concat($.ip,":").concat($.port)),W.push(Ie)):S.default.error("["+h.clientId+"] Invalid address format ",$)}),W.length?I({gateway_addr:W,uid:P.uid,cid:P.cid,vid:P.detail&&P.detail[8],res:P,uni_lbs_ip:P.detail},g):(S.default.error("["+h.clientId+"] Empty Address response",P),L.b.joinChooseServer(r.sid,{lts:v,succ:!1,csAddr:g,serverList:null,ec:u="EMPTY_ADDRESS_RESPONSE"}),c("Get server node failed ["+u+"]",g,u))},function(O,P){"timeout"===O.type?(L.b.joinChooseServer(r.sid,{lts:v,succ:!1,csAddr:P,serverList:null,ec:"timeout"}),c("Connect choose server timeout",P)):L.b.joinChooseServer(r.sid,{lts:v,succ:!1,csAddr:P,serverList:null,ec:"server_wrong"})},{"X-Packet-Service-Type":0,"X-Packet-URI":69})},Ft=function(g,r,I){var c=!1,v=null,h=1,b=1,C=null,O=g.clientId,P=function F(j,u){if(!c){var W=!1,Q=!1,ne=[],Oe=Y.getBrowserInfo()||{};(function(g,r){var I=z()({},g),c=Object(M.getParameter)("CDS_AP"),v=[],h=!1;(c=c.map(function(b){return I.proxyServer?"https://".concat(I.proxyServer,"/ap/?url=").concat(b+"/api/v1"):"https://".concat(b,"/api/v1?action=config")})).map(function(b){var C,P,F;C=b,P=function(C,O){h||(C?(v.push(C),v.length>=c.length&&r&&r("ALL_REQUEST_FAILED")):(h=!0,r&&r(null,O)))},F={flag:64,cipher_method:0,timeout:1e3,features:I},Object(Wn.c)(C,F,function(j){try{var u=JSON.parse(j);P&&P(null,u)}catch(W){P&&P(W)}P&&P(null,j)},function(j){P&&P(j)},{"X-Packet-Service-Type":0,"X-Packet-URI":54})})})({device:Oe.name,system:Oe.os,vendor:g.appId,version:M.VERSION,cname:g.cname,sid:g.sid,session_id:Object(L.a)(),detail:"",proxyServer:j},function($,Ie){Q=!0;try{var We=Object.keys(Ie.test_tags)[0],tt=JSON.parse(Ie.test_tags[We]);C=tt[1]}catch{C=null}L.b.reportApiInvoke(g.sid,{name:"_config-distribute-request",options:{err:$,res:Ie}})(),Ve[O]!==sn.DISCONNECTED&&Ve[O]!==sn.DISCONNECTING?W&&u&&u(ne,C):S.default.debug("[".concat(g.clientId,"] Request config success when connection state is ").concat(Ve[O]))}),function($,Ie,We){for(var tt=(new Date).getTime(),w=!1,Pe=!0,qe=function(dt,yt){if(w)L.b.joinChooseServer($.sid,{lts:tt,succ:!0,csAddr:yt,serverList:dt.gateway_addr,cid:dt.cid+"",uid:dt.uid+"",ec:null},!1);else{if(clearTimeout(st),w=!0,S.default.debug("["+$.clientId+"] Get gateway address:",dt.gateway_addr),$.proxyServer){for(var mt=dt.gateway_addr,It=0;It<mt.length;It++){var vt=mt[It].split(":");dt.gateway_addr[It]=$.proxyServer+"/ws/?h="+vt[0]+"&p="+vt[1]}S.default.debug("["+$.clientId+"] Get gateway address:",dt.gateway_addr)}(function($){c=!0,W=!0,ne=$,clearTimeout(v),Ve[O]!==sn.DISCONNECTED&&Ve[O]!==sn.DISCONNECTING?Q&&u&&u(ne,C):S.default.debug("[".concat(g.clientId,"] Request gateway list success when connection state is ").concat(Ve[O]))})(dt),L.b.joinChooseServer($.sid,{lts:tt,succ:!0,csAddr:yt,serverList:dt.gateway_addr,cid:dt.cid+"",uid:dt.uid+"",ec:null},!0)}},Ee=function(dt,yt,mt){Pe&&(S.default.error("["+$.clientId+"]",dt,yt,mt),mt&&-1===He.indexOf(mt)&&(Pe=!1,We(mt)))},ut=Object(M.getParameter)("WEBCS_DOMAIN"),ie=0;ie<ut.length;++ie){var Ae;if("string"==typeof ut[ie]){var nt=ut[ie];Ae=$.proxyServer?"https://".concat($.proxyServer,"/ap/?url=").concat(nt+"/api/v1"):"https://".concat(nt,"/api/v1"),S.default.debug("["+$.clientId+"] "+"Connect to choose_server: ".concat(Ae)),ct(Ae,$,qe,Ee)}else S.default.error("["+$.clientId+"] Invalid Host",ut[ie])}var st=setTimeout(function(){if(!w)for(var dt=Object(M.getParameter)("WEBCS_DOMAIN_BACKUP_LIST"),yt=0;yt<dt.length;++yt)if("string"==typeof dt[yt]){var mt=dt[yt];Ae=$.proxyServer?"https://".concat($.proxyServer,"/ap/?url=").concat(mt+"/api/v1"):"https://".concat(mt,"/api/v1"),S.default.debug("["+$.clientId+"] "+"Connect to backup_choose_server: ".concat(Ae)),ct(Ae,$,qe,Ee)}else S.default.error("["+$.clientId+"] Invalid Host",dt[yt])},1e3);setTimeout(function(){!w&&Pe&&We()},Object(M.getParameter)("WEBCS_BACKUP_CONNECT_TIMEOUT"))}(g,0,function($){$?S.default.info("["+g.clientId+"] Join failed: "+$):Ve[O]!==sn.DISCONNECTED&&Ve[O]!==sn.DISCONNECTING?(S.default.debug("["+g.clientId+"] Request gateway list will be restart in "+h+"s"),v=setTimeout(function(){F(j,u)},1e3*h),ze[O]=v,h=h>=3600?3600:2*h):S.default.debug("[".concat(g.clientId,"] Request gateway list falied when connection state is ").concat(Ve[O]))})}};g.useProxyServer?function F(){var j,u;u=function(j,u){if(j)return S.default.debug("["+g.clientId+"]",j),S.default.debug("["+g.clientId+"] Request proxy will be restart in "+b+"s"),v=setTimeout(function(){F()},1e3*b),ze[O]=v,void(b=b>=3600?3600:2*b);clearTimeout(v);var W=u.address;g.proxyServer=W,g.turnServer={mode:"manual",url:u.address,tcpport:u.serverResponse.tcpport||"3433",udpport:u.serverResponse.udpport||"3478",username:u.serverResponse.username||"test",credential:u.serverResponse.password||"111111",forceturn:!0},g.turnServer.tcpport+="",g.turnServer.udpport+="",L.b.setProxyServer(W),S.default.setProxyServer(W),P(W,r)},function(g,r){var I=!1,c=0,v={command:"convergeAllocateEdge",sid:g.sid,appId:g.appId,token:g.token,uid:g.uid,cname:g.cname,ts:Math.floor(Date.now()/1e3),version:M.VERSION,seq:0,requestId:1};Object(M.getParameter)("PROXY_CS").map(function(h){var b=(new Date).getTime();_e("https://"+h+"/api/v1",v,function(C,O){if(C)return S.default.debug("["+g.clientId+"] Request proxy server failed: ",C),c++,L.b.requestProxyAppCenter(g.sid,{lts:b,succ:!1,APAddr:h,workerManagerList:null,ec:JSON.stringify(C),response:JSON.stringify({err:C,res:O})}),void(c>=Object(M.getParameter)("PROXY_CS").length&&r&&r("Get proxy server failed: request all failed"));if(!I)if((O=JSON.parse(O)).json_body){var P=JSON.parse(O.json_body);if(S.default.debug("["+g.clientId+"] App return:",P.servers),200!==P.code)S.default.debug("["+g.clientId+"] "+(C="Get proxy server failed: response code ["+P.code+"], reason [ "+P.reason+"]")),L.b.requestProxyAppCenter(g.sid,{lts:b,succ:!1,APAddr:h,workerManagerList:null,ec:C,response:JSON.stringify({err:C,res:O})});else{I=!0;var F=q(P.servers);L.b.requestProxyAppCenter(g.sid,{lts:b,succ:!0,APAddr:h,workerManagerList:JSON.stringify(F),ec:null,response:JSON.stringify({res:O})}),r&&r(null,F)}}else S.default.debug("["+g.clientId+"] Get proxy server failed: no json_body"),L.b.requestProxyAppCenter(g.sid,{lts:b,succ:!1,APAddr:h,workerManagerList:null,ec:"Get proxy server failed: no json_body",response:JSON.stringify({res:O})})})})}(j=g,function(W,Q){if(W)return u&&u(W);S.default.debug("["+j.clientId+"] getProxyServerList: ",Q),function(g,r,I){var c=!1,v=0,h={command:"request",gatewayType:"http",appId:g.appId,cname:g.cname,uid:g.uid+"",sdkVersion:"2.3.1",sid:g.sid,seq:1,ts:+new Date,requestId:3,clientRequest:{appId:g.appId,cname:g.cname,uid:g.uid+"",sid:g.sid}};r.map(function(b){var O,P,F,C=(new Date).getTime();O="https://"+b+":4000/v2/machine",P=h,F=function(O,P){if(O)return S.default.debug("["+g.clientId+"] Request worker manager failed: ",O),v++,L.b.requestProxyWorkerManager(g.sid,{lts:C,succ:!1,workerManagerAddr:b,ec:JSON.stringify(O),response:JSON.stringify({res:P})}),void(v>=r.length&&I&&I("requeet worker manager server failed: request failed"));if(!c){if(!(P=JSON.parse(P)).serverResponse)return I&&I("requeet worker manager server failed: serverResponse is undefined");c=!0,L.b.requestProxyWorkerManager(g.sid,{lts:C,succ:!0,workerManagerAddr:b,ec:JSON.stringify(O),response:JSON.stringify({res:P})}),I&&I(null,{address:b,serverResponse:P.serverResponse})}},Object(Wn.c)(O,P,function(j){F&&F(null,j)},function(j){F&&F(j)})})}(j,Q,u)})}():P(null,r)},cn=function(g,r,I,c){var v=Date.now(),h={sid:r.sid,opid:10,appid:r.appId,string_uid:c=c||r.stringUid};return new Promise(function(b,C){Object(Wn.c)(g+"".concat(-1===g.indexOf("?")?"?":"&","action=stringuid"),h,function(O){try{var P=JSON.parse(O),F=P.code}catch{var j="requestUserAccount failed with unexpected body "+O;return S.default.error("["+r.clientId+"]",j),C({retryable:!0,info:j,url:g}),I&&I.dispatchEvent({type:"error",reason:"USER_ACCOUNT_BODY_NOT_JSON"}),void L.b.reqUserAccount(h.sid,{lts:v,success:!1,serverAddress:g,stringUid:c,uid:null,extend:O,errorCode:"USER_ACCOUNT_BODY_NOT_JSON"})}if(F){var u=Fe[P.code%1e4]||"REQ_ACCOUNT_ERR_".concat(F);return I&&I.dispatchEvent({type:"error",reason:u}),L.b.reqUserAccount(h.sid,{lts:v,success:!1,serverAddress:g,stringUid:c,uid:null,errorCode:u,extend:h}),C({retryable:!1,info:j="Get String Uid Failed ["+u+"]",url:g,error:u})}var W=P.uid;if(!(W>0&&W<Math.pow(2,32)))return S.default.error("["+r.clientId+"] "+"Invalid Uint Uid ".concat(c," => ").concat(W),P),u="INVALID_UINT_UID_".concat(W),I&&I.dispatchEvent({type:"error",reason:u}),L.b.reqUserAccount(h.sid,{lts:v,success:!1,serverAddress:g,stringUid:c,uid:null,errorCode:u,extend:h}),C({retryable:!0,error:u,info:"Get String Uid failed ["+u+"]",url:g});b({uid:W,url:g}),L.b.reqUserAccount(h.sid,{lts:v,success:!0,serverAddress:g,stringUid:c,uid:W,errorCode:null,extend:h})},function(O,P){if("timeout"===O.type){var F="USER_ACCOUNT_TIMEOUT";I&&I.dispatchEvent({type:"error",reason:F}),L.b.reqUserAccount(h.sid,{lts:v,success:!1,serverAddress:P,stringUid:c,uid:null,errorCode:F,extend:h}),C({retryable:!0,info:F,url:P})}else{var j="USER_ACCOUNT_SERVER_WRONG_".concat(O.type);I&&I.dispatchEvent({type:"error",reason:j}),L.b.reqUserAccount(h.sid,{lts:v,success:!1,serverAddress:P,stringUid:c,uid:null,errorCode:j,extend:h}),C({retryable:!0,info:j,url:P})}},{"X-Packet-Service-Type":0,"X-Packet-URI":72})})},qn=function(g,r,I){Date.now();var c,F,v=Object(M.getParameter)("ACCOUNT_REGISTER"),h=!1,b=Object(M.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT"),C=null,O=null,P=new Promise((F=vn()(Rt.a.mark(function j(u,W){var Q,ne,Oe;return Rt.a.wrap(function($){for(;;)switch($.prev=$.next){case 0:C=u,O=W,c=0;case 3:if(!(c<Object(M.getParameter)("ACCOUNT_REGISTER_RETRY_COUNT_MAX"))){$.next=33;break}if(!h){$.next=6;break}return $.abrupt("return");case 6:return Q=v[c%v.length],ne=g.proxyServer?"https://".concat(g.proxyServer,"/ap/?url=").concat(v[i]+"/api/v1"):"https://".concat(Q,"/api/v1"),$.prev=8,$.delegateYield(Rt.a.mark(function Ie(){var We;return Rt.a.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:return tt.next=2,cn(ne,g,r,I);case 2:if(We=tt.sent,!h){tt.next=5;break}return tt.abrupt("return",{v:void 0});case 5:h=!0,setTimeout(function(){S.default.debug("Get UserAccount Successfully",We),C(We)},0);case 7:case"end":return tt.stop()}},Ie,this)})(),"t0",10);case 10:if(Oe=$.t0,"object"!==nn()(Oe)){$.next=13;break}return $.abrupt("return",Oe.v);case 13:$.next=30;break;case 15:if($.prev=15,$.t1=$.catch(8),!h){$.next=19;break}return $.abrupt("return");case 19:if(!$.t1.retryable){$.next=27;break}return(b=Math.ceil(b*Object(M.getParameter)("ACCOUNT_REGISTER_RETRY_RATIO")))>Object(M.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")&&(b=Object(M.getParameter)("ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX")),S.default.error("".concat($.t1.info," ").concat($.t1.url," Will Fetch User Account in ").concat(b/1e3," seconds")),$.next=25,new Promise(function(Ie){setTimeout(Ie,b)});case 25:$.next=30;break;case 27:S.default.error("Get UserAccount Error: ".concat($.t1.info," ").concat($.t1.url),$.t1.error),h=!0,O($.t1);case 30:c++,$.next=3;break;case 33:case"end":return $.stop()}},j,this,[[8,15]])})),function(j,u){return F.apply(this,arguments)}));return P.cancel=function(){h||(h=!0,O({info:"Request Cancelled",retryable:!1}))},P.isFinished=function(){return h},P},yn={ERR_NO_VOCS_AVAILABLE:"tryNext",ERR_NO_VOS_AVAILABLE:"tryNext",ERR_JOIN_CHANNEL_TIMEOUT:"tryNext",WARN_REPEAT_JOIN:"quit",ERR_JOIN_BY_MULTI_IP:"recover",WARN_LOOKUP_CHANNEL_TIMEOUT:"tryNext",WARN_OPEN_CHANNEL_TIMEOUT:"tryNext",ERR_VOM_SERVICE_UNAVAILABLE:"tryNext",ERR_TOO_MANY_USERS:"tryNext",ERR_MASTER_VOCS_UNAVAILABLE:"tryNext",ERR_INTERNAL_ERROR:"tryNext",K_SERVICE_NOT_READY:"recover",notification_test_recover:"recover",notification_test_tryNext:"tryNext",notification_test_retry:"retry"},Yn={googActualEncBitrate:"A_aeb",googAvailableSendBandwidth:"A_asb",googRetransmitBitrate:"A_rb",googAvailableReceiveBandwidth:"A_arb",googTargetEncBitrate:"A_teb",googBucketDelay:"A_bd",googTransmitBitrate:"A_tb",googCodecName:"A_cn",bytesSent:"bytesSent",packetsLost:"packetsLost",packetsSent:"packetsSent",googAdaptationChanges:"A_ac",googAvgEncodeMs:"A_aem",googEncodeUsagePercent:"A_eup",googFirsReceived:"A_fr",googFrameHeightInput:"A_fhi",googFrameHeightSent:"A_fhs",googFrameRateInput:"A_fri",googFrameRateSent:"A_frs",googFrameWidthInput:"A_fwi",googFrameWidthSent:"A_fws",googNacksReceived:"A_nr",googPlisReceived:"A_pr",googRtt:"A_rtt",aecDivergentFilterFraction:"A_adff",audioInputLevel:"A_ail",googEchoCancellationReturnLoss:"A_ecrl",googEchoCancellationReturnLossEnhancement:"A_ecrle",googResidualEchoLikelihood:"A_rel",googResidualEchoLikelihoodRecentMax:"A_relrm",googTargetDelayMs:"A_tdm",bytesReceived:"bytesReceived",packetsReceived:"packetsReceived",googDecodeMs:"A_dm",googMaxDecodeMs:"A_mdm",googRenderDelayMs:"A_rdm",googFrameWidthReceived:"A_fwr",googFrameHeightReceived:"A_fhr",googFrameRateReceived:"A_frr",googFrameRateDecoded:"A_frd",googFrameRateOutput:"A_fro",googJitterBufferMs:"A_jbm",googCurrentDelayMs:"A_cdm",googMinPlayoutDelayMs:"A_mpdm",googNacksSent:"A_ns",googPlisSent:"A_ps",googFirsSent:"A_fs",audioOutputLevel:"A_aol",googAccelerateRate:"A_ar",googDecodingCNG:"A_dcng",googDecodingCTN:"A_dctn",googDecodingCTSG:"A_dctsg",googDecodingNormal:"A_dn",googDecodingPLC:"A_dplc",googDecodingPLCCNG:"A_dplccng",googExpandRate:"A_er",googJitterReceived:"A_jr",googPreemptiveExpandRate:"A_per",googPreferredJitterBufferMs:"A_pjbm",googSecondaryDecodedRate:"A_sdr",googSpeechExpandRate:"A_ser",uplink_fraction_lost:"B_ufl",uplink_cumulative_lost:"B_ucl",uplink_available_bandwidth:"B_uab",access_delay:"B_acd",uplink_network_quality:"B_unq",downlink_network_quality:"B_dnq",pub_audio_lost_ratio_400ms:"B_palr4",pub_video_lost_ratio_400ms:"B_pvlr4",e2e_delay:"B_ed",audio_delay:"B_ad",video_delay:"B_vd",stream_type:"B_st",e2e_audio_lost_ratio_400ms:"B_ealr4",e2e_video_lost_ratio_400ms:"B_evlr4",downlink_estimate_bandwidth:"B_deb"},on={};for(var Sr in Yn){var Pn=Yn[Sr];on[Pn]&&console.error("Key Conflict: ".concat(Pn,": ").concat(Yn[Pn],"| ").concat(Sr)),on[Pn]=Sr}var bt=function(g){return Yn[g]||g},wr=function(g){return on[g]||g},Qn=function g(r){var w,Pe,I=!1,c=function(w){return{_type:"control",_message:w}},v=function(w,Pe){var qe={};return Object.keys(Pe).forEach(function(Ee){Object(M.getParameter)("STATS_FILTER")[Ee]||(qe[bt(Ee)]=Pe[Ee])}),{_type:"subscribe_related_stats",_message:{stream_type:"high",stream_id:w,stats:qe}}},h=function(w){return{_type:"publish",_message:w}},b=function(w,Pe){var qe={};return Object.keys(Pe).forEach(function(Ee){Object(M.getParameter)("STATS_FILTER")[Ee]||(qe[bt(Ee)]=Pe[Ee])}),{_type:"subscribe_stats",_message:{stream_id:w,stats:qe}}},C=g.DISCONNECTED,O=g.CONNECTING,P=g.CONNECTED,F=g.DISCONNECTING,j=C,u=ae();Object.defineProperty(u,"state",{set:function(w){var Pe=j;j=w,Ve[u.clientId]=w,Pe!==w&&u.dispatchEvent({type:"connection-state-change",prevState:g.connetionStateMap[Pe],curState:g.connetionStateMap[w]})},get:function(){return j}}),u.socket=void 0,u.state=C,u.mode=r.mode,u.role=r.role,u.codec=r.codec,u.config={},u.timers={},u.timer_counter={},u.localStreams={},u.remoteStreams={},u.remoteMuteState={},u.attemps=1,u.p2p_attemps=1,u.audioLevel={},u.activeSpeaker=void 0,u.reconnectMode="retry",u.rejoinAttempt=0,u.hasChangeBGPAddress=!1,u.traffic_stats={},u.clientId=r.clientId,u.pingpongCounter=0,u.hasInvokeLeave=!1,u.p2ps=new Map,u.liveStreams=new Map,u.injectLiveStreams=new Map,u.remoteStreamsInChannel=new Set,Pe=lr,(w=u).makeRequest=function(qe,Ee,ut){if(void 0===w.socket)return S.default.error("[".concat(w.clientId,"] No socket available")),void Pe(ut,re_INVALID_OPERATION);try{w.socket.emitRequest(qe,function(ie,Ae){var nt;"success"===ie?"function"==typeof Ee&&Ee(Ae):"function"==typeof ut&&(nt=Ae&&Ae.error_code&&G[Ae.error_code]?G[Ae.error_code]:Ae&&Ae.error_str?Ae.error_str:Ae&&Ae.error_code?"UNKNOW_ERROR_".concat(Ae.error_code):ie,ut(nt,Ae))})}catch(ie){S.default.error("[".concat(w.clientId,"] Socket emit message failed ").concat(JSON.stringify(qe))),S.default.error("[".concat(w.clientId,"] "),ie),Pe(ut,re_SOCKET_ERROR)}},w.makeReport=function(qe){void 0===w.socket&&S.default.error("[".concat(w.clientId,"] No socket available"));try{w.socket.emitReport(qe)}catch{S.default.error("[".concat(w.clientId,"] Socket emit report failed ").concat(JSON.stringify(qe)))}},u.inChannelInfo={joinAt:null,duration:0},u._sendMessage=function(w,Pe){"SubscribeStats"===w&&sendMessage(b.apply(void 0,eo()(Pe)))};var W=lr;u.p2pCounter=Object(zt.f)(1e5),u.generateP2PId=function(){return++u.p2pCounter},u.audioVolumeIndication={enabled:!1,sortedAudioVolumes:[],smooth:3,interval:2e3},u.remoteVideoStreamTypes={REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2},u.streamFallbackTypes={STREAM_FALLBACK_OPTION_DISABLED:0,STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:1,STREAM_FALLBACK_OPTION_AUDIO_ONLY:2},u.configPublisher=function(w){u.config=w},u.getGatewayInfo=function(w,Pe){u.makeRequest({_type:"gateway_info"},w,Pe)},u.setClientRole=function(w,Pe){S.default.debug("[".concat(u.clientId,"] setClientRole to ").concat(w));var qe=L.b.reportApiInvoke(u.joinInfo.sid,{name:"_setClientRole",callback:Pe});u.makeRequest({_type:"set_client_role",_message:{role:w}},function(){u.role=w,u.dispatchEvent({type:"client-role-changed",role:w}),qe&&qe(null,{role:w})},function(Ee,ut){if(ut&&ut.code&&(Ee=ve[ut.code]||"UNKNOW_ERROR_"+ut.code),"ERR_ALREADY_IN_USE"===Ee)return qe&&qe(null);S.default.error("set Client role error to "+w+": "+Ee),qe&&qe(Ee)})},u.join=function(w,Pe,qe,Ee){w.useProxyServer&&(u.hasChangeBGPAddress=!0);var ut=(new Date).getTime(),ie=w.uid;if(u.inChannelInfo.joinAt&&(u.inChannelInfo.duration+=ut-u.inChannelInfo.joinAt),u.inChannelInfo.joinAt=ut,u.state!==O)return S.default.error("[".concat(u.clientId,"] GatewayClient.join Failed: state "),u.state),Ee&&Ee(re_INVALID_OPERATION),void L.b.joinGateway(w.sid,{lts:ut,succ:!1,ec:re_INVALID_OPERATION,addr:null});if(null!=ie&&parseInt(ie)!==ie)return S.default.error("[".concat(u.clientId,"] Input uid is invalid")),u.state=C,Ee&&Ee(re_INVALID_PARAMETER),void L.b.joinGateway(w.sid,{lts:ut,succ:!1,ec:re_INVALID_PARAMETER,addr:null});var Ae=no.register(u,{uid:ie,cname:w&&w.cname});if(Ae)return u.state=C,Ee&&Ee(Ae),void L.b.joinGateway(w.sid,{lts:ut,succ:!1,ec:Ae,addr:null});u.joinInfo=z()({},w),u.uid=ie,u.key=Pe,u.pingpongCounter=0,$(w,function(nt){var dt,yt,mt;u.state=P,S.default.debug("[".concat(u.clientId,"] Connected to gateway server")),clearInterval(u.pingTimer),u.pingTimer=setInterval(function(){var It=Object(M.getParameter)("PING_PONG_TIME_OUT");if(++u.pingpongCounter>=It){var vt=Date.now();S.default.warning("PINGPONG Timeout. Last Socket Message: ".concat(vt-u.socket.getLastMsgTime(),"ms")),u.socket&&u.socket.getLastMsgTime()&&vt-u.socket.getLastMsgTime()>Object(M.getParameter)("WEBSOCKET_TIMEOUT_MIN")&&(u.pingpongCounter=0,u.socket.close(),u.socket.dispatchEvent(Ce({type:"disconnect",event:{msg:"PING_PONG_TIME_OUT"}})))}var Pt=Date.now();u.makeRequest({_type:"ping"},function(){u.pingpongCounter=0;var T=Date.now()-Pt;setTimeout(function(){Object(M.getParameter)("REPORT_STATS")&&u.makeRequest({_type:"ping_back",_message:{pingpongElapse:T}})},1e3)},function(T,k){"TIMEOUT"!==T&&(S.default.error("Ping Error ".concat(T," ").concat(JSON.stringify(k))),k&&k.error_code&&u.socket&&u.socket.signal&&u.socket.signal.connection&&u.socket.signal.connection.readyState===WebSocket.OPEN&&(S.default.info("Disconnecting websocket connection"),u.socket.signal.connection.close()))})},3e3),u.makeRequest((dt=u.role,yt=z()({},u.joinInfo.apResponse),mt={session_id:u.joinInfo.sid,app_id:r.appId,channel_key:u.key,channel_name:u.joinInfo.cname,sdk_version:M.VERSION,browser:navigator.userAgent,process_id:Object(L.a)(),mode:u.mode,codec:u.codec,role:dt,has_changed_gateway:Object(M.getParameter)("FORCE_CHANGED_GATEWAY_FLAG")||u.hasChangeBGPAddress,ap_response:yt,extend:Object(M.getParameter)("JOIN_EXTEND"),details:{}},u.joinInfo.hasOwnProperty("stringUid")&&(mt.string_uid=u.joinInfo.stringUid),u.joinInfo.aesmode&&u.joinInfo.aespassword&&(mt.aes_mode=u.joinInfo.aesmode,mt.aes_secret=u.joinInfo.aespassword),u.socket&&u.socket.signal&&u.socket.signal&&(yt.addresses[u.socket.signal.hostIndex]&&(mt.ap_response.ticket=yt.addresses[u.socket.signal.hostIndex].ticket,delete yt.addresses),u.joinInfo.turnServer&&"auto"===u.joinInfo.turnServer.mode&&u.socket.signal.turnConfig&&(u.joinInfo.turnServer.url=u.socket.signal.turnConfig.url,u.socket.signal.turnConfig.tcpport&&(u.joinInfo.turnServer.tcpport=""+u.socket.signal.turnConfig.tcpport),u.socket.signal.turnConfig.udpport&&(u.joinInfo.turnServer.udpport=""+u.socket.signal.turnConfig.udpport)),S.default.debug("Turn config",u.joinInfo.turnServer)),u.dispatchEvent({type:"join-message-hook",joinMessage:mt}),{_type:"join",_message:mt}),function(It){if(L.b.joinGateway(w.sid,{lts:ut,succ:!0,ec:null,vid:w.vid,addr:u.socket.getURL()}),u.rejoinAttempt=0,qe&&qe(It.uid),u.dispatchEvent({type:"join"}),u.leaveOnConnected){S.default.info("[".concat(u.clientId,"] Calling Leave() once joined"));var vt=u.leaveOnConnected;u.leaveOnConnected=null,u.leave(vt.onSuccess,vt.onFailure)}},function(It,vt){if(S.default.error("[".concat(u.clientId,"] User join failed [").concat(It,"]")),"ERR_JOIN_BY_MULTI_IP"===It)return u.dispatchEvent({type:"onMultiIP",option:vt.option});if(yn[It]&&u.rejoinAttempt<4){if(u._doWithAction(yn[It],qe,Ee),u.leaveOnConnected){S.default.error("[".concat(u.clientId,"] Calling Leave() once joined: Join Failed"));var Pt=u.leaveOnConnected;u.leaveOnConnected=null,Pt.onFailure(re_JOIN_CHANNEL_FAILED)}}else Ee&&Ee(It);L.b.joinGateway(w.sid,{lts:ut,succ:!1,ec:It,addr:u.socket.getURL()})})},function(nt){S.default.error("[".concat(u.clientId,"] User join failed [").concat(nt,"]")),Ee&&Ee(nt),L.b.joinGateway(w.sid,{lts:ut,succ:!1,ec:nt,addr:u.socket.getURL()})}),clearInterval(u.timers.trafficStats),u.timers.trafficStats=setInterval(function(){u.makeRequest({_type:"traffic_stats"},function(nt){var st={};for(var dt in nt)st[wr(dt)]=nt[dt];if(st.peer_delay&&st.peer_delay.length){var yt=[];st.peer_delay.forEach(function(vt){var Pt={};for(var T in vt)Pt[wr(T)]=vt[T];yt.push(Pt)}),st.peer_delay=yt}u.traffic_stats=st;var It=u.localStreams[ie]||u.localStreams[u.joinInfo.stringUid];It&&(It.traffic_stats={access_delay:st.access_delay}),st.peer_delay&&st.peer_delay.forEach(function(vt){var Pt=u.remoteStreams[vt.peer_uid];Pt&&(Pt.traffic_stats={access_delay:st.access_delay,e2e_delay:vt.e2e_delay,audio_delay:vt.audio_delay,video_delay:vt.video_delay})}),u.dispatchEvent({type:"after-getTrafficStats",trafficStats:st})})},3e3),this.remoteMuteState={},u.resetAudioVolumeIndication()},u.leave=function(w,Pe){switch(u.state){case C:return S.default.debug("[".concat(u.clientId,"] Client Already in DISCONNECTED status")),void W(w);case F:return S.default.error("[".concat(u.clientId,"] Client Already in DISCONNECTING status")),void W(Pe,re_INVALID_OPERATION);case O:return u.leaveOnConnected?(S.default.error("[".concat(u.clientId,"] Client.leave() already called")),void W(Pe,re_INVALID_OPERATION)):1==u.reconnectingCS?void 0:(S.default.debug("[".concat(u.clientId,"] Client connecting. Waiting for Client Fully Connected(And leave)")),void(u.leaveOnConnected={onSuccess:w,onFailure:Pe}))}var qe=no.unregister(u);if(qe)S.default.error("[".concat(u.clientId,"] "),qe);else{for(var Ee in u.state=F,clearInterval(u.pingTimer),u.timers)u.timers.hasOwnProperty(Ee)&&clearInterval(u.timers[Ee]);for(var Ee in u.inChannelInfo.joinAt&&(u.inChannelInfo.duration+=Date.now()-u.inChannelInfo.joinAt,u.inChannelInfo.joinAt=null),u.makeRequest({_type:"leave"},function(Ae){u.socket.close(),u.socket=void 0,S.default.info("[".concat(u.clientId,"] Leave channel success")),u.state=C,w&&w(Ae)},function(Ae){S.default.error("[".concat(u.clientId,"] Leave Channel Failed"),Ae),u.state=P,Pe&&Pe(Ae)}),u.localStreams)if(u.localStreams.hasOwnProperty(Ee)){var ut=u.localStreams[Ee];delete u.localStreams[Ee],void 0!==ut.pc&&(ut.pc.close(),ut.pc=void 0)}tt()}},u.publish=function(w,Pe,qe,Ee){var ut=(new Date).getTime(),ie=!1;if(w.publishLTS=ut,"object"!==nn()(w)||null===w)return S.default.error("[".concat(u.clientId,"] Invalid local stream")),Ee&&Ee(re_INVALID_LOCAL_STREAM),void L.b.publish(u.joinInfo.sid,{lts:ut,succ:!1,audioName:w.hasAudio()&&w.audioName,videoName:w.hasVideo()&&w.videoName,screenName:w.hasScreen()&&w.screenName,ec:re_INVALID_LOCAL_STREAM});if(!w.stream&&void 0===w.url)return S.default.error("[".concat(u.clientId,"] Invalid local media stream")),Ee&&Ee(re_INVALID_LOCAL_STREAM),void L.b.publish(u.joinInfo.sid,{lts:ut,succ:!1,audioName:w.hasAudio()&&w.audioName,videoName:w.hasVideo()&&w.videoName,screenName:w.hasScreen()&&w.screenName,ec:re_INVALID_LOCAL_STREAM});if(u.state!==P)return S.default.error("[".concat(u.clientId,"] User is not in the session")),Ee&&Ee(re_INVALID_OPERATION),void L.b.publish(u.joinInfo.sid,{lts:ut,succ:!1,audioName:w.hasAudio()&&w.audioName,videoName:w.hasVideo()&&w.videoName,screenName:w.hasScreen()&&w.screenName,ec:re_INVALID_OPERATION});var Ae=w.getAttributes()||{};if(w.local&&void 0===u.localStreams[w.getId()]&&(w.hasAudio()||w.hasVideo()||w.hasScreen())){var nt=u.generateP2PId();if(u.p2ps.set(nt,w),w.p2pId=nt,void 0!==w.url)Ie(h({state:"url",audio:w.hasAudio(),video:w.hasVideo(),attributes:w.getAttributes(),mode:u.mode}),function(dt,yt){"success"===dt?(w.getUserId()!==yt&&w.setUserId(yt),u.localStreams[yt]=w,w.onClose=function(){u.unpublish(w)}):S.default.error("[".concat(u.clientId,"] Publish local stream failed"),dt)});else{u.localStreams[w.getId()]=w,w.connectionSpec={callback:function(dt){S.default.debug("[".concat(u.clientId,"] SDP exchange in publish : send offer --  "),JSON.parse(dt)),u.makeRequest(h({state:"offer",stream_type:1==Pe.streamType?"low":"high",p2p_id:nt,sdp:dt,audio:w.audio,video:w.screen||w.video,screen:w.screen,attributes:w.getAttributes(),dtx:w.DTX,hq:w.highQuality,lq:w.lowQuality,stereo:w.stereo,speech:w.speech,mode:u.mode,codec:u.codec,extend:Object(M.getParameter)("PUB_EXTEND")}),function(yt){w.getUserId()!==yt.uid&&w.setUserId(yt.uid),S.default.info("[".concat(u.clientId,"] Local stream published with uid"),yt.uid),w.onClose=function(){u.unpublish(w)},w._onAudioUnmute=function(){u.makeReport(c({action:"unmute_local_audio",stream_id:w.getId()}))},w._onVideoUnmute=function(){u.makeReport(c({action:"unmute_local_video",stream_id:w.getId()}))},w._onAudioMute=function(){u.makeReport(c({action:"mute_local_audio",stream_id:w.getId()}))},w._onVideoMute=function(){u.makeReport(c({action:"mute_local_video",stream_id:w.getId()}))},w.getId()===w.getUserId()&&(w.isAudioOn()||w.hasAudio()&&(S.default.debug("[".concat(u.clientId,"] local stream audio mute")),w._onAudioMute()),w.isVideoOn()||(w.hasVideo()||w.hasScreen())&&(S.default.debug("[".concat(u.clientId,"] local stream video mute")),w._onVideoMute())),w.pc.oniceconnectionstatechange=function(mt){if("failed"===mt){if(null!=u.timers[w.getId()]&&(clearInterval(u.timers[w.getId()]),clearInterval(u.timers[w.getId()]+"_RelatedStats")),S.default.error("[".concat(u.clientId,"] Publisher connection is lost -- streamId: ").concat(w.getId(),", p2pId: ").concat(nt)),u.p2ps.delete(nt),S.default.debug("[".concat(u.clientId,"] publish p2p failed: "),u.p2ps),!ie)return ie=!0,L.b.publish(u.joinInfo.sid,{lts:ut,succ:!1,audioName:w.hasAudio()&&w.audioName,videoName:w.hasVideo()&&w.videoName,screenName:w.hasScreen()&&w.screenName,ec:re_PEERCONNECTION_FAILED}),u.dispatchEvent(ce({type:"pubP2PLost",stream:w})),Ee&&Ee(re_PEERCONNECTION_FAILED);u.dispatchEvent(ce({type:"pubP2PLost",stream:w}))}else if("connected"===mt&&(S.default.debug("[".concat(u.clientId,"] publish p2p connected: "),u.p2ps),w._isAudioMuted()?u.makeReport(c({action:"mute_local_audio",stream_id:w.getId()})):u.makeReport(c({action:"unmute_local_audio",stream_id:w.getId()})),w._isVideoMuted()?u.makeReport(c({action:"mute_local_video",stream_id:w.getId()})):u.makeReport(c({action:"unmute_local_video",stream_id:w.getId()})),!ie))return ie=!0,L.b.publish(u.joinInfo.sid,{lts:ut,succ:!0,audioName:w.hasAudio()&&w.audioName,videoName:w.hasVideo()&&w.videoName,screenName:w.hasScreen()&&w.screenName,ec:null}),qe&&qe()},S.default.debug("[".concat(u.clientId,"] SDP exchange in publish : receive answer --  "),JSON.parse(yt.sdp)),w.pc.processSignalingMessage(yt.sdp)},function(yt,mt){S.default.error("Publish Failed: ".concat(yt)),L.b.publish(u.joinInfo.sid,{lts:ut,succ:!0,audioName:w.hasAudio()&&w.audioName,videoName:w.hasVideo()&&w.videoName,screenName:w.hasScreen()&&w.screenName,ec:yt}),"TIMEOUT"!=yt&&(u.processPublishFailure(w),Ee&&Ee(yt))})},audio:w.hasAudio(),video:w.hasVideo(),screen:w.hasScreen(),isSubscriber:!1,stunServerUrl:u.stunServerUrl,turnServer:u.joinInfo.turnServer,maxAudioBW:Ae.maxAudioBW,minVideoBW:Ae.minVideoBW,maxVideoBW:Ae.maxVideoBW,mode:u.mode,codec:u.codec,isVideoMute:w.userMuteVideo||w.peerMuteVideo,isAudioMute:w.userMuteAudio||w.peerMuteAudio,maxFrameRate:w.attributes.maxFrameRate,clientId:u.clientId},w.pc=hn(w.connectionSpec),w.pc.addStream(w.stream),S.default.debug("[".concat(u.clientId,"] PeerConnection add stream :"),w.stream),w.pc.onnegotiationneeded=function(dt){var yt={state:"negotiation",stream_type:1===Pe.streamType?"low":"high",p2p_id:nt,sdp:dt};u.makeRequest(h(yt),function(mt){S.default.debug("Negotating Stream ".concat(w.getId())),w.pc.processSignalingMessage(mt.sdp)},function(mt,It){S.default.error("Negotiation failed ".concat(mt),It,yt)})},clearInterval(u.timers[w.getId()]),u.timers[w.getId()]=setInterval(function(){if(Object(M.getParameter)("REPORT_STATS")){var dt=0;w&&w.pc&&w.pc.getStats&&w.pc.getStatsRate(function(yt){yt.forEach(function(mt){if(mt&&mt.id&&!/_recv$/.test(mt.id)&&!/^time$/.test(mt.id)&&w.getUserId())if(-1===mt.id.indexOf("outbound_rtp")&&-1===mt.id.indexOf("OutboundRTP")||"video"!==mt.mediaType||(mt.googFrameWidthSent=w.videoWidth+"",mt.googFrameHeightSent=w.videoHeight+""),w.getId()==w.getUserId()){var It=200*dt;dt++,setTimeout(function(){var Pt,T,vt=u.socket&&u.socket.getLastMsgTime()&&Date.now()-u.socket.getLastMsgTime();vt>Object(M.getParameter)("REPORT_STATS_TIMEOUT")?S.default.debug("PublishStats report blocked by REPORT_STATS_TIMEOUT ".concat(vt)):u.makeReport((Pt=mt,T={},Object.keys(Pt).forEach(function(k){Object(M.getParameter)("STATS_FILTER")[k]||(T[bt(k)]=Pt[k])}),{_type:"publish_stats",_message:{stream_type:"high",stats:T}}))},It)}else It=200*dt,dt++,setTimeout(function(){var Pt,T,vt=u.socket&&u.socket.getLastMsgTime()&&Date.now()-u.socket.getLastMsgTime();vt>Object(M.getParameter)("REPORT_STATS_TIMEOUT")?S.default.debug("PublishStatsLow report blocked by REPORT_STATS_TIMEOUT ".concat(vt)):u.makeReport((Pt=mt,T={},Object.keys(Pt).forEach(function(k){Object(M.getParameter)("STATS_FILTER")[k]||(T[bt(k)]=Pt[k])}),{_type:"publish_stats",_message:{stream_type:"low",stats:T}}))},It)})})}},3e3);var st=function(){Object(M.getParameter)("REPORT_STATS")&&w&&w.pc&&w.pc.getVideoRelatedStats&&w.pc.getVideoRelatedStats(function(dt){var yt,mt,vt,Pt,It=u.socket&&u.socket.getLastMsgTime()&&Date.now()-u.socket.getLastMsgTime();It>Object(M.getParameter)("REPORT_STATS_TIMEOUT")?S.default.debug("PublishRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(It)):w.getId()===w.getUserId()?u.makeReport((yt=dt,mt={},Object.keys(yt).forEach(function(vt){Object(M.getParameter)("STATS_FILTER")[vt]||(mt[bt(vt)]=yt[vt])}),{_type:"publish_related_stats",_message:{stream_type:"high",stats:mt}})):u.makeReport((vt=dt,Pt={},Object.keys(vt).forEach(function(T){Object(M.getParameter)("STATS_FILTER")[T]||(Pt[bt(T)]=vt[T])}),{_type:"publish_related_stats",_message:{stream_type:"low",stats:Pt}}))})};st(),clearInterval(u.timers[w.getId()+"_RelatedStats"]),u.timers[w.getId()+"_RelatedStats"]=setInterval(st,1e3)}}},u.unpublish=function(w,Pe,qe,Ee){if("object"!==nn()(w)||null===w)return S.default.error("[".concat(u.clientId,"] Invalid local stream")),void W(Ee,re_INVALID_LOCAL_STREAM);if(u.state!==P)return S.default.error("[".concat(u.clientId,"] User not in the session")),void W(Ee,re_INVALID_OPERATION);if(null!=u.timers[w.getId()]&&(clearInterval(u.timers[w.getId()]),clearInterval(u.timers[w.getId()+"_RelatedStats"])),void 0!==u.socket)if(w.local&&void 0!==u.localStreams[w.getId()]){delete u.localStreams[w.getId()];var ut={stream_id:w.getUserId(),stream_type:1===Pe.streamType?"low":"high"};u.makeRequest({_type:"unpublish",_message:ut}),(w.hasAudio()||w.hasVideo()||w.hasScreen())&&void 0===w.url&&void 0!==w.pc&&(w.pc.close(),w.pc=void 0),w.onClose=void 0,w._onAudioMute=void 0,w._onAudioUnute=void 0,w._onVideoMute=void 0,w._onVideoUnmute=void 0,u.p2ps.delete(w.p2pId),u.dispatchEvent({type:"stream-unpublished",stream:w,options:Pe}),qe&&qe()}else S.default.error("[".concat(u.clientId,"] Invalid local stream")),W(Ee,re_INVALID_LOCAL_STREAM);else S.default.error("[".concat(u.clientId,"] User not in the session")),W(Ee,re_INVALID_OPERATION)},u.subscribe=function(w,Pe,qe){var Ee=(new Date).getTime();w.subscribeLTS=Ee;var ut=!1;if(S.default.info("[".concat(u.clientId,"] Gatewayclient ").concat(u.uid," Subscribe ").concat(w.getId(),": ").concat(JSON.stringify(w.subscribeOptions))),"object"!==nn()(w)||null===w)return S.default.error("[".concat(u.clientId,"] Invalid remote stream")),qe&&qe(re_INVALID_REMOTE_STREAM),void L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!1,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:re_INVALID_REMOTE_STREAM});if(u.state!==P&&(S.default.error("[".concat(u.clientId,"] User is not in the session")),!ut))return ut=!0,L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!1,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:re_INVALID_OPERATION}),qe&&qe(re_INVALID_OPERATION);if(!w.local&&u.remoteStreams.hasOwnProperty(w.getId()))if(w.hasAudio()||w.hasVideo()||w.hasScreen()){var ie=u.generateP2PId();u.p2ps.set(ie,w),w.p2pId=ie,w.pc=hn({callback:function(Ae){S.default.debug("[".concat(u.clientId,"] SDP exchange in subscribe : send offer --  "),JSON.parse(Ae));var nt={stream_id:w.getId(),audio:!w.subscribeOptions||w.subscribeOptions.audio,video:!w.subscribeOptions||w.subscribeOptions.video,mode:u.mode,codec:u.codec,p2p_id:ie,sdp:Ae,tcc:Object(M.getParameter)("SUBSCRIBE_TCC"),extend:Object(M.getParameter)("SUB_EXTEND")};u.makeRequest({_type:"subscribe",_message:nt},function(st){S.default.debug("[".concat(u.clientId,"] SDP exchange in subscribe : receive answer --  "),JSON.parse(st.sdp)),w.pc.processSignalingMessage(st.sdp)},function(st,dt){S.default.error("[".concat(u.clientId,"] Subscribe remote stream Failed: ").concat(st,", closing stream "),w.getId(),dt),L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!1,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:st}),"TIMEOUT"!=err&&(u.processSubscribeFailure(w),qe&&qe(st))})},nop2p:!0,audio:!0,video:!0,screen:w.hasScreen(),isSubscriber:!0,stunServerUrl:u.stunServerUrl,turnServer:u.joinInfo.turnServer,isVideoMute:w.userMuteVideo,isAudioMute:w.userMuteAudio,uid:w.getId(),clientId:u.clientId}),w.pc.onaddstream=function(Ae,nt){if(w._onAudioUnmute=function(){u.makeRequest(c({action:"unmute_remote_audio",stream_id:w.getId()}),function(){},function(){})},w._onAudioMute=function(){u.makeRequest(c({action:"mute_remote_audio",stream_id:w.getId()}),function(){},function(){})},w._onVideoUnmute=function(){u.makeRequest(c({action:"unmute_remote_video",stream_id:w.getId()}),function(){},function(){})},w._onVideoMute=function(){u.makeRequest(c({action:"mute_remote_video",stream_id:w.getId()}),function(){},function(){})},"ontrack"===nt&&"video"===Ae.track.kind||"onaddstream"===nt){S.default.info("[".concat(u.clientId,"] Remote stream subscribed with uid "),w.getId());var st=u.remoteStreams[w.getId()];if(u.remoteStreams[w.getId()].stream="onaddstream"===nt?Ae.stream:Ae.streams[0],u.remoteStreams[w.getId()].hasVideo()){if(Object(Y.isFireFox)()||Object(Y.isSafari)()){var dt=u.remoteStreams[w.getId()].stream;Object(zt.g)(dt,function(It,vt){w.videoWidth=It,w.videoHeight=vt},function(It){return S.default.warning("[".concat(u.clientId,"] vsResHack failed: ")+It)})}}else{var yt=u.remoteStreams[w.getId()];yt.peerMuteVideo=!0,u._adjustPCMuteStatus(yt)}st&&st.isPlaying()&&st.elementID&&(S.default.debug("[".concat(u.clientId,"] Reload Player ").concat(st.elementID," StreamId ").concat(st.getId())),w.audioOutput=st.audioOutput,st.stop(),w.play(st.elementID,st.playOptions)),delete w.audioLevelHelper;var mt=pe({type:"stream-subscribed",stream:u.remoteStreams[w.getId()]});u.dispatchEvent(mt)}},clearInterval(u.timers[w.getId()]),u.timers[w.getId()]=setInterval(function(){if(Object(M.getParameter)("REPORT_STATS")){var Ae=0;w&&w.pc&&w.pc.getStats&&w.pc.getStatsRate(function(nt){nt.forEach(function(st){if(st&&st.id){if(/_send$/.test(st.id)||/^time$/.test(st.id)||/^bweforvideo$/.test(st.id))return;-1===st.id.indexOf("inbound_rtp")&&-1===st.id.indexOf("inbound-rtp")||"video"!==st.mediaType||(st.googFrameWidthReceived=w.videoWidth+"",st.googFrameHeightReceived=w.videoHeight+"");var dt=200*Ae;Ae++;var yt=w.getId();setTimeout(function(){var mt=u.socket&&u.socket.getLastMsgTime()&&Date.now()-u.socket.getLastMsgTime();mt>Object(M.getParameter)("REPORT_STATS_TIMEOUT")?S.default.debug("SubscribeStats report blocked by REPORT_STATS_TIMEOUT ".concat(mt)):u.makeReport(b(yt,st))},dt)}})})}},3e3),clearInterval(u.timers[w.getId()+"_RelatedStats"]),u.timers[w.getId()+"_RelatedStats"]=setInterval(function(){if(Object(M.getParameter)("REPORT_STATS")&&w&&w.pc){var Ae=u.socket&&u.socket.getLastMsgTime()&&Date.now()-u.socket.getLastMsgTime();if(Ae>Object(M.getParameter)("REPORT_STATS_TIMEOUT"))return void S.default.debug("SubscribeRelatedStats report blocked by REPORT_STATS_TIMEOUT ".concat(Ae));w.pc.getVideoRelatedStats&&w.pc.getVideoRelatedStats(function(nt){u.makeReport(v(w.getId(),nt))}),w.pc.getAudioRelatedStats&&w.pc.getAudioRelatedStats(function(nt){u.makeReport(v(w.getId(),nt))})}},1e3),u.audioLevel[w.getId()]=0,clearInterval(u.timers[w.getId()+"audio"]),u.timers[w.getId()+"audio"]=setInterval(function(){u.hasListeners("active-speaker")&&w&&w.pc&&"established"===w.pc.state&&w.pc.getStats&&w.pc.getStats(function(Ae){Ae.forEach(function(nt){if("audio"===nt.mediaType){if(nt.audioOutputLevel>5e3)for(var st in u.audioLevel[w.getId()]<20&&(u.audioLevel[w.getId()]+=1),u.audioLevel)st!==""+w.getId()&&u.audioLevel[st]>0&&(u.audioLevel[st]-=1);var dt=Object.keys(u.audioLevel).sort(function(mt,It){return u.audioLevel[It]-u.audioLevel[mt]});if(u.activeSpeaker!==dt[0]){var yt=ce({type:"active-speaker",uid:dt[0]});u.dispatchEvent(yt),u.activeSpeaker=dt[0],S.default.debug("[".concat(u.clientId,"] Update active speaker: ").concat(u.activeSpeaker))}}})},50)},50),w.pc.oniceconnectionstatechange=function(Ae){if("failed"===Ae)null!=u.timers[w.getId()]&&(clearInterval(u.timers[w.getId()]),clearInterval(u.timers[w.getId()]+"audio")),S.default.error("[".concat(u.clientId,"] Subscriber connection is lost -- streamId: ").concat(w.getId(),", p2pId: ").concat(ie)),S.default.debug("[".concat(u.clientId,"] subscribe p2p failed: "),u.p2ps),ut||(ut=!0,qe&&qe(re_PEERCONNECTION_FAILED),L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!1,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:re_PEERCONNECTION_FAILED})),u.remoteStreams[w.getId()]&&u.p2ps.has(ie)&&(u.p2ps.delete(ie),u.dispatchEvent(ce({type:"subP2PLost",stream:w})));else if("connected"===Ae&&(S.default.debug("[".concat(u.clientId,"] subscribe p2p connected: "),u.p2ps),!ut)){ut=!0,L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!0,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:null}),u._adjustPCMuteStatus(w);var nt=!1,st=setInterval(function(){w.pc?w.pc.getStats(function(mt){mt.forEach(function(It){-1!==It.id.indexOf("recv")&&"audio"===It.mediaType&&parseInt(It.googDecodingNormal)>0&&(nt||(nt=!0,u.dispatchEvent({type:"first-audio-frame-decode",stream:w}),clearInterval(st),L.b.reportApiInvoke(u.joinInfo.sid,{name:"firstAudioDecode"})(null,{elapse:Date.now()-w.subscribeLTS})))})},100):clearInterval(st)},100),dt=!1,yt=setInterval(function(){w.pc?w.pc.getStats(function(mt){mt.forEach(function(It){-1===It.id.indexOf("recv")&&-1===It.id.indexOf("inbound_rtp")&&-1===It.id.indexOf("inbound-rtp")&&-1===It.id.indexOf("InboundRTP")||"video"===It.mediaType&&(It.framesDecoded>0||It.googFramesDecoded>0)&&(dt||(dt=!0,u.dispatchEvent({type:"first-video-frame-decode",stream:w}),clearInterval(yt),w.firstFrameTime=(new Date).getTime()-w.subscribeLTS,L.b.firstRemoteFrame(u.joinInfo.sid,{lts:(new Date).getTime(),peerid:w.getId(),succ:!0,width:+It.googFrameWidthReceived,height:+It.googFrameHeightReceived})))})},100):clearInterval(yt)},100);return w.sid=u.joinInfo.sid,Pe&&Pe()}}}else S.default.error("[".concat(u.clientId,"] Invalid remote stream")),ut||(ut=!0,qe&&qe(re_INVALID_REMOTE_STREAM),L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!1,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:re_INVALID_REMOTE_STREAM}));else S.default.error("[".concat(u.clientId,"] No such remote stream")),ut||(ut=!0,qe&&qe(re_NO_SUCH_REMOTE_STREAM),L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!1,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:re_NO_SUCH_REMOTE_STREAM}))},u.subscribeChange=function(w,Pe,qe){var Ee=Date.now();S.default.info("[".concat(u.clientId,"] Gatewayclient ").concat(u.uid," SubscribeChange ").concat(w.getId(),": ").concat(JSON.stringify(w.subscribeOptions))),u._adjustPCMuteStatus(w);var ut={stream_id:w.getId(),audio:w.subscribeOptions.audio,video:w.subscribeOptions.video};u.makeRequest({_type:"subscribe_change",_message:ut},function(ie){var Ae=pe({type:"stream-subscribe-changed",stream:u.remoteStreams[w.getId()]});L.b.subscribe(u.joinInfo.sid,{lts:Ee,succ:!0,video:w.subscribeOptions&&w.subscribeOptions.video,audio:w.subscribeOptions&&w.subscribeOptions.audio,peerid:w.getId(),ec:null}),u.dispatchEvent(Ae),Pe&&Pe()},function(ie,Ae){S.default.error("[".concat(u.clientId,"] Subscribe Change Failed ").concat(w.getId()),ie,Ae),qe&&qe(ie,Ae)})},u.processPublishFailure=function(w){w.publishLTS=null,w.p2pId&&u.p2ps.get(w.p2pId)===w&&u.p2ps.delete(w.p2pId),u.localStreams[w.getUserId()]===w&&delete u.localStreams[w.getUserId()],u.localStreams[w.getId()]===w&&delete u.localStreams[w.getId()],w.pc&&(w.pc.processSignalingMessage=function(){},w.pc.oniceconnectionstatechange=function(){},w.pc.close(),delete w.pc),delete w.onClose,delete w._onAudioUnmute,delete w._onVideoUnmute,delete w._onAudioMute,delete w._onVideoMute,delete w._onAudioUnmute},u.processSubscribeFailure=function(w){w.p2pId&&u.p2ps.get(w.p2pId)===w&&u.p2ps.delete(w.p2pId),u.remoteStreams[w.getId()]===w&&delete u.remoteStreams[w.getId()],u.remoteStreams[w.getId()]===w&&delete u.remoteStreams[w.getId()],w.pc&&(w.pc.onaddstream=function(){},w.pc.processSignalingMessage=function(){},w.pc.oniceconnectionstatechange=function(){},w.pc.close(),delete w.pc),delete w.onClose,delete w._onAudioUnmute,delete w._onVideoUnmute,delete w._onAudioMute,delete w._onVideoMute,delete w._onAudioUnmute},u._adjustPCMuteStatus=function(w){!w.local&&w.pc&&w.pc.peerConnection.getReceivers&&w.pc.peerConnection.getReceivers().forEach(function(Pe){if(Pe&&Pe.track&&"audio"===Pe.track.kind){var qe=!w.userMuteAudio&&!w.peerMuteAudio;w.subscribeOptions&&!w.subscribeOptions.audio&&(qe=!1),Pe.track.enabled=!!qe}else if(Pe&&Pe.track&&"video"===Pe.track.kind){var Ee=!w.userMuteVideo&&!w.peerMuteVideo;w.subscribeOptions&&!w.subscribeOptions.video&&(Ee=!1),Pe.track.enabled=!!Ee}})},u.unsubscribe=function(w,Pe,qe){if("object"!==nn()(w)||null===w)return S.default.error("[".concat(u.clientId,"] Invalid remote stream")),void W(qe,re_INVALID_REMOTE_STREAM);if(u.state!==P)return S.default.error("[".concat(u.clientId,"] User is not in the session")),void W(qe,re_INVALID_OPERATION);if(null!=u.timers[w.getId()]&&(clearInterval(u.timers[w.getId()]),clearInterval(u.timers[w.getId()]+"audio")),null!=u.audioLevel[w.getId()]&&delete u.audioLevel[w.getId()],null!=u.timer_counter[w.getId()]&&delete u.timer_counter[w.getId()],u.remoteStreams.hasOwnProperty(w.getId())){if(!u.socket)return S.default.error("[".concat(u.clientId,"] User is not in the session")),void W(qe,re_INVALID_OPERATION);if(w.local)return S.default.error("[".concat(u.clientId,"] Invalid remote stream")),void W(qe,re_INVALID_REMOTE_STREAM);w.close();var Ee={stream_id:w.getId()};u.makeRequest({_type:"unsubscribe",_message:Ee}),void 0!==w.pc&&(w.pc.close(),w.pc=void 0),w.onClose=void 0,w._onAudioMute=void 0,w._onAudioUnute=void 0,w._onVideoMute=void 0,w._onVideoUnmute=void 0,delete w.subscribeOptions,u.p2ps.delete(w.p2pId),S.default.info("[".concat(u.clientId,"] Unsubscribe stream success")),Pe&&Pe()}else W(qe,re_NO_SUCH_REMOTE_STREAM)},u.setRemoteVideoStreamType=function(w,Pe){if(S.default.debug("[".concat(u.clientId,"] Switching remote video stream ").concat(w.getId()," to ").concat(Pe)),"object"===nn()(w)&&null!==w)if(u.state===P){if(!w.local){switch(Pe){case u.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_HIGH:case u.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_LOW:case u.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_MEDIUM:break;default:return}var qe={stream_id:w.getId(),stream_type:Pe};u.makeRequest({_type:"switch_video_stream",_message:qe},function(){S.default.debug("SwitchVideoStream Success ".concat(qe.stream_id," ").concat(qe.stream_type))},function(Ee,ut){S.default.error("SwitchVideoStream Error ".concat(Ee," ").concat(qe.stream_id," ").concat(qe.stream_type),ut)})}}else S.default.error("[".concat(u.clientId,"] User is not in the session"));else S.default.error("[".concat(u.clientId,"] Invalid remote stream"))},u.renewToken=function(w,Pe,qe){w?u.key?u.state!==P?(S.default.debug("[".concat(u.clientId,"] Client is not connected. Trying to rejoin")),u.key=w,u.rejoin(),Pe&&Pe()):(S.default.debug("[".concat(u.clientId,"] renewToken from ").concat(u.key," to ").concat(w)),u.makeRequest({_type:"renew_token",_message:{token:w}},Pe,qe)):(S.default.error("[".concat(u.clientId,"] Client is previously joined without token")),qe&&qe(re_INVALID_PARAMETER)):(S.default.error("[".concat(u.clientId,"] Invalid Token ").concat(w)),qe&&qe(re_INVALID_PARAMETER))},u.setStreamFallbackOption=function(w,Pe){if(S.default.debug("[".concat(u.clientId,"] Set stream fallback option ").concat(w.getId()," to ").concat(Pe)),"object"===nn()(w)&&null!==w)if(u.state===P){if(!w.local){switch(Pe){case u.streamFallbackTypes.STREAM_FALLBACK_OPTION_DISABLED:case u.streamFallbackTypes.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:case u.streamFallbackTypes.STREAM_FALLBACK_OPTION_AUDIO_ONLY:break;default:return}var qe={stream_id:w.getId(),fallback_type:Pe};u.makeRequest({_type:"set_fallback_option",_message:qe},function(){S.default.debug("SetStreamFallbackOption success ".concat(qe.stream_id," ").concat(Pe))},function(Ee,ut){S.default.error("Failed to SetStreamFallbackOption ".concat(qe.stream_id," ").concat(Pe," ").concat(Ee),ut)})}}else S.default.error("[".concat(u.clientId,"] User is not in the session"));else S.default.error("[".concat(u.clientId,"] Invalid remote stream"))},u.enableAudioVolumeIndicator=function(w,Pe){u.audioVolumeIndication.enabled=!0,u.audioVolumeIndication.interval=w,u.audioVolumeIndication.smooth=Pe,u.resetAudioVolumeIndication()},u.resetAudioVolumeIndication=function(){if(clearInterval(u.timers.audioVolumeIndication),clearInterval(u.timers.audioVolumeSampling),u.audioVolumeIndication.enabled&&u.audioVolumeIndication.interval){var w=Math.floor(1e3*u.audioVolumeIndication.smooth/100);clearInterval(u.timers.audioVolumeSampling),u.timers.audioVolumeSampling=setInterval(function(){u.audioVolumeSampling||(u.audioVolumeSampling={});var Pe={};for(var qe in u.remoteStreams){var Ee=u.remoteStreams[qe];if(Ee.stream&&Ee.hasAudio()){var ut=Ee.getAudioLevel();ut>0&&ut<1&&(ut*=100);var ie=u.audioVolumeSampling[qe]||[];for(ie.push(ut);ie.length>w;)ie.shift();Pe[qe]=ie}}u.audioVolumeSampling=Pe},100),clearInterval(u.timers.audioVolumeIndication),u.timers.audioVolumeIndication=setInterval(function(){if(u.socket&&u.socket.signal&&u.socket.signal.connection&&u.socket.signal.connection.readyState===WebSocket.OPEN){var Pe=[];for(var qe in u.remoteStreams)if(u.audioVolumeSampling&&u.audioVolumeSampling[qe]){var Ee=u.audioVolumeSampling[qe],ut=0;Ee.forEach(function(st){ut+=st});var ie={uid:qe,level:Math.floor(ut/Ee.length)};ie.level&&Pe.push(ie)}var Ae=Pe.sort(function(st,dt){return st.level-dt.level});S.default.debug("[".concat(u.clientId,"] volume-indicator "),JSON.stringify(Ae)),u.audioVolumeIndication.sortedAudioVolumes=Ae;var nt=ce({type:"volume-indicator",attr:Ae});u.dispatchEvent(nt)}},u.audioVolumeIndication.interval)}},u.closeGateway=function(){S.default.debug("[".concat(u.clientId,"] close gateway")),u.state=C,u.socket.close(),ne()};var Q=function(){S.default.debug("[".concat(u.clientId,"] Reconnect gateway")),u.state=C,u.socket.close(),ne(),u.reconnectMode="recover",u.state=O,Oe()};u.recover=Q;var ne=function(){for(var w in u.dispatchEvent({type:"before-clear-connection"}),u.timers)u.timers.hasOwnProperty(w)&&clearInterval(u.timers[w]);for(var w in u.remoteStreams)if(u.remoteStreams.hasOwnProperty(w)){var Pe=u.remoteStreams[w],qe=ce({type:"stream-removed",uid:Pe.getId(),stream:Pe});u.dispatchEvent(qe)}u.p2ps.clear(),tt(),We(),clearInterval(u.pingTimer)};u.rejoin=function(){u.socket&&(clearInterval(u.pingTimer),u.socket.close(),u.socket=void 0),u.state=O,Oe()};var Oe=function(w,Pe){u.dispatchEvent(ce({type:"rejoin-start"})),w=w||function(qe){S.default.info("[".concat(u.clientId,"] User ").concat(qe," is re-joined to ").concat(u.joinInfo.cname)),u.dispatchEvent(ce({type:"rejoin"})),u.liveStreams&&u.liveStreams.size&&u.liveStreams.forEach(function(Ee,ut){Ee&&u.setLiveTranscoding(u.transcoding),u.startLiveStreaming(ut,Ee)}),u.injectLiveStreams&&u.injectLiveStreams.size&&u.injectLiveStreams.forEach(function(Ee,ut){u.addInjectStreamUrl(ut,Ee)})},Pe=Pe||function(qe){S.default.error("[".concat(u.clientId,"] Re-join to channel failed "),qe),u.dispatchEvent(pe({type:"error",reason:qe}))},u.key?(++u.rejoinAttempt,u.join(u.joinInfo,u.key,w,Pe)):S.default.error("[".concat(u.clientId,"] Connection recover failed [Invalid channel key]"))},$=function(w,Pe,qe){if(u.onConnect=Pe,u.socket){if(u.dispatchEvent({type:"reconnect"}),"retry"===u.reconnectMode)S.default.debug("[".concat(u.clientId,"] Retry current gateway")),u.socket.reconnect();else if("tryNext"===u.reconnectMode)S.default.debug("[".concat(u.clientId,"] Try next gateway")),u.socket.connectNext();else if("recover"===u.reconnectMode){S.default.debug("[".concat(u.clientId,"] Recover gateway")),S.default.debug("[".concat(u.clientId,"] Try to reconnect choose server and get gateway list again ")),u.reconnectingCS=!0;var Ee=u.joinInfo&&u.joinInfo.sid;Ft(u.joinInfo,function(ie){S.default.debug("[".concat(u.clientId,"] session:  ").concat(Ee," get gateway list success")),u.joinInfo.apResponse=ie.res,u.reconnectingCS?u.socket.replaceHost(ie.gateway_addr):S.default.debug("[".concat(u.clientId,"] session:  ").concat(Ee," already leave"))})}}else u.socket=_r(w.gatewayAddr,{sid:u.joinInfo.sid,clientId:u.clientId}),u.socket.on("start-connection",function(ie){u.ticket=ie&&ie.msg&&ie.msg.ticket}),u.socket.on("on_uplink_stats",function(ie){var Ae={};for(var nt in ie)Ae[wr(nt)]=ie[nt];u.OutgoingAvailableBandwidth=Ae.uplink_available_bandwidth,u.localStreams[u.uid]&&(u.localStreams[u.uid].uplinkStats=Ae)}),u.socket.on("connect",function(){u.dispatchEvent({type:"connected"}),u.attemps=1,u.onConnect()}),u.socket.on("recover",function(){u.state=O,S.default.debug("[".concat(u.clientId,"] Try to reconnect choose server and get gateway list again ")),u.reconnectingCS=!0,u.leaveOnConnected=null;var ie=u.joinInfo&&u.joinInfo.sid;Ft(u.joinInfo,function(Ae){S.default.debug("[".concat(u.clientId,"] session:  ").concat(ie," get gateway list success")),u.reconnectingCS?u.socket.replaceHost(Ae.gateway_addr):S.default.debug("[".concat(u.clientId,"] session:  ").concat(ie," already leave"))})}),u.socket.on("disconnect",function(ie){if(S.default.debug("[".concat(u.clientId,"] Receive disconnect message")),u.state!==C){u.state=C;var Ae=pe({type:"error",reason:re_SOCKET_DISCONNECTED});if(u.dispatchEvent(Ae),u.reconnectMode=0===u.p2ps.size?"tryNext":"retry",ne(),1!=I){var st=1e3*Math.min(30,Math.pow(2,u.attemps)-1);if(S.default.error("[".concat(u.clientId,"] Disconnect from server [").concat(JSON.stringify(ie),"], attempt to recover [#").concat(u.attemps,"] after ").concat(st/1e3," seconds")),u.hasInvokeLeave)return S.default.debug("[".concat(u.clientId,"] No reconnection becase client.leave has been invoked")),void(u.hasInvokeLeave=!1);setTimeout(function(){u.attemps++,u.state=O,u.inChannelInfo&&Date.now()-u.inChannelInfo.joinAt>Object(M.getParameter)("TICKET_RENEW_TIMEOUT")?(S.default.debug("Recovering to renew ticket"),Q()):Oe()},st)}}}),u.socket.on("on_add_audio_stream",function(ie){if(S.default.info("[".concat(u.clientId,"] Newly added audio stream with uid ").concat(ie.uid)),u.joinInfo.stringUid&&"string"!=typeof ie.uid&&S.default.error("StringUID is Mixed with UintUID"),u.remoteStreamsInChannel.has(ie.uid)||u.remoteStreamsInChannel.add(ie.uid),void 0===u.remoteStreams[ie.uid]){var Ae=En({streamID:ie.uid,local:!1,audio:ie.audio,video:ie.video});Ae.peerMuteVideo=!0,u.remoteStreams[ie.uid]=Ae;var nt=pe({type:"stream-added",stream:Ae});u.dispatchEvent(nt);var st=u.remoteMuteState[ie.uid];st&&st.audio&&(nt=ce({type:"mute-audio",uid:ie.uid}),u.dispatchEvent(nt)),st&&st.video&&(nt=ce({type:"mute-video",uid:ie.uid}),u.dispatchEvent(nt))}}),u.socket.on("on_update_stream",function(ie){var Ae=u.remoteStreams[ie.uid];if(u.joinInfo.stringUid&&"string"!=typeof ie.uid&&S.default.error("StringUID is Mixed with UintUID"),Ae){Ae.audio=ie.audio,Ae.video=ie.video,Ae.screen=ie.screen,Ae.pc&&u._adjustPCMuteStatus(Ae);var nt=pe({type:"stream-updated",stream:Ae});u.dispatchEvent(nt)}else S.default.debug("[".concat(u.clientId,"] Ignoring onUpdateStream event before onAddStream for uid ").concat(ie.uid))}),u.socket.on("on_add_video_stream",function(ie){if(S.default.info("[".concat(u.clientId,"] Newly added remote stream with uid ").concat(ie.uid,".")),u.joinInfo.stringUid&&"string"!=typeof ie.uid&&S.default.error("StringUID is Mixed with UintUID"),u.remoteStreamsInChannel.has(ie.uid)||u.remoteStreamsInChannel.add(ie.uid),void 0===u.remoteStreams[ie.uid]){var Ae=En({streamID:ie.uid,local:!1,audio:ie.audio,video:ie.video});u.remoteStreams[ie.uid]=Ae;var nt=pe({type:"stream-added",stream:Ae});u.dispatchEvent(nt);var st=u.remoteMuteState[ie.uid];st&&st.audio&&(nt=ce({type:"mute-audio",uid:ie.uid}),u.dispatchEvent(nt)),st&&st.video&&(nt=ce({type:"mute-video",uid:ie.uid}),u.dispatchEvent(nt))}else{var dt=u.remoteStreams[ie.uid];if(void 0!==dt.stream){if((Ae=u.remoteStreams[ie.uid]).video=!0,Ae.peerMuteVideo=!1,Ae.pc&&u._adjustPCMuteStatus(Ae),S.default.info("[".concat(u.clientId,"] Stream changed: enable video ").concat(ie.uid)),Ae.isPlaying()){var yt=Ae.player.elementID;Ae.stop(),Ae.play(yt,Ae.playOptions)}}else dt.p2pId?u.remoteStreams[ie.uid].video=!0:(Ae=En({streamID:ie.uid,local:!1,audio:!0,video:!0}),u.remoteStreams[ie.uid]=Ae,S.default.info("[".concat(u.clientId,"] Stream changed: modify video ").concat(ie.uid)))}}),u.socket.on("on_remove_stream",function(ie){u.remoteStreamsInChannel.has(ie.uid)&&u.remoteStreamsInChannel.delete(ie.uid);var Ae=u.remoteStreams[ie.uid];if(Ae){delete u.remoteStreams[ie.uid],delete u.remoteMuteState[ie.uid];var nt=pe({type:"stream-removed",stream:Ae});u.dispatchEvent(nt),Ae.close(),void 0!==Ae.pc&&(Ae.pc.close(),Ae.pc=void 0,u.p2ps.delete(Ae.p2pId))}else S.default.error("ERROR stream ",ie.uid," not found onRemoveStream ",ie)}),u.socket.on("on_publish_stream",function(ie){var nt=pe({type:"streamPublished",stream:u.localStreams[ie.uid]});u.dispatchEvent(nt)}),u.socket.on("mute_audio",function(ie){S.default.info("[".concat(u.clientId,"] rcv peer mute audio: ").concat(ie.uid)),u.remoteMuteState[ie.uid]=u.remoteMuteState[ie.uid]||{audio:!1,video:!1},u.remoteMuteState[ie.uid].audio=!0;var Ae=ce({type:"mute-audio",uid:ie.uid}),nt=u.remoteStreams[ie.uid];nt?(nt.peerMuteAudio=!0,nt.pc&&u._adjustPCMuteStatus(nt),u.dispatchEvent(Ae)):S.default.debug("Ignoring event ".concat(ie.type),ie)}),u.socket.on("unmute_audio",function(ie){S.default.info("[".concat(u.clientId,"] rcv peer unmute audio: ").concat(ie.uid)),u.remoteMuteState[ie.uid]=u.remoteMuteState[ie.uid]||{audio:!1,video:!1},u.remoteMuteState[ie.uid].audio=!1;var Ae=ce({type:"unmute-audio",uid:ie.uid}),nt=u.remoteStreams[ie.uid];nt?(nt.peerMuteAudio=!1,nt.pc&&u._adjustPCMuteStatus(nt),u.dispatchEvent(Ae)):S.default.debug("Ignoring event ".concat(ie.type),ie)}),u.socket.on("mute_video",function(ie){S.default.info("[".concat(u.clientId,"] rcv peer mute video: ").concat(ie.uid)),u.remoteMuteState[ie.uid]=u.remoteMuteState[ie.uid]||{audio:!1,video:!1},u.remoteMuteState[ie.uid].video=!0;var Ae=ce({type:"mute-video",uid:ie.uid}),nt=u.remoteStreams[ie.uid];nt?(nt.peerMuteVideo=!0,nt.pc&&u._adjustPCMuteStatus(nt),u.dispatchEvent(Ae)):S.default.debug("Ignoring event ".concat(ie.type),ie)}),u.socket.on("unmute_video",function(ie){S.default.info("[".concat(u.clientId,"] rcv peer unmute video: ").concat(ie.uid)),u.remoteMuteState[ie.uid]=u.remoteMuteState[ie.uid]||{audio:!1,video:!1},u.remoteMuteState[ie.uid].video=!1;var Ae=ce({type:"unmute-video",uid:ie.uid}),nt=u.remoteStreams[ie.uid];nt?(nt.peerMuteVideo=!1,nt.pc&&u._adjustPCMuteStatus(nt),u.dispatchEvent(Ae)):S.default.debug("Ignoring event ".concat(ie.type),ie)}),u.socket.on("on_user_banned",function(ie){S.default.info("[".concat(u.clientId,"] user banned uid: ").concat(ie.uid," error: ").concat(ie.error_code));var Ae=ce({type:"client-banned",uid:ie.uid,attr:ie.error_code});u.dispatchEvent(Ae),I=!0}),u.socket.on("on_stream_fallback_update",function(ie){S.default.info("[".concat(u.clientId,"] stream fallback peerId: ").concat(ie.stream_id," type: ").concat(ie.stream_type));var Ae=ce({type:"stream-fallback",uid:ie.stream_id,stream:ie.stream_id,attr:ie.stream_type});u.dispatchEvent(Ae)}),u.socket.on("stream_recover",function(ie){S.default.info("[".concat(u.clientId,"] stream recover uid: ").concat(ie.id," peerId: ").concat(ie.peerid," type: ").concat(ie.type));var Ae=ce({type:"stream-recover",uid:ie.id,stream:ie.peerid,attr:ie.type});u.dispatchEvent(Ae)}),u.socket.on("on_p2p_lost",function(ie){S.default.debug("[".concat(u.clientId,"] p2plost: "),ie,"p2ps:",u.p2ps);var Ae,nt="DTLS failed";(Ae=u.localStreams[ie.uid]||u.remoteStreams[ie.uid])?(Ae.pc&&Ae.pc.offerCandidates&&0===Ae.pc.offerCandidates.length&&(nt="NO_CANDIDATES_IN_OFFER"),"publish"===ie.event&&L.b.publish(u.joinInfo.sid,{lts:Ae.publishLTS,succ:!1,audioName:Ae.hasAudio()&&Ae.audioName,videoName:Ae.hasVideo()&&Ae.videoName,screenName:Ae.hasScreen()&&Ae.screenName,ec:nt}),"subscribe"===ie.event&&L.b.subscribe(u.joinInfo.sid,{lts:Ae.subscribeLTS,succ:!1,video:Ae.subscribeOptions&&Ae.subscribeOptions.video,audio:Ae.subscribeOptions&&Ae.subscribeOptions.audio,peerid:ie.uid+"",ec:nt})):S.default.warning("P2PLost Stream Not found",ie),S.default.debug("[".concat(u.clientId,"] p2plost:"),ie.p2pid),(Ae=u.p2ps.get(ie.p2pid))&&(u.p2ps.delete(ie.p2pid),Ae.local?u.dispatchEvent(ce({type:"pubP2PLost",stream:Ae,attr:nt})):u.remoteStreams[Ae.getId()]&&u.dispatchEvent(ce({type:"subP2PLost",stream:Ae,attr:nt})))}),u.socket.on("on_token_privilege_will_expire",function(ie){S.default.debug("[".concat(u.clientId,"] Received Message onTokenPrivilegeWillExpire")),u.dispatchEvent(ce({type:"onTokenPrivilegeWillExpire"}))}),u.socket.on("on_token_privilege_did_expire",function(){S.default.warning("[".concat(u.clientId,"] Received Message onTokenPrivilegeDidExpire, please get new token and join again")),u.closeGateway(),u.dispatchEvent(ce({type:"onTokenPrivilegeDidExpire"}))}),u._doWithAction=function(ie,Ae,nt){var st,dt;"tryNext"===ie?(st=Ae,dt=nt,S.default.debug("[".concat(u.clientId,"] Connect next gateway")),u.state=C,u.socket.close(),ne(),u.reconnectMode="tryNext",Oe(st,dt)):"retry"===ie?function(st,dt){S.default.debug("[".concat(u.clientId,"] Reconnect gateway")),u.state=C,u.socket.close(),ne(),u.reconnectMode="retry",Oe(st,dt)}(Ae,nt):"quit"===ie?(S.default.debug("[".concat(u.clientId,"] quit gateway")),u.state=C,u.socket.close(),ne()):"recover"===ie&&Q()},u.socket.on("on_notification",function(ie){if(S.default.debug("[".concat(u.clientId,"] Receive notification: "),ie),"ERR_JOIN_BY_MULTI_IP"===G[ie.code])return u.dispatchEvent({type:"onMultiIP",option:ie.option});ie.detail?u._doWithAction(yn[G[ie.code]]):ie.action&&u._doWithAction(ie.action)}),u.socket.on("on_user_offline",function(ie){var Ae=ce({type:"peer-leave",uid:ie.uid});if(u.remoteStreamsInChannel.has(ie.uid)&&u.remoteStreamsInChannel.delete(ie.uid),u.remoteStreams.hasOwnProperty(ie.uid)&&(Ae.stream=u.remoteStreams[ie.uid]),u.dispatchEvent(Ae),u.remoteStreams.hasOwnProperty(ie.uid)){S.default.info("[".concat(u.clientId,"] closing stream on peer leave"),ie.uid);var nt=u.remoteStreams[ie.uid];nt.close(),delete u.remoteStreams[ie.uid],void 0!==nt.pc&&(nt.pc.close(),nt.pc=void 0,u.p2ps.delete(nt.p2pId))}u.timers.hasOwnProperty(ie.uid)&&(clearInterval(u.timers[ie.uid]),clearInterval(u.timers[ie.uid]+"_RelatedStats"),delete u.timers[ie.uid]),null!=u.audioLevel[ie.uid]&&delete u.audioLevel[ie.uid],null!=u.timer_counter[ie.uid]&&delete u.timer_counter[ie.uid]}),u.socket.on("onUplinkStats",function(ie){}),u.socket.on("liveStreamingStarted",function(ie){var Ae=we({type:"liveStreamingStarted",url:ie.url});u.dispatchEvent(Ae)}),u.socket.on("liveStreamingFailed",function(ie){var Ae=we({type:"liveStreamingFailed",url:ie.url});u.dispatchEvent(Ae)}),u.socket.on("liveStreamingStopped",function(ie){var Ae=we({type:"liveStreamingStopped",url:ie.url});u.dispatchEvent(Ae)}),u.socket.on("liveTranscodingUpdated",function(ie){var Ae=we({type:"liveTranscodingUpdated",reason:ie.reason});u.dispatchEvent(Ae)}),u.socket.on("streamInjectedStatus",function(ie){var Ae=we({type:"streamInjectedStatus",url:ie.url,uid:ie.uid,status:ie.status});u.dispatchEvent(Ae)}),u.socket.on("on_user_online",function(ie){u.joinInfo.stringUid&&"string"!=typeof ie.uid&&S.default.error("StringUID is Mixed with UintUID"),u.dispatchEvent({type:"peer-online",uid:ie.uid})})},Ie=function(w,Pe){if(void 0!==u.socket)try{u.socket.emitSimpleMessage(w,function(qe,Ee){Pe&&Pe(qe,Ee)})}catch(qe){S.default.error("[".concat(u.clientId,"] Error in sendSimpleSdp [").concat(qe,"]"))}else S.default.error("[".concat(u.clientId,"] Error in sendSimpleSdp [socket not ready]"))},We=function(){for(var w in u.localStreams)if(void 0!==u.localStreams[w]){var Pe=u.localStreams[w];delete u.localStreams[w],void 0!==Pe.pc&&(Pe.pc.close(),Pe.pc=void 0)}},tt=function(){for(var w in u.remoteStreamsInChannel.clear(),u.remoteStreams)if(u.remoteStreams.hasOwnProperty(w)){var Pe=u.remoteStreams[w];Pe.isPlaying()&&Pe.stop(),Pe.close(),delete u.remoteStreams[w],void 0!==Pe.pc&&(Pe.pc.close(),Pe.pc=void 0)}};return u},no={_gatewayClients:{},register:function(g,r){if(!r.uid){var I="NO_UID_PROVIDED";return S.default.error("[".concat(g.clientId,"] "),I,r),I}return r.cname?this._gatewayClients[r.cname]&&this._gatewayClients[r.cname][r.uid]&&this._gatewayClients[r.cname][r.uid]!==g?(I="UID_CONFLICT",S.default.error("[".concat(g.clientId,"] "),I,r),I):(S.default.debug("[".concat(g.clientId,"] register client Channel"),r.cname,"Uid",r.uid),this._gatewayClients[r.cname]||(this._gatewayClients[r.cname]={}),this._gatewayClients[r.cname][r.uid]=g,null):(I="NO_CHANNEL_PROVIDED",S.default.error("[".concat(g.clientId,"] "),I,r),I)},unregister:function(g){var r=g&&g.uid,I=g.joinInfo&&g.joinInfo.cname;if(!r||!I){var c="INVALID_GATEWAYCLIENT";return S.default.error("[".concat(g.clientId,"] "),c),c}if(this._gatewayClients[I]&&this._gatewayClients[I][r])return this._gatewayClients[I][r]!==g?(c="GATEWAYCLIENT_UID_CONFLICT",S.default.error("[".concat(g.clientId,"] "),c),c):(S.default.debug("[".concat(g.clientId,"] unregister client "),g.uid),delete this._gatewayClients[I][r],null);c="GATEWEAY_CLIENT_UNREGISTERED",S.default.error("[".concat(g.clientId,"] "),c)}};Qn.DISCONNECTED=0,Qn.CONNECTING=1,Qn.CONNECTED=2,Qn.DISCONNECTING=3,Qn.connetionStateMap={0:"DISCONNECTED",1:"CONNECTING",2:"CONNECTED",3:"DISCONNECTING"};var g,sn=Qn,Dn=function(g){var r;switch(g){case"120p":case"120p_1":r=["120p_1","120p_1","120p_1"];break;case"120p_3":r=["120p_3","120p_3","120p_3"];break;case"180p":case"180p_1":r=["90p_1","90p_1","180p_1"];break;case"180p_3":r=["120p_3","120p_3","180p_3"];break;case"180p_4":r=["120p_1","120p_1","180p_4"];break;case"240p":case"240p_1":r=["120p_1","120p_1","240p_1"];break;case"240p_3":r=["120p_3","120p_3","240p_3"];break;case"240p_4":r=["120p_4","120p_4","240p_4"];break;case"360p":case"360p_1":case"360p_4":case"360p_9":case"360p_10":case"360p_11":r=["90p_1","90p_1","360p_1"];break;case"360p_3":case"360p_6":r=["120p_3","120p_3","360p_3"];break;case"360p_7":case"360p_8":default:r=["120p_1","120p_1","360p_7"];break;case"480p":case"480p_1":case"480p_2":case"480p_4":case"480p_10":r=["120p_1","120p_1","480p_1"];break;case"480p_3":case"480p_6":r=["120p_3","120p_3","480p_3"];break;case"480p_8":case"480p_9":r=["120p_4","120p_4","480p_8"];break;case"720p":case"720p_1":case"720p_2":case"720p_3":r=["90p_1","90p_1","720p_1"];break;case"720p_5":case"720p_6":r=["120p_1","120p_1","720p_5"];break;case"1080p":case"1080p_1":case"1080p_2":case"1080p_3":case"1080p_5":r=["90p_1","90p_1","1080p_1"];break;case"1440p":case"1440p_1":case"1440p_2":r=["90p_1","90p_1","1440p_1"];break;case"4k":case"4k_1":case"4k_3":r=["90p_1","90p_1","4k_1"]}return Object(Y.isOpera)()?[g,15,50]:Object(Y.isFireFox)()?[r[1],15,100]:Object(Y.isSafari)()?[r[2],15,50]:[r[0],15,50]},tr={1001:"FRAMERATE_INPUT_TOO_LOW",1002:"FRAMERATE_SENT_TOO_LOW",1003:"SEND_VIDEO_BITRATE_TOO_LOW",1005:"RECV_VIDEO_DECODE_FAILED",2001:"AUDIO_INPUT_LEVEL_TOO_LOW",2002:"AUDIO_OUTPUT_LEVEL_TOO_LOW",2003:"SEND_AUDIO_BITRATE_TOO_LOW",2005:"RECV_AUDIO_DECODE_FAILED",3001:"FRAMERATE_INPUT_TOO_LOW_RECOVER",3002:"FRAMERATE_SENT_TOO_LOW_RECOVER",3003:"SEND_VIDEO_BITRATE_TOO_LOW_RECOVER",3005:"RECV_VIDEO_DECODE_FAILED_RECOVER",4001:"AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER",4002:"AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER",4003:"SEND_AUDIO_BITRATE_TOO_LOW_RECOVER",4005:"RECV_AUDIO_DECODE_FAILED_RECOVER"},Kn={FramerateInput:1001,FramerateSent:1002,SendVideoBitrate:1003,VideoDecode:1005,AudioIntputLevel:2001,AudioOutputLevel:2002,SendAudioBitrate:2003,AudioDecode:2005},Gn=function(g){var r={remoteStreamStorage:{},localStreamStorage:{}};return r.gatewayClient=g,r.checkAudioOutputLevel=function(I){return!(I&&parseInt(I.audioRecvBytesDelta)>0&&parseInt(I.audioDecodingNormalDelta)>0&&0===parseInt(I.audioOutputLevel))},r.checkAudioIntputLevel=function(I){return!I||0!==parseInt(I.audioInputLevel)},r.checkFramerateInput=function(I,c){if(!I||!c.attributes)return!0;var v=parseInt(c.attributes.maxFrameRate),h=parseInt(I.googFrameRateInput);return!v||!h||!(v>10&&h<5||v<10&&v>=5&&h<=1)},r.checkFramerateSent=function(I){return!(I&&parseInt(I.googFrameRateInput)>5&&parseInt(I.googFrameRateSent)<=1)},r.checkSendVideoBitrate=function(I){return!I||0!==parseInt(I.videoSendBytesDelta)},r.checkSendAudioBitrate=function(I){return!I||0!==parseInt(I.audioSendBytesDelta)},r.checkVideoDecode=function(I){return!I||0===parseInt(I.videoRecvBytesDelta)||0!==parseInt(I.googFrameRateDecoded)},r.checkAudioDecode=function(I){return!I||0===parseInt(I.audioRecvBytesDelta)||0!==parseInt(I.audioDecodingNormalDelta)},r.record=function(I,c,v,h,b){v[I]||(v[I]={isPrevNormal:!0,record:[]});var C=v[I],O=r["check"+I](c,b);if(C.record.push(O),C.record.length>=5){C.isCurNormal=-1!==C.record.indexOf(!0);var P=Kn[I];C.isPrevNormal&&!C.isCurNormal&&r.gatewayClient.dispatchEvent({type:"exception",code:P,msg:tr[P],uid:h}),!C.isPrevNormal&&C.isCurNormal&&r.gatewayClient.dispatchEvent({type:"exception",code:P+2e3,msg:tr[P+2e3],uid:h}),C.isPrevNormal=C.isCurNormal,C.record=[]}},r.setLocalStats=function(I){var c={};Object.keys(I).map(function(v){var h=I[v],b=r.gatewayClient.localStreams[parseInt(v)],C=r.localStreamStorage[v]||{};b&&b.hasVideo()&&(r.record("SendVideoBitrate",h.videoStats,C,v),r.record("FramerateInput",h.videoStats,C,v,b),r.record("FramerateSent",h.videoStats,C,v)),b&&b.hasAudio()&&(r.record("AudioIntputLevel",h.audioStats,C,v),r.record("SendAudioBitrate",h.audioStats,C,v)),c[v]=C}),r.localStreamStorage=c},r.setRemoteStats=function(I){var c={};Object.keys(I).map(function(v){var h=I[v],b=g.remoteStreams[v],C=r.remoteStreamStorage[v]||{};b&&b.hasVideo()&&b.isPlaying()&&r.record("VideoDecode",h.videoStats,C,v),b&&b.hasAudio()&&b.isPlaying()&&(r.record("AudioOutputLevel",h.audioStats,C,v),r.record("AudioDecode",h.audioStats,C,v)),c[v]=C}),r.remoteStreamStorage=c},r},fr=new function(){var g=ae();return g.states={UNINIT:"UNINIT",INITING:"INITING",INITED:"INITED"},g.state=g.states.UNINIT,g.type=null,g.lastConnectedAt=null,g.lastDisconnectedAt=null,g.lastTypeChangedAt=null,g.networkChangeTimer=null,g._init=function(r,I){if(g.state=g.states.INITING,navigator.connection&&navigator.connection.addEventListener){var c=g._getNetworkInfo();g.type=c&&c.type,g.state=g.states.INITED,r&&r()}else g.state=g.states.UNINIT,I&&I("DO_NOT_SUPPORT")},g._getNetworkInfo=function(){return navigator.connection},g._reloadNetworkInfo=function(){var r=g._getNetworkInfo(),I=r&&r.type||"UNSUPPORTED",c=Date.now();I!==g.type&&(g.lastTypeChangedAt=c,"none"==I?g.lastDisconnectedAt=c:"none"==g.type&&(g.lastConnectedAt=c),g.type=I,g.dispatchEvent({type:"networkTypeChanged",networkType:I}))},g.getStats=function(r,I){var c={},v=g._getNetworkInfo();v&&(c.NetworkType=v.type||"UNSUPPORTED"),setTimeout(function(){r(c)},0)},g._init(function(){navigator.connection.addEventListener("change",function(){g._reloadNetworkInfo()}),g.networkChangeTimer=setInterval(function(){g._reloadNetworkInfo()},5e3)},function(r){}),g},Pr="DISCONNECTING",ro="CONNECTED",Ar=[],Gr=(setInterval(function(){Date.now(),Ar.forEach(function(g){for(var r=g.requests.length-1;r>=0;r--){var I=g.requests[r];I.timeoutCnt++,I.timeoutCnt>=15&&(g.requests.splice(r,1),I.promises.reject({reason:"TIMEOUT",code:499}))}})},1e3),1),pr=1,nr=(g=vn()(Rt.a.mark(function r(I){var c,v,h,b,C,O;return Rt.a.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return c=I.url,v=I.serviceName,h=I.sid,b=I.appId,C=I.cname,O=I.timeout,P.abrupt("return",new Promise(function(F,j){var u=!1,W=new XMLHttpRequest;W.open("POST",c,!0),W.setRequestHeader("Content-Type","application/json; charset=utf-8"),W.setRequestHeader("X-Packet-Service-Type","0"),W.setRequestHeader("X-Packet-URI","61"),W.onload=function(){if(!u){var Q=null,ne=null;try{Q=JSON.parse(W.responseText)}catch{var Oe="Invalid text ".concat(W.responseText);return S.default.error(Oe),u=!0,j(Oe)}if(Q.code){var $="AP_ERR_".concat(Q.code);return S.default.error($,Q),u=!0,j($)}try{ne=JSON.parse(Q.json_body||Q.json)}catch{var Ie="Invalid json_body ".concat(W.responseText);return S.default.error(Ie),u=!0,j(Ie)}if(200!==ne.code){var We="APPCENTER_CODE_".concat(ne.code);return S.default.error(We,ne),u=!0,j(We)}return ne.servers&&ne.servers.length>0?(u=!0,F(ne)):(S.default.error("APPCENTER_EMPTY_SERVER",ne),u=!0,j("APPCENTER_EMPTY_SERVER"))}},W.onerror=function(Q){var ne="AP_REUEST_".concat(Q.type);S.default.error(ne,c,Q),u||(u=!0,j(ne))},W.ontimeout=function(Q){S.default.error("AP_REUEST_TIMEOUT",c,Q),u||(u=!0,j("AP_REUEST_TIMEOUT"))},O&&(W.timeout=O),W.send(JSON.stringify({service_name:v,json_body:JSON.stringify({command:"allocateEdge",sid:h,appId:b,ts:Math.floor(Date.now()/1e3),seq:Gr++,cname:C,version:M.VERSION,requestId:pr++})}))}));case 2:case"end":return P.stop()}},r,this)})),function(r){return g.apply(this,arguments)}),Er=function(){var g=vn()(Rt.a.mark(function r(I){var c,v,h,b,C,O,P,F,j,u,W;return Rt.a.wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:c=I.serviceName,v=I.sid,h=I.appId,b=I.cname,C=null,Q.t0=Rt.a.keys(Object(M.getParameter)("UAP_AP"));case 3:if((Q.t1=Q.t0()).done){Q.next=34;break}return O=Q.t1.value,P="https://".concat(Object(M.getParameter)("UAP_AP")[O],"/api/v1?action=uap"),F=void 0,Q.prev=7,Q.next=10,nr({url:P,appId:h,sid:v,serviceName:c,cname:b,timeout:Object(M.getParameter)("HTTP_CONNECT_TIMEOUT")});case 10:F=Q.sent,Q.next=18;break;case 13:return Q.prev=13,Q.t2=Q.catch(7),S.default.error(Q.t2),C=Q.t2,Q.abrupt("continue",3);case 18:j=Rt.a.mark(function ne(Oe){var $,Ie,We;return Rt.a.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:if(Ie="wss://".concat(($=F.servers[Oe]).address.replace(/\./g,"-"),".edge.").concat(Oe%2==0?"agora.io":"agoraio.cn",":").concat($.wss,"?serviceName=").concat(encodeURIComponent(c)),$.wss){tt.next=5;break}return S.default.error("Invalid server response",$),tt.abrupt("return","continue");case 5:return tt.prev=5,tt.next=8,new Promise(function(w,Pe){var qe=new WebSocket(Ie),Ee=!1;qe.addEventListener("open",function(){Ee||(Ee=!0,w(qe))}),qe.addEventListener("error",function(ut){Ee||(Ee=!0,Pe(ut))})});case 8:return(We=tt.sent).workerToken=F.workerToken,tt.abrupt("return",{v:We});case 13:tt.prev=13,tt.t0=tt.catch(5),S.default.error(tt.t0),C=tt.t0;case 17:case"end":return tt.stop()}},ne,this,[[5,13]])}),u=0;case 20:if(!(u<F.servers.length)){Q.next=32;break}return Q.delegateYield(j(u),"t3",22);case 22:Q.t4=W=Q.t3,Q.next="continue"===Q.t4?26:27;break;case 26:return Q.abrupt("continue",29);case 27:if("object"!==nn()(W)){Q.next=29;break}return Q.abrupt("return",W.v);case 29:u++,Q.next=20;break;case 32:Q.next=3;break;case 34:throw C;case 35:case"end":return Q.stop()}},r,this,[[7,13]])}));return function(r){return g.apply(this,arguments)}}(),_n={},ti=function(g){return _n[g]?(_n[g]+=1,_n[g]):(_n[g]=1,_n[g])},wn={},Jn=function(g){return wn[g]?(wn[g]+=1,wn[g]):(wn[g]=1,wn[g])},Xn=function(g){var b,r=g.appId,I=g.cname,c=g.uid,v=g.sid,h=ae();return h.status="INIT",h.pingpongTimer=null,h.connection=null,h.requests=[],h.appId=r,h.cname=I,h.uid=c,h.sid=v,h.connection=null,h.connect=(b=vn()(Rt.a.mark(function C(O){var P;return Rt.a.wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(P=O.wsClient,"INIT"===h.status){F.next=4;break}return S.default.debug("Ignored UapConnection.connect: ".concat(h.status)),F.abrupt("return");case 4:h.connection=P,h.status=ro,h._flush(),h.startPingpong(),P.addEventListener("close",function(j){console.log("Weboskcet closed",j),P===h.connection&&h.dispatchEvent({type:"close",evt:j})}),P.addEventListener("message",function(j){if(j.data){var u=null;try{u=JSON.parse(j.data)}catch{return void S.default.error("Invalid data from worker manager",u)}if(u.requestId)for(var W=h.requests.length-1;W>=0;W--){var Q=h.requests[W];if(Q.reqData.requestId===u.requestId){h.requests.splice(W,1),u.code<400&&u.code>=200?Q.promises.resolve(u):Q.promises.reject(u);break}}else u.type="notification",h.dispatchEvent(u)}});case 10:case"end":return F.stop()}},C,this)})),function(C){return b.apply(this,arguments)}),h.disconnect=vn()(Rt.a.mark(function b(){var C;return Rt.a.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:for(C in h.status=Pr,clearInterval(h.pingpongTimer),h.pingpongTimer=null,h.requests)h.requests[C].promises.reject("DISCONNECTED");return h.requests=[],h.connection&&(h.connection.close(),h.connection=null),h.status="DISCONNECTED",O.abrupt("return",null);case 9:case"end":return O.stop()}},b,this)})),h.request=function(){var b=vn()(Rt.a.mark(function C(O){var P;return Rt.a.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(P=z()({command:"request",sdkVersion:M.VERSION,seq:Jn(h.sid),appId:h.appId,cname:h.cname,uid:""+h.uid,sid:h.sid,requestId:ti(h.sid),ts:Math.floor(Date.now()/1e3)},O),"INIT"!==h.status){W.next=5;break}return W.abrupt("return",new Promise(function(Q,ne){var Oe={reqData:P,stalledTs:Date.now(),timeoutCnt:0,promises:{resolve:Q,reject:ne}};h.requests.push(Oe)}));case 5:if(h.connection){W.next=11;break}throw S.default.error("NO_WEBSOCKET_CONNECTION"),new Error("NO_WEBSOCKET_CONNECTION");case 11:if(h.status!==Pr||O.clientRequest&&"DestroyWorker"===O.clientRequest.command){W.next=17;break}throw S.default.error("WEBSOCKET_DISCONNECTING"),new Error("WEBSOCKET_DISCONNECTING");case 17:if("DISCONNECTED"!==h.status){W.next=23;break}throw S.default.error("WEBSOCKET_DISCONNECTED"),new Error("WEBSOCKET_DISCONNECTED");case 23:return W.abrupt("return",new Promise(function(Q,ne){var Oe={reqData:P,stalledTs:Date.now(),timeoutCnt:0,promises:{resolve:Q,reject:ne}};h.requests.push(Oe),h._flush()}));case 24:case"end":return W.stop()}},C,this)}));return function(C){return b.apply(this,arguments)}}(),h._flush=function(){h.connection&&h.status===ro&&h.requests.forEach(function(b){b.sentTs||(b.sentTs=Date.now(),b.reqData.clientRequest&&(b.reqData.clientRequest.workerToken=h.connection.workerToken),h.connection.send(JSON.stringify(b.reqData)))})},h.startPingpong=function(){clearInterval(h.pingpongTimer),h.pingpongTimer=setInterval(vn()(Rt.a.mark(function b(){return Rt.a.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(h.status!==ro||!h.connection||1!==h.connection.readyState){C.next=9;break}return C.prev=1,C.next=4,h.request({command:"ping"});case 4:C.next=9;break;case 6:C.prev=6,C.t0=C.catch(1),console.error("pingpong",C.t0);case 9:case"end":return C.stop()}},b,this,[[1,6]])})),6e3)},h._flush(),h.startPingpong(),Ar.push(h),h},Rr=function(g){return"number"==typeof g&&0<=g&&g<=4294967295},Zn=function(g){var r=g;if(Object(M.getParameter)("LIVESTREAMING_ALIGN"))switch(g){case 200:r=0;break;case 451:r=1;break;case 453:r=2;break;case 470:r=10;break;case 499:r=3;break;default:r=4}return r},un=function(g){var r=g;if(Object(M.getParameter)("LIVESTREAMING_ALIGN"))switch(g){case 200:r=5;break;case 404:case 452:r=6;break;case 453:r=7;break;case 499:r=8;break;default:r=9}return r},ho=function(g){var I,c,r={key:void 0,highStream:null,lowStream:null,lowStreamParameter:null,isDualStream:!1,highStreamState:2,lowStreamState:2,proxyServer:null};return r.turnServer={mode:"auto",username:"test",credential:"111111",forceturn:Object(M.getParameter)("FORCE_TURN")},r.useProxyServer=!1,r.mode=g.mode,r.codec=g.codec,r.clientId=Object(zt.b)().slice(0,5),r.uintUid=null,g=z()({},g),r.aespassword=null,r.aesmode="none",r.hasPublished=!1,r.getSessionId=function(){return g.sessionId},r.getConnectionState=function(){var I=L.b.reportApiInvoke(g.sessionId,{name:"Client.getConnectionState",options:arguments,tag:"tracer"}),c=sn.connetionStateMap[r.gatewayClient.state];return I(),c},r.setClientRole=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{callback:c,name:"Client.setClientRole",options:arguments,tag:"tracer"});if(Nn(I,"setClientRole",["host","audience"]),"rtc"===r.mode){var h="RTC mode can not use setClientRole";return S.default.warning("[".concat(r.clientId,"] ").concat(h)),v&&v(h)}r.gatewayClient&&r.gatewayClient.state===sn.CONNECTED?("audience"===I&&(0===this.highStreamState?this._unpublish(this.highStream,function(){v&&v(null,{role:I})},function(b){v&&v(b)}):r.gatewayClient.setClientRole("audience",v)),"host"===I&&r.gatewayClient.setClientRole("host",v)):(r.gatewayClient.role=I,v&&v(null,{role:I}))},r.getGatewayInfo=function(I){if(r.gatewayClient.state!==sn.CONNECTED){var c="Client is not in connected state";return S.default.error("[".concat(r.clientId,"] ").concat(c)),void I(c)}r.gatewayClient.getGatewayInfo(function(v){I(null,v)},I)},r.renewToken=function(I,c,v){var h=L.b.reportApiInvoke(g.sessionId,{callback:function(b,C){if(b)return S.default.error("Failed to renew token ".concat(b),C),v&&v(b);c&&c(C)},name:"Client.renewToken",options:arguments,tag:"tracer"});if(!Et(I))throw new Error("Invalid token: Token is of the string type .Length of the string: [1,255]. ASCII characters only.");return r.gatewayClient?r.key?(r.key=I,void r.gatewayClient.renewToken(I,function(b){return h(null,b)},h)):(S.default.error("[".concat(r.clientId,"] renewToken should not be called before user join")),h(re_INVALID_OPERATION)):(S.default.error("[".concat(r.clientId,"] renewToken Failed. GatewayClient not Exist")),h(re_INVALID_OPERATION))},r.setLowStreamParameter=function(I){var c=L.b.reportApiInvoke(g.sessionId,{name:"Client.setLowStreamParameter",options:arguments,tag:"tracer"});an(I,"param");var v=I.width,h=I.height,b=I.framerate,C=I.bitrate;Je(v)||le(v,"width"),Je(h)||le(h,"height"),Je(b)||le(b,"framerate"),Je(C)||le(C,"bitrate",1,1e7),(!v&&h||v&&!h)&&S.default.warning("[".concat(r.clientId,"] The width and height parameters take effect only when both are set")),r.lowStreamParameter=I,c()},r.init=function(I,c,v){var h=L.b.reportApiInvoke(g.sessionId,{callback:function(b,C){if(b)return v&&v(b);c&&c(C)},name:"Client.init",options:arguments,tag:"tracer"});Kt(I),Object(Y.isChromeKernel)()&&Object(Y.getChromeKernelVersion)()<=48?v?h(re_BAD_ENVIRONMENT):Object(zt.e)():(S.default.info("[".concat(r.clientId,"] Initializing AgoraRTC client, appId: ").concat(I,".")),g.appId=I,g.sessionId=Object(zt.b)(),h())},r.setTurnServer=function(I){var c=L.b.reportApiInvoke(g.sessionId,{name:"Client.setTurnServer",options:arguments,tag:"tracer"});if(r.gatewayClient&&r.gatewayClient.state!==sn.DISCONNECTED)throw new Error("Set turn server before join channel");if(r.useProxyServer)throw new Error("You have already set the proxy");an(I,"turnServer");var v=I.turnServerURL,h=I.username,b=I.password,C=I.udpport,O=I.forceturn,P=I.tcpport;Kt(v,"turnServerURL"),Kt(h,"username"),Kt(b,"password"),Kt(C,"udpport"),Je(O)||te(O,"forceturn"),r.turnServer.mode="manual",r.turnServer.url=v,r.turnServer.udpport=C,r.turnServer.username=h,r.turnServer.credential=b,r.turnServer.forceturn=O||!1,Je(P)||(Kt(P,"tcpport"),r.turnServer.tcpport=P,S.default.info("[".concat(r.clientId,"] Set turnserver tcpurl. ").concat(r.turnServer.url,":").concat(r.turnServer.tcpport))),S.default.info("[".concat(r.clientId,"] Set turnserver udpurl. ").concat(r.turnServer.url,":").concat(r.turnServer.udpport,",username: ").concat(r.turnServer.uername,",password: ").concat(r.turnServer.credential)),c()},r.setProxyServer=function(I){var c=L.b.reportApiInvoke(g.sessionId,{name:"Client.setProxyServer",options:arguments,tag:"tracer"});if(r.gatewayClient&&r.gatewayClient.state!==sn.DISCONNECTED)throw new Error("Set proxy server before join channel");if(!I)throw new Error("Do not set the proxyServer parameter as empty");if(r.useProxyServer)throw new Error("You have already set the proxy");Kt(I,"proxyServer"),r.proxyServer=I,L.b.setProxyServer(I),S.default.setProxyServer(I),c()},r.startProxyServer=function(){var I=L.b.reportApiInvoke(g.sessionId,{name:"Client.startProxyServer",options:arguments,tag:"tracer"});if(r.gatewayClient&&r.gatewayClient.state!==sn.DISCONNECTED)throw new Error("Start proxy server before join channel");if(r.proxyServer||r.turnServer.url)throw new Error("You have already set the proxy");r.useProxyServer=!0,I()},r.stopProxyServer=function(){var I=L.b.reportApiInvoke(g.sessionId,{name:"Client.stopProxyServer",options:arguments,tag:"tracer"});if(r.gatewayClient&&r.gatewayClient.state!==sn.DISCONNECTED)throw new Error("Stop proxy server after leave channel");L.b.setProxyServer(),S.default.setProxyServer(),r.turnServer={},r.proxyServer=null,r.useProxyServer=!1,I()},r.setEncryptionSecret=function(I){var c=L.b.reportApiInvoke(g.sessionId,{name:"Client.setEncryptionSecret",options:arguments,tag:"tracer"});Kt(I,"password"),r.aespassword=I,c()},r.setEncryptionMode=function(I){var c=L.b.reportApiInvoke(g.sessionId,{name:"Client.setEncryptionMode",options:arguments,tag:"tracer"});if(Kt(I,"encryptionMode"),-1===In.indexOf(I))throw new Error('Invalid encryptionMode: encryptionMode should be "aes-128-xts" | "aes-256-xts" | "aes-128-ecb"');r.aesmode=I,c()},r.configPublisher=function(I){var c=L.b.reportApiInvoke(g.sessionId,{name:"Client.configPublisher",options:arguments,tag:"tracer"});an(I,"config");var h=I.height,b=I.framerate,C=I.bitrate,O=I.publisherUrl;le(I.width,"width"),le(h,"height"),le(b,"framerate"),le(C,"bitrate",1,1e7),O&&Kt(O,"publisherUrl"),r.gatewayClient.configPublisher(I),c()},r.enableDualStream=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{callback:function(h,b){if(h)return c&&c(h);I&&I(b)},name:"Client.enableDualStream",options:arguments,tag:"tracer"});return"iOS"===Object(Y.getBrowserOS)()?(L.b.streamSwitch(g.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),v(re_IOS_NOT_SUPPORT)):Object(Y.isWeChatBrowser)()?(L.b.streamSwitch(g.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!1}),v(re_WECHAT_NOT_SUPPORT)):(L.b.streamSwitch(g.sessionId,{lts:(new Date).getTime(),isdual:!0,succ:!0}),r.isDualStream=!0,r.highStream&&(r.highStream.isDualStream=!0),void(0===r.highStreamState?r._publishLowStream(function(h){return v(null,h)},function(h){S.default.warning("[".concat(r.clientId,"]"),h),v(re_ENABLE_DUALSTREAM_FAILED)}):v(1===r.highStreamState?re_STILL_ON_PUBLISHING:null)))},r.disableDualStream=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{callback:function(h,b){if(h)return c&&c(h);I&&I(b)},name:"Client.disableDualStream",options:arguments,tag:"tracer"});L.b.streamSwitch(g.sessionId,{lts:(new Date).getTime(),isdual:!1,succ:!0}),r.isDualStream=!1,r.highStream&&(r.highStream.isDualStream=!1),0===r.highStreamState?r._unpublishLowStream(function(){r.highStream.lowStream=null,v()},function(h){S.default.warning("[".concat(r.clientId,"]"),h),v(re_DISABLE_DUALSTREAM_FAILED)}):1===r.highStreamState?v(re_STILL_ON_PUBLISHING):v()},r._createLowStream=function(I,c){if(r.highStream&&r.highStream.stream){var v=z()({},r.highStream.params);if(v.streamID+=1,v.audio=!1,v.video){var h=r.highStream.stream.getVideoTracks()[0];h?Yt.getVideoCameraIdByLabel(h.label,function(b){v.cameraId=b;var C=new En(v);if(C.streamId=r.highStream.getId()+1,r.lowStreamParameter){var O=z()({},r.lowStreamParameter);if(!O.width||!O.height){var P=Dn(r.highStream.profile),F=M.SUPPORT_RESOLUTION_LIST[P[0]];O.width=F[0],O.height=F[1]}O.framerate=O.framerate||5,O.bitrate=O.bitrate||50,(Object(Y.isSafari)()||Object(Y.isOpera)())&&(S.default.debug("[".concat(r.clientId,"] Shimming lowStreamParameter")),O.width=(F=M.SUPPORT_RESOLUTION_LIST[r.highStream.profile])[0],O.height=F[1]),C.setVideoProfileCustomPlus(O)}else C.setVideoProfileCustom(Dn(r.highStream.profile));C.init(function(){r.highStream.lowStream=C,r.highStream.userMuteVideo&&C.muteVideo(),I&&I(C)},c)},c):c&&c(re_HIGH_STREAM_NOT_VIDEO_TRACE)}else c&&c(re_HIGH_STREAM_NOT_VIDEO_TRACE)}else c&&c(re_HIGH_STREAM_NOT_VIDEO_TRACE)},r._getLowStream=function(I,c){r.lowStream?I(r.lowStream):r._createLowStream(function(v){r.lowStream=v,I(r.lowStream)},c)},r._publishLowStream=function(I,c){return 2!==r.lowStreamState?c&&c(re_LOW_STREAM_ALREADY_PUBLISHED):r.highStream&&r.highStream.hasScreen()?c&&c(re_SHARING_SCREEN_NOT_SUPPORT):void r._getLowStream(function(v){r.lowStreamState=1,r.gatewayClient.publish(v,{streamType:1},function(){r.lowStreamState=0,I&&I()},function(h){1===r.lowStreamState&&(r.lowStreamState=2),S.default.debug("[".concat(r.clientId,"] publish low stream failed")),c&&c(h)})},c)},r._unpublishLowStream=function(I,c){if(0!==r.lowStreamState)return c&&c(re_LOW_STREAM_NOT_YET_PUBLISHED);r.lowStream&&(r.gatewayClient.unpublish(r.lowStream,{streamType:1},function(){},function(v){S.default.debug("[".concat(r.clientId,"] unpublish low stream failed")),c&&c(v)}),r.lowStream.close(),r.lowStream=null,r.lowStreamState=2,I&&I())},r.join=function(I,c,v,h,b){var C,O=L.b.reportApiInvoke(g.sessionId,{callback:function(j,u){if(j)return b&&b(j);h&&h(u)},name:"Client.join",options:arguments,tag:"tracer"});if(I&&!Et(I))return S.default.warning("[".concat(r.clientId,"] Param channelKey should be string")),O(re_INVALID_PARAMETER);if(!Tn(C=c)||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(C))return S.default.error("Invalid Channel Name ".concat(c)),S.default.warning("[".concat(r.clientId,"] The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")),O(re_INVALID_PARAMETER);if("string"==typeof c&&""===c)return S.default.warning("[".concat(r.clientId,"] Param channel should not be empty")),O(re_INVALID_PARAMETER);if(v&&!Object(zt.c)(v)&&!X(v,1,255))return S.default.error("Invalid UID ".concat(v," ").concat(nn()(v))),S.default.warning("[".concat(r.clientId,"] [String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]")),O(re_INVALID_PARAMETER);if("string"==typeof v&&0==v.length)return S.default.warning("[".concat(r.clientId,"] String uid should not be empty")),O(re_INVALID_PARAMETER);if("string"==typeof v&&v.length>256)return S.default.warning("[".concat(r.clientId,"] Length of string uid should be less than 255")),O(re_INVALID_PARAMETER);r.highStream=null,r.lowStream=null,r.lowStreamParameter=null,r.isDualStream=!1,r.highStreamState=2,r.lowStreamState=2;var P={clientId:r.clientId,appId:g.appId,sid:g.sessionId,cname:c,uid:v,turnServer:r.turnServer,proxyServer:r.proxyServer,token:I||g.appId,useProxyServer:r.useProxyServer};if("string"==typeof v&&(P.stringUid=v,r.uintUid?(P.uid=r.uintUid,delete r.uintUid):P.uid=0),r.aespassword&&"none"!==r.aesmode&&z()(P,{aespassword:r.aespassword,aesmode:r.aesmode}),L.b.sessionInit(g.sessionId,{lts:(new Date).getTime(),cname:c,appid:g.appId,mode:g.mode,succ:!0}),r.onSuccess=function(j){r.rtcStatsCollector.startNetworkQualityTimer(),r.onSuccess=null,O(null,j)},r.onFailure=function(j){return O(j)},r.channel=c,r.gatewayClient.state!==sn.DISCONNECTED)return S.default.error("[".concat(r.clientId,"] Client already in connecting/connected state")),O(re_INVALID_OPERATION),void L.b.joinGateway(g.sessionId,{lts:Date.now(),succ:!1,ec:re_INVALID_OPERATION,addr:null});r.gatewayClient.state=sn.CONNECTING;var F=function(j,u){S.default.info("[".concat(r.clientId,"] Joining channel: ").concat(c)),r.gatewayClient.dispatchEvent({type:"config-distribute",config:u,joinInfo:P}),r.key=I||g.appId,P.cid=j.cid,P.uid||(P.uid=j.uid),P.vid=j.vid,P.clientId=r.clientId,P.apResponse=j.res,j.uni_lbs_ip&&j.uni_lbs_ip[1]&&(P.uni_lbs_ip=j.uni_lbs_ip[1]),P.gatewayAddr=j.gateway_addr,r.joinInfo=P,r.gatewayClient.join(P,r.key,function(W){S.default.info("[".concat(r.clientId,"] Join channel ").concat(c," success, join with uid: ").concat(W,".")),r.onSuccess=null,r.rtcStatsCollector.startNetworkQualityTimer(),O(null,W)},function(W){return O(W)})};P.stringUid&&!P.uid?(r.userAccountReq&&!r.userAccountReq.isFinished()&&r.userAccountReq.cancel(),r.userAccountReq=qn(P,r.gatewayClient),r.userAccountReq.then(function(j){S.default.debug("getUserAccount Success ".concat(j.url," ").concat(P.stringUid," => ").concat(j.uid)),P.uid=j.uid,Ft(P,F)}).catch(function(j){S.default.error("getUserAccount rejected",j),O(j)})):Ft(P,F)},r.renewChannelKey=function(I,c,v){var h=L.b.reportApiInvoke(g.sessionId,{callback:function(b,C){if(b)return v&&v(b);c&&c(C)},name:"Client.renewChannelKey",options:arguments,tag:"tracer"});Kt(I,"key",1,2047),void 0===r.key?(S.default.error("[".concat(r.clientId,"] renewChannelKey should not be called before user join")),h(re_INVALID_OPERATION)):(r.key=I,r.gatewayClient.joinInfo.token=I,r.gatewayClient.key=I,r.gatewayClient.recover(),h())},r.leave=function(I,c){r.gatewayClient.hasInvokeLeave=!0;var v=!1,h=L.b.reportApiInvoke(g.sessionId,{callback:function(b,C){if(b)return c&&c(b);r.gatewayClient.reconnectingCS=!1,clearTimeout(ze[r.clientId]),r._renewSession(),r.rtcStatsCollector.clearNetworkQualityTimer(),I&&I(C)},name:"Client.leave",options:arguments,tag:"tracer"});S.default.info("[".concat(r.clientId,"] Leaving channel")),r.userAccountReq&&!r.userAccountReq.isFinished()&&(r.userAccountReq.cancel(),r.gatewayClient.state===sn.CONNECTING&&(r.gatewayClient.state=sn.DISCONNECTED)),r.gatewayClient.leave(function(b){v=!0,h(null,b)},h),setTimeout(function(){v||(r.gatewayClient.socket&&(r.gatewayClient.socket.close(),r.gatewayClient.socket=null),r.gatewayClient.state=sn.DISCONNECTED,h(null,"LEAVE_MSG_TIMEOUT"))},Object(M.getParameter)("LEAVE_MSG_TIMEOUT"))},r._renewSession=function(){var I=Object(zt.b)();if(S.default.debug("renewSession ".concat(g.sessionId," => ").concat(I)),g.sessionId=I,r.joinInfo&&(r.joinInfo.sid=I),r.gatewayClient&&(r.gatewayClient.joinInfo&&(r.gatewayClient.joinInfo.sid=I),r.gatewayClient.localStreams))for(var c in r.gatewayClient.localStreams){var v=r.gatewayClient.localStreams[c];v&&(v.sid=I)}},r._publish=function(I,c,v){if(2!==r.highStreamState)return S.default.warning("[".concat(r.clientId,"] Can't publish stream when stream already publish ").concat(I.getId())),v&&v(re_STREAM_ALREADY_PUBLISHED);if("auto"===r.turnServer.mode&&Object(M.getParameter)("FORCE_TURN")&&!Object(M.getParameter)("TURN_ENABLE_TCP")&&!Object(M.getParameter)("TURN_ENABLE_UDP"))throw new Error("force TURN With No TURN Configuration");S.default.info("[".concat(r.clientId,"] Publishing stream, uid ").concat(I.getId())),r.highStream=I,r.highStreamState=1,r.highStream.streamId=r.joinInfo.stringUid||r.joinInfo.uid,r.hasPublished=!1;var h=function(b,C,O){r.gatewayClient.publish(b,{streamType:0},function(){b.sid=g.sessionId,r.highStreamState=0,S.default.info("[".concat(r.clientId,"] Publish success, uid: ").concat(b.getId())),r.highStream&&(r.highStream.isDualStream=r.isDualStream),r.isDualStream?r._publishLowStream(function(){C&&C()},function(P){S.default.warning("[".concat(r.clientId,"] "),P),C&&C()}):C&&C()},O)};"audience"===r.gatewayClient.role&&"live"===r.mode?r.gatewayClient.setClientRole("host",function(b){if(b)return v&&v(b);h(I,c,v)}):h(I,c,v)},r._unpublish=function(I,c,v){if(0!==r.highStreamState)return S.default.warning("[".concat(r.clientId,"] Can't unpublish stream when stream not publish")),v&&v(re_STREAM_NOT_YET_PUBLISHED);S.default.info("[".concat(r.clientId,"] Unpublish stream, uid ").concat(I.getId()));var h=function(b,C,O){r.isDualStream&&r.lowStream&&r._unpublishLowStream(null,O),r.gatewayClient.unpublish(b,{streamType:0},function(){r.highStreamState=2,S.default.info("[".concat(r.clientId,"] Unpublish stream success, uid: ").concat(b.getId())),C&&C()},function(P){S.default.info("[".concat(r.clientId,"] Unpublish stream fail, uid: ").concat(b.getId())),O&&O(P)})};"host"===r.gatewayClient.role&&"live"===r.mode?r.gatewayClient.setClientRole("audience",function(b){if(b)return v&&v(b);h(I,c,v)}):h(I,c,v)},r.publish=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{callback:function(h,b){if(h)return 1===r.highStreamState&&(r.highStreamState=2),c&&c(h)},name:"Client.publish",tag:"tracer",options:{stream:"too long to show",onFailure:!!c}});2===r.highStreamState?r._publish(I,function(h){return v(null,h)},function(h){return v(h)}):v(re_STREAM_ALREADY_PUBLISHED)},r.unpublish=function(I,c,v){var h=L.b.reportApiInvoke(g.sessionId,{callback:function(b,C){if(b)return c&&c(b);v&&v(C)},name:"Client.unpublish",tag:"tracer",options:{stream:"too long to show",onFailure:!!c}});0===r.highStreamState?r._unpublish(I,function(b){return h(null,b)},function(b){return h(b)}):h(re_STREAM_NOT_YET_PUBLISHED)},r.subscribe=function(I,c,v){var h=L.b.reportApiInvoke(g.sessionId,{callback:function(O,P){if(O)return v&&v(O)},name:"Client.subscribe",tag:"tracer",options:{stream:"too long to show",options:c,onFailure:!!v}});"function"==typeof c&&(v=c,c=null),an(I,"stream"),Je(c)||(an(c,"options"),Je(c.video)||te(c.video,"options.video"),Je(c.audio)||te(c.audio,"options.audio"));var b={video:!0,audio:!0};if(!Je(c)){if(Object(Y.isSafari)()&&(!c.video||!c.audio)){var C="SAFARI_NOT_SUPPORTED_FOR_TRACK_SUBSCRIPTION";return S.default.error("[".concat(r.clientId,"] "),C),void h(C)}if(!Je(c.video)&&!Ke(c.video)||!Je(c.audio)&&!Ke(c.audio)||!1===c.audio&&!1===c.video)return C="INVALID_PARAMETER ".concat(JSON.stringify(c)),S.default.error("[".concat(r.clientId,"] "),C),void h(C)}I.subscribeOptions?(z()(I.subscribeOptions,b,c),r.gatewayClient.subscribeChange(I,function(O){return h(null,O)},h)):(I.subscribeOptions=z()({},b,c),r.gatewayClient.subscribe(I,function(O){return h(null,O)},h))},r.unsubscribe=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{callback:function(h,b){if(h)return c&&c(h)},name:"Client.unsubscribe",tag:"tracer",options:{stream:"too long to show",onFailure:!!c}});S.default.info("[".concat(r.clientId,"] Unsubscribe stream, uid: ").concat(I.getId())),r.gatewayClient.unsubscribe(I,function(h){return v(null,h)},v)},r.setRemoteVideoStreamType=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{name:"Client.setRemoteVideoStreamType",tag:"tracer",options:{stream:"too long to show",streamType:c}});Nn(c,"streamType",[0,1]),r.gatewayClient.setRemoteVideoStreamType(I,c),v()},r.setStreamFallbackOption=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{name:"Client.setStreamFallbackOption",tag:"tracer",options:{stream:"too long to show",fallbackType:c}});Nn(c,"fallbackType",[0,1,2]),r.gatewayClient.setStreamFallbackOption(I,c),v()},r.enableAudioVolumeIndicator=function(I,c){var v=L.b.reportApiInvoke(g.sessionId,{name:"Client.enableAudioVolumeIndicator",options:arguments,tag:"tracer"});I=I||2e3,le(c=c||3,"smooth",1,100),le(I,"interval",50,1e5),r.audioVolumeIndication=r.audioVolumeIndication||{enabled:!0},r.audioVolumeIndication.interval=I,r.audioVolumeIndication.smooth=c,r.audioVolumeIndication={interval:I,smooth:c},S.default.info("[".concat(r.clientId,"] enableAudioVolumeIndicator interval ").concat(I," smooth ").concat(c)),r.gatewayClient.enableAudioVolumeIndicator(I,c),v()},r.getNetworkStats=function(I,c){return S.default.deprecate("[".concat(r.clientId,"] client.getNetworkStats is deprecated. Use client.getTransportStats instead.")),fr.getStats(I,c)},r.getSystemStats=function(I,c){return je.getStats(I,c)},r.getRecordingDevices=function(I,c){return Yt.getRecordingDevices(I,c)},r.getPlayoutDevices=function(I,c){return Yt.getPlayoutDevices(I,c)},r.getCameras=function(I,c){return Yt.getCameras(I,c)},r.getRemoteAudioStats=function(I,c){return r.rtcStatsCollector.getRemoteAudioStats(I,c)},r.getLocalAudioStats=function(I,c){return r.rtcStatsCollector.getLocalAudioStats(I,c)},r.getRemoteVideoStats=function(I,c){return r.rtcStatsCollector.getRemoteVideoStats(I,c)},r.getLocalVideoStats=function(I,c){return r.rtcStatsCollector.getLocalVideoStats(I,c)},r._getRemoteVideoQualityStats=function(I,c){return r.rtcStatsCollector.getRemoteVideoQualityStats(I,c)},r._getRemoteAudioQualityStats=function(I,c){return r.rtcStatsCollector.getRemoteAudioQualityStats(I,c)},r.getTransportStats=function(I,c){return r.rtcStatsCollector.getTransportStats(function(v){return fr.getStats(function(h){var b=z()({},v,h);I&&I(b)},c)},c)},r.getSessionStats=function(I,c){return r.rtcStatsCollector.getSessionStats(I,c)},r.onNetworkQuality=function(){return r.rtcStatsCollector.onNetworkQuality(onSuccess,onFailure)},g.clientId=r.clientId,r.gatewayClient=sn(g),r.listenerLoggerTimer=null,r.listenerLoggerCache=[],r.on=function(I,c){r.gatewayClient.on(I,c),r.listenerLoggerCache.push("".concat(I).concat(c.name?":"+c.name:"")),r.listenerLoggerTimer?clearTimeout(r.listenerLoggerTimer):S.default.info("[".concat(r.clientId,"] Adding event handler on ").concat(I)),r.listenerLoggerTimer=setTimeout(function(){r.listenerLoggerCache.length&&(r.listenerLoggerTimer=null,S.default.info("[".concat(r.clientId,"] Added event handler on ").concat(r.listenerLoggerCache.join(", "))),r.listenerLoggerCache=[])},0)},r.off=function(I,c){S.default.info("remove event handler from [".concat(I,"]")),r.gatewayClient.removeEventListener(I,c)},r.rtcStatsCollector=(I=r.gatewayClient,(c=ae()).gatewayClient=I,c.exceptionMonitor=new Gn(I),c.localStats={},c.remoteStats={},c.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0},c.getRemoteAudioStats=function(v){var h={};for(var b in c.remoteStats){var C={},O=c.remoteStats[b];Te(C,"End2EndDelay",O.peer_delay&&O.peer_delay.audio_delay),Te(C,"TransportDelay",O.peer_delay&&O.peer_delay.e2e_delay),Te(C,"PacketLossRate",O.peer_delay&&O.peer_delay.e2e_audio_lost_ratio_400ms),Te(C,"RecvLevel",O.audioStats&&O.audioStats.audioOutputLevel),Te(C,"RecvBitrate",O.audioRecvBitrate),Te(C,"CodecType",O.audioStats&&O.audioStats.googCodecName),Te(C,"MuteState",O.audioDisabled),Te(C,"TotalFreezeTime",O.audioStats&&O.audioStats.audioTotalFreezeTime),Te(C,"TotalPlayDuration",O.audioStats&&O.audioStats.audioTotalPlayDuration),h[b]=C}v&&v(h)},c.getLocalAudioStats=function(v){var h={};for(var b in c.localStats){var C={},O=c.localStats[b];Te(C,"RecordingLevel",O.audioStats&&O.audioStats.audioInputLevel),Te(C,"SendLevel",O.audioStats&&O.audioStats.totalAudioEnergy),Te(C,"SamplingRate",O.audioStats&&O.audioStats.totalSamplesDuration),Te(C,"SendBitrate",O.audioSendBitrate),Te(C,"CodecType",O.audioStats&&O.audioStats.googCodecName),Te(C,"MuteState",O.audioDisabled);var P=c.gatewayClient.localStreams[b];P&&P.isPlaying()&&Te(C,"MuteState",P.userMuteAudio?"1":"0"),h[b]=C}v&&v(h)},c.getRemoteVideoStats=function(v){var h={};for(var b in c.remoteStats){var C={},O=c.remoteStats[b];Te(C,"End2EndDelay",O.peer_delay&&O.peer_delay.video_delay),Te(C,"TransportDelay",O.peer_delay&&O.peer_delay.e2e_delay),Te(C,"PacketLossRate",O.peer_delay&&O.peer_delay.e2e_video_lost_ratio_400ms),Te(C,"RecvBitrate",O.videoRecvBitrate),Te(C,"RecvResolutionWidth",O.videoStats&&O.videoStats.googFrameWidthReceived),Te(C,"RecvResolutionHeight",O.videoStats&&O.videoStats.googFrameHeightReceived),Te(C,"RenderResolutionWidth",O.videoStats&&O.videoStats.renderRemoteWidth),Te(C,"RenderResolutionHeight",O.videoStats&&O.videoStats.renderRemoteHeight),Te(C,"RenderFrameRate",O.videoStats&&O.videoStats.googFrameRateOutput),Te(C,"MuteState",O.videoDisabled),Te(C,"TotalFreezeTime",O.videoStats&&O.videoStats.videoTotalFreezeTime),Te(C,"TotalPlayDuration",O.videoStats&&O.videoStats.videoTotalPlayDuration),h[b]=C}v&&v(h)},c.getLocalVideoStats=function(v){var h={};for(var b in c.localStats){var C={},O=c.localStats[b];Te(C,"TargetSendBitrate",O.videoTargetSendBitrate),Te(C,"SendFrameRate",O.videoStats&&O.videoStats.googFrameRateSent),Te(C,"SendBitrate",O.videoSendBitrate),Te(C,"SendResolutionWidth",O.videoStats&&O.videoStats.googFrameWidthSent),Te(C,"SendResolutionHeight",O.videoStats&&O.videoStats.googFrameHeightSent),Te(C,"CaptureResolutionWidth",O.videoStats&&O.videoStats.googFrameWidthInput),Te(C,"CaptureResolutionHeight",O.videoStats&&O.videoStats.googFrameHeightInput),Te(C,"EncodeDelay",O.videoStats&&O.videoStats.googAvgEncodeMs),Te(C,"MuteState",O.videoDisabled),Te(C,"TotalFreezeTime",O.videoStats&&O.videoStats.videoTotalFreezeTime),Te(C,"TotalDuration",O.videoStats&&O.videoStats.videoTotalPlayDuration),Te(C,"CaptureFrameRate",O.videoStats&&O.videoStats.googFrameRateSent),O.videoStats&&!O.videoStats.googFrameWidthInput&&Te(C,"CaptureResolutionWidth",O.videoStats&&O.videoStats.renderLocalWidth),O.videoStats&&!O.videoStats.googFrameHeightInput&&Te(C,"CaptureResolutionHeight",O.videoStats&&O.videoStats.renderLocalHeight),h[b]=C,v&&v(h)}},c.getRemoteVideoQualityStats=function(v){var h={};for(var b in c.remoteStats){var C={},O=c.remoteStats[b];Te(C,"videoReceiveDelay",O.videoStats&&O.videoStats.googCurrentDelayMs),Te(C,"VideoFreezeRate",O.videoStats&&O.videoStats.videoFreezeRate),Te(C,"FirstFrameTime",O.firstFrameTime),h[b]=C}v&&v(h)},c.getRemoteAudioQualityStats=function(v){var h={};for(var b in c.remoteStats){var C={},O=c.remoteStats[b];Te(C,"audioReceiveDelay",O.audioStats&&O.audioStats.googCurrentDelayMs),Te(C,"AudioFreezeRate",O.videoStats&&O.videoStats.videoFreezeRate),h[b]=C}v&&v(h)},c.getTransportStats=function(v){var h={},b={},C=c.gatewayClient.traffic_stats,O=C.peer_delay;if(Te(h,"OutgoingAvailableBandwidth",c.gatewayClient.OutgoingAvailableBandwidth/1e3),Te(h,"RTT",C&&C.access_delay),O){var P=!0,F=!1,j=void 0;try{for(var u,W=O[Symbol.iterator]();!(P=(u=W.next()).done);P=!0){var Q=u.value;Q.downlink_estimate_bandwidth&&(b[Q.peer_uid]=Q.downlink_estimate_bandwidth/1e3+"")}}catch(ne){F=!0,j=ne}finally{try{P||null==W.return||W.return()}finally{if(F)throw j}}}h.IncomingAvailableBandwidth=b,v&&v(h)},c.getSessionStats=function(v){var h={},b=c.gatewayClient.traffic_stats,C=c.gatewayClient.socket,O=0,P=0;for(var F in c.remoteStats)(j=c.remoteStats[F])&&j.videoStats&&j.videoStats.videoRecvBytesDelta&&(P+=parseInt(j.videoStats.videoRecvBytesDelta)),j&&j.audioStats&&j.audioStats.audioRecvBytesDelta&&(P+=parseInt(j.audioStats.audioRecvBytesDelta));for(var F in c.localStats){var j;(j=c.localStats[F])&&j.videoStats&&j.videoStats.videoSendBytesDelta&&(O+=parseInt(j.videoStats.videoSendBytesDelta)),j&&j.audioStats&&j.audioStats.audioSendBytesDelta&&(O+=parseInt(j.audioStats.audioSendBytesDelta))}var u=O+c.session.WSSendBytesDelta+c.session.HTTPSendBytesDelta,W=P+c.session.WSRecvBytesDelta+c.session.HTTPRecvBytesDelta,Q=c.session.sendBytes+Object(Wn.b)(),ne=c.session.recvBytes+Object(Wn.a)();c.gatewayClient.socket&&c.gatewayClient.socket.state===c.gatewayClient.CONNECTED&&(Q+=C.getSendBytes(),ne+=C.getRecvBytes());var Oe=1;b.peer_delay&&(Oe=b.peer_delay.length,Oe+=1),Te(h,"Duration",C.getDuration()),Te(h,"UserCount",Oe),Te(h,"SendBytes",Q),Te(h,"RecvBytes",ne),Te(h,"SendBitrate",8*u/1e3),Te(h,"RecvBitrate",8*W/1e3),v&&v(h)},c.isLocalVideoFreeze=function(v,h){var b=0,C=0;if(!v||!h)return!1;if(Object(Y.isChrome)()||Object(Y.isOpera)())b=v.googFrameRateInput,C=v.googFrameRateSent;else if(Object(Y.isSafari)())b=parseInt(v.framerateMean),C=parseInt(v.framesEncoded)-parseInt(h.framesEncoded);else{if(!Object(Y.isFireFox)())return!1;b=parseInt(v.framerateMean),C=parseInt(v.framesEncoded)-parseInt(h.framesEncoded)}return b>5&&C<3},c.isRemoteVideoFreeze=function(v,h){var b=0,C=0;if(!v||!h)return!1;if(Object(Y.isChrome)()||Object(Y.isOpera)())b=v.googFrameRateReceived,C=v.googFrameRateDecoded;else if(Object(Y.isSafari)())b=v.framerateMean,C=parseInt(v.framesDecoded)-parseInt(h.framesDecoded);else{if(!Object(Y.isFireFox)())return!1;b=parseInt(v.framesReceived)-parseInt(h.framesReceived),C=parseInt(v.framesDecoded)-parseInt(h.framesDecoded)}return b>5&&b<10&&C<3||b>10&&b<20&&C<4||b>20&&C<5},c.isAudioFreeze=function(v){if(Object(Y.isChrome)()&&v){if(v.googDecodingPLC&&v.googDecodingPLCCNG&&v.googDecodingCTN)return(parseInt(v.googDecodingPLC)+parseInt(v.googDecodingPLCCNG))/parseInt(v.googDecodingCTN)>.2}else if((Object(Y.isSafari)()||Object(Y.isFireFox)())&&v.packetsLost&&v.packetsReceived)return parseInt(v.packetsLost)/(parseInt(v.packetsLost)+parseInt(v.packetsReceived))>.2;return!1},c.isAudioDecodeFailed=function(v){return!!((Object(Y.isChrome)()||Object(Y.isOpera)())&&v&&parseInt(v.bytesReceived)>0&&0===parseInt(v.googDecodingNormal))},c.startNetworkQualityTimer=function(){c.clearNetworkQualityTimer(),c.networkQualityTimer=setInterval(function(){if(c.gatewayClient.state!==sn.CONNECTED)c.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:0,downlinkNetworkQuality:0});else{var v=c.gatewayClient.traffic_stats;c.gatewayClient.dispatchEvent({type:"network-quality",uplinkNetworkQuality:c.networkQualityTrans(v.uplink_network_quality),downlinkNetworkQuality:c.networkQualityTrans(v.downlink_network_quality)})}},2e3)},c.clearNetworkQualityTimer=function(){c.networkQualityTimer&&clearInterval(c.networkQualityTimer)},c.networkQualityTrans=function(v){return v>=0&&v<.17?1:v>=.17&&v<.36?2:v>=.36&&v<.59?3:v>=.59&&v<=1?4:v>1?5:0},c.getStatsTimer=setInterval(function(){var v=c.gatewayClient.traffic_stats,h=Date.now();c.gatewayClient.dispatchEvent({type:"_testException"}),Object.keys(c.localStats).length&&c.exceptionMonitor.setLocalStats(c.localStats),Object.keys(c.remoteStats).length&&c.exceptionMonitor.setRemoteStats(c.remoteStats);var b={};Object.keys(c.gatewayClient.remoteStreams).forEach(function(P){var F=c.gatewayClient.remoteStreams[P],j=c.remoteStats[P],u={id:P,updatedAt:h};b[P]=u,u.firstFrameTime=F.firstFrameTime,j?(u.audioTotalPlayDuration=j.audioTotalPlayDuration+1,u.audioTotalFreezeTime=j.audioTotalFreezeTime,u.isAudioFreeze=!1,u.isAudioDecodeFailed=!1,u.videoTotalPlayDuration=j.videoTotalPlayDuration+1,u.videoTotalFreezeTime=j.videoTotalFreezeTime,u.isVideoFreeze=!1):(u.audioTotalPlayDuration=1,u.audioTotalFreezeTime=0,u.videoTotalPlayDuration=1,u.videoTotalFreezeTime=0);var W=v&&v.peer_delay&&v.peer_delay.find(function(Q){return Q.peer_uid==P});W&&(u.peer_delay=W),F&&(F.isPlaying()&&(u.audioDisabled=F.userMuteAudio||F.peerMuteAudio?"1":"0",u.videoDisabled=F.userMuteVideo||F.peerMuteVideo?"1":"0"),j&&j.peer_delay&&W&&j.peer_delay.stream_type!==W.stream_type&&c.gatewayClient.dispatchEvent({type:"streamTypeChange",uid:P,streamType:W.stream_type}),F.pc&&"established"==F.pc.state&&F.pc.getStats(function(Q){if(u.pcStats=Q,u.audioStats=Q.find(function(We){return"audio"==We.mediaType&&(We.id.indexOf("_recv")>-1||We.id.toLowerCase().indexOf("inbound")>-1)}),u.videoStats=Q.find(function(We){return"video"==We.mediaType&&(We.id.indexOf("_recv")>-1||We.id.toLowerCase().indexOf("inbound")>-1)}),j&&j.audioStats&&u.audioStats){var ne=parseInt(u.audioStats.bytesReceived)-parseInt(j.audioStats.bytesReceived),Oe=parseInt(u.audioStats.googDecodingNormal)-parseInt(j.audioStats.googDecodingNormal);if(u.audioStats.audioRecvBytesDelta=ne,u.audioStats.audioDecodingNormalDelta=Oe,c.session.recvBytes+=ne,isFinite(ne)&&u.audioStats.timestamp){var $=u.audioStats.timestamp.getTime()-j.audioStats.timestamp.getTime();u.audioRecvBitrate=Math.floor(8*ne/$)}c.isAudioFreeze(u.audioStats)&&u.audioTotalPlayDuration>10&&(u.audioTotalFreezeTime++,u.isAudioFreeze=!0),c.isAudioDecodeFailed(u.audioStats)&&u.audioTotalPlayDuration>10&&(u.isAudioDecodeFailed=!0),u.audioStats.audioTotalFreezeTime=u.audioTotalFreezeTime,u.audioStats.audioTotalPlayDuration=u.audioTotalPlayDuration,u.audioStats.audioFreezeRate=Math.ceil(100*u.audioTotalFreezeTime/u.audioTotalPlayDuration)}if(j&&j.videoStats&&u.videoStats){var Ie=parseInt(u.videoStats.bytesReceived)-parseInt(j.videoStats.bytesReceived);u.videoStats.videoRecvBytesDelta=Ie,c.session.recvBytes+=Ie,isFinite(Ie)&&u.videoStats.timestamp&&($=u.videoStats.timestamp.getTime()-j.videoStats.timestamp.getTime(),u.videoRecvBitrate=Math.floor(8*Ie/$)),c.isRemoteVideoFreeze(u.videoStats,j.videoStats)&&(u.videoTotalFreezeTime++,u.isVideoFreeze=!0),u.videoStats.videoTotalFreezeTime=u.videoTotalFreezeTime,u.videoStats.videoTotalPlayDuration=u.videoTotalPlayDuration,u.videoStats.videoFreezeRate=Math.ceil(100*u.videoTotalFreezeTime/u.videoTotalPlayDuration),F.player&&F.player.video&&F.player.video.videoWidth&&F.player.video.videoHeight?(u.videoStats.renderRemoteWidth=F.player.video.videoWidth,u.videoStats.renderRemoteHeight=F.player.video.videoHeight):(u.videoStats.renderRemoteWidth=F.videoWidth||u.videoStats.googFrameWidthReceived,u.videoStats.renderRemoteHeight=F.videoHeight||u.videoStats.googFrameHeightReceived)}}))}),c.remoteStats=b;var C={};if(Object.keys(c.gatewayClient.localStreams).forEach(function(P){var F=c.gatewayClient.localStreams[P],j=c.localStats[P],u={id:P,updatedAt:h};C[P]=u,j?(u.videoTotalPlayDuration=j.videoTotalPlayDuration+1,u.videoTotalFreezeTime=j.videoTotalFreezeTime,u.isVideoFreeze=!1):(u.videoTotalPlayDuration=1,u.videoTotalFreezeTime=0),F&&(F.isPlaying()&&(u.audioDisabled=F.userMuteAudio?"1":"0",u.videoDisabled=F.userMuteVideo?"1":"0"),F.video&&F.attributes.maxVideoBW?u.videoTargetSendBitrate=F.attributes.maxVideoBW:F.video&&F.screenAttributes&&(u.videoTargetSendBitrate=F.screenAttributes.maxVideoBW),F.pc&&"established"==F.pc.state&&F.pc.getStats(function(W){if(u.pcStats=W.reverse(),u.audioStats=W.find(function($){return"audio"==$.mediaType&&($.id.indexOf("_send")>-1||$.id.toLowerCase().indexOf("outbound")>-1)}),u.videoStats=W.find(function($){return"video"==$.mediaType&&($.id.indexOf("_send")>-1||$.id.toLowerCase().indexOf("outbound")>-1)}),u.audioStats&&j&&j.audioStats){var Q=parseInt(u.audioStats.bytesSent)-parseInt(j.audioStats.bytesSent);if(u.audioStats.audioSendBytesDelta=Q,c.session.sendBytes+=Q,isFinite(Q)&&u.audioStats.timestamp){var ne=u.audioStats.timestamp.getTime()-j.audioStats.timestamp.getTime();u.audioSendBitrate=Math.floor(8*Q/ne)}}if(u.videoStats&&j&&j.videoStats){var Oe=parseInt(u.videoStats.bytesSent)-parseInt(j.videoStats.bytesSent);u.videoStats.videoSendBytesDelta=Oe,c.session.sendBytes+=Oe,isFinite(Oe)&&u.videoStats.timestamp&&(ne=u.videoStats.timestamp.getTime()-j.videoStats.timestamp.getTime(),u.videoSendBitrate=Math.floor(8*Oe/ne)),c.isLocalVideoFreeze(u.videoStats,j.videoStats)&&(u.videoTotalFreezeTime++,u.isVideoFreeze=!0),u.videoStats.videoTotalFreezeTime=u.videoTotalFreezeTime,u.videoStats.videoTotalPlayDuration=u.videoTotalPlayDuration,u.videoStats.videoFreezeRate=Math.ceil(100*u.videoTotalFreezeTime/u.videoTotalPlayDuration),u.videoStats.renderLocalWidth=F.videoWidth||u.videoStats.googFrameWidthSent,u.videoStats.renderLocalHeight=F.videoHeight||u.videoStats.googFrameHeightSent}}))}),c.localStats=C,c.session.HTTPSendBytesDelta=Object(Wn.b)()-c.session.HTTPSendBytes,c.session.HTTPSendBytes=Object(Wn.b)(),c.session.HTTPRecvBytesDelta=Object(Wn.a)()-c.session.HTTPRecvBytes,c.session.HTTPRecvBytes=Object(Wn.a)(),c.gatewayClient.socket&&c.gatewayClient.socket.state===c.gatewayClient.CONNECTED){var O=c.gatewayClient.socket;c.session.WSSendBytesDelta=O.getSendBytes()-c.session.WSSendBytes,c.session.WSSendBytes=O.getSendBytes(),c.session.WSRecvBytesDelta=O.getRecvBytes()-c.session.WSRecvBytes,c.session.WSRecvBytes=O.getRecvBytes()}},1e3),c.gatewayClient.on("join",function(){c.session={sendBytes:0,recvBytes:0,WSSendBytes:0,WSSendBytesDelta:0,WSRecvBytes:0,WSRecvBytesDelta:0,HTTPSendBytes:0,HTTPSendBytesDelta:0,HTTPRecvBytes:0,HTTPRecvBytesDelta:0}}),c),r.configDistributManager=function(I){var c={};return c.client=I,c.client.gatewayClient&&c.client.gatewayClient.on("config-distribute",function(v){var h=v.joinInfo,b=v.config;if(b){Je(b.uploadLog)||(Object(M.setParameter)("UPLOAD_LOG",b.uploadLog),L.b.reportApiInvoke(h.sid,{name:"_configDistribute",options:{feature:"uploadLog",value:b.uploadLog}})()),Je(b.dualStream)||(I.isDualStream=b.dualStream,L.b.reportApiInvoke(h.sid,{name:"_configDistribute",options:{feature:"dualStream",value:b.dualStream}})()),Je(b.streamFallbackOption)||c.client.gatewayClient&&c.client.gatewayClient.on("stream-subscribed",function(C){var O=C.stream;O?(c.client.gatewayClient.setStreamFallbackOption(O,b.streamFallbackOption),L.b.reportApiInvoke(h.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:b.streamFallbackOption,streamId:O.getId()}})()):L.b.reportApiInvoke(h.sid,{name:"_configDistribute",options:{feature:"streamFallbackOption",value:b.streamFallbackOption,streamId:O.getId(),err:"invalid stream"}})()});try{S.default.debug("[".concat(I.clientId,"] setParameter in distribution: ").concat(JSON.stringify(b))),Object.keys(b).map(function(C){return Object(M.setParameter)(C,b[C])})}catch{S.default.debug("[".concat(I.clientId,"] setParameter in distribution failed: ").concat(JSON.stringify(b)))}}}),c}(r),function(I,c){var h,b,C,O,P,F,j,u,W,v=arguments;I.liveStreaming=ae(),I.liveStreaming.connections={inject_streaming:null,mix_streaming:null,raw_streaming:null},I.liveStreaming.connectionTypes={inject_streaming:"pull",mix_streaming:"push",raw_streaming:"push"},I.liveStreaming.pushStates={},I.liveStreaming.pullStates={},I.gatewayClient.addEventListener("join",function(Q){I.liveStreaming.resumeStates("pull")}),I.gatewayClient.addEventListener("stream-unpublished",function(Q){if(Q.options&&0===Q.options.streamType)for(var ne in I.liveStreaming.pushStates){var Oe=I.liveStreaming.pushStates[ne];Oe.url&&I._stopLiveStreaming(Oe.url,Oe.transcodingEnabled,!0)}}),I.gatewayClient.addEventListener("stream-published",function(Q){I.liveStreaming.resumeStates("push")}),I.liveStreaming.connect=(W=vn()(Rt.a.mark(function Q(ne){var Oe,$;return Rt.a.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:if(I.joinInfo&&I.joinInfo.uid&&parseInt(I.joinInfo.vid,10)){Ie.next=3;break}throw new Error("CLIENT_NOT_JOINED");case 3:return Oe=new Xn({appId:c.appId,cname:I.channel,sid:c.sessionId,uid:I.joinInfo.uid}),I.liveStreaming.connections[ne]=Oe,Ie.next=7,Er({appId:c.appId,cname:I.channel,serviceName:ne,sid:c.sessionId});case 7:return $=Ie.sent,Ie.next=10,Oe.connect({wsClient:$});case 10:return Oe.on("notification",function(We){if(We.serviceName=ne,I.liveStreaming.dispatchEvent(We),503!==We.code)switch(We.serviceName){case"inject_streaming":var tt={reason:We&&We.reason,status:Zn(We&&We.code),type:"streamInjectedStatus",uid:We&&We.serverStatus&&We.serverStatus.inject_uid,url:We&&We.serverStatus&&We.serverStatus.url};I.gatewayClient.dispatchEvent(tt);break;case"raw_streaming":case"mix_streaming":I.gatewayClient.dispatchEvent({reason:We&&We.reason,status:We&&We.code,type:We&&200===We.code?"liveStreamingStarted":"liveStreamingFailed",uid:We&&We.serverStatus&&We.uid,url:We&&We.serverStatus&&We.serverStatus.url})}}),Ie.abrupt("return",Oe);case 12:case"end":return Ie.stop()}},Q,this)})),function(Q){return W.apply(this,arguments)}),I.liveStreaming.disconnect=(u=vn()(Rt.a.mark(function Q(ne){var Oe,$;return Rt.a.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:Ie.t0=Rt.a.keys(I.liveStreaming.connections);case 1:if((Ie.t1=Ie.t0()).done){Ie.next=13;break}if(!I.liveStreaming.connections.hasOwnProperty(Oe=Ie.t1.value)){Ie.next=11;break}if(!($=I.liveStreaming.connections[Oe])||ne&&ne!==Oe){Ie.next=11;break}return S.default.info("Disconnecting liveStreaming ".concat(Oe)),Ie.next=9,$.disconnect();case 9:I.liveStreaming.connections[Oe]=null;case 11:Ie.next=1;break;case 13:case"end":return Ie.stop()}},Q,this)})),function(Q){return u.apply(this,arguments)}),I.liveStreaming.resumeStates=(j=vn()(Rt.a.mark(function Q(ne){var Oe,$,Ie,We,tt,w,Pe,qe;return Rt.a.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:Ee.t0=Rt.a.keys(I.liveStreaming.connections);case 1:if((Ee.t1=Ee.t0()).done){Ee.next=8;break}if(Oe=Ee.t1.value,!ne||I.liveStreaming.connectionTypes[Oe]===ne){Ee.next=5;break}return Ee.abrupt("continue",1);case 5:I.liveStreaming.connections.hasOwnProperty(Oe)&&($=I.liveStreaming.connections[Oe])&&(S.default.info("LiveStreaming closing connection ".concat(Oe)),$.disconnect(),I.liveStreaming.connections[Oe]=null),Ee.next=1;break;case 8:Ee.t2=Rt.a.keys(I.liveStreaming.pushStates);case 9:if((Ee.t3=Ee.t2()).done){Ee.next=37;break}if(Ie=Ee.t3.value,!ne||"push"===ne){Ee.next=13;break}return Ee.abrupt("continue",9);case 13:if(!I.liveStreaming.pushStates.hasOwnProperty(Ie)){Ee.next=35;break}if(We=I.liveStreaming.pushStates[Ie],"audience"!==I.gatewayClient.role){Ee.next=19;break}S.default.warning("Cannot resume LiveStreaming in audience mode. ".concat(We.url),We),Ee.next=35;break;case 19:if(!We){Ee.next=35;break}return S.default.debug("Resuming LiveStreaming ".concat(We.url),We),Ee.prev=21,Ee.next=24,I._startLiveStreaming(We.url,We.transcodingEnabled);case 24:tt=Ee.sent,S.default.debug("Resumed LiveStreaming ".concat(We.url,": ").concat(tt.reason)),Ee.next=35;break;case 28:if(Ee.prev=28,Ee.t4=Ee.catch(21),454!==Ee.t4.code){Ee.next=34;break}S.default.debug("Resumed LiveStreaming ".concat(We.url,": ").concat(Ee.t4.reason)),Ee.next=35;break;case 34:throw Ee.t4;case 35:Ee.next=9;break;case 37:Ee.t5=Rt.a.keys(I.liveStreaming.pullStates);case 38:if((Ee.t6=Ee.t5()).done){Ee.next=62;break}if(w=Ee.t6.value,!ne||"pull"===ne){Ee.next=42;break}return Ee.abrupt("continue",38);case 42:if(!I.liveStreaming.pullStates.hasOwnProperty(w)){Ee.next=60;break}if(Pe=I.liveStreaming.pullStates[w],"audience"!==I.gatewayClient.role){Ee.next=48;break}S.default.warning("Cannot resume addInjectStreamUrl in audience mode. ".concat(Pe.url),Pe),Ee.next=60;break;case 48:if(!Pe){Ee.next=60;break}return S.default.debug("Resuming LiveStreaming pullStream ".concat(Pe.url),Pe),Ee.prev=50,Ee.next=53,I._addInjectStreamUrl(Pe.url,Pe.transcodingConfig);case 53:qe=Ee.sent,S.default.debug("Resumed LiveStreaming pullStream ".concat(Pe.url,": ").concat(qe.reason)),Ee.next=60;break;case 57:Ee.prev=57,Ee.t7=Ee.catch(50),451===Ee.t7.code&&S.default.debug("Resumed LiveStreaming pullStream ".concat(Pe.url,": ").concat(Ee.t7.reason));case 60:Ee.next=38;break;case 62:case"end":return Ee.stop()}},Q,this,[[21,28],[50,57]])})),function(Q){return j.apply(this,arguments)}),I.liveStreaming.startOptions={autoDestroyTime:30},I.liveStreaming.transcodingConfig={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,images:[],lowLatency:!1,metadata:"",userConfigExtraInfo:"",userConfigs:[],videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFramerate:15,videoGop:30,width:640},I.startLiveStreaming=function(Q,ne){Je(ne)||te(ne,"transcodingEnabled"),Kt(Q,"url");var Oe=L.b.reportApiInvoke(c.sessionId,{name:"Client.startLiveStreaming",options:arguments,tag:"tracer"});if(I.gatewayClient&&"audience"===I.gatewayClient.role){var $={code:403,reason:"AUDIENCE_STREAMING_FORBIDDEN"};throw Oe($),$}var Ie=I._startLiveStreaming(Q,ne);return Ie.then(function(We){Oe(null,We)}).catch(function(We){Oe(We)}),Ie},I._startLiveStreaming=(F=vn()(Rt.a.mark(function Q(ne,Oe){var $,Ie,We,tt;return Rt.a.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return $=z()({allocate:!0,clientRequest:{command:"PublishStream"},command:"request"}),S.default.debug("startLiveStreaming ".concat(ne,", ").concat(Oe)),z()($.clientRequest,I.liveStreaming.startOptions,{ts:Date.now(),url:ne,vid:parseInt(I.joinInfo.vid,10)}),Ie=null,Oe?(I.liveStreaming.connections.mix_streaming||I.liveStreaming.connect("mix_streaming"),$.clientRequest.transcodingConfig=JSON.parse(JSON.stringify(I.liveStreaming.transcodingConfig)),Ie=I.liveStreaming.connections.mix_streaming):("vp8"===c.codec&&S.default.warning("VP8 is not supported by raw_streaming. Subscriber side will suffer"),"rtc"===c.mode&&S.default.warning("RTC mode is not supported by raw_streaming. Subscriber side will suffer"),I.liveStreaming.connections.raw_streaming||I.liveStreaming.connect("raw_streaming"),Ie=I.liveStreaming.connections.raw_streaming),We=null,tt={},w.prev=7,w.next=10,Ie.request($);case 10:We=w.sent,tt.type="liveStreamingStarted",tt.reason=We&&We.reason,tt.status=We&&We.code,tt.url=We&&We.serverResponse&&We.serverResponse.url,I.gatewayClient.dispatchEvent(tt),w.next=26;break;case 18:throw w.prev=18,w.t0=w.catch(7),tt.type="liveStreamingFailed",tt.reason=w.t0&&w.t0.reason,tt.status=w.t0&&w.t0.code,tt.url=w.t0&&w.t0.serverResponse&&w.t0.serverResponse.url,I.gatewayClient.dispatchEvent(tt),w.t0;case 26:return I.liveStreaming.pushStates[ne]={transcodingEnabled:Oe,url:ne},w.abrupt("return",We);case 28:case"end":return w.stop()}},Q,this,[[7,18]])})),function(Q,ne){return F.apply(this,arguments)}),I.setLiveTranscoding=function(Q,ne){an(Q,"transcoding");var $=Q.width,Ie=Q.height,We=Q.videoBitrate,tt=Q.videoFramerate,w=Q.lowLatency,Pe=Q.audioSampleRate,qe=Q.audioBitrate,Ee=Q.audioChannels,ut=Q.videoGop,ie=Q.videoCodecProfile,Ae=Q.userCount,nt=Q.backgroundColor,st=Q.transcodingUsers;if(st||(st=Q.userConfigs),Je($)||le($,"width"),Je(Ie)||le(Ie,"height"),Je(We)||le(We,"videoBitrate",1,1e6),Je(tt)||le(tt,"videoFramerate"),Je(w)||te(w,"lowLatency"),Je(Pe)||Nn(Pe,"audioSampleRate",[32e3,44100,48e3]),Je(qe)||le(qe,"audioBitrate",1,128),Je(Ee)||Nn(Ee,"audioChannels",[1,2,3,4,5]),Je(ut)||le(ut,"videoGop"),Je(ie)||Nn(ie,"videoCodecProfile",[66,77,100]),Je(Ae)||le(Ae,"userCount",0,17),Je(nt)||le(nt,"backgroundColor",0,16777215),!Je(st)){if(!$t(st))throw new Error("[transcodingUsers]: transcodingUsers should be Array");if(st.length>17)throw new Error("The length of transcodingUsers cannot greater than 17");st.map(function(vt,Pt){if(!Je(vt.uid)&&!Rr(vt.uid)&&!isValidString(vt.uid,1,255))throw new Error("[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");if(Je(vt.x)||le(vt.x,"transcodingUser[".concat(Pt,"].x"),0,1e4),Je(vt.y)||le(vt.y,"transcodingUser[".concat(Pt,"].y"),0,1e4),Je(vt.width)||le(vt.width,"transcodingUser[".concat(Pt,"].width"),0,1e4),Je(vt.height)||le(vt.height,"transcodingUser[".concat(Pt,"].height"),0,1e4),Je(vt.zOrder)||le(vt.zOrder,"transcodingUser[".concat(Pt,"].zOrder"),0,100),!(Je(vt.alpha)||wt(vt.alpha)&&vt.alpha<=1&&vt.alpha>=0))throw new Error("transcodingUser[${index}].alpha: The value range is [0, 1]")})}var dt=L.b.reportApiInvoke(c.sessionId,{name:"Client.setLiveTranscoding",options:arguments,tag:"tracer"});if((Q=JSON.parse(JSON.stringify(Q))).transcodingUsers&&(Q.userConfigs=Q.transcodingUsers,delete Q.transcodingUsers),I.joinInfo.stringUid&&Q.userConfigs&&Q.userConfigs.length){var yt=[];Q.userConfigs.forEach(function(vt){yt.push(qn(I.joinInfo,I.gatewayClient,vt.uid).then(function(Pt){vt.uid=Pt.uid}))});var mt=Promise.all(yt).then(function(){return I._setLiveTranscoding(Q,ne)});return mt.then(function(vt){dt(null,vt)}).catch(function(vt){dt(vt)}),mt}var It=I._setLiveTranscoding(Q,ne);return It.then(function(vt){dt(null,vt)}).catch(function(vt){dt(vt)}),It},I._setLiveTranscoding=(P=vn()(Rt.a.mark(function Q(ne,Oe){var $,Ie,We;return Rt.a.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:if(I.liveStreaming.transcodingConfig=z()(I.liveStreaming.transcodingConfig,ne),"boolean"!=typeof Oe&&(Oe=!!I.liveStreaming.connections.mix_streaming),$=JSON.parse(JSON.stringify({allocate:!1,clientRequest:{command:"UpdateTranscoding",transcodingConfig:I.liveStreaming.transcodingConfig},command:"request"})),Ie={},!Oe){tt.next=16;break}return I.liveStreaming.connections.mix_streaming||I.liveStreaming.connect("mix_streaming"),tt.next=8,I.liveStreaming.connections.mix_streaming.request($);case 8:return We=tt.sent,Ie.type="liveTranscodingUpdated",Ie.reason=We.reason,Ie.status=We.code,I.gatewayClient.dispatchEvent(Ie),tt.abrupt("return",We);case 16:return tt.abrupt("return",{code:200,reason:"success"});case 17:case"end":return tt.stop()}},Q,this)})),function(Q,ne){return P.apply(this,arguments)}),I.stopLiveStreaming=function(Q,ne){Kt(Q,"url");var Oe=L.b.reportApiInvoke(c.sessionId,{name:"Client.stopLiveStreaming",options:arguments,tag:"tracer"}),$=I._stopLiveStreaming(Q,ne);return $.then(function(Ie){Oe(null,Ie)}).catch(function(Ie){Oe(Ie)}),$},I._stopLiveStreaming=(O=vn()(Rt.a.mark(function Q(ne,Oe,$){var Ie,We,tt,w,Pe,qe;return Rt.a.wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return null,tt={allocate:!1,clientRequest:{command:"UnpublishStream",url:ne},command:"request"},I.liveStreaming.connections[Ie=(We=I.liveStreaming.pushStates[ne])?We.transcodingEnabled?"mix_streaming":"raw_streaming":Oe?"mix_streaming":"raw_streaming"]||I.liveStreaming.connect(Ie),w=null,Ee.prev=6,Ee.next=9,I.liveStreaming.connections[Ie].request(tt);case 9:w=Ee.sent,(Pe={}).type="liveStreamingStopped",Pe.reason=w&&w.reason,Pe.status=w&&w.code,Pe.url=w&&w.serverResponse&&w.serverResponse.url,I.gatewayClient.dispatchEvent(Pe),Ee.next=27;break;case 18:throw Ee.prev=18,Ee.t0=Ee.catch(6),(qe={}).type="liveStreamingStopped",qe.reason=Ee.t0&&Ee.t0.reason,qe.status=Ee.t0&&Ee.t0.code,qe.url=Ee.t0&&Ee.t0.serverResponse&&Ee.t0.serverResponse.url,I.gatewayClient.dispatchEvent(qe),Ee.t0;case 27:return $||delete I.liveStreaming.pushStates[ne],Ee.abrupt("return",w);case 29:case"end":return Ee.stop()}},Q,this,[[6,18]])})),function(Q,ne,Oe){return O.apply(this,arguments)}),I.liveStreaming.injectStreamTranscodingConfig={autoDestroyTime:30,audioBitrate:48,audioChannels:1,audioSampleRate:44100,height:0,videoBitrate:400,videoFramerate:15,videoGop:30,width:0},I.addInjectStreamUrl=function(Q,ne){Kt(Q,"url",1,255),an(ne,"config"),!Je(ne&&ne.width)&&le(ne.width,"config.width",0,1e4),!Je(ne&&ne.height)&&le(ne.height,"config.height",0,1e4),!Je(ne&&ne.videoGop)&&le(ne.videoGop,"config.videoGop",1,1e4),!Je(ne&&ne.videoFramerate)&&le(ne.videoFramerate,"config.videoFramerate",1,1e4),!Je(ne&&ne.videoBitrate)&&le(ne.videoBitrate,"config.videoBitrate",1,1e4),!Je(ne&&ne.audioSampleRate)&&Nn(ne.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),!Je(ne&&ne.audioBitrate)&&le(ne.audioBitrate,"config.audioBitrate",1,1e4),!Je(ne&&ne.audioChannels)&&le(ne.audioChannels,"config.audioChannels",1,2);var Oe=L.b.reportApiInvoke(c.sessionId,{name:"Client.addInjectStreamUrl",options:v,tag:"tracer"});if("audience"===I.gatewayClient.role){var $={code:403,reason:"AUDIENCE_INJECTING_FORBIDDEN"};throw Oe($),$}var Ie=I._addInjectStreamUrl(Q,ne);return Ie.then(function(We){Oe(null,We)}).catch(function(We){Oe(We)}),Ie},I._addInjectStreamUrl=(C=vn()(Rt.a.mark(function Q(ne,Oe){var $,Ie,We,tt,w;return Rt.a.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return $=z()({},I.liveStreaming.injectStreamTranscodingConfig,Oe),Ie={allocate:!0,clientRequest:{cname:I.channel,command:"InjectStream",sid:c.sessionId,transcodingConfig:$,ts:Date.now(),url:ne,vid:parseInt(I.joinInfo.vid,10)},command:"request"},I.liveStreaming.connections.inject_streaming||I.liveStreaming.connect("inject_streaming"),We=null,Pe.prev=4,Pe.next=7,I.liveStreaming.connections.inject_streaming.request(Ie);case 7:tt={reason:(We=Pe.sent)&&We.reason,status:Zn(We&&We.code),type:"streamInjectedStatus",uid:We&&We.serverResponse&&We.serverResponse.inject_uid,url:We&&We.serverResponse&&We.serverResponse.url},I.gatewayClient.dispatchEvent(tt),Pe.next=17;break;case 12:throw Pe.prev=12,Pe.t0=Pe.catch(4),w={reason:Pe.t0&&Pe.t0.reason,status:Zn(Pe.t0&&Pe.t0.code),type:"streamInjectedStatus",uid:Pe.t0&&Pe.t0.serverResponse&&Pe.t0.serverResponse.inject_uid,url:Pe.t0&&Pe.t0.serverResponse&&Pe.t0.serverResponse.url},I.gatewayClient.dispatchEvent(w),Pe.t0;case 17:return I.liveStreaming.pullStates[ne]={transcodingConfig:$,url:ne},Pe.abrupt("return",We);case 19:case"end":return Pe.stop()}},Q,this,[[4,12]])})),function(Q,ne){return C.apply(this,arguments)}),I.removeInjectStreamUrl=(b=vn()(Rt.a.mark(function Q(ne){var Oe,$,Ie=arguments;return Rt.a.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:return Kt(ne,"url",1,255),Oe=L.b.reportApiInvoke(c.sessionId,{name:"Client.removeInjectStreamUrl",options:Ie,tag:"tracer"}),($=I._removeInjectStreamUrl(ne)).then(function(tt){Oe(null,tt)}).catch(function(tt){Oe(tt)}),We.abrupt("return",$);case 5:case"end":return We.stop()}},Q,this)})),function(Q){return b.apply(this,arguments)}),I._removeInjectStreamUrl=(h=vn()(Rt.a.mark(function Q(ne){var Oe,$,Ie,We;return Rt.a.wrap(function(tt){for(;;)switch(tt.prev=tt.next){case 0:return Oe={allocate:!1,clientRequest:{command:"UninjectStream",url:ne},command:"request"},I.liveStreaming.connections.inject_streaming||I.liveStreaming.connect("inject_streaming"),$=null,tt.prev=3,tt.next=6,I.liveStreaming.connections.inject_streaming.request(Oe);case 6:Ie={reason:($=tt.sent)&&$.reason,status:un($&&$.code),type:"streamInjectedStatus",uid:$&&$.serverResponse&&$.serverResponse.inject_uid,url:$&&$.serverResponse&&$.serverResponse.url},I.gatewayClient.dispatchEvent(Ie),tt.next=16;break;case 11:throw tt.prev=11,tt.t0=tt.catch(3),We={reason:tt.t0&&tt.t0.reason,status:un(tt.t0&&tt.t0.code),type:"streamInjectedStatus",uid:tt.t0&&tt.t0.serverResponse&&tt.t0.serverResponse.inject_uid,url:tt.t0&&tt.t0.serverResponse&&tt.t0.serverResponse.url},I.gatewayClient.dispatchEvent(We),tt.t0;case 16:return delete I.liveStreaming.pullStates[ne],tt.abrupt("return",$);case 18:case"end":return tt.stop()}},Q,this,[[3,11]])})),function(Q){return h.apply(this,arguments)})}(r,g),Je(g.turnServer)||r.setTurnServer(g.turnServer),Je(g.proxyServer)||r.setProxyServer(g.proxyServer),"live"===r.mode&&(r.gatewayClient.role="audience"),"rtc"===r.mode&&(r.gatewayClient.role="host"),r.gatewayClient.on("onMultiIP",function(I){r.gatewayClient.closeGateway(),r.gatewayClient.socket=void 0,r.gatewayClient.hasChangeBGPAddress=!0,r.joinInfo.multiIP=I.option,r.gatewayClient.state=sn.CONNECTING;var c=function(v){S.default.info("[".concat(r.clientId,"] Joining channel: ").concat(r.channel)),r.joinInfo.cid=v.cid,r.joinInfo.uid||(r.joinInfo.uid=v.uid),r.joinInfo.uni_lbs_ip=v.uni_lbs_ip,r.joinInfo.gatewayAddr=v.gateway_addr,r.onSuccess?r.gatewayClient.join(r.joinInfo,r.key,function(h){S.default.info("[".concat(r.clientId,"] Join channel ").concat(r.channel," success"));var b=r.onSuccess;r.onSuccess=null,r.onFailure=null,b(h)},r.onFailure):(r.gatewayClient.joinInfo=z()({},r.joinInfo),r.gatewayClient.rejoin())};r.joinInfo.stringUid&&!r.joinInfo.uid?(r.userAccountReq&&!r.userAccountReq.isFinished()&&r.userAccountReq.cancel(),r.userAccountReq=qn(joinInfo,r.gatewayClient),r.userAccountReq.then(function(v){S.default.error("getUserAccount Success ".concat(v.url," ").concat(joinInfo.stringUid," => ").concat(v.uid)),r.joinInfo.uid=v.uid,Ft(r.joinInfo,c)}).catch(function(v){S.default.error("getUserAccount rejected",v),r.onFailure(v)})):Ft(r.joinInfo,c)}),r.gatewayClient.on("rejoin-start",function(){r._renewSession(),L.b.sessionInit(g.sessionId,{lts:(new Date).getTime(),extend:{rejoin:!0},cname:r.channel,appid:g.appId,mode:g.mode,succ:!0})}),r.gatewayClient.on("recover",function(){r._renewSession(),console.log("recover",g.sessionId),L.b.sessionInit(g.sessionId,{lts:(new Date).getTime(),extend:{recover:!0},cname:r.channel,appid:g.appId,mode:g.mode,succ:!0})}),r.gatewayClient.on("rejoin",function(){var I=r.highStreamState;if(S.default.debug("[".concat(r.clientId,"] Client local stream preState: ").concat(I)),r.onSuccess){var c=r.onSuccess;r.onSuccess=null,r.onFailure=null,c()}!r.highStream||0!==I&&1!==I||(S.default.info("[".concat(r.clientId,"] publish after rejoin")),r.highStreamState=2,r.lowStreamState=2,r.publish(r.highStream,function(v){v&&S.default.info("[".concat(r.clientId,"] "),v)}))}),r.gatewayClient.on("streamPublished",function(I){r.hasPublished||(r.hasPublished=!0,r.gatewayClient.dispatchEvent(pe({type:"stream-published",stream:I.stream})))}),r.gatewayClient.on("pubP2PLost",function(I){S.default.debug("[".concat(r.clientId,"] Start reconnect local peerConnection: ").concat(r.highStream.getId())),r.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:r.highStream.getId()}),1===r.highStreamState&&(r.highStreamState=0,r.lowStreamState=0),r._unpublish(r.highStream,function(){r._publish(r.highStream,function(){S.default.debug("[".concat(r.clientId,"] Reconnect local peerConnection success: ").concat(r.highStream.getId())),r.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:r.highStream.getId(),success:!0,reason:""})},function(c){S.default.debug("[".concat(r.clientId,"] Reconnect local peerConnection failed: ").concat(c)),r.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:r.highStream.getId(),success:!1,reason:c})})},function(c){S.default.debug("[".concat(r.clientId,"] Reconnect local peerConnection failed: ").concat(c)),r.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:r.highStream.getId(),success:!1,reason:c})})}),r.gatewayClient.on("subP2PLost",function(I){S.default.debug("[".concat(r.clientId,"] Start reconnect remote peerConnection: ").concat(I.stream.getId()," ").concat(I.stream.subscribeOptions)),r.gatewayClient.dispatchEvent({type:"stream-reconnect-start",uid:I.stream.getId()});var c=I.stream.subscribeOptions;console.log("Re-subscribe stream",c,I.stream),r.gatewayClient.unsubscribe(I.stream,function(){I.stream.subscribeOptions=c,r.gatewayClient.subscribe(I.stream,function(){S.default.debug("[".concat(r.clientId,"] Reconnect remote peerConnection success: ").concat(I.stream.getId())),r.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:I.stream.getId(),success:!1,reason:""})},function(v){S.default.debug("[".concat(r.clientId,"] Reconnect remote peerConnection failed: "),v),r.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:I.stream.getId(),success:!1,reason:v})})},function(v){S.default.debug("[".concat(r.clientId,"] Reconnect remote peerConnection failed: "),v),r.gatewayClient.dispatchEvent({type:"stream-reconnect-end",uid:I.stream.getId(),success:!1,reason:v})})}),fr.on("networkTypeChanged",function(I){r.gatewayClient&&r.gatewayClient.dispatchEvent(I);var c=z()({},I,{type:"network-type-changed"});r.gatewayClient.dispatchEvent(c)}),Yt.on("recordingDeviceChanged",function(I){r.gatewayClient&&r.gatewayClient.dispatchEvent(I);var c=z()({},I,{type:"recording-device-changed"});r.gatewayClient.dispatchEvent(c)}),Yt.on("playoutDeviceChanged",function(I){r.gatewayClient&&r.gatewayClient.dispatchEvent(I);var c=z()({},I,{type:"playout-device-changed"});r.gatewayClient.dispatchEvent(c)}),Yt.on("cameraChanged",function(I){r.gatewayClient&&r.gatewayClient.dispatchEvent(I);var c=z()({},I,{type:"camera-changed"});r.gatewayClient.dispatchEvent(c)}),r.gatewayClient.on("streamTypeChange",function(I){var c=z()({},I,{type:"stream-type-changed"});r.gatewayClient.dispatchEvent(c),L.b.reportApiInvoke(g.sessionId,{name:"streamTypeChange"})(null,JSON.stringify(I))}),r},Co=Yt.getDevices,bo=Ut,ri=JSON.parse(JSON.stringify(M.SUPPORT_RESOLUTION_LIST));U.default={TranscodingUser:{uid:0,x:0,y:0,width:0,height:0,zOrder:0,alpha:1},LiveTranscoding:{width:640,height:360,videoBitrate:400,videoFramerate:15,lowLatency:!1,audioSampleRate:48e3,audioBitrate:48,audioChannels:1,videoGop:30,videoCodecProfile:100,userCount:0,userConfigExtraInfo:{},backgroundColor:0,transcodingUsers:[]},createClient:function(g){var r=L.b.reportApiInvoke(null,{name:"createClient",options:arguments,tag:"tracer"});(g=z()({},g||{})).codec||(g.codec="h264_interop"===g.mode?"h264":"vp8");var c,I=-1===$n.indexOf((c=g).mode)?re_INVALID_CLIENT_MODE:-1===yr.indexOf(c.codec)?re_INVALID_CLIENT_CODEC:"h264_interop"==c.mode&&"h264"!==c.codec&&re_CLIENT_MODE_CODEC_MISMATCH;if(I)throw S.default.error("Invalid parameter setting MODE: ".concat(g.mode," CODEC: ").concat(g.codec," ERROR ").concat(I)),r(I),new Error(I);return S.default.info("Creating client, MODE: ".concat(g.mode," CODEC: ").concat(g.codec)),function(c){switch(c.mode){case"interop":case"h264_interop":c.mode="live";break;case"web-only":c.mode="rtc"}}(g),r(null,g),ho(g)},createStream:function(g){var r=L.b.reportApiInvoke(null,{name:"createStream",options:arguments,tag:"tracer"});an(g,"StreamSpec");var I=g.streamID,c=g.audio,v=g.video,h=g.screen,b=g.cameraId,C=g.facingMode,O=g.microphoneId,P=g.mirror,F=g.extensionId,j=g.mediaSource,u=g.audioProcessing;if(!Je(I)&&!Object(zt.c)(I)&&!X(I,1,255))throw new Error("[String streamID] Length of the string: [1,255]. ASCII characters only. [Number streamID] The value range is Uint32");if(te(c,"audio"),te(v,"video"),Je(h)||te(h,"screen"),Je(b)||Kt(b,"cameraId",0,255,!1),Je(C)||Nn(C,"facingMode",["user","environment","left","right"]),Je(O)||Kt(O,"microphoneId",0,255,!1),Je(F)||Kt(F,"extensionId"),Je(j)||Nn(j,"mediaSource",["screen","application","window"]),Je(P)||te(P,"mirror"),!Je(u)){var W=u.AGC,Q=u.AEC,ne=u.ANS;Je(W)||te(W,"AGC"),Je(Q)||te(Q,"AEC"),Je(ne)||te(ne,"ANS")}S.default.debug("Create stream");var Oe=En(g);return r(),Oe},Logger:S.default,report:L.b,getDevices:Co,getScreenSources:bo,getParameter:M.getParameter,setParameter:M.setParameter,checkSystemRequirements:function(){var g=L.b.reportApiInvoke(null,{name:"checkSystemRequirements",options:arguments,tag:"tracer"}),r=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,I=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,c=window.WebSocket,v=!!r&&!!I&&!!c,h=!1;S.default.debug(Y.getBrowserInfo(),"isAPISupport:"+v),Y.isChrome()&&Y.getBrowserVersion()>=58&&"iOS"!==Y.getBrowserOS()&&(h=!0),Y.isFireFox()&&Y.getBrowserVersion()>=56&&(h=!0),Y.isOpera()&&Y.getBrowserVersion()>=45&&(h=!0),Y.isSafari()&&Y.getBrowserVersion()>=11&&(h=!0),Y.isEdge()&&(h=!0),(Y.isWeChatBrowser()||Y.isQQBrowser())&&"iOS"!==Y.getBrowserOS()&&(h=!0),Y.isSupportedPC()||Y.isSupportedMobile()||(h=!1);var b=v&&h;return g(null,b),b},getSupportedCodec:St.getSupportedCodec,VERSION:M.VERSION,BUILD:M.BUILD,PROFILE_TABLE:ri,AUDIO_SAMPLE_RATE_32000:32e3,AUDIO_SAMPLE_RATE_44100:44100,AUDIO_SAMPLE_RATE_48000:48e3,VIDEO_CODEC_PROFILE_BASELINE:66,VIDEO_CODEC_PROFILE_MAIN:77,VIDEO_CODEC_PROFILE_HIGH:100,REMOTE_VIDEO_STREAM_HIGH:0,REMOTE_VIDEO_STREAM_LOW:1,REMOTE_VIDEO_STREAM_MEDIUM:2}}]).default},1444:(Mt,xe,U)=>{"use strict";U.d(xe,{QC:()=>De,TE:()=>L,rp:()=>Ct,uy:()=>On});var E=U(8256),M=U(8293);class L{constructor(Te){this.config=Te,this.audioDevices=[],this.videoDevices=[],this.AgoraRTC=L.AgoraRTC,this.checkSystemRequirements()?this.collectDevices():this.AgoraRTC.Logger.error("Web RTC is not supported in this browser")}checkSystemRequirements(){return this.AgoraRTC.checkSystemRequirements()}createClient(Te,Yt=!0,Mn,nn){return this.client=this.AgoraRTC.createClient(Te),Yt&&this.init(this.config.AppID,Mn,nn),this.client}createStream(Te){if(!Te.microphoneId&&this.audioDevices&&this.audioDevices.length&&(Te.microphoneId=this.audioDevices[0].deviceId),!Te.cameraId&&this.videoDevices&&this.videoDevices.length){const Yt=this.videoDevices[0].deviceId;Te.cameraId=Te.cameraId||Yt}return this.AgoraRTC.createStream(Te)}init(Te,Yt,Mn){this.client.init(Te,Yt,Mn)}collectDevices(){this.AgoraRTC.getDevices(Te=>{const Yt=Te.filter(nn=>"audioinput"===nn.kind&&"default"!==nn.deviceId),Mn=Te.filter(nn=>"videoinput"===nn.kind&&"default"!==nn.deviceId);this.audioDevices=Yt,this.videoDevices=Mn})}}L.\u0275fac=function(Te){return new(Te||L)(E.LFG("config"))},L.\u0275prov=E.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L.AgoraRTC=M,L.ngInjectableDef=(0,E.Yz7)({factory:function(){return new L((0,E.LFG)("config"))},token:L,providedIn:"root"});let De=(()=>{class zt{static forRoot(Yt){return{ngModule:zt,providers:[L,{provide:"config",useValue:Yt}]}}}return zt.\u0275fac=function(Yt){return new(Yt||zt)},zt.\u0275mod=E.oAB({type:zt}),zt.\u0275inj=E.cJS({}),zt})();const Ut={RELAY_OK:0,SERVER_ERROR_RESPONSE:1,SERVER_NO_RESPONSE:2,NO_RESOURCE_AVAILABLE:3,FAILED_JOIN_SRC:4,FAILED_JOIN_DEST:5,FAILED_PACKET_RECEIVED_FROM_SRC:6,FAILED_PACKET_SENT_TO_DEST:7,SERVER_CONNECTION_LOST:8,INTERNAL_ERROR:9,SRC_TOKEN_EXPIRED:10,DEST_TOKEN_EXPIRED:11,RELAY_ALREADY_START:12,RELAY_NOT_START:13};Ut[Ut.RELAY_OK]="RELAY_OK",Ut[Ut.SERVER_ERROR_RESPONSE]="SERVER_ERROR_RESPONSE",Ut[Ut.SERVER_NO_RESPONSE]="SERVER_NO_RESPONSE",Ut[Ut.NO_RESOURCE_AVAILABLE]="NO_RESOURCE_AVAILABLE",Ut[Ut.FAILED_JOIN_SRC]="FAILED_JOIN_SRC",Ut[Ut.FAILED_JOIN_DEST]="FAILED_JOIN_DEST",Ut[Ut.FAILED_PACKET_RECEIVED_FROM_SRC]="FAILED_PACKET_RECEIVED_FROM_SRC",Ut[Ut.FAILED_PACKET_SENT_TO_DEST]="FAILED_PACKET_SENT_TO_DEST",Ut[Ut.SERVER_CONNECTION_LOST]="SERVER_CONNECTION_LOST",Ut[Ut.INTERNAL_ERROR]="INTERNAL_ERROR",Ut[Ut.SRC_TOKEN_EXPIRED]="SRC_TOKEN_EXPIRED",Ut[Ut.DEST_TOKEN_EXPIRED]="DEST_TOKEN_EXPIRED",Ut[Ut.RELAY_ALREADY_START]="RELAY_ALREADY_START",Ut[Ut.RELAY_NOT_START]="RELAY_NOT_START";const Ct={FirstAudioFrameDecoded:"first-audio-frame-decode",FirstVideoFrameDecoded:"first-video-frame-decode",LocalStreamPublished:"stream-published",RemoteStreamAdded:"stream-added",RemoteStreamRemoved:"stream-removed",RemoteStreamSubscribed:"stream-subscribed",PeerLeave:"peer-leave",PeerOnline:"peer-online",RemoteAudioMuted:"mute-audio",RemoteAudioUnmuted:"unmute-audio",RemoveVideoMuted:"mute-video",RemoteVideoUnmuted:"unmute-video",CryptError:"crypt-error",LocalClientBanned:"client-banned",ActiveSpeaker:"active-speaker",VolumeIndicator:"volume-indicator",LiveStreamingStarted:"liveStreamingStarted",LiveStreamingFailed:"liveStreamingFailed",LiveStreamingStopped:"liveStreamingStopped",LiveTranscodingUpdated:"liveTranscodingUpdated",StreamInjectedStatusUpdated:"streamInjectedStatus",TokenPrivelegeWillExpire:"onTokenPrivilegeWillExpire",TokenPrivelegeExpired:"onTokenPrivilegeDidExpire",Error:"error",NetworkTypeChanged:"network-type-changed",RecordingDeviceChanged:"recording-device-changed",AudioOutputDeviceChanged:"playout-device-changed",CameraChanged:"camera-changed",StreamTypeChanged:"stream-type-changed",ConnectionStateChanged:"connection-state-change",StreamReconnectionStart:"stream-reconnect-start",StreamReconnectionEnd:"stream-reconnect-end",ClientRoleChanged:"client-role-changed",NetworkQualityReported:"network-quality",StreamFallback:"stream-fallback",StreamUpdated:"stream-updated",Exception:"exception",RemoteVideoCaptureEnabled:"enable-local-video",RemoteVideoCaptureDisabled:"disable-local-video",MediaStreamEventRelayed:"channel-media-relay-event",MediaStreamRelayStateChanged:"channel-media-relay-state"},bn={Debug:0,Info:1,Warning:2,Error:3,None:4};bn[bn.Debug]="Debug",bn[bn.Info]="Info",bn[bn.Warning]="Warning",bn[bn.Error]="Error",bn[bn.None]="None";const On={MediaAccessAllowed:"accessAllowed",MediaAccessDenied:"accessDenied",ScreenSharingStopped:"stopScreenSharing",VideoTrackEnded:"videoTrackEnded",AudioTrackEnded:"audioTrackEnded",AudioMixingPlayed:"audioMixingPlayed",AudioMixingFinished:"audioMixingFinished",StreamPlaybackStatusChanged:"player-status-change"}},9751:(Mt,xe,U)=>{"use strict";U.d(xe,{y:()=>ce});var E=U(2961),M=U(727),S=U(8822),L=U(9635),ae=U(2416),De=U(576),pe=U(2806);let ce=(()=>{class ee{constructor(Le){Le&&(this._subscribe=Le)}lift(Le){const z=new ee;return z.source=this,z.operator=Le,z}subscribe(Le,z,ke){const ye=function Y(ee){return ee&&ee instanceof E.Lv||function we(ee){return ee&&(0,De.m)(ee.next)&&(0,De.m)(ee.error)&&(0,De.m)(ee.complete)}(ee)&&(0,M.Nn)(ee)}(Le)?Le:new E.Hp(Le,z,ke);return(0,pe.x)(()=>{const{operator:K,source:G}=this;ye.add(K?K.call(ye,G):G?this._subscribe(ye):this._trySubscribe(ye))}),ye}_trySubscribe(Le){try{return this._subscribe(Le)}catch(z){Le.error(z)}}forEach(Le,z){return new(z=Ce(z))((ke,ye)=>{const K=new E.Hp({next:G=>{try{Le(G)}catch(Fe){ye(Fe),K.unsubscribe()}},error:ye,complete:ke});this.subscribe(K)})}_subscribe(Le){var z;return null===(z=this.source)||void 0===z?void 0:z.subscribe(Le)}[S.L](){return this}pipe(...Le){return(0,L.U)(Le)(this)}toPromise(Le){return new(Le=Ce(Le))((z,ke)=>{let ye;this.subscribe(K=>ye=K,K=>ke(K),()=>z(ye))})}}return ee.create=je=>new ee(je),ee})();function Ce(ee){var je;return null!==(je=ee??ae.v.Promise)&&void 0!==je?je:Promise}},7579:(Mt,xe,U)=>{"use strict";U.d(xe,{x:()=>pe});var E=U(9751),M=U(727);const L=(0,U(3888).d)(Ce=>function(){Ce(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ae=U(8737),De=U(2806);let pe=(()=>{class Ce extends E.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Y){const ee=new ce(this,this);return ee.operator=Y,ee}_throwIfClosed(){if(this.closed)throw new L}next(Y){(0,De.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const ee of this.currentObservers)ee.next(Y)}})}error(Y){(0,De.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Y;const{observers:ee}=this;for(;ee.length;)ee.shift().error(Y)}})}complete(){(0,De.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Y}=this;for(;Y.length;)Y.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Y;return(null===(Y=this.observers)||void 0===Y?void 0:Y.length)>0}_trySubscribe(Y){return this._throwIfClosed(),super._trySubscribe(Y)}_subscribe(Y){return this._throwIfClosed(),this._checkFinalizedStatuses(Y),this._innerSubscribe(Y)}_innerSubscribe(Y){const{hasError:ee,isStopped:je,observers:Le}=this;return ee||je?M.Lc:(this.currentObservers=null,Le.push(Y),new M.w0(()=>{this.currentObservers=null,(0,ae.P)(Le,Y)}))}_checkFinalizedStatuses(Y){const{hasError:ee,thrownError:je,isStopped:Le}=this;ee?Y.error(je):Le&&Y.complete()}asObservable(){const Y=new E.y;return Y.source=this,Y}}return Ce.create=(we,Y)=>new ce(we,Y),Ce})();class ce extends pe{constructor(we,Y){super(),this.destination=we,this.source=Y}next(we){var Y,ee;null===(ee=null===(Y=this.destination)||void 0===Y?void 0:Y.next)||void 0===ee||ee.call(Y,we)}error(we){var Y,ee;null===(ee=null===(Y=this.destination)||void 0===Y?void 0:Y.error)||void 0===ee||ee.call(Y,we)}complete(){var we,Y;null===(Y=null===(we=this.destination)||void 0===we?void 0:we.complete)||void 0===Y||Y.call(we)}_subscribe(we){var Y,ee;return null!==(ee=null===(Y=this.source)||void 0===Y?void 0:Y.subscribe(we))&&void 0!==ee?ee:M.Lc}}},2961:(Mt,xe,U)=>{"use strict";U.d(xe,{Hp:()=>ke,Lv:()=>ee});var E=U(576),M=U(727),S=U(2416),L=U(7849);function ae(){}const De=Ce("C",void 0,void 0);function Ce(He,Xe,$e){return{kind:He,value:Xe,error:$e}}var we=U(3410),Y=U(2806);class ee extends M.w0{constructor(Xe){super(),this.isStopped=!1,Xe?(this.destination=Xe,(0,M.Nn)(Xe)&&Xe.add(this)):this.destination=Fe}static create(Xe,$e,me){return new ke(Xe,$e,me)}next(Xe){this.isStopped?G(function ce(He){return Ce("N",He,void 0)}(Xe),this):this._next(Xe)}error(Xe){this.isStopped?G(function pe(He){return Ce("E",void 0,He)}(Xe),this):(this.isStopped=!0,this._error(Xe))}complete(){this.isStopped?G(De,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Xe){this.destination.next(Xe)}_error(Xe){try{this.destination.error(Xe)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const je=Function.prototype.bind;function Le(He,Xe){return je.call(He,Xe)}class z{constructor(Xe){this.partialObserver=Xe}next(Xe){const{partialObserver:$e}=this;if($e.next)try{$e.next(Xe)}catch(me){ye(me)}}error(Xe){const{partialObserver:$e}=this;if($e.error)try{$e.error(Xe)}catch(me){ye(me)}else ye(Xe)}complete(){const{partialObserver:Xe}=this;if(Xe.complete)try{Xe.complete()}catch($e){ye($e)}}}class ke extends ee{constructor(Xe,$e,me){let ge;if(super(),(0,E.m)(Xe)||!Xe)ge={next:Xe??void 0,error:$e??void 0,complete:me??void 0};else{let Se;this&&S.v.useDeprecatedNextContext?(Se=Object.create(Xe),Se.unsubscribe=()=>this.unsubscribe(),ge={next:Xe.next&&Le(Xe.next,Se),error:Xe.error&&Le(Xe.error,Se),complete:Xe.complete&&Le(Xe.complete,Se)}):ge=Xe}this.destination=new z(ge)}}function ye(He){S.v.useDeprecatedSynchronousErrorHandling?(0,Y.O)(He):(0,L.h)(He)}function G(He,Xe){const{onStoppedNotification:$e}=S.v;$e&&we.z.setTimeout(()=>$e(He,Xe))}const Fe={closed:!0,next:ae,error:function K(He){throw He},complete:ae}},727:(Mt,xe,U)=>{"use strict";U.d(xe,{Lc:()=>De,w0:()=>ae,Nn:()=>pe});var E=U(576);const S=(0,U(3888).d)(Ce=>function(Y){Ce(this),this.message=Y?`${Y.length} errors occurred during unsubscription:\n${Y.map((ee,je)=>`${je+1}) ${ee.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Y});var L=U(8737);class ae{constructor(we){this.initialTeardown=we,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let we;if(!this.closed){this.closed=!0;const{_parentage:Y}=this;if(Y)if(this._parentage=null,Array.isArray(Y))for(const Le of Y)Le.remove(this);else Y.remove(this);const{initialTeardown:ee}=this;if((0,E.m)(ee))try{ee()}catch(Le){we=Le instanceof S?Le.errors:[Le]}const{_finalizers:je}=this;if(je){this._finalizers=null;for(const Le of je)try{ce(Le)}catch(z){we=we??[],z instanceof S?we=[...we,...z.errors]:we.push(z)}}if(we)throw new S(we)}}add(we){var Y;if(we&&we!==this)if(this.closed)ce(we);else{if(we instanceof ae){if(we.closed||we._hasParent(this))return;we._addParent(this)}(this._finalizers=null!==(Y=this._finalizers)&&void 0!==Y?Y:[]).push(we)}}_hasParent(we){const{_parentage:Y}=this;return Y===we||Array.isArray(Y)&&Y.includes(we)}_addParent(we){const{_parentage:Y}=this;this._parentage=Array.isArray(Y)?(Y.push(we),Y):Y?[Y,we]:we}_removeParent(we){const{_parentage:Y}=this;Y===we?this._parentage=null:Array.isArray(Y)&&(0,L.P)(Y,we)}remove(we){const{_finalizers:Y}=this;Y&&(0,L.P)(Y,we),we instanceof ae&&we._removeParent(this)}}ae.EMPTY=(()=>{const Ce=new ae;return Ce.closed=!0,Ce})();const De=ae.EMPTY;function pe(Ce){return Ce instanceof ae||Ce&&"closed"in Ce&&(0,E.m)(Ce.remove)&&(0,E.m)(Ce.add)&&(0,E.m)(Ce.unsubscribe)}function ce(Ce){(0,E.m)(Ce)?Ce():Ce.unsubscribe()}},2416:(Mt,xe,U)=>{"use strict";U.d(xe,{v:()=>E});const E={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(Mt,xe,U)=>{"use strict";U.d(xe,{E:()=>M});const M=new(U(9751).y)(ae=>ae.complete())},2076:(Mt,xe,U)=>{"use strict";U.d(xe,{D:()=>me});var E=U(8421),M=U(9672),S=U(4482),L=U(5403);function ae(ge,Se=0){return(0,S.e)((Be,oe)=>{Be.subscribe((0,L.x)(oe,J=>(0,M.f)(oe,ge,()=>oe.next(J),Se),()=>(0,M.f)(oe,ge,()=>oe.complete(),Se),J=>(0,M.f)(oe,ge,()=>oe.error(J),Se)))})}function De(ge,Se=0){return(0,S.e)((Be,oe)=>{oe.add(ge.schedule(()=>Be.subscribe(oe),Se))})}var Ce=U(9751),Y=U(2202),ee=U(576);function Le(ge,Se){if(!ge)throw new Error("Iterable cannot be null");return new Ce.y(Be=>{(0,M.f)(Be,Se,()=>{const oe=ge[Symbol.asyncIterator]();(0,M.f)(Be,Se,()=>{oe.next().then(J=>{J.done?Be.complete():Be.next(J.value)})},0,!0)})})}var z=U(3670),ke=U(8239),ye=U(1144),K=U(6495),G=U(2206),Fe=U(4532),He=U(3260);function me(ge,Se){return Se?function $e(ge,Se){if(null!=ge){if((0,z.c)(ge))return function pe(ge,Se){return(0,E.Xf)(ge).pipe(De(Se),ae(Se))}(ge,Se);if((0,ye.z)(ge))return function we(ge,Se){return new Ce.y(Be=>{let oe=0;return Se.schedule(function(){oe===ge.length?Be.complete():(Be.next(ge[oe++]),Be.closed||this.schedule())})})}(ge,Se);if((0,ke.t)(ge))return function ce(ge,Se){return(0,E.Xf)(ge).pipe(De(Se),ae(Se))}(ge,Se);if((0,G.D)(ge))return Le(ge,Se);if((0,K.T)(ge))return function je(ge,Se){return new Ce.y(Be=>{let oe;return(0,M.f)(Be,Se,()=>{oe=ge[Y.h](),(0,M.f)(Be,Se,()=>{let J,he;try{({value:J,done:he}=oe.next())}catch(de){return void Be.error(de)}he?Be.complete():Be.next(J)},0,!0)}),()=>(0,ee.m)(oe?.return)&&oe.return()})}(ge,Se);if((0,He.L)(ge))return function Xe(ge,Se){return Le((0,He.Q)(ge),Se)}(ge,Se)}throw(0,Fe.z)(ge)}(ge,Se):(0,E.Xf)(ge)}},8421:(Mt,xe,U)=>{"use strict";U.d(xe,{Xf:()=>je});var E=U(655),M=U(1144),S=U(8239),L=U(9751),ae=U(3670),De=U(2206),pe=U(4532),ce=U(6495),Ce=U(3260),we=U(576),Y=U(7849),ee=U(8822);function je(He){if(He instanceof L.y)return He;if(null!=He){if((0,ae.c)(He))return function Le(He){return new L.y(Xe=>{const $e=He[ee.L]();if((0,we.m)($e.subscribe))return $e.subscribe(Xe);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(He);if((0,M.z)(He))return function z(He){return new L.y(Xe=>{for(let $e=0;$e<He.length&&!Xe.closed;$e++)Xe.next(He[$e]);Xe.complete()})}(He);if((0,S.t)(He))return function ke(He){return new L.y(Xe=>{He.then($e=>{Xe.closed||(Xe.next($e),Xe.complete())},$e=>Xe.error($e)).then(null,Y.h)})}(He);if((0,De.D)(He))return K(He);if((0,ce.T)(He))return function ye(He){return new L.y(Xe=>{for(const $e of He)if(Xe.next($e),Xe.closed)return;Xe.complete()})}(He);if((0,Ce.L)(He))return function G(He){return K((0,Ce.Q)(He))}(He)}throw(0,pe.z)(He)}function K(He){return new L.y(Xe=>{(function Fe(He,Xe){var $e,me,ge,Se;return(0,E.mG)(this,void 0,void 0,function*(){try{for($e=(0,E.KL)(He);!(me=yield $e.next()).done;)if(Xe.next(me.value),Xe.closed)return}catch(Be){ge={error:Be}}finally{try{me&&!me.done&&(Se=$e.return)&&(yield Se.call($e))}finally{if(ge)throw ge.error}}Xe.complete()})})(He,Xe).catch($e=>Xe.error($e))})}},9646:(Mt,xe,U)=>{"use strict";U.d(xe,{of:()=>S});var E=U(7669),M=U(2076);function S(...L){const ae=(0,E.yG)(L);return(0,M.D)(L,ae)}},5403:(Mt,xe,U)=>{"use strict";U.d(xe,{x:()=>M});var E=U(2961);function M(L,ae,De,pe,ce){return new S(L,ae,De,pe,ce)}class S extends E.Lv{constructor(ae,De,pe,ce,Ce,we){super(ae),this.onFinalize=Ce,this.shouldUnsubscribe=we,this._next=De?function(Y){try{De(Y)}catch(ee){ae.error(ee)}}:super._next,this._error=ce?function(Y){try{ce(Y)}catch(ee){ae.error(ee)}finally{this.unsubscribe()}}:super._error,this._complete=pe?function(){try{pe()}catch(Y){ae.error(Y)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var ae;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:De}=this;super.unsubscribe(),!De&&(null===(ae=this.onFinalize)||void 0===ae||ae.call(this))}}}},4351:(Mt,xe,U)=>{"use strict";U.d(xe,{b:()=>S});var E=U(5577),M=U(576);function S(L,ae){return(0,M.m)(ae)?(0,E.z)(L,ae,1):(0,E.z)(L,1)}},9300:(Mt,xe,U)=>{"use strict";U.d(xe,{h:()=>S});var E=U(4482),M=U(5403);function S(L,ae){return(0,E.e)((De,pe)=>{let ce=0;De.subscribe((0,M.x)(pe,Ce=>L.call(ae,Ce,ce++)&&pe.next(Ce)))})}},4004:(Mt,xe,U)=>{"use strict";U.d(xe,{U:()=>S});var E=U(4482),M=U(5403);function S(L,ae){return(0,E.e)((De,pe)=>{let ce=0;De.subscribe((0,M.x)(pe,Ce=>{pe.next(L.call(ae,Ce,ce++))}))})}},8189:(Mt,xe,U)=>{"use strict";U.d(xe,{J:()=>S});var E=U(5577),M=U(4671);function S(L=1/0){return(0,E.z)(M.y,L)}},5577:(Mt,xe,U)=>{"use strict";U.d(xe,{z:()=>ce});var E=U(4004),M=U(8421),S=U(4482),L=U(9672),ae=U(5403),pe=U(576);function ce(Ce,we,Y=1/0){return(0,pe.m)(we)?ce((ee,je)=>(0,E.U)((Le,z)=>we(ee,Le,je,z))((0,M.Xf)(Ce(ee,je))),Y):("number"==typeof we&&(Y=we),(0,S.e)((ee,je)=>function De(Ce,we,Y,ee,je,Le,z,ke){const ye=[];let K=0,G=0,Fe=!1;const He=()=>{Fe&&!ye.length&&!K&&we.complete()},Xe=me=>K<ee?$e(me):ye.push(me),$e=me=>{Le&&we.next(me),K++;let ge=!1;(0,M.Xf)(Y(me,G++)).subscribe((0,ae.x)(we,Se=>{je?.(Se),Le?Xe(Se):we.next(Se)},()=>{ge=!0},void 0,()=>{if(ge)try{for(K--;ye.length&&K<ee;){const Se=ye.shift();z?(0,L.f)(we,z,()=>$e(Se)):$e(Se)}He()}catch(Se){we.error(Se)}}))};return Ce.subscribe((0,ae.x)(we,Xe,()=>{Fe=!0,He()})),()=>{ke?.()}}(ee,je,Ce,Y)))}},3410:(Mt,xe,U)=>{"use strict";U.d(xe,{z:()=>E});const E={setTimeout(M,S,...L){const{delegate:ae}=E;return ae?.setTimeout?ae.setTimeout(M,S,...L):setTimeout(M,S,...L)},clearTimeout(M){const{delegate:S}=E;return(S?.clearTimeout||clearTimeout)(M)},delegate:void 0}},2202:(Mt,xe,U)=>{"use strict";U.d(xe,{h:()=>M});const M=function E(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Mt,xe,U)=>{"use strict";U.d(xe,{L:()=>E});const E="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(Mt,xe,U)=>{"use strict";U.d(xe,{_6:()=>De,jO:()=>L,yG:()=>ae});var E=U(576);function S(pe){return pe[pe.length-1]}function L(pe){return(0,E.m)(S(pe))?pe.pop():void 0}function ae(pe){return function M(pe){return pe&&(0,E.m)(pe.schedule)}(S(pe))?pe.pop():void 0}function De(pe,ce){return"number"==typeof S(pe)?pe.pop():ce}},4742:(Mt,xe,U)=>{"use strict";U.d(xe,{D:()=>ae});const{isArray:E}=Array,{getPrototypeOf:M,prototype:S,keys:L}=Object;function ae(pe){if(1===pe.length){const ce=pe[0];if(E(ce))return{args:ce,keys:null};if(function De(pe){return pe&&"object"==typeof pe&&M(pe)===S}(ce)){const Ce=L(ce);return{args:Ce.map(we=>ce[we]),keys:Ce}}}return{args:pe,keys:null}}},8737:(Mt,xe,U)=>{"use strict";function E(M,S){if(M){const L=M.indexOf(S);0<=L&&M.splice(L,1)}}U.d(xe,{P:()=>E})},3888:(Mt,xe,U)=>{"use strict";function E(M){const L=M(ae=>{Error.call(ae),ae.stack=(new Error).stack});return L.prototype=Object.create(Error.prototype),L.prototype.constructor=L,L}U.d(xe,{d:()=>E})},1810:(Mt,xe,U)=>{"use strict";function E(M,S){return M.reduce((L,ae,De)=>(L[ae]=S[De],L),{})}U.d(xe,{n:()=>E})},2806:(Mt,xe,U)=>{"use strict";U.d(xe,{O:()=>L,x:()=>S});var E=U(2416);let M=null;function S(ae){if(E.v.useDeprecatedSynchronousErrorHandling){const De=!M;if(De&&(M={errorThrown:!1,error:null}),ae(),De){const{errorThrown:pe,error:ce}=M;if(M=null,pe)throw ce}}else ae()}function L(ae){E.v.useDeprecatedSynchronousErrorHandling&&M&&(M.errorThrown=!0,M.error=ae)}},9672:(Mt,xe,U)=>{"use strict";function E(M,S,L,ae=0,De=!1){const pe=S.schedule(function(){L(),De?M.add(this.schedule(null,ae)):this.unsubscribe()},ae);if(M.add(pe),!De)return pe}U.d(xe,{f:()=>E})},4671:(Mt,xe,U)=>{"use strict";function E(M){return M}U.d(xe,{y:()=>E})},1144:(Mt,xe,U)=>{"use strict";U.d(xe,{z:()=>E});const E=M=>M&&"number"==typeof M.length&&"function"!=typeof M},2206:(Mt,xe,U)=>{"use strict";U.d(xe,{D:()=>M});var E=U(576);function M(S){return Symbol.asyncIterator&&(0,E.m)(S?.[Symbol.asyncIterator])}},576:(Mt,xe,U)=>{"use strict";function E(M){return"function"==typeof M}U.d(xe,{m:()=>E})},3670:(Mt,xe,U)=>{"use strict";U.d(xe,{c:()=>S});var E=U(8822),M=U(576);function S(L){return(0,M.m)(L[E.L])}},6495:(Mt,xe,U)=>{"use strict";U.d(xe,{T:()=>S});var E=U(2202),M=U(576);function S(L){return(0,M.m)(L?.[E.h])}},8239:(Mt,xe,U)=>{"use strict";U.d(xe,{t:()=>M});var E=U(576);function M(S){return(0,E.m)(S?.then)}},3260:(Mt,xe,U)=>{"use strict";U.d(xe,{L:()=>L,Q:()=>S});var E=U(655),M=U(576);function S(ae){return(0,E.FC)(this,arguments,function*(){const pe=ae.getReader();try{for(;;){const{value:ce,done:Ce}=yield(0,E.qq)(pe.read());if(Ce)return yield(0,E.qq)(void 0);yield yield(0,E.qq)(ce)}}finally{pe.releaseLock()}})}function L(ae){return(0,M.m)(ae?.getReader)}},4482:(Mt,xe,U)=>{"use strict";U.d(xe,{A:()=>M,e:()=>S});var E=U(576);function M(L){return(0,E.m)(L?.lift)}function S(L){return ae=>{if(M(ae))return ae.lift(function(De){try{return L(De,this)}catch(pe){this.error(pe)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Mt,xe,U)=>{"use strict";U.d(xe,{Z:()=>L});var E=U(4004);const{isArray:M}=Array;function L(ae){return(0,E.U)(De=>function S(ae,De){return M(De)?ae(...De):ae(De)}(ae,De))}},9635:(Mt,xe,U)=>{"use strict";U.d(xe,{U:()=>S,z:()=>M});var E=U(4671);function M(...L){return S(L)}function S(L){return 0===L.length?E.y:1===L.length?L[0]:function(De){return L.reduce((pe,ce)=>ce(pe),De)}}},7849:(Mt,xe,U)=>{"use strict";U.d(xe,{h:()=>S});var E=U(2416),M=U(3410);function S(L){M.z.setTimeout(()=>{const{onUnhandledError:ae}=E.v;if(!ae)throw L;ae(L)})}},4532:(Mt,xe,U)=>{"use strict";function E(M){return new TypeError(`You provided ${null!==M&&"object"==typeof M?"an invalid object":`'${M}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}U.d(xe,{z:()=>E})},655:(Mt,xe,U)=>{"use strict";function ce(oe,J,he,de){return new(he||(he=Promise))(function(ve,re){function it(Bt){try{Ye(de.next(Bt))}catch(mn){re(mn)}}function ft(Bt){try{Ye(de.throw(Bt))}catch(mn){re(mn)}}function Ye(Bt){Bt.done?ve(Bt.value):function Ze(ve){return ve instanceof he?ve:new he(function(re){re(ve)})}(Bt.value).then(it,ft)}Ye((de=de.apply(oe,J||[])).next())})}function ye(oe){return this instanceof ye?(this.v=oe,this):new ye(oe)}function K(oe,J,he){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Ze,de=he.apply(oe,J||[]),ve=[];return Ze={},re("next"),re("throw"),re("return"),Ze[Symbol.asyncIterator]=function(){return this},Ze;function re(Vt){de[Vt]&&(Ze[Vt]=function(qt){return new Promise(function(At,Xt){ve.push([Vt,qt,At,Xt])>1||it(Vt,qt)})})}function it(Vt,qt){try{!function ft(Vt){Vt.value instanceof ye?Promise.resolve(Vt.value.v).then(Ye,Bt):mn(ve[0][2],Vt)}(de[Vt](qt))}catch(At){mn(ve[0][3],At)}}function Ye(Vt){it("next",Vt)}function Bt(Vt){it("throw",Vt)}function mn(Vt,qt){Vt(qt),ve.shift(),ve.length&&it(ve[0][0],ve[0][1])}}function Fe(oe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var he,J=oe[Symbol.asyncIterator];return J?J.call(oe):(oe=function ee(oe){var J="function"==typeof Symbol&&Symbol.iterator,he=J&&oe[J],de=0;if(he)return he.call(oe);if(oe&&"number"==typeof oe.length)return{next:function(){return oe&&de>=oe.length&&(oe=void 0),{value:oe&&oe[de++],done:!oe}}};throw new TypeError(J?"Object is not iterable.":"Symbol.iterator is not defined.")}(oe),he={},de("next"),de("throw"),de("return"),he[Symbol.asyncIterator]=function(){return this},he);function de(ve){he[ve]=oe[ve]&&function(re){return new Promise(function(it,ft){!function Ze(ve,re,it,ft){Promise.resolve(ft).then(function(Ye){ve({value:Ye,done:it})},re)}(it,ft,(re=oe[ve](re)).done,re.value)})}}}U.d(xe,{FC:()=>K,KL:()=>Fe,mG:()=>ce,qq:()=>ye})},6895:(Mt,xe,U)=>{"use strict";U.d(xe,{Do:()=>Fe,EM:()=>dt,HT:()=>ae,JF:()=>Pt,K0:()=>pe,Mx:()=>sn,S$:()=>ye,V_:()=>we,Ye:()=>He,b0:()=>G,bD:()=>w,ez:()=>tt,q:()=>S,sg:()=>Pr,w_:()=>De});var E=U(8256);let M=null;function S(){return M}function ae(T){M||(M=T)}class De{}const pe=new E.OlP("DocumentToken");let ce=(()=>{class T{historyGo(A){throw new Error("Not implemented")}}return T.\u0275fac=function(A){return new(A||T)},T.\u0275prov=E.Yz7({token:T,factory:function(){return function Ce(){return(0,E.LFG)(Y)}()},providedIn:"platform"}),T})();const we=new E.OlP("Location Initialized");let Y=(()=>{class T extends ce{constructor(A){super(),this._doc=A,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return S().getBaseHref(this._doc)}onPopState(A){const V=S().getGlobalEventTarget(this._doc,"window");return V.addEventListener("popstate",A,!1),()=>V.removeEventListener("popstate",A)}onHashChange(A){const V=S().getGlobalEventTarget(this._doc,"window");return V.addEventListener("hashchange",A,!1),()=>V.removeEventListener("hashchange",A)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(A){this.location.pathname=A}pushState(A,V,fe){ee()?this._history.pushState(A,V,fe):this.location.hash=fe}replaceState(A,V,fe){ee()?this._history.replaceState(A,V,fe):this.location.hash=fe}forward(){this._history.forward()}back(){this._history.back()}historyGo(A=0){this._history.go(A)}getState(){return this._history.state}}return T.\u0275fac=function(A){return new(A||T)(E.LFG(pe))},T.\u0275prov=E.Yz7({token:T,factory:function(){return function je(){return new Y((0,E.LFG)(pe))}()},providedIn:"platform"}),T})();function ee(){return!!window.history.pushState}function Le(T,k){if(0==T.length)return k;if(0==k.length)return T;let A=0;return T.endsWith("/")&&A++,k.startsWith("/")&&A++,2==A?T+k.substring(1):1==A?T+k:T+"/"+k}function z(T){const k=T.match(/#|\?|$/),A=k&&k.index||T.length;return T.slice(0,A-("/"===T[A-1]?1:0))+T.slice(A)}function ke(T){return T&&"?"!==T[0]?"?"+T:T}let ye=(()=>{class T{historyGo(A){throw new Error("Not implemented")}}return T.\u0275fac=function(A){return new(A||T)},T.\u0275prov=E.Yz7({token:T,factory:function(){return(0,E.f3M)(G)},providedIn:"root"}),T})();const K=new E.OlP("appBaseHref");let G=(()=>{class T extends ye{constructor(A,V){super(),this._platformLocation=A,this._removeListenerFns=[],this._baseHref=V??this._platformLocation.getBaseHrefFromDOM()??(0,E.f3M)(pe).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(A){this._removeListenerFns.push(this._platformLocation.onPopState(A),this._platformLocation.onHashChange(A))}getBaseHref(){return this._baseHref}prepareExternalUrl(A){return Le(this._baseHref,A)}path(A=!1){const V=this._platformLocation.pathname+ke(this._platformLocation.search),fe=this._platformLocation.hash;return fe&&A?`${V}${fe}`:V}pushState(A,V,fe,Ue){const Qe=this.prepareExternalUrl(fe+ke(Ue));this._platformLocation.pushState(A,V,Qe)}replaceState(A,V,fe,Ue){const Qe=this.prepareExternalUrl(fe+ke(Ue));this._platformLocation.replaceState(A,V,Qe)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(A=0){this._platformLocation.historyGo?.(A)}}return T.\u0275fac=function(A){return new(A||T)(E.LFG(ce),E.LFG(K,8))},T.\u0275prov=E.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"}),T})(),Fe=(()=>{class T extends ye{constructor(A,V){super(),this._platformLocation=A,this._baseHref="",this._removeListenerFns=[],null!=V&&(this._baseHref=V)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(A){this._removeListenerFns.push(this._platformLocation.onPopState(A),this._platformLocation.onHashChange(A))}getBaseHref(){return this._baseHref}path(A=!1){let V=this._platformLocation.hash;return null==V&&(V="#"),V.length>0?V.substring(1):V}prepareExternalUrl(A){const V=Le(this._baseHref,A);return V.length>0?"#"+V:V}pushState(A,V,fe,Ue){let Qe=this.prepareExternalUrl(fe+ke(Ue));0==Qe.length&&(Qe=this._platformLocation.pathname),this._platformLocation.pushState(A,V,Qe)}replaceState(A,V,fe,Ue){let Qe=this.prepareExternalUrl(fe+ke(Ue));0==Qe.length&&(Qe=this._platformLocation.pathname),this._platformLocation.replaceState(A,V,Qe)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(A=0){this._platformLocation.historyGo?.(A)}}return T.\u0275fac=function(A){return new(A||T)(E.LFG(ce),E.LFG(K,8))},T.\u0275prov=E.Yz7({token:T,factory:T.\u0275fac}),T})(),He=(()=>{class T{constructor(A){this._subject=new E.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=A;const V=this._locationStrategy.getBaseHref();this._baseHref=z(me(V)),this._locationStrategy.onPopState(fe=>{this._subject.emit({url:this.path(!0),pop:!0,state:fe.state,type:fe.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(A=!1){return this.normalize(this._locationStrategy.path(A))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(A,V=""){return this.path()==this.normalize(A+ke(V))}normalize(A){return T.stripTrailingSlash(function $e(T,k){return T&&k.startsWith(T)?k.substring(T.length):k}(this._baseHref,me(A)))}prepareExternalUrl(A){return A&&"/"!==A[0]&&(A="/"+A),this._locationStrategy.prepareExternalUrl(A)}go(A,V="",fe=null){this._locationStrategy.pushState(fe,"",A,V),this._notifyUrlChangeListeners(this.prepareExternalUrl(A+ke(V)),fe)}replaceState(A,V="",fe=null){this._locationStrategy.replaceState(fe,"",A,V),this._notifyUrlChangeListeners(this.prepareExternalUrl(A+ke(V)),fe)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(A=0){this._locationStrategy.historyGo?.(A)}onUrlChange(A){return this._urlChangeListeners.push(A),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(V=>{this._notifyUrlChangeListeners(V.url,V.state)})),()=>{const V=this._urlChangeListeners.indexOf(A);this._urlChangeListeners.splice(V,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(A="",V){this._urlChangeListeners.forEach(fe=>fe(A,V))}subscribe(A,V,fe){return this._subject.subscribe({next:A,error:V,complete:fe})}}return T.normalizeQueryParams=ke,T.joinWithSlash=Le,T.stripTrailingSlash=z,T.\u0275fac=function(A){return new(A||T)(E.LFG(ye))},T.\u0275prov=E.Yz7({token:T,factory:function(){return function Xe(){return new He((0,E.LFG)(ye))}()},providedIn:"root"}),T})();function me(T){return T.replace(/\/index.html$/,"")}function sn(T,k){k=encodeURIComponent(k);for(const A of T.split(";")){const V=A.indexOf("="),[fe,Ue]=-1==V?[A,""]:[A.slice(0,V),A.slice(V+1)];if(fe.trim()===k)return decodeURIComponent(Ue)}return null}class fr{constructor(k,A,V,fe){this.$implicit=k,this.ngForOf=A,this.index=V,this.count=fe}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Pr=(()=>{class T{constructor(A,V,fe){this._viewContainer=A,this._template=V,this._differs=fe,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(A){this._ngForOf=A,this._ngForOfDirty=!0}set ngForTrackBy(A){this._trackByFn=A}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(A){A&&(this._template=A)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const A=this._ngForOf;!this._differ&&A&&(this._differ=this._differs.find(A).create(this.ngForTrackBy))}if(this._differ){const A=this._differ.diff(this._ngForOf);A&&this._applyChanges(A)}}_applyChanges(A){const V=this._viewContainer;A.forEachOperation((fe,Ue,Qe)=>{if(null==fe.previousIndex)V.createEmbeddedView(this._template,new fr(fe.item,this._ngForOf,-1,-1),null===Qe?void 0:Qe);else if(null==Qe)V.remove(null===Ue?void 0:Ue);else if(null!==Ue){const ht=V.get(Ue);V.move(ht,Qe),Qt(ht,fe)}});for(let fe=0,Ue=V.length;fe<Ue;fe++){const ht=V.get(fe).context;ht.index=fe,ht.count=Ue,ht.ngForOf=this._ngForOf}A.forEachIdentityChange(fe=>{Qt(V.get(fe.currentIndex),fe)})}static ngTemplateContextGuard(A,V){return!0}}return T.\u0275fac=function(A){return new(A||T)(E.Y36(E.s_b),E.Y36(E.Rgc),E.Y36(E.ZZ4))},T.\u0275dir=E.lG2({type:T,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),T})();function Qt(T,k){T.context.$implicit=k.item}let tt=(()=>{class T{}return T.\u0275fac=function(A){return new(A||T)},T.\u0275mod=E.oAB({type:T}),T.\u0275inj=E.cJS({}),T})();const w="browser";let dt=(()=>{class T{}return T.\u0275prov=(0,E.Yz7)({token:T,providedIn:"root",factory:()=>new yt((0,E.LFG)(pe),window)}),T})();class yt{constructor(k,A){this.document=k,this.window=A,this.offset=()=>[0,0]}setOffset(k){this.offset=Array.isArray(k)?()=>k:k}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(k){this.supportsScrolling()&&this.window.scrollTo(k[0],k[1])}scrollToAnchor(k){if(!this.supportsScrolling())return;const A=function It(T,k){const A=T.getElementById(k)||T.getElementsByName(k)[0];if(A)return A;if("function"==typeof T.createTreeWalker&&T.body&&(T.body.createShadowRoot||T.body.attachShadow)){const V=T.createTreeWalker(T.body,NodeFilter.SHOW_ELEMENT);let fe=V.currentNode;for(;fe;){const Ue=fe.shadowRoot;if(Ue){const Qe=Ue.getElementById(k)||Ue.querySelector(`[name="${k}"]`);if(Qe)return Qe}fe=V.nextNode()}}return null}(this.document,k);A&&(this.scrollToElement(A),A.focus())}setHistoryScrollRestoration(k){if(this.supportScrollRestoration()){const A=this.window.history;A&&A.scrollRestoration&&(A.scrollRestoration=k)}}scrollToElement(k){const A=k.getBoundingClientRect(),V=A.left+this.window.pageXOffset,fe=A.top+this.window.pageYOffset,Ue=this.offset();this.window.scrollTo(V-Ue[0],fe-Ue[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const k=mt(this.window.history)||mt(Object.getPrototypeOf(this.window.history));return!(!k||!k.writable&&!k.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function mt(T){return Object.getOwnPropertyDescriptor(T,"scrollRestoration")}class Pt{}},529:(Mt,xe,U)=>{"use strict";U.d(xe,{JF:()=>Nn,eN:()=>ve});var E=U(6895),M=U(8256),S=U(9646),L=U(9751),ae=U(4351),De=U(9300),pe=U(4004);class ce{}class Ce{}class we{constructor(te){this.normalizedNames=new Map,this.lazyUpdate=null,te?this.lazyInit="string"==typeof te?()=>{this.headers=new Map,te.split("\n").forEach(X=>{const Me=X.indexOf(":");if(Me>0){const Ke=X.slice(0,Me),Et=Ke.toLowerCase(),Nt=X.slice(Me+1).trim();this.maybeSetNormalizedName(Ke,Et),this.headers.has(Et)?this.headers.get(Et).push(Nt):this.headers.set(Et,[Nt])}})}:()=>{this.headers=new Map,Object.keys(te).forEach(X=>{let Me=te[X];const Ke=X.toLowerCase();"string"==typeof Me&&(Me=[Me]),Me.length>0&&(this.headers.set(Ke,Me),this.maybeSetNormalizedName(X,Ke))})}:this.headers=new Map}has(te){return this.init(),this.headers.has(te.toLowerCase())}get(te){this.init();const X=this.headers.get(te.toLowerCase());return X&&X.length>0?X[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(te){return this.init(),this.headers.get(te.toLowerCase())||null}append(te,X){return this.clone({name:te,value:X,op:"a"})}set(te,X){return this.clone({name:te,value:X,op:"s"})}delete(te,X){return this.clone({name:te,value:X,op:"d"})}maybeSetNormalizedName(te,X){this.normalizedNames.has(X)||this.normalizedNames.set(X,te)}init(){this.lazyInit&&(this.lazyInit instanceof we?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(te=>this.applyUpdate(te)),this.lazyUpdate=null))}copyFrom(te){te.init(),Array.from(te.headers.keys()).forEach(X=>{this.headers.set(X,te.headers.get(X)),this.normalizedNames.set(X,te.normalizedNames.get(X))})}clone(te){const X=new we;return X.lazyInit=this.lazyInit&&this.lazyInit instanceof we?this.lazyInit:this,X.lazyUpdate=(this.lazyUpdate||[]).concat([te]),X}applyUpdate(te){const X=te.name.toLowerCase();switch(te.op){case"a":case"s":let Me=te.value;if("string"==typeof Me&&(Me=[Me]),0===Me.length)return;this.maybeSetNormalizedName(te.name,X);const Ke=("a"===te.op?this.headers.get(X):void 0)||[];Ke.push(...Me),this.headers.set(X,Ke);break;case"d":const Et=te.value;if(Et){let Nt=this.headers.get(X);if(!Nt)return;Nt=Nt.filter(kt=>-1===Et.indexOf(kt)),0===Nt.length?(this.headers.delete(X),this.normalizedNames.delete(X)):this.headers.set(X,Nt)}else this.headers.delete(X),this.normalizedNames.delete(X)}}forEach(te){this.init(),Array.from(this.normalizedNames.keys()).forEach(X=>te(this.normalizedNames.get(X),this.headers.get(X)))}}class ee{encodeKey(te){return ke(te)}encodeValue(te){return ke(te)}decodeKey(te){return decodeURIComponent(te)}decodeValue(te){return decodeURIComponent(te)}}const Le=/%(\d[a-f0-9])/gi,z={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function ke(le){return encodeURIComponent(le).replace(Le,(te,X)=>z[X]??te)}function ye(le){return`${le}`}class K{constructor(te={}){if(this.updates=null,this.cloneFrom=null,this.encoder=te.encoder||new ee,te.fromString){if(te.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function je(le,te){const X=new Map;return le.length>0&&le.replace(/^\?/,"").split("&").forEach(Ke=>{const Et=Ke.indexOf("="),[Nt,kt]=-1==Et?[te.decodeKey(Ke),""]:[te.decodeKey(Ke.slice(0,Et)),te.decodeValue(Ke.slice(Et+1))],wt=X.get(Nt)||[];wt.push(kt),X.set(Nt,wt)}),X}(te.fromString,this.encoder)}else te.fromObject?(this.map=new Map,Object.keys(te.fromObject).forEach(X=>{const Me=te.fromObject[X],Ke=Array.isArray(Me)?Me.map(ye):[ye(Me)];this.map.set(X,Ke)})):this.map=null}has(te){return this.init(),this.map.has(te)}get(te){this.init();const X=this.map.get(te);return X?X[0]:null}getAll(te){return this.init(),this.map.get(te)||null}keys(){return this.init(),Array.from(this.map.keys())}append(te,X){return this.clone({param:te,value:X,op:"a"})}appendAll(te){const X=[];return Object.keys(te).forEach(Me=>{const Ke=te[Me];Array.isArray(Ke)?Ke.forEach(Et=>{X.push({param:Me,value:Et,op:"a"})}):X.push({param:Me,value:Ke,op:"a"})}),this.clone(X)}set(te,X){return this.clone({param:te,value:X,op:"s"})}delete(te,X){return this.clone({param:te,value:X,op:"d"})}toString(){return this.init(),this.keys().map(te=>{const X=this.encoder.encodeKey(te);return this.map.get(te).map(Me=>X+"="+this.encoder.encodeValue(Me)).join("&")}).filter(te=>""!==te).join("&")}clone(te){const X=new K({encoder:this.encoder});return X.cloneFrom=this.cloneFrom||this,X.updates=(this.updates||[]).concat(te),X}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(te=>this.map.set(te,this.cloneFrom.map.get(te))),this.updates.forEach(te=>{switch(te.op){case"a":case"s":const X=("a"===te.op?this.map.get(te.param):void 0)||[];X.push(ye(te.value)),this.map.set(te.param,X);break;case"d":if(void 0===te.value){this.map.delete(te.param);break}{let Me=this.map.get(te.param)||[];const Ke=Me.indexOf(ye(te.value));-1!==Ke&&Me.splice(Ke,1),Me.length>0?this.map.set(te.param,Me):this.map.delete(te.param)}}}),this.cloneFrom=this.updates=null)}}class Fe{constructor(){this.map=new Map}set(te,X){return this.map.set(te,X),this}get(te){return this.map.has(te)||this.map.set(te,te.defaultValue()),this.map.get(te)}delete(te){return this.map.delete(te),this}has(te){return this.map.has(te)}keys(){return this.map.keys()}}function Xe(le){return typeof ArrayBuffer<"u"&&le instanceof ArrayBuffer}function $e(le){return typeof Blob<"u"&&le instanceof Blob}function me(le){return typeof FormData<"u"&&le instanceof FormData}class Se{constructor(te,X,Me,Ke){let Et;if(this.url=X,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=te.toUpperCase(),function He(le){switch(le){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Ke?(this.body=void 0!==Me?Me:null,Et=Ke):Et=Me,Et&&(this.reportProgress=!!Et.reportProgress,this.withCredentials=!!Et.withCredentials,Et.responseType&&(this.responseType=Et.responseType),Et.headers&&(this.headers=Et.headers),Et.context&&(this.context=Et.context),Et.params&&(this.params=Et.params)),this.headers||(this.headers=new we),this.context||(this.context=new Fe),this.params){const Nt=this.params.toString();if(0===Nt.length)this.urlWithParams=X;else{const kt=X.indexOf("?");this.urlWithParams=X+(-1===kt?"?":kt<X.length-1?"&":"")+Nt}}else this.params=new K,this.urlWithParams=X}serializeBody(){return null===this.body?null:Xe(this.body)||$e(this.body)||me(this.body)||function ge(le){return typeof URLSearchParams<"u"&&le instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof K?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||me(this.body)?null:$e(this.body)?this.body.type||null:Xe(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof K?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(te={}){const X=te.method||this.method,Me=te.url||this.url,Ke=te.responseType||this.responseType,Et=void 0!==te.body?te.body:this.body,Nt=void 0!==te.withCredentials?te.withCredentials:this.withCredentials,kt=void 0!==te.reportProgress?te.reportProgress:this.reportProgress;let wt=te.headers||this.headers,Tn=te.params||this.params;const $t=te.context??this.context;return void 0!==te.setHeaders&&(wt=Object.keys(te.setHeaders).reduce((Je,Wt)=>Je.set(Wt,te.setHeaders[Wt]),wt)),te.setParams&&(Tn=Object.keys(te.setParams).reduce((Je,Wt)=>Je.set(Wt,te.setParams[Wt]),Tn)),new Se(X,Me,Et,{params:Tn,headers:wt,context:$t,reportProgress:kt,responseType:Ke,withCredentials:Nt})}}var Be=(()=>((Be=Be||{})[Be.Sent=0]="Sent",Be[Be.UploadProgress=1]="UploadProgress",Be[Be.ResponseHeader=2]="ResponseHeader",Be[Be.DownloadProgress=3]="DownloadProgress",Be[Be.Response=4]="Response",Be[Be.User=5]="User",Be))();class oe{constructor(te,X=200,Me="OK"){this.headers=te.headers||new we,this.status=void 0!==te.status?te.status:X,this.statusText=te.statusText||Me,this.url=te.url||null,this.ok=this.status>=200&&this.status<300}}class J extends oe{constructor(te={}){super(te),this.type=Be.ResponseHeader}clone(te={}){return new J({headers:te.headers||this.headers,status:void 0!==te.status?te.status:this.status,statusText:te.statusText||this.statusText,url:te.url||this.url||void 0})}}class he extends oe{constructor(te={}){super(te),this.type=Be.Response,this.body=void 0!==te.body?te.body:null}clone(te={}){return new he({body:void 0!==te.body?te.body:this.body,headers:te.headers||this.headers,status:void 0!==te.status?te.status:this.status,statusText:te.statusText||this.statusText,url:te.url||this.url||void 0})}}class de extends oe{constructor(te){super(te,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${te.url||"(unknown url)"}`:`Http failure response for ${te.url||"(unknown url)"}: ${te.status} ${te.statusText}`,this.error=te.error||null}}function Ze(le,te){return{body:te,headers:le.headers,context:le.context,observe:le.observe,params:le.params,reportProgress:le.reportProgress,responseType:le.responseType,withCredentials:le.withCredentials}}let ve=(()=>{class le{constructor(X){this.handler=X}request(X,Me,Ke={}){let Et;if(X instanceof Se)Et=X;else{let wt,Tn;wt=Ke.headers instanceof we?Ke.headers:new we(Ke.headers),Ke.params&&(Tn=Ke.params instanceof K?Ke.params:new K({fromObject:Ke.params})),Et=new Se(X,Me,void 0!==Ke.body?Ke.body:null,{headers:wt,context:Ke.context,params:Tn,reportProgress:Ke.reportProgress,responseType:Ke.responseType||"json",withCredentials:Ke.withCredentials})}const Nt=(0,S.of)(Et).pipe((0,ae.b)(wt=>this.handler.handle(wt)));if(X instanceof Se||"events"===Ke.observe)return Nt;const kt=Nt.pipe((0,De.h)(wt=>wt instanceof he));switch(Ke.observe||"body"){case"body":switch(Et.responseType){case"arraybuffer":return kt.pipe((0,pe.U)(wt=>{if(null!==wt.body&&!(wt.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return wt.body}));case"blob":return kt.pipe((0,pe.U)(wt=>{if(null!==wt.body&&!(wt.body instanceof Blob))throw new Error("Response is not a Blob.");return wt.body}));case"text":return kt.pipe((0,pe.U)(wt=>{if(null!==wt.body&&"string"!=typeof wt.body)throw new Error("Response is not a string.");return wt.body}));default:return kt.pipe((0,pe.U)(wt=>wt.body))}case"response":return kt;default:throw new Error(`Unreachable: unhandled observe type ${Ke.observe}}`)}}delete(X,Me={}){return this.request("DELETE",X,Me)}get(X,Me={}){return this.request("GET",X,Me)}head(X,Me={}){return this.request("HEAD",X,Me)}jsonp(X,Me){return this.request("JSONP",X,{params:(new K).append(Me,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(X,Me={}){return this.request("OPTIONS",X,Me)}patch(X,Me,Ke={}){return this.request("PATCH",X,Ze(Ke,Me))}post(X,Me,Ke={}){return this.request("POST",X,Ze(Ke,Me))}put(X,Me,Ke={}){return this.request("PUT",X,Ze(Ke,Me))}}return le.\u0275fac=function(X){return new(X||le)(M.LFG(ce))},le.\u0275prov=M.Yz7({token:le,factory:le.\u0275fac}),le})();class re{constructor(te,X){this.next=te,this.interceptor=X}handle(te){return this.interceptor.intercept(te,this.next)}}const it=new M.OlP("HTTP_INTERCEPTORS");let ft=(()=>{class le{intercept(X,Me){return Me.handle(X)}}return le.\u0275fac=function(X){return new(X||le)},le.\u0275prov=M.Yz7({token:le,factory:le.\u0275fac}),le})();const jn=/^\)\]\}',?\n/;let Ct=(()=>{class le{constructor(X){this.xhrFactory=X}handle(X){if("JSONP"===X.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new L.y(Me=>{const Ke=this.xhrFactory.build();if(Ke.open(X.method,X.urlWithParams),X.withCredentials&&(Ke.withCredentials=!0),X.headers.forEach((rn,Jt)=>Ke.setRequestHeader(rn,Jt.join(","))),X.headers.has("Accept")||Ke.setRequestHeader("Accept","application/json, text/plain, */*"),!X.headers.has("Content-Type")){const rn=X.detectContentTypeHeader();null!==rn&&Ke.setRequestHeader("Content-Type",rn)}if(X.responseType){const rn=X.responseType.toLowerCase();Ke.responseType="json"!==rn?rn:"text"}const Et=X.serializeBody();let Nt=null;const kt=()=>{if(null!==Nt)return Nt;const rn=Ke.statusText||"OK",Jt=new we(Ke.getAllResponseHeaders()),Lt=function Ut(le){return"responseURL"in le&&le.responseURL?le.responseURL:/^X-Request-URL:/m.test(le.getAllResponseHeaders())?le.getResponseHeader("X-Request-URL"):null}(Ke)||X.url;return Nt=new J({headers:Jt,status:Ke.status,statusText:rn,url:Lt}),Nt},wt=()=>{let{headers:rn,status:Jt,statusText:Lt,url:En}=kt(),St=null;204!==Jt&&(St=typeof Ke.response>"u"?Ke.responseText:Ke.response),0===Jt&&(Jt=St?200:0);let $n=Jt>=200&&Jt<300;if("json"===X.responseType&&"string"==typeof St){const yr=St;St=St.replace(jn,"");try{St=""!==St?JSON.parse(St):null}catch(In){St=yr,$n&&($n=!1,St={error:In,text:St})}}$n?(Me.next(new he({body:St,headers:rn,status:Jt,statusText:Lt,url:En||void 0})),Me.complete()):Me.error(new de({error:St,headers:rn,status:Jt,statusText:Lt,url:En||void 0}))},Tn=rn=>{const{url:Jt}=kt(),Lt=new de({error:rn,status:Ke.status||0,statusText:Ke.statusText||"Unknown Error",url:Jt||void 0});Me.error(Lt)};let $t=!1;const Je=rn=>{$t||(Me.next(kt()),$t=!0);let Jt={type:Be.DownloadProgress,loaded:rn.loaded};rn.lengthComputable&&(Jt.total=rn.total),"text"===X.responseType&&!!Ke.responseText&&(Jt.partialText=Ke.responseText),Me.next(Jt)},Wt=rn=>{let Jt={type:Be.UploadProgress,loaded:rn.loaded};rn.lengthComputable&&(Jt.total=rn.total),Me.next(Jt)};return Ke.addEventListener("load",wt),Ke.addEventListener("error",Tn),Ke.addEventListener("timeout",Tn),Ke.addEventListener("abort",Tn),X.reportProgress&&(Ke.addEventListener("progress",Je),null!==Et&&Ke.upload&&Ke.upload.addEventListener("progress",Wt)),Ke.send(Et),Me.next({type:Be.Sent}),()=>{Ke.removeEventListener("error",Tn),Ke.removeEventListener("abort",Tn),Ke.removeEventListener("load",wt),Ke.removeEventListener("timeout",Tn),X.reportProgress&&(Ke.removeEventListener("progress",Je),null!==Et&&Ke.upload&&Ke.upload.removeEventListener("progress",Wt)),Ke.readyState!==Ke.DONE&&Ke.abort()}})}}return le.\u0275fac=function(X){return new(X||le)(M.LFG(E.JF))},le.\u0275prov=M.Yz7({token:le,factory:le.\u0275fac}),le})();const pn=new M.OlP("XSRF_COOKIE_NAME"),bn=new M.OlP("XSRF_HEADER_NAME");class hn{}let On=(()=>{class le{constructor(X,Me,Ke){this.doc=X,this.platform=Me,this.cookieName=Ke,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const X=this.doc.cookie||"";return X!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,E.Mx)(X,this.cookieName),this.lastCookieString=X),this.lastToken}}return le.\u0275fac=function(X){return new(X||le)(M.LFG(E.K0),M.LFG(M.Lbi),M.LFG(pn))},le.\u0275prov=M.Yz7({token:le,factory:le.\u0275fac}),le})(),zt=(()=>{class le{constructor(X,Me){this.tokenService=X,this.headerName=Me}intercept(X,Me){const Ke=X.url.toLowerCase();if("GET"===X.method||"HEAD"===X.method||Ke.startsWith("http://")||Ke.startsWith("https://"))return Me.handle(X);const Et=this.tokenService.getToken();return null!==Et&&!X.headers.has(this.headerName)&&(X=X.clone({headers:X.headers.set(this.headerName,Et)})),Me.handle(X)}}return le.\u0275fac=function(X){return new(X||le)(M.LFG(hn),M.LFG(bn))},le.\u0275prov=M.Yz7({token:le,factory:le.\u0275fac}),le})(),Te=(()=>{class le{constructor(X,Me){this.backend=X,this.injector=Me,this.chain=null}handle(X){if(null===this.chain){const Me=this.injector.get(it,[]);this.chain=Me.reduceRight((Ke,Et)=>new re(Ke,Et),this.backend)}return this.chain.handle(X)}}return le.\u0275fac=function(X){return new(X||le)(M.LFG(Ce),M.LFG(M.zs3))},le.\u0275prov=M.Yz7({token:le,factory:le.\u0275fac}),le})(),nn=(()=>{class le{static disable(){return{ngModule:le,providers:[{provide:zt,useClass:ft}]}}static withOptions(X={}){return{ngModule:le,providers:[X.cookieName?{provide:pn,useValue:X.cookieName}:[],X.headerName?{provide:bn,useValue:X.headerName}:[]]}}}return le.\u0275fac=function(X){return new(X||le)},le.\u0275mod=M.oAB({type:le}),le.\u0275inj=M.cJS({providers:[zt,{provide:it,useExisting:zt,multi:!0},{provide:hn,useClass:On},{provide:pn,useValue:"XSRF-TOKEN"},{provide:bn,useValue:"X-XSRF-TOKEN"}]}),le})(),Nn=(()=>{class le{}return le.\u0275fac=function(X){return new(X||le)},le.\u0275mod=M.oAB({type:le}),le.\u0275inj=M.cJS({providers:[ve,{provide:ce,useClass:Te},Ct,{provide:Ce,useExisting:Ct}],imports:[nn.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),le})()},8256:(Mt,xe,U)=>{"use strict";U.d(xe,{tb:()=>kg,AFp:()=>Ng,ip1:()=>Mg,CZH:()=>Ya,hGG:()=>MI,z2F:()=>Ja,sBO:()=>gI,Sil:()=>K0,_Vd:()=>Ns,EJc:()=>q0,Xts:()=>Mc,SBq:()=>Ps,lqb:()=>qo,qLn:()=>xs,vpe:()=>Zr,XFs:()=>le,OlP:()=>fn,zs3:()=>Ko,ZZ4:()=>wl,aQg:()=>Al,soG:()=>Ka,YKP:()=>Hh,h0i:()=>Qi,PXZ:()=>cI,R0b:()=>br,FiY:()=>bs,Lbi:()=>W0,g9A:()=>xg,Qsj:()=>pv,FYo:()=>Od,JOm:()=>Yr,tp0:()=>Ts,Rgc:()=>Js,dDg:()=>oI,eoX:()=>Hg,GfV:()=>Md,s_b:()=>Ga,ifc:()=>$t,MMx:()=>nl,Lck:()=>PE,eFA:()=>Gg,G48:()=>hI,Gpc:()=>G,f3M:()=>Xl,_c5:()=>OI,c2e:()=>G0,zSh:()=>xc,wAp:()=>Ot,vHH:()=>$e,lri:()=>jg,rWj:()=>Bg,D6c:()=>NI,cg1:()=>Yu,kL8:()=>ph,dqk:()=>Je,sIi:()=>Bs,CqO:()=>yp,QGY:()=>Hu,QP$:()=>Zi,F4k:()=>vp,RDi:()=>bm,AaK:()=>ke,qOj:()=>Pu,TTD:()=>tt,_Bn:()=>Bh,xp6:()=>hf,uIk:()=>Lu,ekj:()=>Gu,Suo:()=>cg,Xpm:()=>lr,lG2:()=>vn,Yz7:()=>pn,cJS:()=>hn,oAB:()=>Nr,Yjl:()=>dr,Y36:()=>ki,_UZ:()=>Uu,qZA:()=>Va,TgZ:()=>Fa,n5z:()=>Ss,LFG:()=>Bn,$8M:()=>Es,$Z:()=>wf,NdJ:()=>$u,CRH:()=>ug,Q6J:()=>Fu,iGM:()=>sg,LSH:()=>Oc,kYT:()=>Rt,YNc:()=>gp,_uU:()=>zp,Gf:()=>ag});var E=U(8189),M=U(8421),S=U(515),L=U(7669),ae=U(2076),pe=U(7579),ce=U(727),Ce=U(9751),we=U(2961),Y=U(4482);function je(e,t,...n){if(!0===t)return void e();if(!1===t)return;const o=new we.Hp({next:()=>{o.unsubscribe(),e()}});return t(...n).subscribe(o)}function Le(e){for(let t in e)if(e[t]===Le)return t;throw Error("Could not find renamed property on target object.")}function z(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function ke(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(ke).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function ye(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const K=Le({__forward_ref__:Le});function G(e){return e.__forward_ref__=G,e.toString=function(){return ke(this())},e}function Fe(e){return He(e)?e():e}function He(e){return"function"==typeof e&&e.hasOwnProperty(K)&&e.__forward_ref__===G}class $e extends Error{constructor(t,n){super(function me(e,t){return`NG0${Math.abs(e)}${t?": "+t.trim():""}`}(t,n)),this.code=t}}function ge(e){return"string"==typeof e?e:null==e?"":String(e)}function he(e,t){throw new $e(-201,!1)}function tn(e,t){null==e&&function xt(e,t,n,o){throw new Error(`ASSERTION ERROR: ${e}`+(null==o?"":` [Expected=> ${n} ${o} ${t} <=Actual]`))}(t,e,null,"!=")}function pn(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function hn(e){return{providers:e.providers||[],imports:e.imports||[]}}function On(e){return zt(e,nn)||zt(e,an)}function zt(e,t){return e.hasOwnProperty(t)?e[t]:null}function Mn(e){return e&&(e.hasOwnProperty(Nn)||e.hasOwnProperty(Kt))?e[Nn]:null}const nn=Le({\u0275prov:Le}),Nn=Le({\u0275inj:Le}),an=Le({ngInjectableDef:Le}),Kt=Le({ngInjectorDef:Le});var le=(()=>((le=le||{})[le.Default=0]="Default",le[le.Host=1]="Host",le[le.Self=2]="Self",le[le.SkipSelf=4]="SkipSelf",le[le.Optional=8]="Optional",le))();let te;function Me(e){const t=te;return te=e,t}function Ke(e,t,n){const o=On(e);return o&&"root"==o.providedIn?void 0===o.value?o.value=o.factory():o.value:n&le.Optional?null:void 0!==t?t:void he(ke(e))}function Nt(e){return{toString:e}.toString()}var kt=(()=>((kt=kt||{})[kt.OnPush=0]="OnPush",kt[kt.Default=1]="Default",kt))(),$t=(()=>{return(e=$t||($t={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",$t;var e})();const Je=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Jt={},Lt=[],En=Le({\u0275cmp:Le}),St=Le({\u0275dir:Le}),$n=Le({\u0275pipe:Le}),yr=Le({\u0275mod:Le}),In=Le({\u0275fac:Le}),ur=Le({__NG_ELEMENT_ID__:Le});let eo=0;function lr(e){return Nt(()=>{const n=!0===e.standalone,o={},s={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:o,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===kt.OnPush,directiveDefs:null,pipeDefs:null,standalone:n,dependencies:n&&e.dependencies||null,getStandaloneInjector:null,selectors:e.selectors||Lt,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||$t.Emulated,id:"c"+eo++,styles:e.styles||Lt,_:null,setInput:null,schemas:e.schemas||null,tView:null},a=e.dependencies,l=e.features;return s.inputs=to(e.inputs,o),s.outputs=to(e.outputs),l&&l.forEach(m=>m(s)),s.directiveDefs=a?()=>("function"==typeof a?a():a).map(Tr).filter(_r):null,s.pipeDefs=a?()=>("function"==typeof a?a():a).map(q).filter(_r):null,s})}function Tr(e){return _e(e)||se(e)}function _r(e){return null!==e}function Nr(e){return Nt(()=>({type:e.type,bootstrap:e.bootstrap||Lt,declarations:e.declarations||Lt,imports:e.imports||Lt,exports:e.exports||Lt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Rt(e,t){return Nt(()=>{const n=Re(e,!0);n.declarations=t.declarations||Lt,n.imports=t.imports||Lt,n.exports=t.exports||Lt})}function to(e,t){if(null==e)return Jt;const n={};for(const o in e)if(e.hasOwnProperty(o)){let s=e[o],a=s;Array.isArray(s)&&(a=s[1],s=s[0]),n[s]=o,t&&(t[s]=a)}return n}const vn=lr;function dr(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function _e(e){return e[En]||null}function se(e){return e[St]||null}function q(e){return e[$n]||null}function Re(e,t){const n=e[yr]||null;if(!n&&!0===t)throw new Error(`Type ${ke(e)} does not have '\u0275mod' property.`);return n}function wn(e){return Array.isArray(e)&&"object"==typeof e[1]}function Jn(e){return Array.isArray(e)&&!0===e[1]}function Xn(e){return 0!=(8&e.flags)}function Rr(e){return 2==(2&e.flags)}function Zn(e){return 1==(1&e.flags)}function un(e){return null!==e.template}function ho(e){return 0!=(256&e[2])}function Ie(e,t){return e.hasOwnProperty(In)?e[In]:null}class We{constructor(t,n,o){this.previousValue=t,this.currentValue=n,this.firstChange=o}isFirstChange(){return this.firstChange}}function tt(){return w}function w(e){return e.type.prototype.ngOnChanges&&(e.setInput=qe),Pe}function Pe(){const e=ut(this),t=e?.current;if(t){const n=e.previous;if(n===Jt)e.previous=t;else for(let o in t)n[o]=t[o];e.current=null,this.ngOnChanges(t)}}function qe(e,t,n,o){const s=ut(e)||function ie(e,t){return e[Ee]=t}(e,{previous:Jt,current:null}),a=s.current||(s.current={}),l=s.previous,m=this.declaredInputs[n],_=l[m];a[m]=new We(_&&_.currentValue,t,l===Jt),e[o]=t}tt.ngInherit=!0;const Ee="__ngSimpleChanges__";function ut(e){return e[Ee]||null}function Pt(e){for(;Array.isArray(e);)e=e[0];return e}function V(e,t){return Pt(t[e.index])}function Ue(e,t){return e.data[t]}function ht(e,t){const n=t[e];return wn(n)?n:n[0]}function Sn(e){return 4==(4&e[2])}function dn(e){return 64==(64&e[2])}function Ht(e,t){return null==t?null:e[t]}function Ln(e){e[18]=0}function gn(e,t){e[5]+=t;let n=e,o=e[3];for(;null!==o&&(1===t&&1===n[5]||-1===t&&0===n[5]);)o[5]+=t,n=o,o=o[3]}const _t={lFrame:cs(null),bindingsEnabled:!0};function go(){return _t.bindingsEnabled}function et(){return _t.lFrame.lView}function Zt(){return _t.lFrame.tView}function Vn(){let e=Xs();for(;null!==e&&64===e.type;)e=e.parent;return e}function Xs(){return _t.lFrame.currentTNode}function rr(e,t){const n=_t.lFrame;n.currentTNode=e,n.isParent=t}function ts(){return _t.lFrame.isParent}function Fr(){return _t.lFrame.bindingIndex++}function nc(e,t){const n=_t.lFrame;n.bindingIndex=n.bindingRootIndex=e,rs(t)}function rs(e){_t.lFrame.currentDirectiveIndex=e}function ea(){return _t.lFrame.currentQueryIndex}function is(e){_t.lFrame.currentQueryIndex=e}function oc(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function ss(e,t,n){if(n&le.SkipSelf){let s=t,a=e;for(;!(s=s.parent,null!==s||n&le.Host||(s=oc(a),null===s||(a=a[15],10&s.type))););if(null===s)return!1;t=s,e=a}const o=_t.lFrame=ui();return o.currentTNode=t,o.lView=e,!0}function as(e){const t=ui(),n=e[1];_t.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function ui(){const e=_t.lFrame,t=null===e?null:e.child;return null===t?cs(e):t}function cs(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function li(){const e=_t.lFrame;return _t.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const Ao=li;function us(){const e=li();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function er(){return _t.lFrame.selectedIndex}function Ir(e){_t.lFrame.selectedIndex=e}function An(){const e=_t.lFrame;return Ue(e.tView,e.selectedIndex)}function pi(e,t){for(let n=t.directiveStart,o=t.directiveEnd;n<o;n++){const a=e.data[n].type.prototype,{ngAfterContentInit:l,ngAfterContentChecked:m,ngAfterViewInit:_,ngAfterViewChecked:R,ngOnDestroy:x}=a;l&&(e.contentHooks||(e.contentHooks=[])).push(-n,l),m&&((e.contentHooks||(e.contentHooks=[])).push(n,m),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,m)),_&&(e.viewHooks||(e.viewHooks=[])).push(-n,_),R&&((e.viewHooks||(e.viewHooks=[])).push(n,R),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,R)),null!=x&&(e.destroyHooks||(e.destroyHooks=[])).push(n,x)}}function hi(e,t,n){oa(e,t,3,n)}function gi(e,t,n,o){(3&e[2])===n&&oa(e,t,n,o)}function ls(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function oa(e,t,n,o){const a=o??-1,l=t.length-1;let m=0;for(let _=void 0!==o?65535&e[18]:0;_<l;_++)if("number"==typeof t[_+1]){if(m=t[_],null!=o&&m>=o)break}else t[_]<0&&(e[18]+=65536),(m<a||-1==a)&&(mi(e,n,t,_),e[18]=(4294901760&e[18])+_+2),_++}function mi(e,t,n,o){const s=n[o]<0,a=n[o+1],m=e[s?-n[o]:n[o]];if(s){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(m)}finally{}}}else try{a.call(m)}finally{}}class Oo{constructor(t,n,o){this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=o}}function No(e,t,n){let o=0;for(;o<n.length;){const s=n[o];if("number"==typeof s){if(0!==s)break;o++;const a=n[o++],l=n[o++],m=n[o++];e.setAttribute(t,l,m,a)}else{const a=s,l=n[++o];ps(a)?e.setProperty(t,a,l):e.setAttribute(t,a,l),o++}}return o}function fs(e){return 3===e||4===e||6===e}function ps(e){return 64===e.charCodeAt(0)}function Po(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let o=0;o<t.length;o++){const s=t[o];"number"==typeof s?n=s:0===n||sa(e,n,s,null,-1===n||2===n?t[++o]:null)}}return e}function sa(e,t,n,o,s){let a=0,l=e.length;if(-1===t)l=-1;else for(;a<e.length;){const m=e[a++];if("number"==typeof m){if(m===t){l=-1;break}if(m>t){l=a-1;break}}}for(;a<e.length;){const m=e[a];if("number"==typeof m)break;if(m===n){if(null===o)return void(null!==s&&(e[a+1]=s));if(o===e[a+1])return void(e[a+2]=s)}a++,null!==o&&a++,null!==s&&a++}-1!==l&&(e.splice(l,0,t),a=l+1),e.splice(a++,0,n),null!==o&&e.splice(a++,0,o),null!==s&&e.splice(a++,0,s)}function vi(e){return-1!==e}function mo(e){return 32767&e}function vo(e,t){let n=function dc(e){return e>>16}(e),o=t;for(;n>0;)o=o[15],n--;return o}let hs=!0;function yi(e){const t=hs;return hs=e,t}let aa=0;const Vr={};function xo(e,t){const n=vs(e,t);if(-1!==n)return n;const o=t[1];o.firstCreatePass&&(e.injectorIndex=t.length,ms(o.data,e),ms(t,null),ms(o.blueprint,null));const s=yo(e,t),a=e.injectorIndex;if(vi(s)){const l=mo(s),m=vo(s,t),_=m[1].data;for(let R=0;R<8;R++)t[a+R]=m[l+R]|_[l+R]}return t[a+8]=s,a}function ms(e,t){e.push(0,0,0,0,0,0,0,0,t)}function vs(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function yo(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,o=null,s=t;for(;null!==s;){if(o=da(s),null===o)return-1;if(n++,s=s[15],-1!==o.injectorIndex)return o.injectorIndex|n<<16}return-1}function ko(e,t,n){!function pc(e,t,n){let o;"string"==typeof n?o=n.charCodeAt(0)||0:n.hasOwnProperty(ur)&&(o=n[ur]),null==o&&(o=n[ur]=aa++);const s=255&o;t.data[e+(s>>5)]|=1<<s}(e,t,n)}function Si(e,t,n){if(n&le.Optional)return e;he()}function ca(e,t,n,o){if(n&le.Optional&&void 0===o&&(o=null),0==(n&(le.Self|le.Host))){const s=e[9],a=Me(void 0);try{return s?s.get(t,o,n&le.Optional):Ke(t,o,n&le.Optional)}finally{Me(a)}}return Si(o,0,n)}function ua(e,t,n,o=le.Default,s){if(null!==e){if(1024&t[2]){const l=function Ii(e,t,n,o,s){let a=e,l=t;for(;null!==a&&null!==l&&1024&l[2]&&!(256&l[2]);){const m=Lo(a,l,n,o|le.Self,Vr);if(m!==Vr)return m;let _=a.parent;if(!_){const R=l[21];if(R){const x=R.get(n,Vr,o);if(x!==Vr)return x}_=da(l),l=l[15]}a=_}return s}(e,t,n,o,Vr);if(l!==Vr)return l}const a=Lo(e,t,n,o,Vr);if(a!==Vr)return a}return ca(t,n,o,s)}function Lo(e,t,n,o,s){const a=function gc(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(ur)?e[ur]:void 0;return"number"==typeof t?t>=0?255&t:mc:t}(n);if("function"==typeof a){if(!ss(t,e,o))return o&le.Host?Si(s,0,o):ca(t,n,o,s);try{const l=a(o);if(null!=l||o&le.Optional)return l;he()}finally{Ao()}}else if("number"==typeof a){let l=null,m=vs(e,t),_=-1,R=o&le.Host?t[16][6]:null;for((-1===m||o&le.SkipSelf)&&(_=-1===m?yo(e,t):t[m+8],-1!==_&&_s(o,!1)?(l=t[1],m=mo(_),t=vo(_,t)):m=-1);-1!==m;){const x=t[1];if(la(a,m,x.data)){const B=hc(m,t,n,l,o,R);if(B!==Vr)return B}_=t[m+8],-1!==_&&_s(o,t[1].data[m+8]===R)&&la(a,m,t)?(l=x,m=mo(_),t=vo(_,t)):m=-1}}return s}function hc(e,t,n,o,s,a){const l=t[1],m=l.data[e+8],x=Ei(m,l,n,null==o?Rr(m)&&hs:o!=l&&0!=(3&m.type),s&le.Host&&a===m);return null!==x?Fo(t,l,x,m):Vr}function Ei(e,t,n,o,s){const a=e.providerIndexes,l=t.data,m=1048575&a,_=e.directiveStart,x=a>>20,ue=s?m+x:e.directiveEnd;for(let be=o?m:m+x;be<ue;be++){const Ge=l[be];if(be<_&&n===Ge||be>=_&&Ge.type===n)return be}if(s){const be=l[_];if(be&&un(be)&&be.type===n)return _}return null}function Fo(e,t,n,o){let s=e[n];const a=t.data;if(function ac(e){return e instanceof Oo}(s)){const l=s;l.resolving&&function Be(e,t){const n=t?`. Dependency path: ${t.join(" > ")} > ${e}`:"";throw new $e(-200,`Circular dependency in DI detected for ${e}${n}`)}(function Se(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():ge(e)}(a[n]));const m=yi(l.canSeeViewProviders);l.resolving=!0;const _=l.injectImpl?Me(l.injectImpl):null;ss(e,o,le.Default);try{s=e[n]=l.factory(void 0,a,e,o),t.firstCreatePass&&n>=o.directiveStart&&function ra(e,t,n){const{ngOnChanges:o,ngOnInit:s,ngDoCheck:a}=t.type.prototype;if(o){const l=w(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,l),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,l)}s&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,s),a&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,a),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,a))}(n,a[n],t)}finally{null!==_&&Me(_),yi(m),l.resolving=!1,Ao()}}return s}function la(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function _s(e,t){return!(e&le.Self||e&le.Host&&t)}class xn{constructor(t,n){this._tNode=t,this._lView=n}get(t,n,o){return ua(this._tNode,this._lView,t,o,n)}}function mc(){return new xn(Vn(),et())}function Ss(e){return Nt(()=>{const t=e.prototype.constructor,n=t[In]||Vo(t),o=Object.prototype;let s=Object.getPrototypeOf(e.prototype).constructor;for(;s&&s!==o;){const a=s[In]||Vo(s);if(a&&a!==n)return a;s=Object.getPrototypeOf(s)}return a=>new a})}function Vo(e){return He(e)?()=>{const t=Vo(Fe(e));return t&&t()}:Ie(e)}function da(e){const t=e[1],n=t.type;return 2===n?t.declTNode:1===n?e[6]:null}function Es(e){return function ys(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;const n=e.attrs;if(n){const o=n.length;let s=0;for(;s<o;){const a=n[s];if(fs(a))break;if(0===a)s+=2;else if("number"==typeof a)for(s++;s<o&&"string"==typeof n[s];)s++;else{if(a===t)return n[s+1];s+=2}}}return null}(Vn(),e)}const Uo="__parameters__";function _o(e,t,n){return Nt(()=>{const o=function Di(e){return function(...n){if(e){const o=e(...n);for(const s in o)this[s]=o[s]}}}(t);function s(...a){if(this instanceof s)return o.apply(this,a),this;const l=new s(...a);return m.annotation=l,m;function m(_,R,x){const B=_.hasOwnProperty(Uo)?_[Uo]:Object.defineProperty(_,Uo,{value:[]})[Uo];for(;B.length<=x;)B.push(null);return(B[x]=B[x]||[]).push(l),_}}return n&&(s.prototype=Object.create(n.prototype)),s.prototype.ngMetadataName=e,s.annotationCls=s,s})}class fn{constructor(t,n){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=pn({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function hr(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let o=e[n];Array.isArray(o)?(t===e&&(t=e.slice(0,n)),hr(o,t)):t!==e&&t.push(o)}return t}function Dr(e,t){e.forEach(n=>Array.isArray(n)?Dr(n,t):t(n))}function pa(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function bi(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function N(e,t,n){let o=Z(e,t);return o>=0?e[1|o]=n:(o=~o,function p(e,t,n,o){let s=e.length;if(s==t)e.push(n,o);else if(1===s)e.push(o,e[0]),e[0]=n;else{for(s--,e.push(e[s-1],e[s]);s>t;)e[s]=e[s-2],s--;e[t]=n,e[t+1]=o}}(e,o,t,n)),o}function H(e,t){const n=Z(e,t);if(n>=0)return e[1|n]}function Z(e,t){return function at(e,t,n){let o=0,s=e.length>>n;for(;s!==o;){const a=o+(s-o>>1),l=e[a<<n];if(t===l)return a<<n;l>t?s=a:o=a+1}return~(s<<n)}(e,t,1)}const Go={},Sc="__NG_DI_FLAG__",ha="ngTempTokenPath",lm=/\n/gm,Jl="__source";let Ds;function wi(e){const t=Ds;return Ds=e,t}function fm(e,t=le.Default){if(void 0===Ds)throw new $e(-203,!1);return null===Ds?Ke(e,void 0,t):Ds.get(e,t&le.Optional?null:void 0,t)}function Bn(e,t=le.Default){return(function X(){return te}()||fm)(Fe(e),t)}function Xl(e,t=le.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),Bn(e,t)}function Ec(e){const t=[];for(let n=0;n<e.length;n++){const o=Fe(e[n]);if(Array.isArray(o)){if(0===o.length)throw new $e(900,!1);let s,a=le.Default;for(let l=0;l<o.length;l++){const m=o[l],_=pm(m);"number"==typeof _?-1===_?s=m.token:a|=_:s=m}t.push(Bn(s,a))}else t.push(Bn(o))}return t}function Cs(e,t){return e[Sc]=t,e.prototype[Sc]=t,e}function pm(e){return e[Sc]}const bs=Cs(_o("Optional"),8),Ts=Cs(_o("SkipSelf"),4);let Dc;function bm(e){Dc=e}class ld{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function So(e){return e instanceof ld?e.changingThisBreaksApplicationSecurity:e}const Fm=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Vm=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var Hn=(()=>((Hn=Hn||{})[Hn.NONE=0]="NONE",Hn[Hn.HTML=1]="HTML",Hn[Hn.STYLE=2]="STYLE",Hn[Hn.SCRIPT=3]="SCRIPT",Hn[Hn.URL=4]="URL",Hn[Hn.RESOURCE_URL=5]="RESOURCE_URL",Hn))();function Oc(e){const t=function Ms(){const e=et();return e&&e[12]}();return t?t.sanitize(Hn.URL,e)||"":function Rs(e,t){const n=function Pm(e){return e instanceof ld&&e.getTypeName()||null}(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}(e,"URL")?So(e):function _a(e){return(e=String(e)).match(Fm)||e.match(Vm)?e:"unsafe:"+e}(ge(e))}const Mc=new fn("ENVIRONMENT_INITIALIZER"),_d=new fn("INJECTOR",-1),Sd=new fn("INJECTOR_DEF_TYPES");class Ed{get(t,n=Go){if(n===Go){const o=new Error(`NullInjectorError: No provider for ${ke(t)}!`);throw o.name="NullInjectorError",o}return n}}function Xm(...e){return{\u0275providers:Id(0,e)}}function Id(e,...t){const n=[],o=new Set;let s;return Dr(t,a=>{const l=a;Nc(l,n,[],o)&&(s||(s=[]),s.push(l))}),void 0!==s&&Dd(s,n),n}function Dd(e,t){for(let n=0;n<e.length;n++){const{providers:s}=e[n];Dr(s,a=>{t.push(a)})}}function Nc(e,t,n,o){if(!(e=Fe(e)))return!1;let s=null,a=Mn(e);const l=!a&&_e(e);if(a||l){if(l&&!l.standalone)return!1;s=e}else{const _=e.ngModule;if(a=Mn(_),!a)return!1;s=_}const m=o.has(s);if(l){if(m)return!1;if(o.add(s),l.dependencies){const _="function"==typeof l.dependencies?l.dependencies():l.dependencies;for(const R of _)Nc(R,t,n,o)}}else{if(!a)return!1;{if(null!=a.imports&&!m){let R;o.add(s);try{Dr(a.imports,x=>{Nc(x,t,n,o)&&(R||(R=[]),R.push(x))})}finally{}void 0!==R&&Dd(R,t)}if(!m){const R=Ie(s)||(()=>new s);t.push({provide:s,useFactory:R,deps:Lt},{provide:Sd,useValue:s,multi:!0},{provide:Mc,useValue:()=>Bn(s),multi:!0})}const _=a.providers;null==_||m||Dr(_,x=>{t.push(x)})}}return s!==e&&void 0!==e.providers}const Zm=Le({provide:String,useValue:Le});function Pc(e){return null!==e&&"object"==typeof e&&Zm in e}function zo(e){return"function"==typeof e}const xc=new fn("Set Injector scope."),Ea={},tv={};let kc;function Ia(){return void 0===kc&&(kc=new Ed),kc}class qo{}class Td extends qo{constructor(t,n,o,s){super(),this.parent=n,this.source=o,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Fc(t,l=>this.processProvider(l)),this.records.set(_d,Oi(void 0,this)),s.has("environment")&&this.records.set(qo,Oi(void 0,this));const a=this.records.get(xc);null!=a&&"string"==typeof a.value&&this.scopes.add(a.value),this.injectorDefTypes=new Set(this.get(Sd.multi,Lt,le.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const n=wi(this),o=Me(void 0);try{return t()}finally{wi(n),Me(o)}}get(t,n=Go,o=le.Default){this.assertNotDestroyed();const s=wi(this),a=Me(void 0);try{if(!(o&le.SkipSelf)){let m=this.records.get(t);if(void 0===m){const _=function sv(e){return"function"==typeof e||"object"==typeof e&&e instanceof fn}(t)&&On(t);m=_&&this.injectableDefInScope(_)?Oi(Lc(t),Ea):null,this.records.set(t,m)}if(null!=m)return this.hydrate(t,m)}return(o&le.Self?Ia():this.parent).get(t,n=o&le.Optional&&n===Go?null:n)}catch(l){if("NullInjectorError"===l.name){if((l[ha]=l[ha]||[]).unshift(ke(t)),s)throw l;return function hm(e,t,n,o){const s=e[ha];throw t[Jl]&&s.unshift(t[Jl]),e.message=function gm(e,t,n,o=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let s=ke(t);if(Array.isArray(t))s=t.map(ke).join(" -> ");else if("object"==typeof t){let a=[];for(let l in t)if(t.hasOwnProperty(l)){let m=t[l];a.push(l+":"+("string"==typeof m?JSON.stringify(m):ke(m)))}s=`{${a.join(", ")}}`}return`${n}${o?"("+o+")":""}[${s}]: ${e.replace(lm,"\n  ")}`}("\n"+e.message,s,n,o),e.ngTokenPath=s,e[ha]=null,e}(l,t,"R3InjectorError",this.source)}throw l}finally{Me(a),wi(s)}}resolveInjectorInitializers(){const t=wi(this),n=Me(void 0);try{const o=this.get(Mc.multi,Lt,le.Self);for(const s of o)s()}finally{wi(t),Me(n)}}toString(){const t=[],n=this.records;for(const o of n.keys())t.push(ke(o));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $e(205,!1)}processProvider(t){let n=zo(t=Fe(t))?t:Fe(t&&t.provide);const o=function rv(e){return Pc(e)?Oi(void 0,e.useValue):Oi(wd(e),Ea)}(t);if(zo(t)||!0!==t.multi)this.records.get(n);else{let s=this.records.get(n);s||(s=Oi(void 0,Ea,!0),s.factory=()=>Ec(s.multi),this.records.set(n,s)),n=t,s.multi.push(t)}this.records.set(n,o)}hydrate(t,n){return n.value===Ea&&(n.value=tv,n.value=n.factory()),"object"==typeof n.value&&n.value&&function iv(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(t){if(!t.providedIn)return!1;const n=Fe(t.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}}function Lc(e){const t=On(e),n=null!==t?t.factory:Ie(e);if(null!==n)return n;if(e instanceof fn)throw new $e(204,!1);if(e instanceof Function)return function nv(e){const t=e.length;if(t>0)throw function $o(e,t){const n=[];for(let o=0;o<e;o++)n.push(t);return n}(t,"?"),new $e(204,!1);const n=function Te(e){const t=e&&(e[nn]||e[an]);if(t){const n=function Yt(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new $e(204,!1)}function wd(e,t,n){let o;if(zo(e)){const s=Fe(e);return Ie(s)||Lc(s)}if(Pc(e))o=()=>Fe(e.useValue);else if(function bd(e){return!(!e||!e.useFactory)}(e))o=()=>e.useFactory(...Ec(e.deps||[]));else if(function Cd(e){return!(!e||!e.useExisting)}(e))o=()=>Bn(Fe(e.useExisting));else{const s=Fe(e&&(e.useClass||e.provide));if(!function ov(e){return!!e.deps}(e))return Ie(s)||Lc(s);o=()=>new s(...Ec(e.deps))}return o}function Oi(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function av(e){return!!e.\u0275providers}function Fc(e,t){for(const n of e)Array.isArray(n)?Fc(n,t):av(n)?Fc(n.\u0275providers,t):t(n)}class Ad{}class lv{resolveComponentFactory(t){throw function uv(e){const t=Error(`No component factory found for ${ke(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(t)}}let Ns=(()=>{class e{}return e.NULL=new lv,e})();function dv(){return Mi(Vn(),et())}function Mi(e,t){return new Ps(V(e,t))}let Ps=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=dv,e})();function fv(e){return e instanceof Ps?e.nativeElement:e}class Od{}let pv=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function hv(){const e=et(),n=ht(Vn().index,e);return(wn(n)?n:e)[11]}(),e})(),gv=(()=>{class e{}return e.\u0275prov=pn({token:e,providedIn:"root",factory:()=>null}),e})();class Md{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const mv=new Md("14.1.3"),Vc={};function $c(e){return e.ngOriginalError}class xs{constructor(){this._console=console}handleError(t){const n=this._findOriginalError(t);this._console.error("ERROR",t),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(t){let n=t&&$c(t);for(;n&&$c(n);)n=$c(n);return n||null}}const Wc=new Map;let Av=0;const zc="__ngContext__";function ar(e,t){wn(t)?(e[zc]=t[20],function Ov(e){Wc.set(e[20],e)}(t)):e[zc]=t}function ks(e){const t=e[zc];return"number"==typeof t?function Fd(e){return Wc.get(e)||null}(t):t||null}function qc(e){const t=ks(e);return t?wn(t)?t:t.lView:null}const Uv=(()=>(typeof requestAnimationFrame<"u"&&requestAnimationFrame||setTimeout).bind(Je))();function co(e){return e instanceof Function?e():e}var Yr=(()=>((Yr=Yr||{})[Yr.Important=1]="Important",Yr[Yr.DashCase=2]="DashCase",Yr))();function Kc(e,t){return undefined(e,t)}function Ls(e){const t=e[3];return Jn(t)?t[3]:t}function Jc(e){return Gd(e[13])}function Qc(e){return Gd(e[4])}function Gd(e){for(;null!==e&&!Jn(e);)e=e[4];return e}function Pi(e,t,n,o,s){if(null!=o){let a,l=!1;Jn(o)?a=o:wn(o)&&(l=!0,o=o[0]);const m=Pt(o);0===e&&null!==n?null==s?Qd(t,n,m):Yo(t,n,m,s||null,!0):1===e&&null!==n?Yo(t,n,m,s||null,!0):2===e?function sf(e,t,n){const o=Da(e,t);o&&function ry(e,t,n,o){e.removeChild(t,n,o)}(e,o,t,n)}(t,m,l):3===e&&t.destroyNode(m),null!=a&&function sy(e,t,n,o,s){const a=n[7];a!==Pt(n)&&Pi(t,e,o,a,s);for(let m=10;m<n.length;m++){const _=n[m];Fs(_[1],_,e,t,o,a)}}(t,e,a,n,s)}}function Zc(e,t,n){return e.createElement(t,n)}function qd(e,t){const n=e[9],o=n.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,gn(s,-1)),n.splice(o,1)}function eu(e,t){if(e.length<=10)return;const n=10+t,o=e[n];if(o){const s=o[17];null!==s&&s!==e&&qd(s,o),t>0&&(e[n-1][4]=o[4]);const a=bi(e,10+t);!function Kv(e,t){Fs(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(o[1],o);const l=a[19];null!==l&&l.detachView(a[1]),o[3]=null,o[4]=null,o[2]&=-65}return o}function Yd(e,t){if(!(128&t[2])){const n=t[11];n.destroyNode&&Fs(e,t,n,3,null,null),function Xv(e){let t=e[13];if(!t)return tu(e[1],e);for(;t;){let n=null;if(wn(t))n=t[13];else{const o=t[10];o&&(n=o)}if(!n){for(;t&&!t[4]&&t!==e;)wn(t)&&tu(t[1],t),t=t[3];null===t&&(t=e),wn(t)&&tu(t[1],t),n=t&&t[4]}t=n}}(t)}}function tu(e,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function ny(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let o=0;o<n.length;o+=2){const s=t[n[o]];if(!(s instanceof Oo)){const a=n[o+1];if(Array.isArray(a))for(let l=0;l<a.length;l+=2){const m=s[a[l]],_=a[l+1];try{_.call(m)}finally{}}else try{a.call(s)}finally{}}}}(e,t),function ty(e,t){const n=e.cleanup,o=t[7];let s=-1;if(null!==n)for(let a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){const l=n[a+1],m="function"==typeof l?l(t):Pt(t[l]),_=o[s=n[a+2]],R=n[a+3];"boolean"==typeof R?m.removeEventListener(n[a],_,R):R>=0?o[s=R]():o[s=-R].unsubscribe(),a+=2}else{const l=o[s=n[a+1]];n[a].call(l)}if(null!==o){for(let a=s+1;a<o.length;a++)(0,o[a])();t[7]=null}}(e,t),1===t[1].type&&t[11].destroy();const n=t[17];if(null!==n&&Jn(t[3])){n!==t[3]&&qd(n,t);const o=t[19];null!==o&&o.detachView(e)}!function Mv(e){Wc.delete(e[20])}(t)}}function Kd(e,t,n){return function Jd(e,t,n){let o=t;for(;null!==o&&40&o.type;)o=(t=o).parent;if(null===o)return n[0];if(2&o.flags){const s=e.data[o.directiveStart].encapsulation;if(s===$t.None||s===$t.Emulated)return null}return V(o,n)}(e,t.parent,n)}function Yo(e,t,n,o,s){e.insertBefore(t,n,o,s)}function Qd(e,t,n){e.appendChild(t,n)}function Xd(e,t,n,o,s){null!==o?Yo(e,t,n,o,s):Qd(e,t,n)}function Da(e,t){return e.parentNode(t)}let tf=function ef(e,t,n){return 40&e.type?V(e,n):null};function Ca(e,t,n,o){const s=Kd(e,o,t),a=t[11],m=function Zd(e,t,n){return tf(e,t,n)}(o.parent||t[6],o,t);if(null!=s)if(Array.isArray(n))for(let _=0;_<n.length;_++)Xd(a,s,n[_],m,!1);else Xd(a,s,n,m,!1)}function ba(e,t){if(null!==t){const n=t.type;if(3&n)return V(t,e);if(4&n)return ru(-1,e[t.index]);if(8&n){const o=t.child;if(null!==o)return ba(e,o);{const s=e[t.index];return Jn(s)?ru(-1,s):Pt(s)}}if(32&n)return Kc(t,e)()||Pt(e[t.index]);{const o=rf(e,t);return null!==o?Array.isArray(o)?o[0]:ba(Ls(e[16]),o):ba(e,t.next)}}return null}function rf(e,t){return null!==t?e[16][6].projection[t.projection]:null}function ru(e,t){const n=10+e+1;if(n<t.length){const o=t[n],s=o[1].firstChild;if(null!==s)return ba(o,s)}return t[7]}function ou(e,t,n,o,s,a,l){for(;null!=n;){const m=o[n.index],_=n.type;if(l&&0===t&&(m&&ar(Pt(m),o),n.flags|=4),64!=(64&n.flags))if(8&_)ou(e,t,n.child,o,s,a,!1),Pi(t,e,s,m,a);else if(32&_){const R=Kc(n,o);let x;for(;x=R();)Pi(t,e,s,x,a);Pi(t,e,s,m,a)}else 16&_?af(e,t,o,n,s,a):Pi(t,e,s,m,a);n=l?n.projectionNext:n.next}}function Fs(e,t,n,o,s,a){ou(n,o,e.firstChild,t,s,a,!1)}function af(e,t,n,o,s,a){const l=n[16],_=l[6].projection[o.projection];if(Array.isArray(_))for(let R=0;R<_.length;R++)Pi(t,e,s,_[R],a);else ou(e,t,_,l[3],s,a,!0)}function cf(e,t,n){e.setAttribute(t,"style",n)}function iu(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function uf(e,t,n){let o=e.length;for(;;){const s=e.indexOf(t,n);if(-1===s)return s;if(0===s||e.charCodeAt(s-1)<=32){const a=t.length;if(s+a===o||e.charCodeAt(s+a)<=32)return s}n=s+1}}const lf="ng-template";function cy(e,t,n){let o=0;for(;o<e.length;){let s=e[o++];if(n&&"class"===s){if(s=e[o],-1!==uf(s.toLowerCase(),t,0))return!0}else if(1===s){for(;o<e.length&&"string"==typeof(s=e[o++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function df(e){return 4===e.type&&e.value!==lf}function uy(e,t,n){return t===(4!==e.type||n?e.value:lf)}function ly(e,t,n){let o=4;const s=e.attrs||[],a=function py(e){for(let t=0;t<e.length;t++)if(fs(e[t]))return t;return e.length}(s);let l=!1;for(let m=0;m<t.length;m++){const _=t[m];if("number"!=typeof _){if(!l)if(4&o){if(o=2|1&o,""!==_&&!uy(e,_,n)||""===_&&1===t.length){if(jr(o))return!1;l=!0}}else{const R=8&o?_:t[++m];if(8&o&&null!==e.attrs){if(!cy(e.attrs,R,n)){if(jr(o))return!1;l=!0}continue}const B=dy(8&o?"class":_,s,df(e),n);if(-1===B){if(jr(o))return!1;l=!0;continue}if(""!==R){let ue;ue=B>a?"":s[B+1].toLowerCase();const be=8&o?ue:null;if(be&&-1!==uf(be,R,0)||2&o&&R!==ue){if(jr(o))return!1;l=!0}}}}else{if(!l&&!jr(o)&&!jr(_))return!1;if(l&&jr(_))continue;l=!1,o=_|1&o}}return jr(o)||l}function jr(e){return 0==(1&e)}function dy(e,t,n,o){if(null===t)return-1;let s=0;if(o||!n){let a=!1;for(;s<t.length;){const l=t[s];if(l===e)return s;if(3===l||6===l)a=!0;else{if(1===l||2===l){let m=t[++s];for(;"string"==typeof m;)m=t[++s];continue}if(4===l)break;if(0===l){s+=4;continue}}s+=a?1:2}return-1}return function hy(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const o=e[n];if("number"==typeof o)return-1;if(o===t)return n;n++}return-1}(t,e)}function ff(e,t,n=!1){for(let o=0;o<t.length;o++)if(ly(e,t[o],n))return!0;return!1}function pf(e,t){return e?":not("+t.trim()+")":t}function my(e){let t=e[0],n=1,o=2,s="",a=!1;for(;n<e.length;){let l=e[n];if("string"==typeof l)if(2&o){const m=e[++n];s+="["+l+(m.length>0?'="'+m+'"':"")+"]"}else 8&o?s+="."+l:4&o&&(s+=" "+l);else""!==s&&!jr(l)&&(t+=pf(a,s),s=""),o=l,a=a||!jr(o);n++}return""!==s&&(t+=pf(a,s)),t}const Gt={};function hf(e){gf(Zt(),et(),er()+e,!1)}function gf(e,t,n,o){if(!o)if(3==(3&t[2])){const a=e.preOrderCheckHooks;null!==a&&hi(t,a,n)}else{const a=e.preOrderHooks;null!==a&&gi(t,a,0,n)}Ir(n)}function _f(e,t=null,n=null,o){const s=Sf(e,t,n,o);return s.resolveInjectorInitializers(),s}function Sf(e,t=null,n=null,o,s=new Set){const a=[n||Lt,Xm(e)];return o=o||("object"==typeof e?void 0:ke(e)),new Td(a,t||Ia(),o||null,s)}let Ko=(()=>{class e{static create(n,o){if(Array.isArray(n))return _f({name:""},o,n,"");{const s=n.name??"";return _f({name:s},n.parent,n.providers,s)}}}return e.THROW_IF_NOT_FOUND=Go,e.NULL=new Ed,e.\u0275prov=pn({token:e,providedIn:"any",factory:()=>Bn(_d)}),e.__NG_ELEMENT_ID__=-1,e})();function ki(e,t=le.Default){const n=et();return null===n?Bn(e,t):ua(Vn(),n,Fe(e),t)}function wf(){throw new Error("invalid")}function wa(e,t){return e<<17|t<<2}function Br(e){return e>>17&32767}function lu(e){return 2|e}function uo(e){return(131068&e)>>2}function du(e,t){return-131069&e|t<<2}function fu(e){return 1|e}function Vf(e,t){const n=e.contentQueries;if(null!==n)for(let o=0;o<n.length;o+=2){const s=n[o],a=n[o+1];if(-1!==a){const l=e.data[a];is(s),l.contentQueries(2,t[a],a)}}}function Oa(e,t,n,o,s,a,l,m,_,R,x){const B=t.blueprint.slice();return B[0]=s,B[2]=76|o,(null!==x||e&&1024&e[2])&&(B[2]|=1024),Ln(B),B[3]=B[15]=e,B[8]=n,B[10]=l||e&&e[10],B[11]=m||e&&e[11],B[12]=_||e&&e[12]||null,B[9]=R||e&&e[9]||null,B[6]=a,B[20]=function Rv(){return Av++}(),B[21]=x,B[16]=2==t.type?e[16]:B,B}function Li(e,t,n,o,s){let a=e.data[t];if(null===a)a=function Eu(e,t,n,o,s){const a=Xs(),l=ts(),_=e.data[t]=function Zy(e,t,n,o,s,a){return{type:n,index:o,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,l?a:a&&a.parent,n,t,o,s);return null===e.firstChild&&(e.firstChild=_),null!==a&&(l?null==a.child&&null!==_.parent&&(a.child=_):null===a.next&&(a.next=_)),_}(e,t,n,o,s),function tc(){return _t.lFrame.inI18n}()&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=o,a.attrs=s;const l=function kr(){const e=_t.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();a.injectorIndex=null===l?-1:l.injectorIndex}return rr(a,!0),a}function Fi(e,t,n,o){if(0===n)return-1;const s=t.length;for(let a=0;a<n;a++)t.push(o),e.blueprint.push(o),e.data.push(null);return s}function Ma(e,t,n){as(t);try{const o=e.viewQuery;null!==o&&Ou(1,o,n);const s=e.template;null!==s&&Uf(e,t,s,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Vf(e,t),e.staticViewQueries&&Ou(2,e.viewQuery,n);const a=e.components;null!==a&&function Ky(e,t){for(let n=0;n<t.length;n++)g_(e,t[n])}(t,a)}catch(o){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),o}finally{t[2]&=-5,us()}}function Vs(e,t,n,o){const s=t[2];if(128!=(128&s)){as(t);try{Ln(t),function ci(e){return _t.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&Uf(e,t,n,2,o);const l=3==(3&s);if(l){const R=e.preOrderCheckHooks;null!==R&&hi(t,R,null)}else{const R=e.preOrderHooks;null!==R&&gi(t,R,0,null),ls(t,0)}if(function p_(e){for(let t=Jc(e);null!==t;t=Qc(t)){if(!t[2])continue;const n=t[9];for(let o=0;o<n.length;o++){const s=n[o],a=s[3];0==(512&s[2])&&gn(a,1),s[2]|=512}}}(t),function f_(e){for(let t=Jc(e);null!==t;t=Qc(t))for(let n=10;n<t.length;n++){const o=t[n],s=o[1];dn(o)&&Vs(s,o,s.template,o[8])}}(t),null!==e.contentQueries&&Vf(e,t),l){const R=e.contentCheckHooks;null!==R&&hi(t,R)}else{const R=e.contentHooks;null!==R&&gi(t,R,1),ls(t,1)}!function qy(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let o=0;o<n.length;o++){const s=n[o];if(s<0)Ir(~s);else{const a=s,l=n[++o],m=n[++o];nc(l,a),m(2,t[a])}}}finally{Ir(-1)}}(e,t);const m=e.components;null!==m&&function Yy(e,t){for(let n=0;n<t.length;n++)h_(e,t[n])}(t,m);const _=e.viewQuery;if(null!==_&&Ou(2,_,o),l){const R=e.viewCheckHooks;null!==R&&hi(t,R)}else{const R=e.viewHooks;null!==R&&gi(t,R,2),ls(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,gn(t[3],-1))}finally{us()}}}function Jy(e,t,n,o){const s=t[10],l=Sn(t);try{!l&&s.begin&&s.begin(),l&&Ma(e,t,o),Vs(e,t,n,o)}finally{!l&&s.end&&s.end()}}function Uf(e,t,n,o,s){const a=er(),l=2&o;try{Ir(-1),l&&t.length>22&&gf(e,t,22,!1),n(o,s)}finally{Ir(a)}}function Iu(e,t,n){!go()||(function o_(e,t,n,o){const s=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||xo(n,t),ar(o,t);const l=n.initialInputs;for(let m=s;m<a;m++){const _=e.data[m],R=un(_);R&&u_(t,n,_);const x=Fo(t,e,m,n);ar(x,t),null!==l&&l_(0,m-s,x,_,0,l),R&&(ht(n.index,t)[8]=x)}}(e,t,n,V(n,t)),128==(128&n.flags)&&function i_(e,t,n){const o=n.directiveStart,s=n.directiveEnd,a=n.index,l=function rc(){return _t.lFrame.currentDirectiveIndex}();try{Ir(a);for(let m=o;m<s;m++){const _=e.data[m],R=t[m];rs(m),(null!==_.hostBindings||0!==_.hostVars||null!==_.hostAttrs)&&qf(_,R)}}finally{Ir(-1),rs(l)}}(e,t,n))}function Du(e,t,n=V){const o=t.localNames;if(null!==o){let s=t.index+1;for(let a=0;a<o.length;a+=2){const l=o[a+1],m=-1===l?n(t,e):e[l];e[s++]=m}}}function Bf(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Cu(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Cu(e,t,n,o,s,a,l,m,_,R){const x=22+o,B=x+s,ue=function Qy(e,t){const n=[];for(let o=0;o<t;o++)n.push(o<e?null:Gt);return n}(x,B),be="function"==typeof R?R():R;return ue[1]={type:e,blueprint:ue,template:n,queries:null,viewQuery:m,declTNode:t,data:ue.slice().fill(null,x),bindingStartIndex:x,expandoStartIndex:B,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof l?l():l,firstChild:null,schemas:_,consts:be,incompleteFirstPass:!1}}function Hf(e,t,n,o){const s=ep(t);null===n?s.push(o):(s.push(n),e.firstCreatePass&&tp(e).push(o,s.length-1))}function $f(e,t,n){for(let o in e)if(e.hasOwnProperty(o)){const s=e[o];(n=null===n?{}:n).hasOwnProperty(o)?n[o].push(t,s):n[o]=[t,s]}return n}function Wf(e,t){const o=t.directiveEnd,s=e.data,a=t.attrs,l=[];let m=null,_=null;for(let R=t.directiveStart;R<o;R++){const x=s[R],B=x.inputs,ue=null===a||df(t)?null:d_(B,a);l.push(ue),m=$f(B,R,m),_=$f(x.outputs,R,_)}null!==m&&(m.hasOwnProperty("class")&&(t.flags|=16),m.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=l,t.inputs=m,t.outputs=_}function Gf(e,t){const n=ht(t,e);16&n[2]||(n[2]|=32)}function bu(e,t,n,o){let s=!1;if(go()){const a=function s_(e,t,n){const o=e.directiveRegistry;let s=null;if(o)for(let a=0;a<o.length;a++){const l=o[a];ff(n,l.selectors,!1)&&(s||(s=[]),ko(xo(n,t),e,l.type),un(l)?(Yf(e,n),s.unshift(l)):s.push(l))}return s}(e,t,n),l=null===o?null:{"":-1};if(null!==a){s=!0,Kf(n,e.data.length,a.length);for(let x=0;x<a.length;x++){const B=a[x];B.providersResolver&&B.providersResolver(B)}let m=!1,_=!1,R=Fi(e,t,a.length,null);for(let x=0;x<a.length;x++){const B=a[x];n.mergedAttrs=Po(n.mergedAttrs,B.hostAttrs),Jf(e,n,t,R,B),c_(R,B,l),null!==B.contentQueries&&(n.flags|=8),(null!==B.hostBindings||null!==B.hostAttrs||0!==B.hostVars)&&(n.flags|=128);const ue=B.type.prototype;!m&&(ue.ngOnChanges||ue.ngOnInit||ue.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),m=!0),!_&&(ue.ngOnChanges||ue.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),_=!0),R++}Wf(e,n)}l&&function a_(e,t,n){if(t){const o=e.localNames=[];for(let s=0;s<t.length;s+=2){const a=n[t[s+1]];if(null==a)throw new $e(-301,!1);o.push(t[s],a)}}}(n,o,l)}return n.mergedAttrs=Po(n.mergedAttrs,n.attrs),s}function zf(e,t,n,o,s,a){const l=a.hostBindings;if(l){let m=e.hostBindingOpCodes;null===m&&(m=e.hostBindingOpCodes=[]);const _=~t.index;(function r_(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(m)!=_&&m.push(_),m.push(o,s,l)}}function qf(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Yf(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function c_(e,t,n){if(n){if(t.exportAs)for(let o=0;o<t.exportAs.length;o++)n[t.exportAs[o]]=e;un(t)&&(n[""]=e)}}function Kf(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Jf(e,t,n,o,s){e.data[o]=s;const a=s.factory||(s.factory=Ie(s.type)),l=new Oo(a,un(s),ki);e.blueprint[o]=l,n[o]=l,zf(e,t,0,o,Fi(e,n,s.hostVars,Gt),s)}function u_(e,t,n){const o=V(t,e),s=Bf(n),a=e[10],l=Na(e,Oa(e,s,null,n.onPush?32:16,o,t,a,a.createRenderer(o,n),null,null,null));e[t.index]=l}function Kr(e,t,n,o,s,a){const l=V(e,t);!function Tu(e,t,n,o,s,a,l){if(null==a)e.removeAttribute(t,s,n);else{const m=null==l?ge(a):l(a,o||"",s);e.setAttribute(t,s,m,n)}}(t[11],l,a,e.value,n,o,s)}function l_(e,t,n,o,s,a){const l=a[t];if(null!==l){const m=o.setInput;for(let _=0;_<l.length;){const R=l[_++],x=l[_++],B=l[_++];null!==m?o.setInput(n,B,R,x):n[x]=B}}}function d_(e,t){let n=null,o=0;for(;o<t.length;){const s=t[o];if(0!==s)if(5!==s){if("number"==typeof s)break;e.hasOwnProperty(s)&&(null===n&&(n=[]),n.push(s,e[s],t[o+1])),o+=2}else o+=2;else o+=4}return n}function Qf(e,t,n,o){return new Array(e,!0,!1,t,null,0,o,n,null,null)}function h_(e,t){const n=ht(t,e);if(dn(n)){const o=n[1];48&n[2]?Vs(o,n,o.template,n[8]):n[5]>0&&wu(n)}}function wu(e){for(let o=Jc(e);null!==o;o=Qc(o))for(let s=10;s<o.length;s++){const a=o[s];if(dn(a))if(512&a[2]){const l=a[1];Vs(l,a,l.template,a[8])}else a[5]>0&&wu(a)}const n=e[1].components;if(null!==n)for(let o=0;o<n.length;o++){const s=ht(n[o],e);dn(s)&&s[5]>0&&wu(s)}}function g_(e,t){const n=ht(t,e),o=n[1];(function m_(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(o,n),Ma(o,n,n[8])}function Na(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Au(e){for(;e;){e[2]|=32;const t=Ls(e);if(ho(e)&&!t)return e;e=t}return null}function Zf(e){!function Xf(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],o=qc(n);if(null!==o){const s=o[1];Jy(s,o,s.template,n)}}}(e[8])}function Ou(e,t,n){is(0),t(e,n)}const y_=(()=>Promise.resolve(null))();function ep(e){return e[7]||(e[7]=[])}function tp(e){return e.cleanup||(e.cleanup=[])}function rp(e,t){const n=e[9],o=n?n.get(xs,null):null;o&&o.handleError(t)}function Mu(e,t,n,o,s){for(let a=0;a<n.length;){const l=n[a++],m=n[a++],_=t[l],R=e.data[l];null!==R.setInput?R.setInput(_,s,o,m):_[m]=s}}function Pa(e,t,n){let o=n?e.styles:null,s=n?e.classes:null,a=0;if(null!==t)for(let l=0;l<t.length;l++){const m=t[l];"number"==typeof m?a=m:1==a?s=ye(s,m):2==a&&(o=ye(o,m+": "+t[++l]+";"))}n?e.styles=o:e.stylesWithoutHost=o,n?e.classes=s:e.classesWithoutHost=s}function xa(e,t,n,o,s=!1){for(;null!==n;){const a=t[n.index];if(null!==a&&o.push(Pt(a)),Jn(a))for(let m=10;m<a.length;m++){const _=a[m],R=_[1].firstChild;null!==R&&xa(_[1],_,R,o)}const l=n.type;if(8&l)xa(e,t,n.child,o);else if(32&l){const m=Kc(n,t);let _;for(;_=m();)o.push(_)}else if(16&l){const m=rf(t,n);if(Array.isArray(m))o.push(...m);else{const _=Ls(t[16]);xa(_[1],_,m,o,!0)}}n=s?n.projectionNext:n.next}return o}class Us{constructor(t,n){this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,n=t[1];return xa(n,t,n.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Jn(t)){const n=t[8],o=n?n.indexOf(this):-1;o>-1&&(eu(t,o),bi(n,o))}this._attachedToViewContainer=!1}Yd(this._lView[1],this._lView)}onDestroy(t){Hf(this._lView[1],this._lView,null,t)}markForCheck(){Au(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function Ru(e,t,n){const o=t[10];o.begin&&o.begin();try{Vs(e,t,e.template,n)}catch(s){throw rp(t,s),s}finally{o.end&&o.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $e(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Qv(e,t){Fs(e,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new $e(902,!1);this._appRef=t}}class __ extends Us{constructor(t){super(t),this._view=t}detectChanges(){Zf(this._view)}checkNoChanges(){}get context(){return null}}class Nu extends Ns{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=_e(t);return new js(n,this.ngModule)}}function op(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}class E_{constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,o){const s=this.injector.get(t,Vc,o);return s!==Vc||n===Vc?s:this.parentInjector.get(t,n,o)}}class js extends Ad{constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function vy(e){return e.map(my).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return op(this.componentDef.inputs)}get outputs(){return op(this.componentDef.outputs)}create(t,n,o,s){let a=(s=s||this.ngModule)instanceof qo?s:s?.injector;a&&null!==this.componentDef.getStandaloneInjector&&(a=this.componentDef.getStandaloneInjector(a)||a);const l=a?new E_(t,a):t,m=l.get(Od,null);if(null===m)throw new $e(407,!1);const _=l.get(gv,null),R=m.createRenderer(null,this.componentDef),x=this.componentDef.selectors[0][0]||"div",B=o?function Xy(e,t,n){return e.selectRootElement(t,n===$t.ShadowDom)}(R,o,this.componentDef.encapsulation):Zc(m.createRenderer(null,this.componentDef),x,function S_(e){const t=e.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(x)),ue=this.componentDef.onPush?288:272,be=function T_(e,t){return{components:[],scheduler:e||Uv,clean:y_,playerHandler:t||null,flags:0}}(),Ge=Cu(0,null,null,1,0,null,null,null,null,null),ot=Oa(null,Ge,be,ue,null,null,m,R,_,l,null);let lt,gt;as(ot);try{const Dt=function C_(e,t,n,o,s,a){const l=n[1];n[22]=e;const _=Li(l,22,2,"#host",null),R=_.mergedAttrs=t.hostAttrs;null!==R&&(Pa(_,R,!0),null!==e&&(No(s,e,R),null!==_.classes&&iu(s,e,_.classes),null!==_.styles&&cf(s,e,_.styles)));const x=o.createRenderer(e,t),B=Oa(n,Bf(t),null,t.onPush?32:16,n[22],_,o,x,a||null,null,null);return l.firstCreatePass&&(ko(xo(_,n),l,t.type),Yf(l,_),Kf(_,n.length,1)),Na(n,B),n[22]=B}(B,this.componentDef,ot,m,R);if(B)if(o)No(R,B,["ng-version",mv.full]);else{const{attrs:rt,classes:Tt}=function yy(e){const t=[],n=[];let o=1,s=2;for(;o<e.length;){let a=e[o];if("string"==typeof a)2===s?""!==a&&t.push(a,e[++o]):8===s&&n.push(a);else{if(!jr(s))break;s=a}o++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);rt&&No(R,B,rt),Tt&&Tt.length>0&&iu(R,B,Tt.join(" "))}if(gt=Ue(Ge,22),void 0!==n){const rt=gt.projection=[];for(let Tt=0;Tt<this.ngContentSelectors.length;Tt++){const en=n[Tt];rt.push(null!=en?Array.from(en):null)}}lt=function b_(e,t,n,o,s){const a=n[1],l=function n_(e,t,n){const o=Vn();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Jf(e,o,t,Fi(e,t,1,null),n),Wf(e,o));const s=Fo(t,e,o.directiveStart,o);ar(s,t);const a=V(o,t);return a&&ar(a,t),s}(a,n,t);if(o.components.push(l),e[8]=l,null!==s)for(const _ of s)_(l,t);if(t.contentQueries){const _=Vn();t.contentQueries(1,l,_.directiveStart)}const m=Vn();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Ir(m.index),zf(n[1],m,0,m.directiveStart,m.directiveEnd,t),qf(t,l)),l}(Dt,this.componentDef,ot,be,[w_]),Ma(Ge,ot,null)}finally{us()}return new D_(this.componentType,lt,Mi(gt,ot),ot,gt)}}class D_ extends class cv{}{constructor(t,n,o,s,a){super(),this.location=o,this._rootLView=s,this._tNode=a,this.instance=n,this.hostView=this.changeDetectorRef=new __(s),this.componentType=t}setInput(t,n){const o=this._tNode.inputs;let s;if(null!==o&&(s=o[t])){const a=this._rootLView;Mu(a[1],a,s,t,n),Gf(a,this._tNode.index)}}get injector(){return new xn(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function w_(){const e=Vn();pi(et()[1],e)}function Pu(e){let t=function ip(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const o=[e];for(;t;){let s;if(un(e))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new $e(903,!1);s=t.\u0275dir}if(s){if(n){o.push(s);const l=e;l.inputs=xu(e.inputs),l.declaredInputs=xu(e.declaredInputs),l.outputs=xu(e.outputs);const m=s.hostBindings;m&&M_(e,m);const _=s.viewQuery,R=s.contentQueries;if(_&&R_(e,_),R&&O_(e,R),z(e.inputs,s.inputs),z(e.declaredInputs,s.declaredInputs),z(e.outputs,s.outputs),un(s)&&s.data.animation){const x=e.data;x.animation=(x.animation||[]).concat(s.data.animation)}}const a=s.features;if(a)for(let l=0;l<a.length;l++){const m=a[l];m&&m.ngInherit&&m(e),m===Pu&&(n=!1)}}t=Object.getPrototypeOf(t)}!function A_(e){let t=0,n=null;for(let o=e.length-1;o>=0;o--){const s=e[o];s.hostVars=t+=s.hostVars,s.hostAttrs=Po(s.hostAttrs,n=Po(n,s.hostAttrs))}}(o)}function xu(e){return e===Jt?{}:e===Lt?[]:e}function R_(e,t){const n=e.viewQuery;e.viewQuery=n?(o,s)=>{t(o,s),n(o,s)}:t}function O_(e,t){const n=e.contentQueries;e.contentQueries=n?(o,s,a)=>{t(o,s,a),n(o,s,a)}:t}function M_(e,t){const n=e.hostBindings;e.hostBindings=n?(o,s)=>{t(o,s),n(o,s)}:t}let ka=null;function Jo(){if(!ka){const e=Je.Symbol;if(e&&e.iterator)ka=e.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<t.length;++n){const o=t[n];"entries"!==o&&"size"!==o&&Map.prototype[o]===Map.prototype.entries&&(ka=o)}}}return ka}function Bs(e){return!!ku(e)&&(Array.isArray(e)||!(e instanceof Map)&&Jo()in e)}function ku(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function cr(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function Lu(e,t,n,o){const s=et();return cr(s,Fr(),t)&&(Zt(),Kr(An(),s,e,t,n,o)),Lu}function gp(e,t,n,o,s,a,l,m){const _=et(),R=Zt(),x=e+22,B=R.firstCreatePass?function j_(e,t,n,o,s,a,l,m,_){const R=t.consts,x=Li(t,e,4,l||null,Ht(R,m));bu(t,n,x,Ht(R,_)),pi(t,x);const B=x.tViews=Cu(2,x,o,s,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,R);return null!==t.queries&&(t.queries.template(t,x),B.queries=t.queries.embeddedTView(x)),x}(x,R,_,t,n,o,s,a,l):R.data[x];rr(B,!1);const ue=_[11].createComment("");Ca(R,_,ue,B),ar(ue,_),Na(_,_[x]=Qf(ue,_,ue,B)),Zn(B)&&Iu(R,_,B),null!=l&&Du(_,B,m)}function Fu(e,t,n){const o=et();return cr(o,Fr(),t)&&function Cr(e,t,n,o,s,a,l,m){const _=V(t,n);let x,R=t.inputs;!m&&null!=R&&(x=R[o])?(Mu(e,n,x,o,s),Rr(t)&&Gf(n,t.index)):3&t.type&&(o=function e_(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(o),s=null!=l?l(s,t.value||"",o):s,a.setProperty(_,o,s))}(Zt(),An(),o,e,t,o[11],n,!1),Fu}function Vu(e,t,n,o,s){const l=s?"class":"style";Mu(e,n,t.inputs[l],l,o)}function Fa(e,t,n,o){const s=et(),a=Zt(),l=22+e,m=s[11],_=s[l]=Zc(m,t,function Ro(){return _t.lFrame.currentNamespace}()),R=a.firstCreatePass?function $_(e,t,n,o,s,a,l){const m=t.consts,R=Li(t,e,2,s,Ht(m,a));return bu(t,n,R,Ht(m,l)),null!==R.attrs&&Pa(R,R.attrs,!1),null!==R.mergedAttrs&&Pa(R,R.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,R),R}(l,a,s,0,t,n,o):a.data[l];rr(R,!0);const x=R.mergedAttrs;null!==x&&No(m,_,x);const B=R.classes;null!==B&&iu(m,_,B);const ue=R.styles;return null!==ue&&cf(m,_,ue),64!=(64&R.flags)&&Ca(a,s,_,R),0===function oo(){return _t.lFrame.elementDepthCount}()&&ar(_,s),function xr(){_t.lFrame.elementDepthCount++}(),Zn(R)&&(Iu(a,s,R),function jf(e,t,n){if(Xn(t)){const s=t.directiveEnd;for(let a=t.directiveStart;a<s;a++){const l=e.data[a];l.contentQueries&&l.contentQueries(1,n[a],a)}}}(a,R,s)),null!==o&&Du(s,R),Fa}function Va(){let e=Vn();ts()?function ns(){_t.lFrame.isParent=!1}():(e=e.parent,rr(e,!1));const t=e;!function oi(){_t.lFrame.elementDepthCount--}();const n=Zt();return n.firstCreatePass&&(pi(n,e),Xn(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function uc(e){return 0!=(16&e.flags)}(t)&&Vu(n,t,et(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function ia(e){return 0!=(32&e.flags)}(t)&&Vu(n,t,et(),t.stylesWithoutHost,!1),Va}function Uu(e,t,n,o){return Fa(e,t,n,o),Va(),Uu}function Hu(e){return!!e&&"function"==typeof e.then}function vp(e){return!!e&&"function"==typeof e.subscribe}const yp=vp;function $u(e,t,n,o){const s=et(),a=Zt(),l=Vn();return function Sp(e,t,n,o,s,a,l,m){const _=Zn(o),x=e.firstCreatePass&&tp(e),B=t[8],ue=ep(t);let be=!0;if(3&o.type||m){const lt=V(o,t),gt=m?m(lt):lt,Dt=ue.length,rt=m?en=>m(Pt(en[o.index])):o.index;let Tt=null;if(!m&&_&&(Tt=function z_(e,t,n,o){const s=e.cleanup;if(null!=s)for(let a=0;a<s.length-1;a+=2){const l=s[a];if(l===n&&s[a+1]===o){const m=t[7],_=s[a+2];return m.length>_?m[_]:null}"string"==typeof l&&(a+=2)}return null}(e,t,s,o.index)),null!==Tt)(Tt.__ngLastListenerFn__||Tt).__ngNextListenerFn__=a,Tt.__ngLastListenerFn__=a,be=!1;else{a=Ip(o,t,B,a,!1);const en=n.listen(gt,s,a);ue.push(a,en),x&&x.push(s,rt,Dt,Dt+1)}}else a=Ip(o,t,B,a,!1);const Ge=o.outputs;let ot;if(be&&null!==Ge&&(ot=Ge[s])){const lt=ot.length;if(lt)for(let gt=0;gt<lt;gt+=2){const Rn=t[ot[gt]][ot[gt+1]].subscribe(a),ei=ue.length;ue.push(a,Rn),x&&x.push(s,o.index,ei,-(ei+1))}}}(a,s,s[11],l,e,t,0,o),$u}function Ep(e,t,n,o){try{return!1!==n(o)}catch(s){return rp(e,s),!1}}function Ip(e,t,n,o,s){return function a(l){if(l===Function)return o;Au(2&e.flags?ht(e.index,t):t);let _=Ep(t,0,o,l),R=a.__ngNextListenerFn__;for(;R;)_=Ep(t,0,R,l)&&_,R=R.__ngNextListenerFn__;return s&&!1===_&&(l.preventDefault(),l.returnValue=!1),_}}function Np(e,t,n,o,s){const a=e[n+1],l=null===t;let m=o?Br(a):uo(a),_=!1;for(;0!==m&&(!1===_||l);){const x=e[m+1];Z_(e[m],t)&&(_=!0,e[m+1]=o?fu(x):lu(x)),m=o?Br(x):uo(x)}_&&(e[n+1]=o?lu(a):fu(a))}function Z_(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Z(e,t)>=0}function Gu(e,t){return function Hr(e,t,n,o){const s=et(),a=Zt(),l=function ir(e){const t=_t.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}(2);a.firstUpdatePass&&function Bp(e,t,n,o){const s=e.data;if(null===s[n+1]){const a=s[er()],l=function jp(e,t){return t>=e.expandoStartIndex}(e,n);(function Gp(e,t){return 0!=(e.flags&(t?16:32))})(a,o)&&null===t&&!l&&(t=!1),t=function cS(e,t,n,o){const s=function os(e){const t=_t.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let a=o?t.residualClasses:t.residualStyles;if(null===s)0===(o?t.classBindings:t.styleBindings)&&(n=$s(n=zu(null,e,t,n,o),t.attrs,o),a=null);else{const l=t.directiveStylingLast;if(-1===l||e[l]!==s)if(n=zu(s,e,t,n,o),null===a){let _=function uS(e,t,n){const o=n?t.classBindings:t.styleBindings;if(0!==uo(o))return e[Br(o)]}(e,t,o);void 0!==_&&Array.isArray(_)&&(_=zu(null,e,t,_[1],o),_=$s(_,t.attrs,o),function lS(e,t,n,o){e[Br(n?t.classBindings:t.styleBindings)]=o}(e,t,o,_))}else a=function dS(e,t,n){let o;const s=t.directiveEnd;for(let a=1+t.directiveStylingLast;a<s;a++)o=$s(o,e[a].hostAttrs,n);return $s(o,t.attrs,n)}(e,t,o)}return void 0!==a&&(o?t.residualClasses=a:t.residualStyles=a),n}(s,a,t,o),function Q_(e,t,n,o,s,a){let l=a?t.classBindings:t.styleBindings,m=Br(l),_=uo(l);e[o]=n;let x,R=!1;if(Array.isArray(n)){const B=n;x=B[1],(null===x||Z(B,x)>0)&&(R=!0)}else x=n;if(s)if(0!==_){const ue=Br(e[m+1]);e[o+1]=wa(ue,m),0!==ue&&(e[ue+1]=du(e[ue+1],o)),e[m+1]=function Fy(e,t){return 131071&e|t<<17}(e[m+1],o)}else e[o+1]=wa(m,0),0!==m&&(e[m+1]=du(e[m+1],o)),m=o;else e[o+1]=wa(_,0),0===m?m=o:e[_+1]=du(e[_+1],o),_=o;R&&(e[o+1]=lu(e[o+1])),Np(e,x,o,!0),Np(e,x,o,!1),function X_(e,t,n,o,s){const a=s?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&Z(a,t)>=0&&(n[o+1]=fu(n[o+1]))}(t,x,e,o,a),l=wa(m,_),a?t.classBindings=l:t.styleBindings=l}(s,a,t,n,l,o)}}(a,e,l,o),t!==Gt&&cr(s,l,t)&&function $p(e,t,n,o,s,a,l,m){if(!(3&t.type))return;const _=e.data,R=_[m+1];Ua(function Of(e){return 1==(1&e)}(R)?Wp(_,t,n,s,uo(R),l):void 0)||(Ua(a)||function Rf(e){return 2==(2&e)}(R)&&(a=Wp(_,null,n,s,m,l)),function ay(e,t,n,o,s){if(t)s?e.addClass(n,o):e.removeClass(n,o);else{let a=-1===o.indexOf("-")?void 0:Yr.DashCase;null==s?e.removeStyle(n,o,a):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),a|=Yr.Important),e.setStyle(n,o,s,a))}}(o,l,function A(e,t){return Pt(t[e])}(er(),n),s,a))}(a,a.data[er()],s,s[11],e,s[l+1]=function hS(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=ke(So(e)))),e}(t,n),o,l)}(e,t,null,!0),Gu}function zu(e,t,n,o,s){let a=null;const l=n.directiveEnd;let m=n.directiveStylingLast;for(-1===m?m=n.directiveStart:m++;m<l&&(a=t[m],o=$s(o,a.hostAttrs,s),a!==e);)m++;return null!==e&&(n.directiveStylingLast=m),o}function $s(e,t,n){const o=n?1:2;let s=-1;if(null!==t)for(let a=0;a<t.length;a++){const l=t[a];"number"==typeof l?s=l:s===o&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),N(e,l,!!n||t[++a]))}return void 0===e?null:e}function Wp(e,t,n,o,s,a){const l=null===t;let m;for(;s>0;){const _=e[s],R=Array.isArray(_),x=R?_[1]:_,B=null===x;let ue=n[s+1];ue===Gt&&(ue=B?Lt:void 0);let be=B?H(ue,o):x===o?ue:void 0;if(R&&!Ua(be)&&(be=H(_,o)),Ua(be)&&(m=be,l))return m;const Ge=e[s+1];s=l?Br(Ge):uo(Ge)}if(null!==t){let _=a?t.residualClasses:t.residualStyles;null!=_&&(m=H(_,o))}return m}function Ua(e){return void 0!==e}function zp(e,t=""){const n=et(),o=Zt(),s=e+22,a=o.firstCreatePass?Li(o,s,1,t,null):o.data[s],l=n[s]=function Xc(e,t){return e.createText(t)}(n[11],t);Ca(o,n,l,a),rr(a,!1)}const Xo=void 0;var xS=["en",[["a","p"],["AM","PM"],Xo],[["AM","PM"],Xo,Xo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Xo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Xo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Xo,"{1} 'at' {0}",Xo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function PS(e){const n=Math.floor(Math.abs(e)),o=e.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===o?1:5}];let Yi={};function Yu(e){const t=function kS(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=hh(t);if(n)return n;const o=t.split("-")[0];if(n=hh(o),n)return n;if("en"===o)return xS;throw new $e(701,!1)}function ph(e){return Yu(e)[Ot.PluralCase]}function hh(e){return e in Yi||(Yi[e]=Je.ng&&Je.ng.common&&Je.ng.common.locales&&Je.ng.common.locales[e]),Yi[e]}var Ot=(()=>((Ot=Ot||{})[Ot.LocaleId=0]="LocaleId",Ot[Ot.DayPeriodsFormat=1]="DayPeriodsFormat",Ot[Ot.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ot[Ot.DaysFormat=3]="DaysFormat",Ot[Ot.DaysStandalone=4]="DaysStandalone",Ot[Ot.MonthsFormat=5]="MonthsFormat",Ot[Ot.MonthsStandalone=6]="MonthsStandalone",Ot[Ot.Eras=7]="Eras",Ot[Ot.FirstDayOfWeek=8]="FirstDayOfWeek",Ot[Ot.WeekendRange=9]="WeekendRange",Ot[Ot.DateFormat=10]="DateFormat",Ot[Ot.TimeFormat=11]="TimeFormat",Ot[Ot.DateTimeFormat=12]="DateTimeFormat",Ot[Ot.NumberSymbols=13]="NumberSymbols",Ot[Ot.NumberFormats=14]="NumberFormats",Ot[Ot.CurrencyCode=15]="CurrencyCode",Ot[Ot.CurrencySymbol=16]="CurrencySymbol",Ot[Ot.CurrencyName=17]="CurrencyName",Ot[Ot.Currencies=18]="Currencies",Ot[Ot.Directionality=19]="Directionality",Ot[Ot.PluralCase=20]="PluralCase",Ot[Ot.ExtraData=21]="ExtraData",Ot))();const Ki="en-US";let gh=Ki;function Qu(e,t,n,o,s){if(e=Fe(e),Array.isArray(e))for(let a=0;a<e.length;a++)Qu(e[a],t,n,o,s);else{const a=Zt(),l=et();let m=zo(e)?e:Fe(e.provide),_=wd(e);const R=Vn(),x=1048575&R.providerIndexes,B=R.directiveStart,ue=R.providerIndexes>>20;if(zo(e)||!e.multi){const be=new Oo(_,s,ki),Ge=Zu(m,t,s?x:x+ue,B);-1===Ge?(ko(xo(R,l),a,m),Xu(a,e,t.length),t.push(m),R.directiveStart++,R.directiveEnd++,s&&(R.providerIndexes+=1048576),n.push(be),l.push(be)):(n[Ge]=be,l[Ge]=be)}else{const be=Zu(m,t,x+ue,B),Ge=Zu(m,t,x,x+ue),ot=be>=0&&n[be],lt=Ge>=0&&n[Ge];if(s&&!lt||!s&&!ot){ko(xo(R,l),a,m);const gt=function NE(e,t,n,o,s){const a=new Oo(e,n,ki);return a.multi=[],a.index=t,a.componentProviders=0,jh(a,s,o&&!n),a}(s?ME:OE,n.length,s,o,_);!s&&lt&&(n[Ge].providerFactory=gt),Xu(a,e,t.length,0),t.push(m),R.directiveStart++,R.directiveEnd++,s&&(R.providerIndexes+=1048576),n.push(gt),l.push(gt)}else Xu(a,e,be>-1?be:Ge,jh(n[s?Ge:be],_,!s&&o));!s&&o&&lt&&n[Ge].componentProviders++}}}function Xu(e,t,n,o){const s=zo(t),a=function ev(e){return!!e.useClass}(t);if(s||a){const _=(a?Fe(t.useClass):t).prototype.ngOnDestroy;if(_){const R=e.destroyHooks||(e.destroyHooks=[]);if(!s&&t.multi){const x=R.indexOf(n);-1===x?R.push(n,[o,_]):R[x+1].push(o,_)}else R.push(n,_)}}}function jh(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function Zu(e,t,n,o){for(let s=n;s<o;s++)if(t[s]===e)return s;return-1}function OE(e,t,n,o){return el(this.multi,[])}function ME(e,t,n,o){const s=this.multi;let a;if(this.providerFactory){const l=this.providerFactory.componentProviders,m=Fo(n,n[1],this.providerFactory.index,o);a=m.slice(0,l),el(s,a);for(let _=l;_<m.length;_++)a.push(m[_])}else a=[],el(s,a);return a}function el(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function Bh(e,t=[]){return n=>{n.providersResolver=(o,s)=>function RE(e,t,n){const o=Zt();if(o.firstCreatePass){const s=un(e);Qu(n,o.data,o.blueprint,s,!0),Qu(t,o.data,o.blueprint,s,!1)}}(o,s?s(e):e,t)}}class Qi{}class Hh{}function PE(e,t){return new $h(e,t??null)}class $h extends Qi{constructor(t,n){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Nu(this);const o=Re(t);this._bootstrapComponents=co(o.bootstrap),this._r3Injector=Sf(t,n,[{provide:Qi,useValue:this},{provide:Ns,useValue:this.componentFactoryResolver}],ke(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class tl extends Hh{constructor(t){super(),this.moduleType=t}create(t){return new $h(this.moduleType,t)}}class xE extends Qi{constructor(t,n,o){super(),this.componentFactoryResolver=new Nu(this),this.instance=null;const s=new Td([...t,{provide:Qi,useValue:this},{provide:Ns,useValue:this.componentFactoryResolver}],n||Ia(),o,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function nl(e,t,n=null){return new xE(e,t,n).injector}function ol(e){return t=>{setTimeout(e,void 0,t)}}const Zr=class u0 extends pe.x{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,n,o){let s=t,a=n||(()=>null),l=o;if(t&&"object"==typeof t){const _=t;s=_.next?.bind(_),a=_.error?.bind(_),l=_.complete?.bind(_)}this.__isAsync&&(a=ol(a),s&&(s=ol(s)),l&&(l=ol(l)));const m=super.subscribe({next:s,error:a,complete:l});return t instanceof ce.w0&&t.add(m),m}};function l0(){return this._results[Jo()]()}class il{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=Jo(),o=il.prototype;o[n]||(o[n]=l0)}get changes(){return this._changes||(this._changes=new Zr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){const o=this;o.dirty=!1;const s=hr(t);(this._changesDetected=!function fa(e,t,n){if(e.length!==t.length)return!1;for(let o=0;o<e.length;o++){let s=e[o],a=t[o];if(n&&(s=n(s),a=n(a)),a!==s)return!1}return!0}(o._results,s,n))&&(o._results=s,o.length=s.length,o.last=s[this.length-1],o.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Js=(()=>{class e{}return e.__NG_ELEMENT_ID__=p0,e})();const d0=Js,f0=class extends d0{constructor(t,n,o){super(),this._declarationLView=t,this._declarationTContainer=n,this.elementRef=o}createEmbeddedView(t,n){const o=this._declarationTContainer.tViews,s=Oa(this._declarationLView,o,t,16,null,o.declTNode,null,null,null,null,n||null);s[17]=this._declarationLView[this._declarationTContainer.index];const l=this._declarationLView[19];return null!==l&&(s[19]=l.createEmbeddedView(o)),Ma(o,s,t),new Us(s)}};function p0(){return Wa(Vn(),et())}function Wa(e,t){return 4&e.type?new f0(t,e,Mi(e,t)):null}let Ga=(()=>{class e{}return e.__NG_ELEMENT_ID__=h0,e})();function h0(){return rg(Vn(),et())}const g0=Ga,tg=class extends g0{constructor(t,n,o){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=o}get element(){return Mi(this._hostTNode,this._hostLView)}get injector(){return new xn(this._hostTNode,this._hostLView)}get parentInjector(){const t=yo(this._hostTNode,this._hostLView);if(vi(t)){const n=vo(t,this._hostLView),o=mo(t);return new xn(n[1].data[o+8],n)}return new xn(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=ng(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,n,o){let s,a;"number"==typeof o?s=o:null!=o&&(s=o.index,a=o.injector);const l=t.createEmbeddedView(n||{},a);return this.insert(l,s),l}createComponent(t,n,o,s,a){const l=t&&!function Ho(e){return"function"==typeof e}(t);let m;if(l)m=n;else{const B=n||{};m=B.index,o=B.injector,s=B.projectableNodes,a=B.environmentInjector||B.ngModuleRef}const _=l?t:new js(_e(t)),R=o||this.parentInjector;if(!a&&null==_.ngModule){const ue=(l?R:this.parentInjector).get(qo,null);ue&&(a=ue)}const x=_.create(R,s,void 0,a);return this.insert(x.hostView,m),x}insert(t,n){const o=t._lView,s=o[1];if(function Cn(e){return Jn(e[3])}(o)){const x=this.indexOf(t);if(-1!==x)this.detach(x);else{const B=o[3],ue=new tg(B,B[6],B[3]);ue.detach(ue.indexOf(t))}}const a=this._adjustIndex(n),l=this._lContainer;!function Zv(e,t,n,o){const s=10+o,a=n.length;o>0&&(n[s-1][4]=t),o<a-10?(t[4]=n[s],pa(n,10+o,t)):(n.push(t),t[4]=null),t[3]=n;const l=t[17];null!==l&&n!==l&&function ey(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(l,t);const m=t[19];null!==m&&m.insertView(e),t[2]|=64}(s,o,l,a);const m=ru(a,l),_=o[11],R=Da(_,l[7]);return null!==R&&function Jv(e,t,n,o,s,a){o[0]=s,o[6]=t,Fs(e,o,n,1,s,a)}(s,l[6],_,o,R,m),t.attachToViewContainerRef(),pa(sl(l),a,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=ng(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),o=eu(this._lContainer,n);o&&(bi(sl(this._lContainer),n),Yd(o[1],o))}detach(t){const n=this._adjustIndex(t,-1),o=eu(this._lContainer,n);return o&&null!=bi(sl(this._lContainer),n)?new Us(o):null}_adjustIndex(t,n=0){return t??this.length+n}};function ng(e){return e[8]}function sl(e){return e[8]||(e[8]=[])}function rg(e,t){let n;const o=t[e.index];if(Jn(o))n=o;else{let s;if(8&e.type)s=Pt(o);else{const a=t[11];s=a.createComment("");const l=V(e,t);Yo(a,Da(a,l),s,function oy(e,t){return e.nextSibling(t)}(a,l),!1)}t[e.index]=n=Qf(o,t,s,e),Na(t,n)}return new tg(n,e,t)}class al{constructor(t){this.queryList=t,this.matches=null}clone(){return new al(this.queryList)}setDirty(){this.queryList.setDirty()}}class cl{constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const o=null!==t.contentQueries?t.contentQueries[0]:n.length,s=[];for(let a=0;a<o;a++){const l=n.getByIndex(a);s.push(this.queries[l.indexInDeclarationView].clone())}return new cl(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==fg(t,n).matches&&this.queries[n].setDirty()}}class og{constructor(t,n,o=null){this.predicate=t,this.flags=n,this.read=o}}class ul{constructor(t=[]){this.queries=t}elementStart(t,n){for(let o=0;o<this.queries.length;o++)this.queries[o].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let o=0;o<this.length;o++){const s=null!==n?n.length:0,a=this.getByIndex(o).embeddedTView(t,s);a&&(a.indexInDeclarationView=o,null!==n?n.push(a):n=[a])}return null!==n?new ul(n):null}template(t,n){for(let o=0;o<this.queries.length;o++)this.queries[o].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class ll{constructor(t,n=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new ll(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let o=t.parent;for(;null!==o&&8&o.type&&o.index!==n;)o=o.parent;return n===(null!==o?o.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const o=this.metadata.predicate;if(Array.isArray(o))for(let s=0;s<o.length;s++){const a=o[s];this.matchTNodeWithReadOption(t,n,y0(n,a)),this.matchTNodeWithReadOption(t,n,Ei(n,t,a,!1,!1))}else o===Js?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,Ei(n,t,o,!1,!1))}matchTNodeWithReadOption(t,n,o){if(null!==o){const s=this.metadata.read;if(null!==s)if(s===Ps||s===Ga||s===Js&&4&n.type)this.addMatch(n.index,-2);else{const a=Ei(n,t,s,!1,!1);null!==a&&this.addMatch(n.index,a)}else this.addMatch(n.index,o)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function y0(e,t){const n=e.localNames;if(null!==n)for(let o=0;o<n.length;o+=2)if(n[o]===t)return n[o+1];return null}function S0(e,t,n,o){return-1===n?function _0(e,t){return 11&e.type?Mi(e,t):4&e.type?Wa(e,t):null}(t,e):-2===n?function E0(e,t,n){return n===Ps?Mi(t,e):n===Js?Wa(t,e):n===Ga?rg(t,e):void 0}(e,t,o):Fo(e,e[1],n,t)}function ig(e,t,n,o){const s=t[19].queries[o];if(null===s.matches){const a=e.data,l=n.matches,m=[];for(let _=0;_<l.length;_+=2){const R=l[_];m.push(R<0?null:S0(t,a[R],l[_+1],n.metadata.read))}s.matches=m}return s.matches}function dl(e,t,n,o){const s=e.queries.getByIndex(n),a=s.matches;if(null!==a){const l=ig(e,t,s,n);for(let m=0;m<a.length;m+=2){const _=a[m];if(_>0)o.push(l[m/2]);else{const R=a[m+1],x=t[-_];for(let B=10;B<x.length;B++){const ue=x[B];ue[17]===ue[3]&&dl(ue[1],ue,R,o)}if(null!==x[9]){const B=x[9];for(let ue=0;ue<B.length;ue++){const be=B[ue];dl(be[1],be,R,o)}}}}}return o}function sg(e){const t=et(),n=Zt(),o=ea();is(o+1);const s=fg(n,o);if(e.dirty&&Sn(t)===(2==(2&s.metadata.flags))){if(null===s.matches)e.reset([]);else{const a=s.crossesNgTemplate?dl(n,t,o,[]):ig(n,t,s,o);e.reset(a,fv),e.notifyOnChanges()}return!0}return!1}function ag(e,t,n){const o=Zt();o.firstCreatePass&&(dg(o,new og(e,t,n),-1),2==(2&t)&&(o.staticViewQueries=!0)),lg(o,et(),t)}function cg(e,t,n,o){const s=Zt();if(s.firstCreatePass){const a=Vn();dg(s,new og(t,n,o),a.index),function D0(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(s,e),2==(2&n)&&(s.staticContentQueries=!0)}lg(s,et(),n)}function ug(){return function I0(e,t){return e[19].queries[t].queryList}(et(),ea())}function lg(e,t,n){const o=new il(4==(4&n));Hf(e,t,o,o.destroy),null===t[19]&&(t[19]=new cl),t[19].queries.push(new al(o))}function dg(e,t,n){null===e.queries&&(e.queries=new ul),e.queries.track(new ll(t,n))}function fg(e,t){return e.queries.getByIndex(t)}function Zi(e){const t=_e(e)||se(e)||q(e);return null!==t&&t.standalone}function qa(...e){}const Mg=new fn("Application Initializer");let Ya=(()=>{class e{constructor(n){this.appInits=n,this.resolve=qa,this.reject=qa,this.initialized=!1,this.done=!1,this.donePromise=new Promise((o,s)=>{this.resolve=o,this.reject=s})}runInitializers(){if(this.initialized)return;const n=[],o=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const a=this.appInits[s]();if(Hu(a))n.push(a);else if(yp(a)){const l=new Promise((m,_)=>{a.subscribe({complete:m,error:_})});n.push(l)}}Promise.all(n).then(()=>{o()}).catch(s=>{this.reject(s)}),0===n.length&&o(),this.initialized=!0}}return e.\u0275fac=function(n){return new(n||e)(Bn(Mg,8))},e.\u0275prov=pn({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Ng=new fn("AppId",{providedIn:"root",factory:function Pg(){return`${ml()}${ml()}${ml()}`}});function ml(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const xg=new fn("Platform Initializer"),W0=new fn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),kg=new fn("appBootstrapListener");let G0=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=pn({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();const Ka=new fn("LocaleId",{providedIn:"root",factory:()=>Xl(Ka,le.Optional|le.SkipSelf)||function z0(){return typeof $localize<"u"&&$localize.locale||Ki}()}),q0=new fn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Y0{constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let K0=(()=>{class e{compileModuleSync(n){return new tl(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const o=this.compileModuleSync(n),a=co(Re(n).declarations).reduce((l,m)=>{const _=_e(m);return _&&l.push(new js(_)),l},[]);return new Y0(o,a)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=pn({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const X0=(()=>Promise.resolve(0))();function vl(e){typeof Zone>"u"?X0.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class br{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:o=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Zr(!1),this.onMicrotaskEmpty=new Zr(!1),this.onStable=new Zr(!1),this.onError=new Zr(!1),typeof Zone>"u")throw new $e(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const a=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new a("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!o&&n,s.shouldCoalesceRunChangeDetection=o,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function Z0(){let e=Je.requestAnimationFrame,t=Je.cancelAnimationFrame;if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const o=t[Zone.__symbol__("OriginalDelegate")];o&&(t=o)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function nI(e){const t=()=>{!function tI(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Je,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,_l(e),e.isCheckStableRunning=!0,yl(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),_l(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,o,s,a,l,m)=>{try{return Vg(e),n.invokeTask(s,a,l,m)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),Ug(e)}},onInvoke:(n,o,s,a,l,m,_)=>{try{return Vg(e),n.invoke(s,a,l,m,_)}finally{e.shouldCoalesceRunChangeDetection&&t(),Ug(e)}},onHasTask:(n,o,s,a)=>{n.hasTask(s,a),o===s&&("microTask"==a.change?(e._hasPendingMicrotasks=a.microTask,_l(e),yl(e)):"macroTask"==a.change&&(e.hasPendingMacrotasks=a.macroTask))},onHandleError:(n,o,s,a)=>(n.handleError(s,a),e.runOutsideAngular(()=>e.onError.emit(a)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!br.isInAngularZone())throw new $e(909,!1)}static assertNotInAngularZone(){if(br.isInAngularZone())throw new $e(909,!1)}run(t,n,o){return this._inner.run(t,n,o)}runTask(t,n,o,s){const a=this._inner,l=a.scheduleEventTask("NgZoneEvent: "+s,t,eI,qa,qa);try{return a.runTask(l,n,o)}finally{a.cancelTask(l)}}runGuarded(t,n,o){return this._inner.runGuarded(t,n,o)}runOutsideAngular(t){return this._outer.run(t)}}const eI={};function yl(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function _l(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Vg(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Ug(e){e._nesting--,yl(e)}class rI{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Zr,this.onMicrotaskEmpty=new Zr,this.onStable=new Zr,this.onError=new Zr}run(t,n,o){return t.apply(n,o)}runGuarded(t,n,o){return t.apply(n,o)}runOutsideAngular(t){return t()}runTask(t,n,o,s){return t.apply(n,o)}}const jg=new fn(""),Bg=new fn("");let Sl,oI=(()=>{class e{constructor(n,o,s){this._ngZone=n,this.registry=o,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Sl||(function iI(e){Sl=e}(s),s.addToWindow(o)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{br.assertNotInAngularZone(),vl(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())vl(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(o=>!o.updateCb||!o.updateCb(n)||(clearTimeout(o.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,o,s){let a=-1;o&&o>0&&(a=setTimeout(()=>{this._callbacks=this._callbacks.filter(l=>l.timeoutId!==a),n(this._didWork,this.getPendingTasks())},o)),this._callbacks.push({doneCb:n,timeoutId:a,updateCb:s})}whenStable(n,o,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,o,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,o,s){return[]}}return e.\u0275fac=function(n){return new(n||e)(Bn(br),Bn(Hg),Bn(Bg))},e.\u0275prov=pn({token:e,factory:e.\u0275fac}),e})(),Hg=(()=>{class e{constructor(){this._applications=new Map}registerApplication(n,o){this._applications.set(n,o)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,o=!0){return Sl?.findTestabilityInTree(this,n,o)??null}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=pn({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})(),Do=null;const $g=new fn("AllowMultipleToken"),El=new fn("PlatformDestroyListeners");class cI{constructor(t,n){this.name=t,this.token=n}}function Gg(e,t,n=[]){const o=`Platform: ${t}`,s=new fn(o);return(a=[])=>{let l=Il();if(!l||l.injector.get($g,!1)){const m=[...n,...a,{provide:s,useValue:!0}];e?e(m):function uI(e){if(Do&&!Do.get($g,!1))throw new $e(400,!1);Do=e;const t=e.get(qg);(function Wg(e){const t=e.get(xg,null);t&&t.forEach(n=>n())})(e)}(function zg(e=[],t){return Ko.create({name:t,providers:[{provide:xc,useValue:"platform"},{provide:El,useValue:new Set([()=>Do=null])},...e]})}(m,o))}return function dI(e){const t=Il();if(!t)throw new $e(401,!1);return t}()}}function Il(){return Do?.get(qg)??null}let qg=(()=>{class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,o){const s=function fI(e,t){let n;return n="noop"===e?new rI:("zone.js"===e?void 0:e)||new br(t),n}(o?.ngZone,function Yg(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!e||!e.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!e||!e.ngZoneRunCoalescing)||!1}}(o)),a=[{provide:br,useValue:s}];return s.run(()=>{const l=Ko.create({providers:a,parent:this.injector,name:n.moduleType.name}),m=n.create(l),_=m.injector.get(xs,null);if(!_)throw new $e(402,!1);return s.runOutsideAngular(()=>{const R=s.onError.subscribe({next:x=>{_.handleError(x)}});m.onDestroy(()=>{Qa(this._modules,m),R.unsubscribe()})}),function Kg(e,t,n){try{const o=n();return Hu(o)?o.catch(s=>{throw t.runOutsideAngular(()=>e.handleError(s)),s}):o}catch(o){throw t.runOutsideAngular(()=>e.handleError(o)),o}}(_,s,()=>{const R=m.injector.get(Ya);return R.runInitializers(),R.donePromise.then(()=>(function mh(e){tn(e,"Expected localeId to be defined"),"string"==typeof e&&(gh=e.toLowerCase().replace(/_/g,"-"))}(m.injector.get(Ka,Ki)||Ki),this._moduleDoBootstrap(m),m))})})}bootstrapModule(n,o=[]){const s=Jg({},o);return function sI(e,t,n){const o=new tl(n);return Promise.resolve(o)}(0,0,n).then(a=>this.bootstrapModuleFactory(a,s))}_moduleDoBootstrap(n){const o=n.injector.get(Ja);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(s=>o.bootstrap(s));else{if(!n.instance.ngDoBootstrap)throw new $e(403,!1);n.instance.ngDoBootstrap(o)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $e(404,!1);this._modules.slice().forEach(o=>o.destroy()),this._destroyListeners.forEach(o=>o());const n=this._injector.get(El,null);n&&(n.forEach(o=>o()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(n){return new(n||e)(Bn(Ko))},e.\u0275prov=pn({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();function Jg(e,t){return Array.isArray(t)?t.reduce(Jg,e):{...e,...t}}let Ja=(()=>{class e{constructor(n,o,s){this._zone=n,this._injector=o,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new Ce.y(m=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{m.next(this._stable),m.complete()})}),l=new Ce.y(m=>{let _;this._zone.runOutsideAngular(()=>{_=this._zone.onStable.subscribe(()=>{br.assertNotInAngularZone(),vl(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,m.next(!0))})})});const R=this._zone.onUnstable.subscribe(()=>{br.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{m.next(!1)}))});return()=>{_.unsubscribe(),R.unsubscribe()}});this.isStable=function De(...e){const t=(0,L.yG)(e),n=(0,L._6)(e,1/0),o=e;return o.length?1===o.length?(0,M.Xf)(o[0]):(0,E.J)(n)((0,ae.D)(o,t)):S.E}(a,l.pipe(function ee(e={}){const{connector:t=(()=>new pe.x),resetOnError:n=!0,resetOnComplete:o=!0,resetOnRefCountZero:s=!0}=e;return a=>{let l,m,_,R=0,x=!1,B=!1;const ue=()=>{m?.unsubscribe(),m=void 0},be=()=>{ue(),l=_=void 0,x=B=!1},Ge=()=>{const ot=l;be(),ot?.unsubscribe()};return(0,Y.e)((ot,lt)=>{R++,!B&&!x&&ue();const gt=_=_??t();lt.add(()=>{R--,0===R&&!B&&!x&&(m=je(Ge,s))}),gt.subscribe(lt),!l&&R>0&&(l=new we.Hp({next:Dt=>gt.next(Dt),error:Dt=>{B=!0,ue(),m=je(be,n,Dt),gt.error(Dt)},complete:()=>{x=!0,ue(),m=je(be,o),gt.complete()}}),(0,M.Xf)(ot).subscribe(l))})(a)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,o){const s=n instanceof Ad;if(!this._injector.get(Ya).done)throw!s&&Zi(n),new $e(405,false);let l;l=s?n:this._injector.get(Ns).resolveComponentFactory(n),this.componentTypes.push(l.componentType);const m=function aI(e){return e.isBoundToModule}(l)?void 0:this._injector.get(Qi),R=l.create(Ko.NULL,[],o||l.selector,m),x=R.location.nativeElement,B=R.injector.get(jg,null);return B?.registerApplication(x),R.onDestroy(()=>{this.detachView(R.hostView),Qa(this.components,R),B?.unregisterApplication(x)}),this._loadComponent(R),R}tick(){if(this._runningTick)throw new $e(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const o=n;this._views.push(o),o.attachToAppRef(this)}detachView(n){const o=n;Qa(this._views,o),o.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(kg,[]).concat(this._bootstrapListeners).forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Qa(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new $e(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return e.\u0275fac=function(n){return new(n||e)(Bn(br),Bn(qo),Bn(xs))},e.\u0275prov=pn({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Qa(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}let Xg=!0;function hI(){Xg=!1}let gI=(()=>{class e{}return e.__NG_ELEMENT_ID__=mI,e})();function mI(e){return function vI(e,t,n){if(Rr(e)&&!n){const o=ht(e.index,t);return new Us(o,o)}return 47&e.type?new Us(t[16],t):null}(Vn(),et(),16==(16&e))}class rm{constructor(){}supports(t){return Bs(t)}create(t){return new DI(t)}}const II=(e,t)=>t;class DI{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||II}forEachItem(t){let n;for(n=this._itHead;null!==n;n=n._next)t(n)}forEachOperation(t){let n=this._itHead,o=this._removalsHead,s=0,a=null;for(;n||o;){const l=!o||n&&n.currentIndex<im(o,s,a)?n:o,m=im(l,s,a),_=l.currentIndex;if(l===o)s--,o=o._nextRemoved;else if(n=n._next,null==l.previousIndex)s++;else{a||(a=[]);const R=m-s,x=_-s;if(R!=x){for(let ue=0;ue<R;ue++){const be=ue<a.length?a[ue]:a[ue]=0,Ge=be+ue;x<=Ge&&Ge<R&&(a[ue]=be+1)}a[l.previousIndex]=x-R}}m!==_&&t(l,m,_)}}forEachPreviousItem(t){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachMovedItem(t){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}forEachIdentityChange(t){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)t(n)}diff(t){if(null==t&&(t=[]),!Bs(t))throw new $e(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,a,l,n=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let m=0;m<this.length;m++)a=t[m],l=this._trackByFn(m,a),null!==n&&Object.is(n.trackById,l)?(o&&(n=this._verifyReinsertion(n,a,l,m)),Object.is(n.item,a)||this._addIdentityChange(n,a)):(n=this._mismatch(n,a,l,m),o=!0),n=n._next}else s=0,function L_(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[Jo()]();let o;for(;!(o=n.next()).done;)t(o.value)}}(t,m=>{l=this._trackByFn(s,m),null!==n&&Object.is(n.trackById,l)?(o&&(n=this._verifyReinsertion(n,m,l,s)),Object.is(n.item,m)||this._addIdentityChange(n,m)):(n=this._mismatch(n,m,l,s),o=!0),n=n._next,s++}),this.length=s;return this._truncate(n),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,n,o,s){let a;return null===t?a=this._itTail:(a=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._reinsertAfter(t,a,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(o,s))?(Object.is(t.item,n)||this._addIdentityChange(t,n),this._moveAfter(t,a,s)):t=this._addAfter(new CI(n,o),a,s),t}_verifyReinsertion(t,n,o,s){let a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(o,null);return null!==a?t=this._reinsertAfter(a,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const n=t._next;this._addToRemovals(this._unlink(t)),t=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,n,o){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,a=t._nextRemoved;return null===s?this._removalsHead=a:s._nextRemoved=a,null===a?this._removalsTail=s:a._prevRemoved=s,this._insertAfter(t,n,o),this._addToMoves(t,o),t}_moveAfter(t,n,o){return this._unlink(t),this._insertAfter(t,n,o),this._addToMoves(t,o),t}_addAfter(t,n,o){return this._insertAfter(t,n,o),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,n,o){const s=null===n?this._itHead:n._next;return t._next=s,t._prev=n,null===s?this._itTail=t:s._prev=t,null===n?this._itHead=t:n._next=t,null===this._linkedRecords&&(this._linkedRecords=new om),this._linkedRecords.put(t),t.currentIndex=o,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const n=t._prev,o=t._next;return null===n?this._itHead=o:n._next=o,null===o?this._itTail=n:o._prev=n,t}_addToMoves(t,n){return t.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new om),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,n){return t.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class CI{constructor(t,n){this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class bI{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,n){let o;for(o=this._head;null!==o;o=o._nextDup)if((null===n||n<=o.currentIndex)&&Object.is(o.trackById,t))return o;return null}remove(t){const n=t._prevDup,o=t._nextDup;return null===n?this._head=o:n._nextDup=o,null===o?this._tail=n:o._prevDup=n,null===this._head}}class om{constructor(){this.map=new Map}put(t){const n=t.trackById;let o=this.map.get(n);o||(o=new bI,this.map.set(n,o)),o.add(t)}get(t,n){const s=this.map.get(t);return s?s.get(t,n):null}remove(t){const n=t.trackById;return this.map.get(n).remove(t)&&this.map.delete(n),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function im(e,t,n){const o=e.previousIndex;if(null===o)return o;let s=0;return n&&o<n.length&&(s=n[o]),o+t+s}class sm{constructor(){}supports(t){return t instanceof Map||ku(t)}create(){return new TI}}class TI{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||ku(t)))throw new $e(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(o,s)=>{if(n&&n.key===s)this._maybeAddToChanges(n,o),this._appendAfter=n,n=n._next;else{const a=this._getOrCreateRecordForKey(s,o);n=this._insertBeforeOrAppend(n,a)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let o=n;null!==o;o=o._nextRemoved)o===this._mapHead&&(this._mapHead=null),this._records.delete(o.key),o._nextRemoved=o._next,o.previousValue=o.currentValue,o.currentValue=null,o._prev=null,o._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const o=t._prev;return n._next=t,n._prev=o,t._prev=n,o&&(o._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,n);const a=s._prev,l=s._next;return a&&(a._next=l),l&&(l._prev=a),s._next=null,s._prev=null,s}const o=new wI(t);return this._records.set(t,o),o.currentValue=n,this._addToAdditions(o),o}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(o=>n(t[o],o))}}class wI{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function am(){return new wl([new rm])}let wl=(()=>{class e{constructor(n){this.factories=n}static create(n,o){if(null!=o){const s=o.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:o=>e.create(n,o||am()),deps:[[e,new Ts,new bs]]}}find(n){const o=this.factories.find(s=>s.supports(n));if(null!=o)return o;throw new $e(901,!1)}}return e.\u0275prov=pn({token:e,providedIn:"root",factory:am}),e})();function cm(){return new Al([new sm])}let Al=(()=>{class e{constructor(n){this.factories=n}static create(n,o){if(o){const s=o.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:o=>e.create(n,o||cm()),deps:[[e,new Ts,new bs]]}}find(n){const o=this.factories.find(s=>s.supports(n));if(o)return o;throw new $e(901,!1)}}return e.\u0275prov=pn({token:e,providedIn:"root",factory:cm}),e})();const OI=Gg(null,"core",[]);let MI=(()=>{class e{constructor(n){}}return e.\u0275fac=function(n){return new(n||e)(Bn(Ja))},e.\u0275mod=Nr({type:e}),e.\u0275inj=hn({}),e})();function NI(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}},1481:(Mt,xe,U)=>{"use strict";U.d(xe,{Dx:()=>te,b2:()=>nn,q6:()=>zt});var E=U(6895),M=U(8256);class S extends E.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class L extends S{static makeCurrent(){(0,E.HT)(new L)}onAndCancel(se,q,Re){return se.addEventListener(q,Re,!1),()=>{se.removeEventListener(q,Re,!1)}}dispatchEvent(se,q){se.dispatchEvent(q)}remove(se){se.parentNode&&se.parentNode.removeChild(se)}createElement(se,q){return(q=q||this.getDefaultDocument()).createElement(se)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(se){return se.nodeType===Node.ELEMENT_NODE}isShadowRoot(se){return se instanceof DocumentFragment}getGlobalEventTarget(se,q){return"window"===q?window:"document"===q?se:"body"===q?se.body:null}getBaseHref(se){const q=function De(){return ae=ae||document.querySelector("base"),ae?ae.getAttribute("href"):null}();return null==q?null:function ce(_e){pe=pe||document.createElement("a"),pe.setAttribute("href",_e);const se=pe.pathname;return"/"===se.charAt(0)?se:`/${se}`}(q)}resetBaseElement(){ae=null}getUserAgent(){return window.navigator.userAgent}getCookie(se){return(0,E.Mx)(document.cookie,se)}}let pe,ae=null;const Ce=new M.OlP("TRANSITION_ID"),Y=[{provide:M.ip1,useFactory:function we(_e,se,q){return()=>{q.get(M.CZH).donePromise.then(()=>{const Re=(0,E.q)(),ze=se.querySelectorAll(`style[ng-transition="${_e}"]`);for(let Ve=0;Ve<ze.length;Ve++)Re.remove(ze[Ve])})}},deps:[Ce,E.K0,M.zs3],multi:!0}];let je=(()=>{class _e{build(){return new XMLHttpRequest}}return _e.\u0275fac=function(q){return new(q||_e)},_e.\u0275prov=M.Yz7({token:_e,factory:_e.\u0275fac}),_e})();const Le=new M.OlP("EventManagerPlugins");let z=(()=>{class _e{constructor(q,Re){this._zone=Re,this._eventNameToPlugin=new Map,q.forEach(ze=>ze.manager=this),this._plugins=q.slice().reverse()}addEventListener(q,Re,ze){return this._findPluginFor(Re).addEventListener(q,Re,ze)}addGlobalEventListener(q,Re,ze){return this._findPluginFor(Re).addGlobalEventListener(q,Re,ze)}getZone(){return this._zone}_findPluginFor(q){const Re=this._eventNameToPlugin.get(q);if(Re)return Re;const ze=this._plugins;for(let Ve=0;Ve<ze.length;Ve++){const ct=ze[Ve];if(ct.supports(q))return this._eventNameToPlugin.set(q,ct),ct}throw new Error(`No event manager plugin found for event ${q}`)}}return _e.\u0275fac=function(q){return new(q||_e)(M.LFG(Le),M.LFG(M.R0b))},_e.\u0275prov=M.Yz7({token:_e,factory:_e.\u0275fac}),_e})();class ke{constructor(se){this._doc=se}addGlobalEventListener(se,q,Re){const ze=(0,E.q)().getGlobalEventTarget(this._doc,se);if(!ze)throw new Error(`Unsupported event target ${ze} for event ${q}`);return this.addEventListener(ze,q,Re)}}let ye=(()=>{class _e{constructor(){this._stylesSet=new Set}addStyles(q){const Re=new Set;q.forEach(ze=>{this._stylesSet.has(ze)||(this._stylesSet.add(ze),Re.add(ze))}),this.onStylesAdded(Re)}onStylesAdded(q){}getAllStyles(){return Array.from(this._stylesSet)}}return _e.\u0275fac=function(q){return new(q||_e)},_e.\u0275prov=M.Yz7({token:_e,factory:_e.\u0275fac}),_e})(),K=(()=>{class _e extends ye{constructor(q){super(),this._doc=q,this._hostNodes=new Map,this._hostNodes.set(q.head,[])}_addStylesToHost(q,Re,ze){q.forEach(Ve=>{const ct=this._doc.createElement("style");ct.textContent=Ve,ze.push(Re.appendChild(ct))})}addHost(q){const Re=[];this._addStylesToHost(this._stylesSet,q,Re),this._hostNodes.set(q,Re)}removeHost(q){const Re=this._hostNodes.get(q);Re&&Re.forEach(G),this._hostNodes.delete(q)}onStylesAdded(q){this._hostNodes.forEach((Re,ze)=>{this._addStylesToHost(q,ze,Re)})}ngOnDestroy(){this._hostNodes.forEach(q=>q.forEach(G))}}return _e.\u0275fac=function(q){return new(q||_e)(M.LFG(E.K0))},_e.\u0275prov=M.Yz7({token:_e,factory:_e.\u0275fac}),_e})();function G(_e){(0,E.q)().remove(_e)}const Fe={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},He=/%COMP%/g;function oe(_e,se,q){for(let Re=0;Re<se.length;Re++){let ze=se[Re];Array.isArray(ze)?oe(_e,ze,q):(ze=ze.replace(He,_e),q.push(ze))}return q}function J(_e){return se=>{if("__ngUnwrap__"===se)return _e;!1===_e(se)&&(se.preventDefault(),se.returnValue=!1)}}let de=(()=>{class _e{constructor(q,Re,ze){this.eventManager=q,this.sharedStylesHost=Re,this.appId=ze,this.rendererByCompId=new Map,this.defaultRenderer=new Ze(q)}createRenderer(q,Re){if(!q||!Re)return this.defaultRenderer;switch(Re.encapsulation){case M.ifc.Emulated:{let ze=this.rendererByCompId.get(Re.id);return ze||(ze=new ft(this.eventManager,this.sharedStylesHost,Re,this.appId),this.rendererByCompId.set(Re.id,ze)),ze.applyToHost(q),ze}case 1:case M.ifc.ShadowDom:return new Ye(this.eventManager,this.sharedStylesHost,q,Re);default:if(!this.rendererByCompId.has(Re.id)){const ze=oe(Re.id,Re.styles,[]);this.sharedStylesHost.addStyles(ze),this.rendererByCompId.set(Re.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return _e.\u0275fac=function(q){return new(q||_e)(M.LFG(z),M.LFG(K),M.LFG(M.AFp))},_e.\u0275prov=M.Yz7({token:_e,factory:_e.\u0275fac}),_e})();class Ze{constructor(se){this.eventManager=se,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(se,q){return q?document.createElementNS(Fe[q]||q,se):document.createElement(se)}createComment(se){return document.createComment(se)}createText(se){return document.createTextNode(se)}appendChild(se,q){(it(se)?se.content:se).appendChild(q)}insertBefore(se,q,Re){se&&(it(se)?se.content:se).insertBefore(q,Re)}removeChild(se,q){se&&se.removeChild(q)}selectRootElement(se,q){let Re="string"==typeof se?document.querySelector(se):se;if(!Re)throw new Error(`The selector "${se}" did not match any elements`);return q||(Re.textContent=""),Re}parentNode(se){return se.parentNode}nextSibling(se){return se.nextSibling}setAttribute(se,q,Re,ze){if(ze){q=ze+":"+q;const Ve=Fe[ze];Ve?se.setAttributeNS(Ve,q,Re):se.setAttribute(q,Re)}else se.setAttribute(q,Re)}removeAttribute(se,q,Re){if(Re){const ze=Fe[Re];ze?se.removeAttributeNS(ze,q):se.removeAttribute(`${Re}:${q}`)}else se.removeAttribute(q)}addClass(se,q){se.classList.add(q)}removeClass(se,q){se.classList.remove(q)}setStyle(se,q,Re,ze){ze&(M.JOm.DashCase|M.JOm.Important)?se.style.setProperty(q,Re,ze&M.JOm.Important?"important":""):se.style[q]=Re}removeStyle(se,q,Re){Re&M.JOm.DashCase?se.style.removeProperty(q):se.style[q]=""}setProperty(se,q,Re){se[q]=Re}setValue(se,q){se.nodeValue=q}listen(se,q,Re){return"string"==typeof se?this.eventManager.addGlobalEventListener(se,q,J(Re)):this.eventManager.addEventListener(se,q,J(Re))}}function it(_e){return"TEMPLATE"===_e.tagName&&void 0!==_e.content}class ft extends Ze{constructor(se,q,Re,ze){super(se),this.component=Re;const Ve=oe(ze+"-"+Re.id,Re.styles,[]);q.addStyles(Ve),this.contentAttr=function Se(_e){return"_ngcontent-%COMP%".replace(He,_e)}(ze+"-"+Re.id),this.hostAttr=function Be(_e){return"_nghost-%COMP%".replace(He,_e)}(ze+"-"+Re.id)}applyToHost(se){super.setAttribute(se,this.hostAttr,"")}createElement(se,q){const Re=super.createElement(se,q);return super.setAttribute(Re,this.contentAttr,""),Re}}class Ye extends Ze{constructor(se,q,Re,ze){super(se),this.sharedStylesHost=q,this.hostEl=Re,this.shadowRoot=Re.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Ve=oe(ze.id,ze.styles,[]);for(let ct=0;ct<Ve.length;ct++){const Ft=document.createElement("style");Ft.textContent=Ve[ct],this.shadowRoot.appendChild(Ft)}}nodeOrShadowRoot(se){return se===this.hostEl?this.shadowRoot:se}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(se,q){return super.appendChild(this.nodeOrShadowRoot(se),q)}insertBefore(se,q,Re){return super.insertBefore(this.nodeOrShadowRoot(se),q,Re)}removeChild(se,q){return super.removeChild(this.nodeOrShadowRoot(se),q)}parentNode(se){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(se)))}}let Bt=(()=>{class _e extends ke{constructor(q){super(q)}supports(q){return!0}addEventListener(q,Re,ze){return q.addEventListener(Re,ze,!1),()=>this.removeEventListener(q,Re,ze)}removeEventListener(q,Re,ze){return q.removeEventListener(Re,ze)}}return _e.\u0275fac=function(q){return new(q||_e)(M.LFG(E.K0))},_e.\u0275prov=M.Yz7({token:_e,factory:_e.\u0275fac}),_e})();const mn=["alt","control","meta","shift"],qt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},At={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Xt={alt:_e=>_e.altKey,control:_e=>_e.ctrlKey,meta:_e=>_e.metaKey,shift:_e=>_e.shiftKey};let tn=(()=>{class _e extends ke{constructor(q){super(q)}supports(q){return null!=_e.parseEventName(q)}addEventListener(q,Re,ze){const Ve=_e.parseEventName(Re),ct=_e.eventCallback(Ve.fullKey,ze,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,E.q)().onAndCancel(q,Ve.domEventName,ct))}static parseEventName(q){const Re=q.toLowerCase().split("."),ze=Re.shift();if(0===Re.length||"keydown"!==ze&&"keyup"!==ze)return null;const Ve=_e._normalizeKey(Re.pop());let ct="";if(mn.forEach(cn=>{const qn=Re.indexOf(cn);qn>-1&&(Re.splice(qn,1),ct+=cn+".")}),ct+=Ve,0!=Re.length||0===Ve.length)return null;const Ft={};return Ft.domEventName=ze,Ft.fullKey=ct,Ft}static getEventFullKey(q){let Re="",ze=function xt(_e){let se=_e.key;if(null==se){if(se=_e.keyIdentifier,null==se)return"Unidentified";se.startsWith("U+")&&(se=String.fromCharCode(parseInt(se.substring(2),16)),3===_e.location&&At.hasOwnProperty(se)&&(se=At[se]))}return qt[se]||se}(q);return ze=ze.toLowerCase()," "===ze?ze="space":"."===ze&&(ze="dot"),mn.forEach(Ve=>{Ve!=ze&&(0,Xt[Ve])(q)&&(Re+=Ve+".")}),Re+=ze,Re}static eventCallback(q,Re,ze){return Ve=>{_e.getEventFullKey(Ve)===q&&ze.runGuarded(()=>Re(Ve))}}static _normalizeKey(q){return"esc"===q?"escape":q}}return _e.\u0275fac=function(q){return new(q||_e)(M.LFG(E.K0))},_e.\u0275prov=M.Yz7({token:_e,factory:_e.\u0275fac}),_e})();const zt=(0,M.eFA)(M._c5,"browser",[{provide:M.Lbi,useValue:E.bD},{provide:M.g9A,useValue:function pn(){L.makeCurrent()},multi:!0},{provide:E.K0,useFactory:function hn(){return(0,M.RDi)(document),document},deps:[]}]),Te=new M.OlP(""),Yt=[{provide:M.rWj,useClass:class ee{addToWindow(se){M.dqk.getAngularTestability=(Re,ze=!0)=>{const Ve=se.findTestabilityInTree(Re,ze);if(null==Ve)throw new Error("Could not find testability for element.");return Ve},M.dqk.getAllAngularTestabilities=()=>se.getAllTestabilities(),M.dqk.getAllAngularRootElements=()=>se.getAllRootElements(),M.dqk.frameworkStabilizers||(M.dqk.frameworkStabilizers=[]),M.dqk.frameworkStabilizers.push(Re=>{const ze=M.dqk.getAllAngularTestabilities();let Ve=ze.length,ct=!1;const Ft=function(cn){ct=ct||cn,Ve--,0==Ve&&Re(ct)};ze.forEach(function(cn){cn.whenStable(Ft)})})}findTestabilityInTree(se,q,Re){return null==q?null:se.getTestability(q)??(Re?(0,E.q)().isShadowRoot(q)?this.findTestabilityInTree(se,q.host,!0):this.findTestabilityInTree(se,q.parentElement,!0):null)}},deps:[]},{provide:M.lri,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]},{provide:M.dDg,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]}],Mn=[{provide:M.zSh,useValue:"root"},{provide:M.qLn,useFactory:function bn(){return new M.qLn},deps:[]},{provide:Le,useClass:Bt,multi:!0,deps:[E.K0,M.R0b,M.Lbi]},{provide:Le,useClass:tn,multi:!0,deps:[E.K0]},{provide:de,useClass:de,deps:[z,K,M.AFp]},{provide:M.FYo,useExisting:de},{provide:ye,useExisting:K},{provide:K,useClass:K,deps:[E.K0]},{provide:z,useClass:z,deps:[Le,M.R0b]},{provide:E.JF,useClass:je,deps:[]},[]];let nn=(()=>{class _e{constructor(q){}static withServerTransition(q){return{ngModule:_e,providers:[{provide:M.AFp,useValue:q.appId},{provide:Ce,useExisting:M.AFp},Y]}}}return _e.\u0275fac=function(q){return new(q||_e)(M.LFG(Te,12))},_e.\u0275mod=M.oAB({type:_e}),_e.\u0275inj=M.cJS({providers:[...Mn,...Yt],imports:[E.ez,M.hGG]}),_e})(),te=(()=>{class _e{constructor(q){this._doc=q}getTitle(){return this._doc.title}setTitle(q){this._doc.title=q||""}}return _e.\u0275fac=function(q){return new(q||_e)(M.LFG(E.K0))},_e.\u0275prov=M.Yz7({token:_e,factory:function(q){let Re=null;return Re=q?new q:function le(){return new te((0,M.LFG)(E.K0))}(),Re},providedIn:"root"}),_e})();typeof window<"u"&&window},6773:(Mt,xe,U)=>{"use strict";U.d(xe,{F0:()=>xn,yS:()=>Ii,Bz:()=>Gl,lC:()=>A});var E=U(8256),M=U(7579);class S extends M.x{constructor(p){super(),this._value=p}get value(){return this.getValue()}_subscribe(p){const d=super._subscribe(p);return!d.closed&&p.next(this._value),d}getValue(){const{hasError:p,thrownError:d,_value:y}=this;if(p)throw d;return this._throwIfClosed(),y}next(p){super.next(this._value=p)}}const ae=(0,U(3888).d)(f=>function(){f(this),this.name="EmptyError",this.message="no elements in sequence"});var De=U(9751),pe=U(4742),ce=U(2076),Ce=U(4671),we=U(3268),Y=U(7669),ee=U(1810),je=U(5403),Le=U(9672);function z(...f){const p=(0,Y.yG)(f),d=(0,Y.jO)(f),{args:y,keys:D}=(0,pe.D)(f);if(0===y.length)return(0,ce.D)([],p);const N=new De.y(function ke(f,p,d=Ce.y){return y=>{ye(p,()=>{const{length:D}=f,N=new Array(D);let H=D,Z=D;for(let Ne=0;Ne<D;Ne++)ye(p,()=>{const at=(0,ce.D)(f[Ne],p);let jt=!1;at.subscribe((0,je.x)(y,pt=>{N[Ne]=pt,jt||(jt=!0,Z--),Z||y.next(d(N.slice()))},()=>{--H||y.complete()}))},y)},y)}}(y,p,D?H=>(0,ee.n)(D,H):Ce.y));return d?N.pipe((0,we.Z)(d)):N}function ye(f,p,d){f?(0,Le.f)(d,f,p):p()}var K=U(8189);function Fe(...f){return function G(){return(0,K.J)(1)}()((0,ce.D)(f,(0,Y.yG)(f)))}var He=U(8421);function Xe(f){return new De.y(p=>{(0,He.Xf)(f()).subscribe(p)})}var $e=U(576);function me(f,p){const d=(0,$e.m)(f)?f:()=>f,y=D=>D.error(d());return new De.y(p?D=>p.schedule(y,0,D):y)}var ge=U(727),Se=U(4482);function Be(){return(0,Se.e)((f,p)=>{let d=null;f._refCount++;const y=(0,je.x)(p,void 0,void 0,void 0,()=>{if(!f||f._refCount<=0||0<--f._refCount)return void(d=null);const D=f._connection,N=d;d=null,D&&(!N||D===N)&&D.unsubscribe(),p.unsubscribe()});f.subscribe(y),y.closed||(d=f.connect())})}class oe extends De.y{constructor(p,d){super(),this.source=p,this.subjectFactory=d,this._subject=null,this._refCount=0,this._connection=null,(0,Se.A)(p)&&(this.lift=p.lift)}_subscribe(p){return this.getSubject().subscribe(p)}getSubject(){const p=this._subject;return(!p||p.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:p}=this;this._subject=this._connection=null,p?.unsubscribe()}connect(){let p=this._connection;if(!p){p=this._connection=new ge.w0;const d=this.getSubject();p.add(this.source.subscribe((0,je.x)(d,void 0,()=>{this._teardown(),d.complete()},y=>{this._teardown(),d.error(y)},()=>this._teardown()))),p.closed&&(this._connection=null,p=ge.w0.EMPTY)}return p}refCount(){return Be()(this)}}var J=U(9646),he=U(9635),de=U(515),Ze=U(6895);function ve(f,p){return(0,Se.e)((d,y)=>{let D=null,N=0,H=!1;const Z=()=>H&&!D&&y.complete();d.subscribe((0,je.x)(y,Ne=>{D?.unsubscribe();let at=0;const jt=N++;(0,He.Xf)(f(Ne,jt)).subscribe(D=(0,je.x)(y,pt=>y.next(p?p(Ne,pt,jt,at++):pt),()=>{D=null,Z()}))},()=>{H=!0,Z()}))})}function re(f){return f<=0?()=>de.E:(0,Se.e)((p,d)=>{let y=0;p.subscribe((0,je.x)(d,D=>{++y<=f&&(d.next(D),f<=y&&d.complete())}))})}var ft=U(9300);function Ye(f){return(0,Se.e)((p,d)=>{let y=!1;p.subscribe((0,je.x)(d,D=>{y=!0,d.next(D)},()=>{y||d.next(f),d.complete()}))})}function Bt(f=mn){return(0,Se.e)((p,d)=>{let y=!1;p.subscribe((0,je.x)(d,D=>{y=!0,d.next(D)},()=>y?d.complete():d.error(f())))})}function mn(){return new ae}function Vt(f,p){const d=arguments.length>=2;return y=>y.pipe(f?(0,ft.h)((D,N)=>f(D,N,y)):Ce.y,re(1),d?Ye(p):Bt(()=>new ae))}function qt(f,p,d){const y=(0,$e.m)(f)||p||d?{next:f,error:p,complete:d}:f;return y?(0,Se.e)((D,N)=>{var H;null===(H=y.subscribe)||void 0===H||H.call(y);let Z=!0;D.subscribe((0,je.x)(N,Ne=>{var at;null===(at=y.next)||void 0===at||at.call(y,Ne),N.next(Ne)},()=>{var Ne;Z=!1,null===(Ne=y.complete)||void 0===Ne||Ne.call(y),N.complete()},Ne=>{var at;Z=!1,null===(at=y.error)||void 0===at||at.call(y,Ne),N.error(Ne)},()=>{var Ne,at;Z&&(null===(Ne=y.unsubscribe)||void 0===Ne||Ne.call(y)),null===(at=y.finalize)||void 0===at||at.call(y)}))}):Ce.y}function At(f){return(0,Se.e)((p,d)=>{let N,y=null,D=!1;y=p.subscribe((0,je.x)(d,void 0,void 0,H=>{N=(0,He.Xf)(f(H,At(f)(p))),y?(y.unsubscribe(),y=null,N.subscribe(d)):D=!0})),D&&(y.unsubscribe(),y=null,N.subscribe(d))})}function Xt(f,p,d,y,D){return(N,H)=>{let Z=d,Ne=p,at=0;N.subscribe((0,je.x)(H,jt=>{const pt=at++;Ne=Z?f(Ne,jt,pt):(Z=!0,jt),y&&H.next(Ne)},D&&(()=>{Z&&H.next(Ne),H.complete()})))}}function tn(f,p){return(0,Se.e)(Xt(f,p,arguments.length>=2,!0))}function xt(f){return f<=0?()=>de.E:(0,Se.e)((p,d)=>{let y=[];p.subscribe((0,je.x)(d,D=>{y.push(D),f<y.length&&y.shift()},()=>{for(const D of y)d.next(D);d.complete()},void 0,()=>{y=null}))})}function jn(f,p){const d=arguments.length>=2;return y=>y.pipe(f?(0,ft.h)((D,N)=>f(D,N,y)):Ce.y,xt(1),d?Ye(p):Bt(()=>new ae))}var Ct=U(4004);function bn(f){return(0,Se.e)((p,d)=>{try{p.subscribe(d)}finally{d.add(f)}})}var hn=U(5577),On=U(4351),zt=U(1481);const Te="primary";class Yt{constructor(p){this.params=p||{}}has(p){return Object.prototype.hasOwnProperty.call(this.params,p)}get(p){if(this.has(p)){const d=this.params[p];return Array.isArray(d)?d[0]:d}return null}getAll(p){if(this.has(p)){const d=this.params[p];return Array.isArray(d)?d:[d]}return[]}get keys(){return Object.keys(this.params)}}function Mn(f){return new Yt(f)}function nn(f,p,d){const y=d.path.split("/");if(y.length>f.length||"full"===d.pathMatch&&(p.hasChildren()||y.length<f.length))return null;const D={};for(let N=0;N<y.length;N++){const H=y[N],Z=f[N];if(H.startsWith(":"))D[H.substring(1)]=Z;else if(H!==Z.path)return null}return{consumed:f.slice(0,y.length),posParams:D}}function an(f,p){const d=f?Object.keys(f):void 0,y=p?Object.keys(p):void 0;if(!d||!y||d.length!=y.length)return!1;let D;for(let N=0;N<d.length;N++)if(D=d[N],!Kt(f[D],p[D]))return!1;return!0}function Kt(f,p){if(Array.isArray(f)&&Array.isArray(p)){if(f.length!==p.length)return!1;const d=[...f].sort(),y=[...p].sort();return d.every((D,N)=>y[N]===D)}return f===p}function le(f){return Array.prototype.concat.apply([],f)}function te(f){return f.length>0?f[f.length-1]:null}function Me(f,p){for(const d in f)f.hasOwnProperty(d)&&p(f[d],d)}function Ke(f){return(0,E.CqO)(f)?f:(0,E.QGY)(f)?(0,ce.D)(Promise.resolve(f)):(0,J.of)(f)}const kt={exact:function Je(f,p,d){if(!In(f.segments,p.segments)||!Lt(f.segments,p.segments,d)||f.numberOfChildren!==p.numberOfChildren)return!1;for(const y in p.children)if(!f.children[y]||!Je(f.children[y],p.children[y],d))return!1;return!0},subset:rn},wt={exact:function $t(f,p){return an(f,p)},subset:function Wt(f,p){return Object.keys(p).length<=Object.keys(f).length&&Object.keys(p).every(d=>Kt(f[d],p[d]))},ignored:()=>!0};function Tn(f,p,d){return kt[d.paths](f.root,p.root,d.matrixParams)&&wt[d.queryParams](f.queryParams,p.queryParams)&&!("exact"===d.fragment&&f.fragment!==p.fragment)}function rn(f,p,d){return Jt(f,p,p.segments,d)}function Jt(f,p,d,y){if(f.segments.length>d.length){const D=f.segments.slice(0,d.length);return!(!In(D,d)||p.hasChildren()||!Lt(D,d,y))}if(f.segments.length===d.length){if(!In(f.segments,d)||!Lt(f.segments,d,y))return!1;for(const D in p.children)if(!f.children[D]||!rn(f.children[D],p.children[D],y))return!1;return!0}{const D=d.slice(0,f.segments.length),N=d.slice(f.segments.length);return!!(In(f.segments,D)&&Lt(f.segments,D,y)&&f.children[Te])&&Jt(f.children[Te],p,N,y)}}function Lt(f,p,d){return p.every((y,D)=>wt[d](f[D].parameters,y.parameters))}class En{constructor(p,d,y){this.root=p,this.queryParams=d,this.fragment=y}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Mn(this.queryParams)),this._queryParamMap}toString(){return Wn.serialize(this)}}class St{constructor(p,d){this.segments=p,this.children=d,this.parent=null,Me(d,(y,D)=>y.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Tr(this)}}class $n{constructor(p,d){this.path=p,this.parameters=d}get parameterMap(){return this._parameterMap||(this._parameterMap=Mn(this.parameters)),this._parameterMap}toString(){return se(this)}}function In(f,p){return f.length===p.length&&f.every((d,y)=>d.path===p[y].path)}let eo=(()=>{class f{}return f.\u0275fac=function(d){return new(d||f)},f.\u0275prov=E.Yz7({token:f,factory:function(){return new lr},providedIn:"root"}),f})();class lr{parse(p){const d=new yn(p);return new En(d.parseRootSegment(),d.parseQueryParams(),d.parseFragment())}serialize(p){const d=`/${_r(p.root,!0)}`,y=function Re(f){const p=Object.keys(f).map(d=>{const y=f[d];return Array.isArray(y)?y.map(D=>`${Rt(d)}=${Rt(D)}`).join("&"):`${Rt(d)}=${Rt(y)}`}).filter(d=>!!d);return p.length?`?${p.join("&")}`:""}(p.queryParams);return`${d}${y}${"string"==typeof p.fragment?`#${function to(f){return encodeURI(f)}(p.fragment)}`:""}`}}const Wn=new lr;function Tr(f){return f.segments.map(p=>se(p)).join("/")}function _r(f,p){if(!f.hasChildren())return Tr(f);if(p){const d=f.children[Te]?_r(f.children[Te],!1):"",y=[];return Me(f.children,(D,N)=>{N!==Te&&y.push(`${N}:${_r(D,!1)}`)}),y.length>0?`${d}(${y.join("//")})`:d}{const d=function ur(f,p){let d=[];return Me(f.children,(y,D)=>{D===Te&&(d=d.concat(p(y,D)))}),Me(f.children,(y,D)=>{D!==Te&&(d=d.concat(p(y,D)))}),d}(f,(y,D)=>D===Te?[_r(f.children[Te],!1)]:[`${D}:${_r(y,!1)}`]);return 1===Object.keys(f.children).length&&null!=f.children[Te]?`${Tr(f)}/${d[0]}`:`${Tr(f)}/(${d.join("//")})`}}function Nr(f){return encodeURIComponent(f).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Rt(f){return Nr(f).replace(/%3B/gi,";")}function vn(f){return Nr(f).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function dr(f){return decodeURIComponent(f)}function _e(f){return dr(f.replace(/\+/g,"%20"))}function se(f){return`${vn(f.path)}${function q(f){return Object.keys(f).map(p=>`;${vn(p)}=${vn(f[p])}`).join("")}(f.parameters)}`}const ze=/^[^\/()?;=#]+/;function Ve(f){const p=f.match(ze);return p?p[0]:""}const ct=/^[^=?&#]+/,cn=/^[^&#]+/;class yn{constructor(p){this.url=p,this.remaining=p}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new St([],{}):new St([],this.parseChildren())}parseQueryParams(){const p={};if(this.consumeOptional("?"))do{this.parseQueryParam(p)}while(this.consumeOptional("&"));return p}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const p=[];for(this.peekStartsWith("(")||p.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),p.push(this.parseSegment());let d={};this.peekStartsWith("/(")&&(this.capture("/"),d=this.parseParens(!0));let y={};return this.peekStartsWith("(")&&(y=this.parseParens(!1)),(p.length>0||Object.keys(d).length>0)&&(y[Te]=new St(p,d)),y}parseSegment(){const p=Ve(this.remaining);if(""===p&&this.peekStartsWith(";"))throw new E.vHH(4009,!1);return this.capture(p),new $n(dr(p),this.parseMatrixParams())}parseMatrixParams(){const p={};for(;this.consumeOptional(";");)this.parseParam(p);return p}parseParam(p){const d=Ve(this.remaining);if(!d)return;this.capture(d);let y="";if(this.consumeOptional("=")){const D=Ve(this.remaining);D&&(y=D,this.capture(y))}p[dr(d)]=dr(y)}parseQueryParam(p){const d=function Ft(f){const p=f.match(ct);return p?p[0]:""}(this.remaining);if(!d)return;this.capture(d);let y="";if(this.consumeOptional("=")){const H=function qn(f){const p=f.match(cn);return p?p[0]:""}(this.remaining);H&&(y=H,this.capture(y))}const D=_e(d),N=_e(y);if(p.hasOwnProperty(D)){let H=p[D];Array.isArray(H)||(H=[H],p[D]=H),H.push(N)}else p[D]=N}parseParens(p){const d={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const y=Ve(this.remaining),D=this.remaining[y.length];if("/"!==D&&")"!==D&&";"!==D)throw new E.vHH(4010,!1);let N;y.indexOf(":")>-1?(N=y.slice(0,y.indexOf(":")),this.capture(N),this.capture(":")):p&&(N=Te);const H=this.parseChildren();d[N]=1===Object.keys(H).length?H[Te]:new St([],H),this.consumeOptional("//")}return d}peekStartsWith(p){return this.remaining.startsWith(p)}consumeOptional(p){return!!this.peekStartsWith(p)&&(this.remaining=this.remaining.substring(p.length),!0)}capture(p){if(!this.consumeOptional(p))throw new E.vHH(4011,!1)}}function Yn(f){return f.segments.length>0?new St([],{[Te]:f}):f}function on(f){const p={};for(const y of Object.keys(f.children)){const N=on(f.children[y]);(N.segments.length>0||N.hasChildren())&&(p[y]=N)}return function Sr(f){if(1===f.numberOfChildren&&f.children[Te]){const p=f.children[Te];return new St(f.segments.concat(p.segments),p.children)}return f}(new St(f.segments,p))}function Pn(f){return f instanceof En}function sn(f,p,d,y,D){if(0===d.length)return Kn(p.root,p.root,p.root,y,D);const N=function Pr(f){if("string"==typeof f[0]&&1===f.length&&"/"===f[0])return new fr(!0,0,f);let p=0,d=!1;const y=f.reduce((D,N,H)=>{if("object"==typeof N&&null!=N){if(N.outlets){const Z={};return Me(N.outlets,(Ne,at)=>{Z[at]="string"==typeof Ne?Ne.split("/"):Ne}),[...D,{outlets:Z}]}if(N.segmentPath)return[...D,N.segmentPath]}return"string"!=typeof N?[...D,N]:0===H?(N.split("/").forEach((Z,Ne)=>{0==Ne&&"."===Z||(0==Ne&&""===Z?d=!0:".."===Z?p++:""!=Z&&D.push(Z))}),D):[...D,N]},[]);return new fr(d,p,y)}(d);return N.toRoot()?Kn(p.root,p.root,new St([],{}),y,D):function H(Ne){const at=function po(f,p,d,y){if(f.isAbsolute)return new Qt(p.root,!0,0);if(-1===y)return new Qt(d,d===p.root,0);return function Ar(f,p,d){let y=f,D=p,N=d;for(;N>D;){if(N-=D,y=y.parent,!y)throw new E.vHH(4005,!1);D=y.segments.length}return new Qt(y,!1,D-N)}(d,y+(Dn(f.commands[0])?0:1),f.numberOfDoubleDots)}(N,p,f.snapshot?._urlSegment,Ne),jt=at.processChildren?nr(at.segmentGroup,at.index,N.commands):pr(at.segmentGroup,at.index,N.commands);return Kn(p.root,at.segmentGroup,jt,y,D)}(f.snapshot?._lastPathIndex)}function Dn(f){return"object"==typeof f&&null!=f&&!f.outlets&&!f.segmentPath}function tr(f){return"object"==typeof f&&null!=f&&f.outlets}function Kn(f,p,d,y,D){let H,N={};y&&Me(y,(Ne,at)=>{N[at]=Array.isArray(Ne)?Ne.map(jt=>`${jt}`):`${Ne}`}),H=f===p?d:Gn(f,p,d);const Z=Yn(on(H));return new En(Z,N,D)}function Gn(f,p,d){const y={};return Me(f.children,(D,N)=>{y[N]=D===p?d:Gn(D,p,d)}),new St(f.segments,y)}class fr{constructor(p,d,y){if(this.isAbsolute=p,this.numberOfDoubleDots=d,this.commands=y,p&&y.length>0&&Dn(y[0]))throw new E.vHH(4003,!1);const D=y.find(tr);if(D&&D!==te(y))throw new E.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Qt{constructor(p,d,y){this.segmentGroup=p,this.processChildren=d,this.index=y}}function pr(f,p,d){if(f||(f=new St([],{})),0===f.segments.length&&f.hasChildren())return nr(f,p,d);const y=function Er(f,p,d){let y=0,D=p;const N={match:!1,pathIndex:0,commandIndex:0};for(;D<f.segments.length;){if(y>=d.length)return N;const H=f.segments[D],Z=d[y];if(tr(Z))break;const Ne=`${Z}`,at=y<d.length-1?d[y+1]:null;if(D>0&&void 0===Ne)break;if(Ne&&at&&"object"==typeof at&&void 0===at.outlets){if(!Jn(Ne,at,H))return N;y+=2}else{if(!Jn(Ne,{},H))return N;y++}D++}return{match:!0,pathIndex:D,commandIndex:y}}(f,p,d),D=d.slice(y.commandIndex);if(y.match&&y.pathIndex<f.segments.length){const N=new St(f.segments.slice(0,y.pathIndex),{});return N.children[Te]=new St(f.segments.slice(y.pathIndex),f.children),nr(N,0,D)}return y.match&&0===D.length?new St(f.segments,{}):y.match&&!f.hasChildren()?_n(f,p,d):y.match?nr(f,0,D):_n(f,p,d)}function nr(f,p,d){if(0===d.length)return new St(f.segments,{});{const y=function Gr(f){return tr(f[0])?f[0].outlets:{[Te]:f}}(d),D={};return Me(y,(N,H)=>{"string"==typeof N&&(N=[N]),null!==N&&(D[H]=pr(f.children[H],p,N))}),Me(f.children,(N,H)=>{void 0===y[H]&&(D[H]=N)}),new St(f.segments,D)}}function _n(f,p,d){const y=f.segments.slice(0,p);let D=0;for(;D<d.length;){const N=d[D];if(tr(N)){const Ne=ti(N.outlets);return new St(y,Ne)}if(0===D&&Dn(d[0])){y.push(new $n(f.segments[p].path,wn(d[0]))),D++;continue}const H=tr(N)?N.outlets[Te]:`${N}`,Z=D<d.length-1?d[D+1]:null;H&&Z&&Dn(Z)?(y.push(new $n(H,wn(Z))),D+=2):(y.push(new $n(H,{})),D++)}return new St(y,{})}function ti(f){const p={};return Me(f,(d,y)=>{"string"==typeof d&&(d=[d]),null!==d&&(p[y]=_n(new St([],{}),0,d))}),p}function wn(f){const p={};return Me(f,(d,y)=>p[y]=`${d}`),p}function Jn(f,p,d){return f==d.path&&an(p,d.parameters)}class Xn{constructor(p,d){this.id=p,this.url=d}}class Rr extends Xn{constructor(p,d,y="imperative",D=null){super(p,d),this.type=0,this.navigationTrigger=y,this.restoredState=D}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Zn extends Xn{constructor(p,d,y){super(p,d),this.urlAfterRedirects=y,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class un extends Xn{constructor(p,d,y,D){super(p,d),this.reason=y,this.code=D,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ho extends Xn{constructor(p,d,y,D){super(p,d),this.error=y,this.target=D,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ni extends Xn{constructor(p,d,y,D){super(p,d),this.urlAfterRedirects=y,this.state=D,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Co extends Xn{constructor(p,d,y,D){super(p,d),this.urlAfterRedirects=y,this.state=D,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class bo extends Xn{constructor(p,d,y,D,N){super(p,d),this.urlAfterRedirects=y,this.state=D,this.shouldActivate=N,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ri extends Xn{constructor(p,d,y,D){super(p,d),this.urlAfterRedirects=y,this.state=D,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class g extends Xn{constructor(p,d,y,D){super(p,d),this.urlAfterRedirects=y,this.state=D,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class r{constructor(p){this.route=p,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class I{constructor(p){this.route=p,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class c{constructor(p){this.snapshot=p,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class v{constructor(p){this.snapshot=p,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class h{constructor(p){this.snapshot=p,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class b{constructor(p){this.snapshot=p,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class C{constructor(p,d,y){this.routerEvent=p,this.position=d,this.anchor=y,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class P{constructor(p){this._root=p}get root(){return this._root.value}parent(p){const d=this.pathFromRoot(p);return d.length>1?d[d.length-2]:null}children(p){const d=F(p,this._root);return d?d.children.map(y=>y.value):[]}firstChild(p){const d=F(p,this._root);return d&&d.children.length>0?d.children[0].value:null}siblings(p){const d=j(p,this._root);return d.length<2?[]:d[d.length-2].children.map(D=>D.value).filter(D=>D!==p)}pathFromRoot(p){return j(p,this._root).map(d=>d.value)}}function F(f,p){if(f===p.value)return p;for(const d of p.children){const y=F(f,d);if(y)return y}return null}function j(f,p){if(f===p.value)return[p];for(const d of p.children){const y=j(f,d);if(y.length)return y.unshift(p),y}return[]}class u{constructor(p,d){this.value=p,this.children=d}toString(){return`TreeNode(${this.value})`}}function W(f){const p={};return f&&f.children.forEach(d=>p[d.value.outlet]=d),p}class Q extends P{constructor(p,d){super(p),this.snapshot=d,Pe(this,p)}toString(){return this.snapshot.toString()}}function ne(f,p){const d=function Oe(f,p){const H=new tt([],{},{},"",{},Te,p,null,f.root,-1,{});return new w("",new u(H,[]))}(f,p),y=new S([new $n("",{})]),D=new S({}),N=new S({}),H=new S({}),Z=new S(""),Ne=new $(y,D,H,Z,N,Te,p,d.root);return Ne.snapshot=d.root,new Q(new u(Ne,[]),d)}class ${constructor(p,d,y,D,N,H,Z,Ne){this.url=p,this.params=d,this.queryParams=y,this.fragment=D,this.data=N,this.outlet=H,this.component=Z,this._futureSnapshot=Ne}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ct.U)(p=>Mn(p)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ct.U)(p=>Mn(p)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ie(f,p="emptyOnly"){const d=f.pathFromRoot;let y=0;if("always"!==p)for(y=d.length-1;y>=1;){const D=d[y],N=d[y-1];if(D.routeConfig&&""===D.routeConfig.path)y--;else{if(N.component)break;y--}}return function We(f){return f.reduce((p,d)=>({params:{...p.params,...d.params},data:{...p.data,...d.data},resolve:{...d.data,...p.resolve,...d.routeConfig?.data,...d._resolvedData}}),{params:{},data:{},resolve:{}})}(d.slice(y))}class tt{constructor(p,d,y,D,N,H,Z,Ne,at,jt,pt,ln){this.url=p,this.params=d,this.queryParams=y,this.fragment=D,this.data=N,this.outlet=H,this.component=Z,this.routeConfig=Ne,this._urlSegment=at,this._lastPathIndex=jt,this._correctedLastPathIndex=ln??jt,this._resolve=pt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Mn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Mn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(y=>y.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class w extends P{constructor(p,d){super(d),this.url=p,Pe(this,d)}toString(){return qe(this._root)}}function Pe(f,p){p.value._routerState=f,p.children.forEach(d=>Pe(f,d))}function qe(f){const p=f.children.length>0?` { ${f.children.map(qe).join(", ")} } `:"";return`${f.value}${p}`}function Ee(f){if(f.snapshot){const p=f.snapshot,d=f._futureSnapshot;f.snapshot=d,an(p.queryParams,d.queryParams)||f.queryParams.next(d.queryParams),p.fragment!==d.fragment&&f.fragment.next(d.fragment),an(p.params,d.params)||f.params.next(d.params),function Nn(f,p){if(f.length!==p.length)return!1;for(let d=0;d<f.length;++d)if(!an(f[d],p[d]))return!1;return!0}(p.url,d.url)||f.url.next(d.url),an(p.data,d.data)||f.data.next(d.data)}else f.snapshot=f._futureSnapshot,f.data.next(f._futureSnapshot.data)}function ut(f,p){const d=an(f.params,p.params)&&function yr(f,p){return In(f,p)&&f.every((d,y)=>an(d.parameters,p[y].parameters))}(f.url,p.url);return d&&!(!f.parent!=!p.parent)&&(!f.parent||ut(f.parent,p.parent))}function Ae(f,p,d){if(d&&f.shouldReuseRoute(p.value,d.value.snapshot)){const y=d.value;y._futureSnapshot=p.value;const D=function nt(f,p,d){return p.children.map(y=>{for(const D of d.children)if(f.shouldReuseRoute(y.value,D.value.snapshot))return Ae(f,y,D);return Ae(f,y)})}(f,p,d);return new u(y,D)}{if(f.shouldAttach(p.value)){const N=f.retrieve(p.value);if(null!==N){const H=N.route;return H.value._futureSnapshot=p.value,H.children=p.children.map(Z=>Ae(f,Z)),H}}const y=function st(f){return new $(new S(f.url),new S(f.params),new S(f.queryParams),new S(f.fragment),new S(f.data),f.outlet,f.component,f)}(p.value),D=p.children.map(N=>Ae(f,N));return new u(y,D)}}const dt="ngNavigationCancelingError";function yt(f,p){const{redirectTo:d,navigationBehaviorOptions:y}=Pn(p)?{redirectTo:p,navigationBehaviorOptions:void 0}:p,D=mt(!1,0,p);return D.url=d,D.navigationBehaviorOptions=y,D}function mt(f,p,d){const y=new Error("NavigationCancelingError: "+(f||""));return y[dt]=!0,y.cancellationCode=p,d&&(y.url=d),y}function It(f){return vt(f)&&Pn(f.url)}function vt(f){return f&&f[dt]}class Pt{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new T,this.attachRef=null}}let T=(()=>{class f{constructor(){this.contexts=new Map}onChildOutletCreated(d,y){const D=this.getOrCreateContext(d);D.outlet=y,this.contexts.set(d,D)}onChildOutletDestroyed(d){const y=this.getContext(d);y&&(y.outlet=null,y.attachRef=null)}onOutletDeactivated(){const d=this.contexts;return this.contexts=new Map,d}onOutletReAttached(d){this.contexts=d}getOrCreateContext(d){let y=this.getContext(d);return y||(y=new Pt,this.contexts.set(d,y)),y}getContext(d){return this.contexts.get(d)||null}}return f.\u0275fac=function(d){return new(d||f)},f.\u0275prov=E.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();const k=!1;let A=(()=>{class f{constructor(d,y,D,N,H){this.parentContexts=d,this.location=y,this.changeDetector=N,this.environmentInjector=H,this.activated=null,this._activatedRoute=null,this.activateEvents=new E.vpe,this.deactivateEvents=new E.vpe,this.attachEvents=new E.vpe,this.detachEvents=new E.vpe,this.name=D||Te,d.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const d=this.parentContexts.getContext(this.name);d&&d.route&&(d.attachRef?this.attach(d.attachRef,d.route):this.activateWith(d.route,d.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new E.vHH(4012,k);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new E.vHH(4012,k);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new E.vHH(4012,k);this.location.detach();const d=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(d.instance),d}attach(d,y){this.activated=d,this._activatedRoute=y,this.location.insert(d.hostView),this.attachEvents.emit(d.instance)}deactivate(){if(this.activated){const d=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(d)}}activateWith(d,y){if(this.isActivated)throw new E.vHH(4013,k);this._activatedRoute=d;const D=this.location,H=d._futureSnapshot.component,Z=this.parentContexts.getOrCreateContext(this.name).children,Ne=new V(d,Z,D.injector);if(y&&function fe(f){return!!f.resolveComponentFactory}(y)){const at=y.resolveComponentFactory(H);this.activated=D.createComponent(at,D.length,Ne)}else this.activated=D.createComponent(H,{index:D.length,injector:Ne,environmentInjector:y??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return f.\u0275fac=function(d){return new(d||f)(E.Y36(T),E.Y36(E.s_b),E.$8M("name"),E.Y36(E.sBO),E.Y36(E.lqb))},f.\u0275dir=E.lG2({type:f,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),f})();class V{constructor(p,d,y){this.route=p,this.childContexts=d,this.parent=y}get(p,d){return p===$?this.route:p===T?this.childContexts:this.parent.get(p,d)}}let Ue=(()=>{class f{}return f.\u0275fac=function(d){return new(d||f)},f.\u0275cmp=E.Xpm({type:f,selectors:[["ng-component"]],decls:1,vars:0,template:function(d,y){1&d&&E._UZ(0,"router-outlet")},dependencies:[A],encapsulation:2}),f})();function Qe(f,p){return f.providers&&!f._injector&&(f._injector=(0,E.MMx)(f.providers,p,`Route: ${f.path}`)),f._injector??p}function Or(f){const p=f.children&&f.children.map(Or),d=p?{...f,children:p}:{...f};return!d.component&&!d.loadComponent&&(p||d.loadChildren)&&d.outlet&&d.outlet!==Te&&(d.component=Ue),d}function Fn(f){return f.outlet||Te}function oo(f,p){const d=f.filter(y=>Fn(y)===p);return d.push(...f.filter(y=>Fn(y)!==p)),d}function xr(f){if(!f)return null;if(f.routeConfig?._injector)return f.routeConfig._injector;for(let p=f.parent;p;p=p.parent){const d=p.routeConfig;if(d?._loadedInjector)return d._loadedInjector;if(d?._injector)return d._injector}return null}class go{constructor(p,d,y,D){this.routeReuseStrategy=p,this.futureState=d,this.currState=y,this.forwardEvent=D}activate(p){const d=this.futureState._root,y=this.currState?this.currState._root:null;this.deactivateChildRoutes(d,y,p),Ee(this.futureState.root),this.activateChildRoutes(d,y,p)}deactivateChildRoutes(p,d,y){const D=W(d);p.children.forEach(N=>{const H=N.value.outlet;this.deactivateRoutes(N,D[H],y),delete D[H]}),Me(D,(N,H)=>{this.deactivateRouteAndItsChildren(N,y)})}deactivateRoutes(p,d,y){const D=p.value,N=d?d.value:null;if(D===N)if(D.component){const H=y.getContext(D.outlet);H&&this.deactivateChildRoutes(p,d,H.children)}else this.deactivateChildRoutes(p,d,y);else N&&this.deactivateRouteAndItsChildren(d,y)}deactivateRouteAndItsChildren(p,d){p.value.component&&this.routeReuseStrategy.shouldDetach(p.value.snapshot)?this.detachAndStoreRouteSubtree(p,d):this.deactivateRouteAndOutlet(p,d)}detachAndStoreRouteSubtree(p,d){const y=d.getContext(p.value.outlet),D=y&&p.value.component?y.children:d,N=W(p);for(const H of Object.keys(N))this.deactivateRouteAndItsChildren(N[H],D);if(y&&y.outlet){const H=y.outlet.detach(),Z=y.children.onOutletDeactivated();this.routeReuseStrategy.store(p.value.snapshot,{componentRef:H,route:p,contexts:Z})}}deactivateRouteAndOutlet(p,d){const y=d.getContext(p.value.outlet),D=y&&p.value.component?y.children:d,N=W(p);for(const H of Object.keys(N))this.deactivateRouteAndItsChildren(N[H],D);y&&y.outlet&&(y.outlet.deactivate(),y.children.onOutletDeactivated(),y.attachRef=null,y.resolver=null,y.route=null)}activateChildRoutes(p,d,y){const D=W(d);p.children.forEach(N=>{this.activateRoutes(N,D[N.value.outlet],y),this.forwardEvent(new b(N.value.snapshot))}),p.children.length&&this.forwardEvent(new v(p.value.snapshot))}activateRoutes(p,d,y){const D=p.value,N=d?d.value:null;if(Ee(D),D===N)if(D.component){const H=y.getOrCreateContext(D.outlet);this.activateChildRoutes(p,d,H.children)}else this.activateChildRoutes(p,d,y);else if(D.component){const H=y.getOrCreateContext(D.outlet);if(this.routeReuseStrategy.shouldAttach(D.snapshot)){const Z=this.routeReuseStrategy.retrieve(D.snapshot);this.routeReuseStrategy.store(D.snapshot,null),H.children.onOutletReAttached(Z.contexts),H.attachRef=Z.componentRef,H.route=Z.route.value,H.outlet&&H.outlet.attach(Z.componentRef,Z.route.value),Ee(Z.route.value),this.activateChildRoutes(p,null,H.children)}else{const Z=xr(D.snapshot),Ne=Z?.get(E._Vd)??null;H.attachRef=null,H.route=D,H.resolver=Ne,H.injector=Z,H.outlet&&H.outlet.activateWith(D,H.injector),this.activateChildRoutes(p,null,H.children)}}else this.activateChildRoutes(p,null,y)}}class To{constructor(p){this.path=p,this.route=this.path[this.path.length-1]}}class ii{constructor(p,d){this.component=p,this.route=d}}function et(f,p,d){const y=f._root;return wo(y,p?p._root:null,d,[y.value])}function si(f,p,d){return(xr(p)??d).get(f)}function wo(f,p,d,y,D={canDeactivateChecks:[],canActivateChecks:[]}){const N=W(p);return f.children.forEach(H=>{(function Vn(f,p,d,y,D={canDeactivateChecks:[],canActivateChecks:[]}){const N=f.value,H=p?p.value:null,Z=d?d.getContext(f.value.outlet):null;if(H&&N.routeConfig===H.routeConfig){const Ne=function Xs(f,p,d){if("function"==typeof d)return d(f,p);switch(d){case"pathParamsChange":return!In(f.url,p.url);case"pathParamsOrQueryParamsChange":return!In(f.url,p.url)||!an(f.queryParams,p.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ut(f,p)||!an(f.queryParams,p.queryParams);default:return!ut(f,p)}}(H,N,N.routeConfig.runGuardsAndResolvers);Ne?D.canActivateChecks.push(new To(y)):(N.data=H.data,N._resolvedData=H._resolvedData),wo(f,p,N.component?Z?Z.children:null:d,y,D),Ne&&Z&&Z.outlet&&Z.outlet.isActivated&&D.canDeactivateChecks.push(new ii(Z.outlet.component,H))}else H&&kr(p,Z,D),D.canActivateChecks.push(new To(y)),wo(f,null,N.component?Z?Z.children:null:d,y,D)})(H,N[H.value.outlet],d,y.concat([H.value]),D),delete N[H.value.outlet]}),Me(N,(H,Z)=>kr(H,d.getContext(Z),D)),D}function kr(f,p,d){const y=W(f),D=f.value;Me(y,(N,H)=>{kr(N,D.component?p?p.children.getContext(H):null:p,d)}),d.canDeactivateChecks.push(new ii(D.component&&p&&p.outlet&&p.outlet.isActivated?p.outlet.component:null,D))}function rr(f){return"function"==typeof f}function ci(f){return f instanceof ae||"EmptyError"===f?.name}const Fr=Symbol("INITIAL_VALUE");function ir(){return ve(f=>z(f.map(p=>p.pipe(re(1),function it(...f){const p=(0,Y.yG)(f);return(0,Se.e)((d,y)=>{(p?Fe(f,d,p):Fe(f,d)).subscribe(y)})}(Fr)))).pipe((0,Ct.U)(p=>{for(const d of p)if(!0!==d){if(d===Fr)return Fr;if(!1===d||d instanceof En)return d}return!0}),(0,ft.h)(p=>p!==Fr),re(1)))}function ss(f){return(0,he.z)(qt(p=>{if(Pn(p))throw yt(0,p)}),(0,Ct.U)(p=>!0===p))}const ui={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function cs(f,p,d,y,D){const N=li(f,p,d);return N.matched?function as(f,p,d,y){const D=p.canMatch;if(!D||0===D.length)return(0,J.of)(!0);const N=D.map(H=>{const Z=f.get(H),Ne=function ai(f){return f&&rr(f.canMatch)}(Z)?Z.canMatch(p,d):Z(p,d);return Ke(Ne)});return(0,J.of)(N).pipe(ir(),ss())}(y=Qe(p,y),p,d).pipe((0,Ct.U)(H=>!0===H?N:{...ui})):(0,J.of)(N)}function li(f,p,d){if(""===p.path)return"full"===p.pathMatch&&(f.hasChildren()||d.length>0)?{...ui}:{matched:!0,consumedSegments:[],remainingSegments:d,parameters:{},positionalParamSegments:{}};const D=(p.matcher||nn)(d,f,p);if(!D)return{...ui};const N={};Me(D.posParams,(Z,Ne)=>{N[Ne]=Z.path});const H=D.consumed.length>0?{...N,...D.consumed[D.consumed.length-1].parameters}:N;return{matched:!0,consumedSegments:D.consumed,remainingSegments:d.slice(D.consumed.length),parameters:H,positionalParamSegments:D.posParams??{}}}function Ao(f,p,d,y,D="corrected"){if(d.length>0&&function sc(f,p,d){return d.some(y=>Ir(f,p,y)&&Fn(y)!==Te)}(f,d,y)){const H=new St(p,function ic(f,p,d,y){const D={};D[Te]=y,y._sourceSegment=f,y._segmentIndexShift=p.length;for(const N of d)if(""===N.path&&Fn(N)!==Te){const H=new St([],{});H._sourceSegment=f,H._segmentIndexShift=p.length,D[Fn(N)]=H}return D}(f,p,y,new St(d,f.children)));return H._sourceSegment=f,H._segmentIndexShift=p.length,{segmentGroup:H,slicedSegments:[]}}if(0===d.length&&function er(f,p,d){return d.some(y=>Ir(f,p,y))}(f,d,y)){const H=new St(f.segments,function us(f,p,d,y,D,N){const H={};for(const Z of y)if(Ir(f,d,Z)&&!D[Fn(Z)]){const Ne=new St([],{});Ne._sourceSegment=f,Ne._segmentIndexShift="legacy"===N?f.segments.length:p.length,H[Fn(Z)]=Ne}return{...D,...H}}(f,p,d,y,f.children,D));return H._sourceSegment=f,H._segmentIndexShift=p.length,{segmentGroup:H,slicedSegments:d}}const N=new St(f.segments,f.children);return N._sourceSegment=f,N._segmentIndexShift=p.length,{segmentGroup:N,slicedSegments:d}}function Ir(f,p,d){return(!(f.hasChildren()||p.length>0)||"full"!==d.pathMatch)&&""===d.path}function An(f,p,d,y){return!!(Fn(f)===y||y!==Te&&Ir(p,d,f))&&("**"===f.path||li(p,f,d).matched)}function ta(f,p,d){return 0===p.length&&!f.children[d]}const di=!1;class fi{constructor(p){this.segmentGroup=p||null}}class na{constructor(p){this.urlTree=p}}function Ro(f){return me(new fi(f))}function ra(f){return me(new na(f))}class ls{constructor(p,d,y,D,N){this.injector=p,this.configLoader=d,this.urlSerializer=y,this.urlTree=D,this.config=N,this.allowRedirects=!0}apply(){const p=Ao(this.urlTree.root,[],[],this.config).segmentGroup,d=new St(p.segments,p.children);return this.expandSegmentGroup(this.injector,this.config,d,Te).pipe((0,Ct.U)(N=>this.createUrlTree(on(N),this.urlTree.queryParams,this.urlTree.fragment))).pipe(At(N=>{if(N instanceof na)return this.allowRedirects=!1,this.match(N.urlTree);throw N instanceof fi?this.noMatchError(N):N}))}match(p){return this.expandSegmentGroup(this.injector,this.config,p.root,Te).pipe((0,Ct.U)(D=>this.createUrlTree(on(D),p.queryParams,p.fragment))).pipe(At(D=>{throw D instanceof fi?this.noMatchError(D):D}))}noMatchError(p){return new E.vHH(4002,di)}createUrlTree(p,d,y){const D=Yn(p);return new En(D,d,y)}expandSegmentGroup(p,d,y,D){return 0===y.segments.length&&y.hasChildren()?this.expandChildren(p,d,y).pipe((0,Ct.U)(N=>new St([],N))):this.expandSegment(p,y,d,y.segments,D,!0)}expandChildren(p,d,y){const D=[];for(const N of Object.keys(y.children))"primary"===N?D.unshift(N):D.push(N);return(0,ce.D)(D).pipe((0,On.b)(N=>{const H=y.children[N],Z=oo(d,N);return this.expandSegmentGroup(p,Z,H,N).pipe((0,Ct.U)(Ne=>({segment:Ne,outlet:N})))}),tn((N,H)=>(N[H.outlet]=H.segment,N),{}),jn())}expandSegment(p,d,y,D,N,H){return(0,ce.D)(y).pipe((0,On.b)(Z=>this.expandSegmentAgainstRoute(p,d,y,Z,D,N,H).pipe(At(at=>{if(at instanceof fi)return(0,J.of)(null);throw at}))),Vt(Z=>!!Z),At((Z,Ne)=>{if(ci(Z))return ta(d,D,N)?(0,J.of)(new St([],{})):Ro(d);throw Z}))}expandSegmentAgainstRoute(p,d,y,D,N,H,Z){return An(D,d,N,H)?void 0===D.redirectTo?this.matchSegmentAgainstRoute(p,d,D,N,H):Z&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(p,d,y,D,N,H):Ro(d):Ro(d)}expandSegmentAgainstRouteUsingRedirect(p,d,y,D,N,H){return"**"===D.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(p,y,D,H):this.expandRegularSegmentAgainstRouteUsingRedirect(p,d,y,D,N,H)}expandWildCardWithParamsAgainstRouteUsingRedirect(p,d,y,D){const N=this.applyRedirectCommands([],y.redirectTo,{});return y.redirectTo.startsWith("/")?ra(N):this.lineralizeSegments(y,N).pipe((0,hn.z)(H=>{const Z=new St(H,{});return this.expandSegment(p,Z,d,H,D,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(p,d,y,D,N,H){const{matched:Z,consumedSegments:Ne,remainingSegments:at,positionalParamSegments:jt}=li(d,D,N);if(!Z)return Ro(d);const pt=this.applyRedirectCommands(Ne,D.redirectTo,jt);return D.redirectTo.startsWith("/")?ra(pt):this.lineralizeSegments(D,pt).pipe((0,hn.z)(ln=>this.expandSegment(p,d,y,ln.concat(at),H,!1)))}matchSegmentAgainstRoute(p,d,y,D,N){return"**"===y.path?(p=Qe(y,p),y.loadChildren?(y._loadedRoutes?(0,J.of)({routes:y._loadedRoutes,injector:y._loadedInjector}):this.configLoader.loadChildren(p,y)).pipe((0,Ct.U)(Z=>(y._loadedRoutes=Z.routes,y._loadedInjector=Z.injector,new St(D,{})))):(0,J.of)(new St(D,{}))):cs(d,y,D,p).pipe(ve(({matched:H,consumedSegments:Z,remainingSegments:Ne})=>H?this.getChildConfig(p=y._injector??p,y,D).pipe((0,hn.z)(jt=>{const pt=jt.injector??p,ln=jt.routes,{segmentGroup:sr,slicedSegments:Ur}=Ao(d,Z,Ne,ln),ao=new St(sr.segments,sr.children);if(0===Ur.length&&ao.hasChildren())return this.expandChildren(pt,ln,ao).pipe((0,Ct.U)(Go=>new St(Z,Go)));if(0===ln.length&&0===Ur.length)return(0,J.of)(new St(Z,{}));const gr=Fn(y)===N;return this.expandSegment(pt,ao,ln,Ur,gr?Te:N,!0).pipe((0,Ct.U)(Ti=>new St(Z.concat(Ti.segments),Ti.children)))})):Ro(d)))}getChildConfig(p,d,y){return d.children?(0,J.of)({routes:d.children,injector:p}):d.loadChildren?void 0!==d._loadedRoutes?(0,J.of)({routes:d._loadedRoutes,injector:d._loadedInjector}):function oc(f,p,d,y){const D=p.canLoad;if(void 0===D||0===D.length)return(0,J.of)(!0);const N=D.map(H=>{const Z=f.get(H),Ne=function ns(f){return f&&rr(f.canLoad)}(Z)?Z.canLoad(p,d):Z(p,d);return Ke(Ne)});return(0,J.of)(N).pipe(ir(),ss())}(p,d,y).pipe((0,hn.z)(D=>D?this.configLoader.loadChildren(p,d).pipe(qt(N=>{d._loadedRoutes=N.routes,d._loadedInjector=N.injector})):function hi(f){return me(mt(di,3))}())):(0,J.of)({routes:[],injector:p})}lineralizeSegments(p,d){let y=[],D=d.root;for(;;){if(y=y.concat(D.segments),0===D.numberOfChildren)return(0,J.of)(y);if(D.numberOfChildren>1||!D.children[Te])return me(new E.vHH(4e3,di));D=D.children[Te]}}applyRedirectCommands(p,d,y){return this.applyRedirectCreateUrlTree(d,this.urlSerializer.parse(d),p,y)}applyRedirectCreateUrlTree(p,d,y,D){const N=this.createSegmentGroup(p,d.root,y,D);return new En(N,this.createQueryParams(d.queryParams,this.urlTree.queryParams),d.fragment)}createQueryParams(p,d){const y={};return Me(p,(D,N)=>{if("string"==typeof D&&D.startsWith(":")){const Z=D.substring(1);y[N]=d[Z]}else y[N]=D}),y}createSegmentGroup(p,d,y,D){const N=this.createSegments(p,d.segments,y,D);let H={};return Me(d.children,(Z,Ne)=>{H[Ne]=this.createSegmentGroup(p,Z,y,D)}),new St(N,H)}createSegments(p,d,y,D){return d.map(N=>N.path.startsWith(":")?this.findPosParam(p,N,D):this.findOrReturn(N,y))}findPosParam(p,d,y){const D=y[d.path.substring(1)];if(!D)throw new E.vHH(4001,di);return D}findOrReturn(p,d){let y=0;for(const D of d){if(D.path===p.path)return d.splice(y),D;y++}return p}}class zr{}class cc{constructor(p,d,y,D,N,H,Z,Ne){this.injector=p,this.rootComponentType=d,this.config=y,this.urlTree=D,this.url=N,this.paramsInheritanceStrategy=H,this.relativeLinkResolution=Z,this.urlSerializer=Ne}recognize(){const p=Ao(this.urlTree.root,[],[],this.config.filter(d=>void 0===d.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,p,Te).pipe((0,Ct.U)(d=>{if(null===d)return null;const y=new tt([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Te,this.rootComponentType,null,this.urlTree.root,-1,{}),D=new u(y,d),N=new w(this.url,D);return this.inheritParamsAndData(N._root),N}))}inheritParamsAndData(p){const d=p.value,y=Ie(d,this.paramsInheritanceStrategy);d.params=Object.freeze(y.params),d.data=Object.freeze(y.data),p.children.forEach(D=>this.inheritParamsAndData(D))}processSegmentGroup(p,d,y,D){return 0===y.segments.length&&y.hasChildren()?this.processChildren(p,d,y):this.processSegment(p,d,y,y.segments,D)}processChildren(p,d,y){return(0,ce.D)(Object.keys(y.children)).pipe((0,On.b)(D=>{const N=y.children[D],H=oo(d,D);return this.processSegmentGroup(p,H,N,D)}),tn((D,N)=>D&&N?(D.push(...N),D):null),function Ut(f,p=!1){return(0,Se.e)((d,y)=>{let D=0;d.subscribe((0,je.x)(y,N=>{const H=f(N,D++);(H||p)&&y.next(N),!H&&y.complete()}))})}(D=>null!==D),Ye(null),jn(),(0,Ct.U)(D=>{if(null===D)return null;const N=ia(D);return function Mo(f){f.sort((p,d)=>p.value.outlet===Te?-1:d.value.outlet===Te?1:p.value.outlet.localeCompare(d.value.outlet))}(N),N}))}processSegment(p,d,y,D,N){return(0,ce.D)(d).pipe((0,On.b)(H=>this.processSegmentAgainstRoute(H._injector??p,H,y,D,N)),Vt(H=>!!H),At(H=>{if(ci(H))return ta(y,D,N)?(0,J.of)([]):(0,J.of)(null);throw H}))}processSegmentAgainstRoute(p,d,y,D,N){if(d.redirectTo||!An(d,y,D,N))return(0,J.of)(null);let H;if("**"===d.path){const Z=D.length>0?te(D).parameters:{},Ne=No(y)+D.length,at=new tt(D,Z,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ps(d),Fn(d),d.component??d._loadedComponent??null,d,lc(y),Ne,Po(d),Ne);H=(0,J.of)({snapshot:at,consumedSegments:[],remainingSegments:[]})}else H=cs(y,d,D,p).pipe((0,Ct.U)(({matched:Z,consumedSegments:Ne,remainingSegments:at,parameters:jt})=>{if(!Z)return null;const pt=No(y)+Ne.length;return{snapshot:new tt(Ne,jt,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ps(d),Fn(d),d.component??d._loadedComponent??null,d,lc(y),pt,Po(d),pt),consumedSegments:Ne,remainingSegments:at}}));return H.pipe(ve(Z=>{if(null===Z)return(0,J.of)(null);const{snapshot:Ne,consumedSegments:at,remainingSegments:jt}=Z;p=d._injector??p;const pt=d._loadedInjector??p,ln=function ds(f){return f.children?f.children:f.loadChildren?f._loadedRoutes:[]}(d),{segmentGroup:sr,slicedSegments:Ur}=Ao(y,at,jt,ln.filter(gr=>void 0===gr.redirectTo),this.relativeLinkResolution);if(0===Ur.length&&sr.hasChildren())return this.processChildren(pt,ln,sr).pipe((0,Ct.U)(gr=>null===gr?null:[new u(Ne,gr)]));if(0===ln.length&&0===Ur.length)return(0,J.of)([new u(Ne,[])]);const ao=Fn(d)===N;return this.processSegment(pt,ln,sr,Ur,ao?Te:N).pipe((0,Ct.U)(gr=>null===gr?null:[new u(Ne,gr)]))}))}}function uc(f){const p=f.value.routeConfig;return p&&""===p.path&&void 0===p.redirectTo}function ia(f){const p=[],d=new Set;for(const y of f){if(!uc(y)){p.push(y);continue}const D=p.find(N=>y.value.routeConfig===N.value.routeConfig);void 0!==D?(D.children.push(...y.children),d.add(D)):p.push(y)}for(const y of d){const D=ia(y.children);p.push(new u(y.value,D))}return p.filter(y=>!d.has(y))}function lc(f){let p=f;for(;p._sourceSegment;)p=p._sourceSegment;return p}function No(f){let p=f,d=p._segmentIndexShift??0;for(;p._sourceSegment;)p=p._sourceSegment,d+=p._segmentIndexShift??0;return d-1}function ps(f){return f.data||{}}function Po(f){return f.resolve||{}}const vi=Symbol("RouteTitle");function fc(f){return"string"==typeof f.title||null===f.title}function _i(f){return ve(p=>{const d=f(p);return d?(0,ce.D)(d).pipe((0,Ct.U)(()=>p)):(0,J.of)(p)})}let gs=(()=>{class f{buildTitle(d){let y,D=d.root;for(;void 0!==D;)y=this.getResolvedTitleForRoute(D)??y,D=D.children.find(N=>N.outlet===Te);return y}getResolvedTitleForRoute(d){return d.data[vi]}}return f.\u0275fac=function(d){return new(d||f)},f.\u0275prov=E.Yz7({token:f,factory:function(){return(0,E.f3M)(aa)},providedIn:"root"}),f})(),aa=(()=>{class f extends gs{constructor(d){super(),this.title=d}updateTitle(d){const y=this.buildTitle(d);void 0!==y&&this.title.setTitle(y)}}return f.\u0275fac=function(d){return new(d||f)(E.LFG(zt.Dx))},f.\u0275prov=E.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();class pc{}class ms extends class xo{shouldDetach(p){return!1}store(p,d){}shouldAttach(p){return!1}retrieve(p){return null}shouldReuseRoute(p,d){return p.routeConfig===d.routeConfig}}{}const yo=new E.OlP("",{providedIn:"root",factory:()=>({})}),ys=new E.OlP("ROUTES");let Si=(()=>{class f{constructor(d,y){this.injector=d,this.compiler=y,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(d){if(this.componentLoaders.get(d))return this.componentLoaders.get(d);if(d._loadedComponent)return(0,J.of)(d._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(d);const y=Ke(d.loadComponent()).pipe(qt(N=>{this.onLoadEndListener&&this.onLoadEndListener(d),d._loadedComponent=N}),bn(()=>{this.componentLoaders.delete(d)})),D=new oe(y,()=>new M.x).pipe(Be());return this.componentLoaders.set(d,D),D}loadChildren(d,y){if(this.childrenLoaders.get(y))return this.childrenLoaders.get(y);if(y._loadedRoutes)return(0,J.of)({routes:y._loadedRoutes,injector:y._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(y);const N=this.loadModuleFactoryOrRoutes(y.loadChildren).pipe((0,Ct.U)(Z=>{this.onLoadEndListener&&this.onLoadEndListener(y);let Ne,at,jt=!1;Array.isArray(Z)?at=Z:(Ne=Z.create(d).injector,at=le(Ne.get(ys,[],E.XFs.Self|E.XFs.Optional)));return{routes:at.map(Or),injector:Ne}}),bn(()=>{this.childrenLoaders.delete(y)})),H=new oe(N,()=>new M.x).pipe(Be());return this.childrenLoaders.set(y,H),H}loadModuleFactoryOrRoutes(d){return Ke(d()).pipe((0,hn.z)(y=>y instanceof E.YKP||Array.isArray(y)?(0,J.of)(y):(0,ce.D)(this.compiler.compileModuleAsync(y))))}}return f.\u0275fac=function(d){return new(d||f)(E.LFG(E.zs3),E.LFG(E.Sil))},f.\u0275prov=E.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})();class ca{}class ua{shouldProcessUrl(p){return!0}extract(p){return p}merge(p,d){return p}}function hc(f){throw f}function Ei(f,p,d){return p.parse("/")}const Fo={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},gc={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function _s(){const f=(0,E.f3M)(eo),p=(0,E.f3M)(T),d=(0,E.f3M)(Ze.Ye),y=(0,E.f3M)(E.zs3),D=(0,E.f3M)(E.Sil),N=(0,E.f3M)(ys,{optional:!0})??[],H=(0,E.f3M)(yo,{optional:!0})??{},Z=(0,E.f3M)(aa),Ne=(0,E.f3M)(gs,{optional:!0}),at=(0,E.f3M)(ca,{optional:!0}),jt=(0,E.f3M)(pc,{optional:!0}),pt=new xn(null,f,p,d,y,D,le(N));return at&&(pt.urlHandlingStrategy=at),jt&&(pt.routeReuseStrategy=jt),pt.titleStrategy=Ne??Z,function la(f,p){f.errorHandler&&(p.errorHandler=f.errorHandler),f.malformedUriErrorHandler&&(p.malformedUriErrorHandler=f.malformedUriErrorHandler),f.onSameUrlNavigation&&(p.onSameUrlNavigation=f.onSameUrlNavigation),f.paramsInheritanceStrategy&&(p.paramsInheritanceStrategy=f.paramsInheritanceStrategy),f.relativeLinkResolution&&(p.relativeLinkResolution=f.relativeLinkResolution),f.urlUpdateStrategy&&(p.urlUpdateStrategy=f.urlUpdateStrategy),f.canceledNavigationResolution&&(p.canceledNavigationResolution=f.canceledNavigationResolution)}(H,pt),pt}let xn=(()=>{class f{constructor(d,y,D,N,H,Z,Ne){this.rootComponentType=d,this.urlSerializer=y,this.rootContexts=D,this.location=N,this.config=Ne,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new M.x,this.errorHandler=hc,this.malformedUriErrorHandler=Ei,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>(0,J.of)(void 0),this.urlHandlingStrategy=new ua,this.routeReuseStrategy=new ms,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=H.get(Si),this.configLoader.onLoadEndListener=ln=>this.triggerEvent(new I(ln)),this.configLoader.onLoadStartListener=ln=>this.triggerEvent(new r(ln)),this.ngModule=H.get(E.h0i),this.console=H.get(E.c2e);const pt=H.get(E.R0b);this.isNgZoneEnabled=pt instanceof E.R0b&&E.R0b.isInAngularZone(),this.resetConfig(Ne),this.currentUrlTree=function Nt(){return new En(new St([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=ne(this.currentUrlTree,this.rootComponentType),this.transitions=new S({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(d){const y=this.events;return d.pipe((0,ft.h)(D=>0!==D.id),(0,Ct.U)(D=>({...D,extractedUrl:this.urlHandlingStrategy.extract(D.rawUrl)})),ve(D=>{let N=!1,H=!1;return(0,J.of)(D).pipe(qt(Z=>{this.currentNavigation={id:Z.id,initialUrl:Z.rawUrl,extractedUrl:Z.extractedUrl,trigger:Z.source,extras:Z.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ve(Z=>{const Ne=this.browserUrlTree.toString(),at=!this.navigated||Z.extractedUrl.toString()!==Ne||Ne!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||at)&&this.urlHandlingStrategy.shouldProcessUrl(Z.rawUrl))return Ss(Z.source)&&(this.browserUrlTree=Z.extractedUrl),(0,J.of)(Z).pipe(ve(pt=>{const ln=this.transitions.getValue();return y.next(new Rr(pt.id,this.serializeUrl(pt.extractedUrl),pt.source,pt.restoredState)),ln!==this.transitions.getValue()?de.E:Promise.resolve(pt)}),function oa(f,p,d,y){return ve(D=>function gi(f,p,d,y,D){return new ls(f,p,d,y,D).apply()}(f,p,d,D.extractedUrl,y).pipe((0,Ct.U)(N=>({...D,urlAfterRedirects:N}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),qt(pt=>{this.currentNavigation={...this.currentNavigation,finalUrl:pt.urlAfterRedirects},D.urlAfterRedirects=pt.urlAfterRedirects}),function sa(f,p,d,y,D,N){return(0,hn.z)(H=>function ac(f,p,d,y,D,N,H="emptyOnly",Z="legacy"){return new cc(f,p,d,y,D,H,Z,N).recognize().pipe(ve(Ne=>null===Ne?function Oo(f){return new De.y(p=>p.error(f))}(new zr):(0,J.of)(Ne)))}(f,p,d,H.urlAfterRedirects,y.serialize(H.urlAfterRedirects),y,D,N).pipe((0,Ct.U)(Z=>({...H,targetSnapshot:Z}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),qt(pt=>{if(D.targetSnapshot=pt.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!pt.extras.skipLocationChange){const sr=this.urlHandlingStrategy.merge(pt.urlAfterRedirects,pt.rawUrl);this.setBrowserUrl(sr,pt)}this.browserUrlTree=pt.urlAfterRedirects}const ln=new ni(pt.id,this.serializeUrl(pt.extractedUrl),this.serializeUrl(pt.urlAfterRedirects),pt.targetSnapshot);y.next(ln)}));if(at&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:ln,extractedUrl:sr,source:Ur,restoredState:ao,extras:gr}=Z,Wo=new Rr(ln,this.serializeUrl(sr),Ur,ao);y.next(Wo);const Ti=ne(sr,this.rootComponentType).snapshot;return D={...Z,targetSnapshot:Ti,urlAfterRedirects:sr,extras:{...gr,skipLocationChange:!1,replaceUrl:!1}},(0,J.of)(D)}return this.rawUrlTree=Z.rawUrl,Z.resolve(null),de.E}),qt(Z=>{const Ne=new Co(Z.id,this.serializeUrl(Z.extractedUrl),this.serializeUrl(Z.urlAfterRedirects),Z.targetSnapshot);this.triggerEvent(Ne)}),(0,Ct.U)(Z=>D={...Z,guards:et(Z.targetSnapshot,Z.currentSnapshot,this.rootContexts)}),function tc(f,p){return(0,hn.z)(d=>{const{targetSnapshot:y,currentSnapshot:D,guards:{canActivateChecks:N,canDeactivateChecks:H}}=d;return 0===H.length&&0===N.length?(0,J.of)({...d,guardsResult:!0}):function Zs(f,p,d,y){return(0,ce.D)(f).pipe((0,hn.z)(D=>function is(f,p,d,y,D){const N=p&&p.routeConfig?p.routeConfig.canDeactivate:null;if(!N||0===N.length)return(0,J.of)(!0);const H=N.map(Z=>{const Ne=si(Z,p,D);return Ke(function Ul(f){return f&&rr(f.canDeactivate)}(Ne)?Ne.canDeactivate(f,p,d,y):Ne(f,p,d,y)).pipe(Vt())});return(0,J.of)(H).pipe(ir())}(D.component,D.route,d,p,y)),Vt(D=>!0!==D,!0))}(H,y,D,f).pipe((0,hn.z)(Z=>Z&&function ts(f){return"boolean"==typeof f}(Z)?function nc(f,p,d,y){return(0,ce.D)(p).pipe((0,On.b)(D=>Fe(function rs(f,p){return null!==f&&p&&p(new c(f)),(0,J.of)(!0)}(D.route.parent,y),function rc(f,p){return null!==f&&p&&p(new h(f)),(0,J.of)(!0)}(D.route,y),function ea(f,p,d){const y=p[p.length-1],N=p.slice(0,p.length-1).reverse().map(H=>function Zt(f){const p=f.routeConfig?f.routeConfig.canActivateChild:null;return p&&0!==p.length?{node:f,guards:p}:null}(H)).filter(H=>null!==H).map(H=>Xe(()=>{const Z=H.guards.map(Ne=>{const at=si(Ne,H.node,d);return Ke(function ec(f){return f&&rr(f.canActivateChild)}(at)?at.canActivateChild(y,f):at(y,f)).pipe(Vt())});return(0,J.of)(Z).pipe(ir())}));return(0,J.of)(N).pipe(ir())}(f,D.path,d),function os(f,p,d){const y=p.routeConfig?p.routeConfig.canActivate:null;if(!y||0===y.length)return(0,J.of)(!0);const D=y.map(N=>Xe(()=>{const H=si(N,p,d);return Ke(function Vl(f){return f&&rr(f.canActivate)}(H)?H.canActivate(p,f):H(p,f)).pipe(Vt())}));return(0,J.of)(D).pipe(ir())}(f,D.route,d))),Vt(D=>!0!==D,!0))}(y,N,f,p):(0,J.of)(Z)),(0,Ct.U)(Z=>({...d,guardsResult:Z})))})}(this.ngModule.injector,Z=>this.triggerEvent(Z)),qt(Z=>{if(D.guardsResult=Z.guardsResult,Pn(Z.guardsResult))throw yt(0,Z.guardsResult);const Ne=new bo(Z.id,this.serializeUrl(Z.extractedUrl),this.serializeUrl(Z.urlAfterRedirects),Z.targetSnapshot,!!Z.guardsResult);this.triggerEvent(Ne)}),(0,ft.h)(Z=>!!Z.guardsResult||(this.restoreHistory(Z),this.cancelNavigationTransition(Z,"",3),!1)),_i(Z=>{if(Z.guards.canActivateChecks.length)return(0,J.of)(Z).pipe(qt(Ne=>{const at=new ri(Ne.id,this.serializeUrl(Ne.extractedUrl),this.serializeUrl(Ne.urlAfterRedirects),Ne.targetSnapshot);this.triggerEvent(at)}),ve(Ne=>{let at=!1;return(0,J.of)(Ne).pipe(function mo(f,p){return(0,hn.z)(d=>{const{targetSnapshot:y,guards:{canActivateChecks:D}}=d;if(!D.length)return(0,J.of)(d);let N=0;return(0,ce.D)(D).pipe((0,On.b)(H=>function dc(f,p,d,y){const D=f.routeConfig,N=f._resolve;return void 0!==D?.title&&!fc(D)&&(N[vi]=D.title),function vo(f,p,d,y){const D=function hs(f){return[...Object.keys(f),...Object.getOwnPropertySymbols(f)]}(f);if(0===D.length)return(0,J.of)({});const N={};return(0,ce.D)(D).pipe((0,hn.z)(H=>function yi(f,p,d,y){const D=si(f,p,y);return Ke(D.resolve?D.resolve(p,d):D(p,d))}(f[H],p,d,y).pipe(Vt(),qt(Z=>{N[H]=Z}))),xt(1),function pn(f){return(0,Ct.U)(()=>f)}(N),At(H=>ci(H)?de.E:me(H)))}(N,f,p,y).pipe((0,Ct.U)(H=>(f._resolvedData=H,f.data=Ie(f,d).resolve,D&&fc(D)&&(f.data[vi]=D.title),null)))}(H.route,y,f,p)),qt(()=>N++),xt(1),(0,hn.z)(H=>N===D.length?(0,J.of)(d):de.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),qt({next:()=>at=!0,complete:()=>{at||(this.restoreHistory(Ne),this.cancelNavigationTransition(Ne,"",2))}}))}),qt(Ne=>{const at=new g(Ne.id,this.serializeUrl(Ne.extractedUrl),this.serializeUrl(Ne.urlAfterRedirects),Ne.targetSnapshot);this.triggerEvent(at)}))}),_i(Z=>{const Ne=at=>{const jt=[];at.routeConfig?.loadComponent&&!at.routeConfig._loadedComponent&&jt.push(this.configLoader.loadComponent(at.routeConfig).pipe(qt(pt=>{at.component=pt}),(0,Ct.U)(()=>{})));for(const pt of at.children)jt.push(...Ne(pt));return jt};return z(Ne(Z.targetSnapshot.root)).pipe(Ye(),re(1))}),_i(()=>this.afterPreactivation()),(0,Ct.U)(Z=>{const Ne=function ie(f,p,d){const y=Ae(f,p._root,d?d._root:void 0);return new Q(y,p)}(this.routeReuseStrategy,Z.targetSnapshot,Z.currentRouterState);return D={...Z,targetRouterState:Ne}}),qt(Z=>{this.currentUrlTree=Z.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(Z.urlAfterRedirects,Z.rawUrl),this.routerState=Z.targetRouterState,"deferred"===this.urlUpdateStrategy&&(Z.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,Z),this.browserUrlTree=Z.urlAfterRedirects)}),((f,p,d)=>(0,Ct.U)(y=>(new go(p,y.targetRouterState,y.currentRouterState,d).activate(f),y)))(this.rootContexts,this.routeReuseStrategy,Z=>this.triggerEvent(Z)),qt({next(){N=!0},complete(){N=!0}}),bn(()=>{N||H||this.cancelNavigationTransition(D,"",1),this.currentNavigation?.id===D.id&&(this.currentNavigation=null)}),At(Z=>{if(H=!0,vt(Z)){It(Z)||(this.navigated=!0,this.restoreHistory(D,!0));const Ne=new un(D.id,this.serializeUrl(D.extractedUrl),Z.message,Z.cancellationCode);if(y.next(Ne),It(Z)){const at=this.urlHandlingStrategy.merge(Z.url,this.rawUrlTree),jt={skipLocationChange:D.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Ss(D.source)};this.scheduleNavigation(at,"imperative",null,jt,{resolve:D.resolve,reject:D.reject,promise:D.promise})}else D.resolve(!1)}else{this.restoreHistory(D,!0);const Ne=new ho(D.id,this.serializeUrl(D.extractedUrl),Z,D.targetSnapshot??void 0);y.next(Ne);try{D.resolve(this.errorHandler(Z))}catch(at){D.reject(at)}}return de.E}))}))}resetRootComponentType(d){this.rootComponentType=d,this.routerState.root.component=this.rootComponentType}setTransition(d){this.transitions.next({...this.transitions.value,...d})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(d=>{const y="popstate"===d.type?"popstate":"hashchange";"popstate"===y&&setTimeout(()=>{const D={replaceUrl:!0},N=d.state?.navigationId?d.state:null;if(N){const Z={...N};delete Z.navigationId,delete Z.\u0275routerPageId,0!==Object.keys(Z).length&&(D.state=Z)}const H=this.parseUrl(d.url);this.scheduleNavigation(H,y,N,D)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(d){this.events.next(d)}resetConfig(d){this.config=d.map(Or),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(d,y={}){const{relativeTo:D,queryParams:N,fragment:H,queryParamsHandling:Z,preserveFragment:Ne}=y,at=D||this.routerState.root,jt=Ne?this.currentUrlTree.fragment:H;let pt=null;switch(Z){case"merge":pt={...this.currentUrlTree.queryParams,...N};break;case"preserve":pt=this.currentUrlTree.queryParams;break;default:pt=N||null}return null!==pt&&(pt=this.removeEmptyProps(pt)),sn(at,this.currentUrlTree,d,pt,jt??null)}navigateByUrl(d,y={skipLocationChange:!1}){const D=Pn(d)?d:this.parseUrl(d),N=this.urlHandlingStrategy.merge(D,this.rawUrlTree);return this.scheduleNavigation(N,"imperative",null,y)}navigate(d,y={skipLocationChange:!1}){return function mc(f){for(let p=0;p<f.length;p++){if(null==f[p])throw new E.vHH(4008,false)}}(d),this.navigateByUrl(this.createUrlTree(d,y),y)}serializeUrl(d){return this.urlSerializer.serialize(d)}parseUrl(d){let y;try{y=this.urlSerializer.parse(d)}catch(D){y=this.malformedUriErrorHandler(D,this.urlSerializer,d)}return y}isActive(d,y){let D;if(D=!0===y?{...Fo}:!1===y?{...gc}:y,Pn(d))return Tn(this.currentUrlTree,d,D);const N=this.parseUrl(d);return Tn(this.currentUrlTree,N,D)}removeEmptyProps(d){return Object.keys(d).reduce((y,D)=>{const N=d[D];return null!=N&&(y[D]=N),y},{})}processNavigations(){this.navigations.subscribe(d=>{this.navigated=!0,this.lastSuccessfulId=d.id,this.currentPageId=d.targetPageId,this.events.next(new Zn(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),d.resolve(!0)},d=>{this.console.warn(`Unhandled Navigation Error: ${d}`)})}scheduleNavigation(d,y,D,N,H){if(this.disposed)return Promise.resolve(!1);let Z,Ne,at;H?(Z=H.resolve,Ne=H.reject,at=H.promise):at=new Promise((ln,sr)=>{Z=ln,Ne=sr});const jt=++this.navigationId;let pt;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(D=this.location.getState()),pt=D&&D.\u0275routerPageId?D.\u0275routerPageId:N.replaceUrl||N.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):pt=0,this.setTransition({id:jt,targetPageId:pt,source:y,restoredState:D,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:d,extras:N,resolve:Z,reject:Ne,promise:at,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),at.catch(ln=>Promise.reject(ln))}setBrowserUrl(d,y){const D=this.urlSerializer.serialize(d),N={...y.extras.state,...this.generateNgRouterState(y.id,y.targetPageId)};this.location.isCurrentPathEqualTo(D)||y.extras.replaceUrl?this.location.replaceState(D,"",N):this.location.go(D,"",N)}restoreHistory(d,y=!1){if("computed"===this.canceledNavigationResolution){const D=this.currentPageId-d.targetPageId;"popstate"!==d.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===D?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===D&&(this.resetState(d),this.browserUrlTree=d.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(D)}else"replace"===this.canceledNavigationResolution&&(y&&this.resetState(d),this.resetUrlToCurrentUrlTree())}resetState(d){this.routerState=d.currentRouterState,this.currentUrlTree=d.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,d.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(d,y,D){const N=new un(d.id,this.serializeUrl(d.extractedUrl),y,D);this.triggerEvent(N),d.resolve(!1)}generateNgRouterState(d,y){return"computed"===this.canceledNavigationResolution?{navigationId:d,\u0275routerPageId:y}:{navigationId:d}}}return f.\u0275fac=function(d){E.$Z()},f.\u0275prov=E.Yz7({token:f,factory:function(){return _s()},providedIn:"root"}),f})();function Ss(f){return"imperative"!==f}let Ii=(()=>{class f{constructor(d,y,D){this.router=d,this.route=y,this.locationStrategy=D,this.commands=null,this.href=null,this.onChanges=new M.x,this.subscription=d.events.subscribe(N=>{N instanceof Zn&&this.updateTargetUrlAndHref()})}set routerLink(d){this.commands=null!=d?Array.isArray(d)?d:[d]:null}ngOnChanges(d){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(d,y,D,N,H){if(0!==d||y||D||N||H||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const Z={skipLocationChange:(0,E.D6c)(this.skipLocationChange),replaceUrl:(0,E.D6c)(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,Z),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:(0,E.D6c)(this.preserveFragment)})}}return f.\u0275fac=function(d){return new(d||f)(E.Y36(xn),E.Y36($),E.Y36(Ze.S$))},f.\u0275dir=E.lG2({type:f,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(d,y){1&d&&E.NdJ("click",function(N){return y.onClick(N.button,N.ctrlKey,N.shiftKey,N.altKey,N.metaKey)}),2&d&&E.uIk("target",y.target)("href",y.href,E.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[E.TTD]}),f})();class io{}let Is=(()=>{class f{constructor(d,y,D,N,H){this.router=d,this.injector=D,this.preloadingStrategy=N,this.loader=H}setUpPreloading(){this.subscription=this.router.events.pipe((0,ft.h)(d=>d instanceof Zn),(0,On.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(d,y){const D=[];for(const N of y){N.providers&&!N._injector&&(N._injector=(0,E.MMx)(N.providers,d,`Route: ${N.path}`));const H=N._injector??d,Z=N._loadedInjector??H;N.loadChildren&&!N._loadedRoutes&&void 0===N.canLoad||N.loadComponent&&!N._loadedComponent?D.push(this.preloadConfig(H,N)):(N.children||N._loadedRoutes)&&D.push(this.processRoutes(Z,N.children??N._loadedRoutes))}return(0,ce.D)(D).pipe((0,K.J)())}preloadConfig(d,y){return this.preloadingStrategy.preload(y,()=>{let D;D=y.loadChildren&&void 0===y.canLoad?this.loader.loadChildren(d,y):(0,J.of)(null);const N=D.pipe((0,hn.z)(H=>null===H?(0,J.of)(void 0):(y._loadedRoutes=H.routes,y._loadedInjector=H.injector,this.processRoutes(H.injector??d,H.routes))));if(y.loadComponent&&!y._loadedComponent){const H=this.loader.loadComponent(y);return(0,ce.D)([N,H]).pipe((0,K.J)())}return N})}}return f.\u0275fac=function(d){return new(d||f)(E.LFG(xn),E.LFG(E.Sil),E.LFG(E.lqb),E.LFG(io),E.LFG(Si))},f.\u0275prov=E.Yz7({token:f,factory:f.\u0275fac}),f})();const Di=new E.OlP("");let _o=(()=>{class f{constructor(d,y,D={}){this.router=d,this.viewportScroller=y,this.options=D,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},D.scrollPositionRestoration=D.scrollPositionRestoration||"disabled",D.anchorScrolling=D.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(d=>{d instanceof Rr?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=d.navigationTrigger,this.restoredId=d.restoredState?d.restoredState.navigationId:0):d instanceof Zn&&(this.lastId=d.id,this.scheduleScrollEvent(d,this.router.parseUrl(d.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(d=>{d instanceof C&&(d.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(d.position):d.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(d.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(d,y){this.router.triggerEvent(new C(d,"popstate"===this.lastSource?this.store[this.restoredId]:null,y))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return f.\u0275fac=function(d){E.$Z()},f.\u0275prov=E.Yz7({token:f,factory:f.\u0275fac}),f})();const fn=new E.OlP("ROUTER_FORROOT_GUARD"),vc=new E.OlP(""),Hl=[Ze.Ye,{provide:eo,useClass:lr},{provide:xn,useFactory:_s},T,{provide:$,useFactory:function $l(f){return f.routerState.root},deps:[xn]},Si];function Wl(){return new E.PXZ("Router",xn)}let Gl=(()=>{class f{constructor(d){}static forRoot(d,y){return{ngModule:f,providers:[Hl,[],yc(d),{provide:fn,useFactory:Yl,deps:[[xn,new E.FiY,new E.tp0]]},{provide:yo,useValue:y||{}},y?.useHash?{provide:Ze.S$,useClass:Ze.Do}:{provide:Ze.S$,useClass:Ze.b0},{provide:Di,useFactory:()=>{const f=(0,E.f3M)(xn),p=(0,E.f3M)(Ze.EM),d=(0,E.f3M)(yo);return d.scrollOffset&&p.setOffset(d.scrollOffset),new _o(f,p,d)}},y?.preloadingStrategy?$o(y.preloadingStrategy):[],{provide:E.PXZ,multi:!0,useFactory:Wl},y?.initialNavigation?Ho(y):[],[{provide:Ci,useFactory:Un},{provide:E.tb,multi:!0,useExisting:Ci}]]}}static forChild(d){return{ngModule:f,providers:[yc(d)]}}}return f.\u0275fac=function(d){return new(d||f)(E.LFG(fn,8))},f.\u0275mod=E.oAB({type:f}),f.\u0275inj=E.cJS({}),f})();function Yl(f){return"guarded"}function yc(f){return[{provide:ys,multi:!0,useValue:f}]}function Un(){const f=(0,E.f3M)(E.zs3);return p=>{const d=f.get(E.z2F);if(p!==d.components[0])return;const y=f.get(xn),D=f.get(fa);1===f.get(Dr)&&y.initialNavigation(),f.get(vc,null,E.XFs.Optional)?.setUpPreloading(),f.get(Di,null,E.XFs.Optional)?.init(),y.resetRootComponentType(d.componentTypes[0]),D.next(),D.complete()}}const Ci=new E.OlP("");function Ho(f){return["disabled"===f.initialNavigation?[{provide:E.ip1,multi:!0,useFactory:()=>{const f=(0,E.f3M)(xn);return()=>{f.setUpLocationChangeListener()}}},{provide:Dr,useValue:2}]:[],"enabledBlocking"===f.initialNavigation?[{provide:Dr,useValue:0},{provide:E.ip1,multi:!0,deps:[E.zs3],useFactory:f=>{const p=f.get(Ze.V_,Promise.resolve(null));let d=!1;return()=>p.then(()=>new Promise(D=>{const N=f.get(xn),H=f.get(fa);(function y(D){f.get(xn).events.pipe((0,ft.h)(H=>H instanceof Zn||H instanceof un||H instanceof ho),(0,Ct.U)(H=>H instanceof Zn||H instanceof un&&(0===H.code||1===H.code)&&null),(0,ft.h)(H=>null!==H),re(1)).subscribe(()=>{D()})})(()=>{D(!0),d=!0}),N.afterPreactivation=()=>(D(!0),d||H.closed?(0,J.of)(void 0):H),N.initialNavigation()}))}}]:[]]}const fa=new E.OlP("",{factory:()=>new M.x}),Dr=new E.OlP("",{providedIn:"root",factory:()=>1});function $o(f){return[Is,{provide:vc,useExisting:Is},{provide:io,useExisting:f}]}}},Mt=>{Mt(Mt.s=3543)}]);